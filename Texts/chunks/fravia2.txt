.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>



<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>neto_03.htm HTMLPad: A nasty protection</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%  HEIGHT=" 22">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">HTMLPad</fonT><br>
        <FONT SIZE="+1">A nasty protection</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm"><IMG SRC="images/protecti.gif" tppabs="http://members.xoom.com/tsehp_/images/protecti.gif" 
ALT="our protections" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Our Protections</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
25 July 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Miguel Neto
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" 
ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td>
</tr>
<TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" 
ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited<br>
by reverser+</center></td>
</TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font 
color="#C4C0CF">fra_00xx<bR>980725<br>MiguelNeto<br>0100<br>OP<br>PC<br
></fonT></td><td><i><center>
<font color=purple>"Sorry.  You'll have to crack
the code again.  In the mean
time you can fix the little
presents that are going to be left on
your machine!"</fonT><bR>Well, my first natural reaction, like that of Miguel Neto, 
was of anger against Intermania (Portland, Oregon) and its product (HTMLPad, version 2.6), yet, come to think of it inside the perspective of the 'larger scheme of things', this 
is actually not a bad idea at all 
for a (lame but working) protection scheme.<bR>In fact no 'real' cracker would 
have any difficulty in cracking any protection scheme, however complex, therefore 
concentrating on 'heavy' protection schemes does not 
make much sense. See: shareware authors are 
not loosing money because a couple of dozens of real crackers, out there, study (or even 
explain to other 'studiosi') their protection schemes, they are 
loosing money because million of morons, that would not 
understand what a byte is if it come out of the screen in order to bite them, use ready made patches (made by some 
real cracker of the darker side) in order to steal software. Therefore it makes A LOT of sense 
to concnetrate in punishing the lusers, since outsmarting the crackers is much too difficult for 
programmers that have drunk too much visual basic and too few assembly.<br>This 
kind of protection schemes (I have seen other on the same lines) are patently 
directed against 
all those morons that seek ready-made cracks and use them in order to steal targets 
<br>Anyway why should we care? We are NOT friends of the 
luser little thieves, are we? So I reckon that this is actually <u>a pretty good idea</u> and 
easy to implement: 1) Release your soft with 
dummy cracker/password couples and a simple protection scheme that is ready to wreak havoc inside 
the luser's machine.  
2) A couple of weeks later, if your soft is worth something (a very big if most of the time) you'll 
find a dozen of ready made cracks on any warez site. 3) Release a second version of your soft 
that has this time 'real' cracker/password couples and screw up the lusers' machines.
<br>Not bad: I like it!<br>(You may also find very useful -along similar protection lines- 
to read 
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Ghiribizzo's ideas</a> 
about a 'later implemented' part of the serial number).
<br>BTW: does really exist a 
cracker "thatguy"? Or did they mean 'thatdude'? Or did they purposely seed some ready made 
cracks with name 'thatguy'? Who knows?
</i></center></td>
<td></td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in 
everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
()<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> ( 
)<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
This essay will show you how to deprotect HPAD, a nag and function
disabled 
protected program<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
HTMLPad
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
A nasty protection
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
Miguel Neto
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 
color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
<p>
Hi, it's me again. This protection is slightly more difficult than the
ones I 
tackled in my former essays, so, in order to spare you (and me) some
time, 
I'll try to avoid the usual jokes (reverser cuts most of them off anyway
:-)   <p>
The target you will need for this cracking session is called HTMLPad,
it is 
a nice web-design utility. Basically, it provides shortctus for the
HTML tags;
You have more control over the HTML code than if you used a standard
editor, but 
you don't loose as much time as if you wrote the code with UltraEdit. 

</p>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools 
required</fonT>
</fonT></center></td></tr></table>
Wdasm<br>Soft-Ice<br>Your Favourite HexEditor<!-- PASTE HERE YOUR 
REQUIRED TOOLS -->
<br><br>


<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font 
color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<p>
First of all, install the target. Play with it a little. All done? ok.
If you've read, as you should, the help files, you will notice that we
already 
have this shareware limitations listed. Here is the snippet from that
file:
<bR>
<h3>HTMLpad Registration</h3>

<p>By purchasing HTMLpad and registering your copy, you will be
entitled to 
additional benefits such as:<br><br>

<ul> 

<li type="box">Not seeing the friendly shareware reminder message 
anymore.</li>
<li type="box">Unlock the Custom Update Stamp feature under the options 
dialog</li>
<li type="box">Automatic notification of updates and new releases</li>
<li type="box">Discounts on future releases</li>
<li type="box">Extended Technical Support</li>

</ul>
<pre>Our task will be to remove the first 2 limitations: the nag and the 
crippling lock.

The target's weak points, which you should be able to identify after playing 
a few minutes with this program, are the following:

1) The Option to Register
2) The &quot;Registered to&quot; String in the about box
3) The Nag Itself

Let's try to stalk the first one; 

Disassembling the target and searching for the invalid reg code
error message, you will land here (some code has been removed in 
order to spare you dw time:

:0046511E E8D1900000              call 0046E1F4
:00465123 3C01                    cmp al, 01
:00465125 7517                    jne 0046513E
(...)

* StringData Ref from Code Obj -&gt;&quot;Thank you for registering HTMLpad! &quot;
                               -&gt;&quot;Keep the registration number in &quot;
                               -&gt;&quot;a safe place in case you need &quot;
                               -&gt;&quot;it at a later date.&quot;
                                  |
:00465132 B8E4514600              mov eax, 004651E4
:00465137 E8E484FDFF              call 0043D620
:0046513C EB1C                    jmp 0046515A

* Referenced by a  Jump at Address: 00465125(C)
|
:0046513E 8BC3                    mov eax, ebx
(..)
* StringData Ref from Code Obj -&gt;&quot;You have entered an invalid 
        			      &quot;registration number.&quot;
                                  |
:00465150 B864524600              mov eax, 00465264

Bottom line, if after the call at 46511E al is 1 we are registered. 
Of course, if you nop the jne at 465125, you will get a thank you
message, but you will still be unregistered. But let's see where 
else is 46E1F4 called from...

* Referenced by a CALL at Addresses:004610C9, :00464D90, :0046511E, :00473294   
|
:0046E1F4 E803000000              call 0046E1FC
:0046E1F9 C3                      ret

I reckon that it is the first time that I see a call such as this one, 
but nevermind, let's go on. We must now inspect the locations that call
our 6E1F4... I didn't find the code at 610C9 very interesting, you can
and should check for yourself ofcourse... However, at 64D90 we see
this:

:00464D90 E85F940000              call 0046E1F4
:00464D95 84C0                    test al, al
:00464D97 745C                    je 00464DF5
(...)
* Possible StringData Ref from Code Obj -&gt;&quot;UNREGISTERED&quot;
                                  |
:00464DF5 BA8C4E4600              mov edx, 00464E8C
 
If after the call, al is 0, we are REGISTERED TO UNREGISTERED.
Otherwise, the application will get our name from the registry (see 
your own dead listing, I didn't want to overcode this essay) and print 
it instead of UNREGISTERED. So, once again, if the al flag is 1, our 
reg code has been accepted and we will nolonger be &quot;unregistered&quot;. But 
that is not all...
In Soft-Ice, set a breakpoint at 46E1F4. Now click on &quot;About HTML PAD&quot;
Soft-Ice will bang, confirming our speculations. 
Now click on Register. Soft-Ice pops up again.
Finally, click on Options (one of them was locked, remember?). Soft-Ice
will pop up once more. So, Now, if you change the instruction at 4610C9
from

call 46e1f4 

to, say

mov al, 00
inc al
jmp 46e1f9

You will take care of all of this target's limits *but* the nag. 

Why? Rememeber that I was surprised that all 6E1F4 did was to call
6E1FC? Why not call 46E1FC in the first place, thus saving a lot
of bytes? (Compiler constraints... you'll find the same pattern at 
73C3C, 7DF2C and 812D4 for instance) In anycase, this means that calling 
6E1F4 has exactly the same effect as calling 6E1FC; so maybe some 
limits call the latter instead of the former... Just to make sure, set
a breakpoint on 46E1FC in Soft-Ice. Now insert a few scripts (this will
make the nag appear). Bingo! Soft-Ice pops up! Press F12 and what do you
know...
Here is what you get:

:00480CEC E80BD5FEFF              call 0046E1FC
:00480CF1 84C0                    test al, al
:00480CF3 7507                    jne 00480CFC
  
You just have to change that jne to jmp and you will never see the nag
again.
However, that makes a lot of changes, and since the only thing that
matters is to get flag 1 at al at the end of the call, we might as 
well just patch the former. 
The boys at intermania have realised this: inside this huge call,
we can admire the following snippet:

* StringData Ref from Code Obj -&gt;&quot;thatguy&quot;
                                  |
:0046E28D BA20E44600              mov edx, 0046E420
:0046E292 E8C959F9FF              call 00403C60
:0046E297 7528                    jne 0046E2C1
:0046E299 6A00                    push 00000000
:0046E29B 668B0D28E44600          mov cx, word ptr [0046E428]
:0046E2A2 B202                    mov dl, 02

* StringData Ref from Code Obj -&gt;&quot;Sorry.  You'll have to crack the &quot;
                                        -&gt;&quot;code again.  In the mean time &quot;
                                        -&gt;&quot;you can fix the little presents &quot;
                                        -&gt;&quot;that are going to be left on your &quot;
                                        -&gt;&quot;machine!&quot;</prE>

Pathetic! To put this at the sight of everyone TENTHS of bytes before
the end of the call, giving us all the room we want to patch. I suppose 
intermaniacs think they are funny... They are morons... I won't even
bother
to make fun of them, humour is a powerful weapon, but it can only hurt
those
who have a minimum sense of *pride*, which is not the case of the
Intermania 
programmers... You guys don't deserve my respect... Not knowing how to 
program is one thing, but trying to #$%&/!up my machine and NOT doing
it right is an insult to my intelligence... You can
thank the fact that +we are not crackers of the dark side, else you would be
bankrupt before you could say "censorship"!
<p>
Anyway, let's finish this:
<p>
Since the end of the call is as follows:<pre>

:0046E3BC 8BC3                    mov eax, ebx
:0046E3BE 5E                      pop esi
:0046E3BF 5B                      pop ebx
:0046E3C0 8BE5                    mov esp, ebp
:0046E3C2 5D                      pop ebp
:0046E3C3 C3                      ret

Anyone that cares would just need to change

:0046E3BC 8BC3                    mov eax, ebx

to 

:0046E3BC B001                    mov al, 01</prE>

And there you go, you are fully registered. Of course, if you want to be 
registered
with a chosen name (for instance 
'thatguy' :-) you have to first make these changes in memory just
before 
you enter
your chosen name and chosen bogus code, 
then close the program, patch it, and rerun. 
<bR>
Alternatively, of course, 
you could also make the changes later, directly inside 
the registry (the dead
listing will show 
you 
where :-)
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final 
Notes</fonT>
</fonT></center></td></tr></table>

I hope all this didn't sound too confusing, if you have any doubts or
comments
please send them to <A HREF=mailto:"mneto@bigfoot.com">mneto@bigfoot.com</a> (me)<!-- PASTE 
HERE YOUR FINAL NOTES (if any) -->
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= 
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob 
Duh</fonT></fonT>
</center></td></tr></table>
 <center>
   <i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for
a longer 
   period than the allowed one. Should you want 
   to STEAL this software instead, you don't need to crack its
protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged (just watch it in this case :-)... 
farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->

<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 
VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->

<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to 
Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A 
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' 
essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy 
database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality 
cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to 
search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript 
wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity 
academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>&nbsp;
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse 
engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
This page was last updated on 21-07-98 20:12 using <a href="http://www.intermania.com/htmlpad/" >HTMLpad</a>.
</BODY>
</HTML><html>
<head>
<title>drlan1</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<p><center><font SIZE="+3">Cool 3D by Ulead - up against nags and smears<br>
</font><font SIZE="+2">Easy unsmearing and denagging</font>
<br>
</center>

<h4><center><i>by DrLan</i><br>
(03 September 1997)</center></h4>

<center><hr><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> Courtesy of Reverser's page of reverse engineering<br>
<hr> <i>Well, it's a stimulating essay. As usual, when two brains do reverse the 
same target, they pick very interesting approaches, you may like to have a look at plushmm's attempt on the same target in order to learn even more from a single  session</i></center><hr size="6"><pre>
Target Program: Cool 3D by Ulead
Protection: Nag(s), &quot;smearing&quot;
Cracked by: drlan [Me'97/C4N]!
Location: <a href="FRAVIA_index.htm#190 tppabs=" tppabs="http://members.xoom.com/tsehp_/index.htm#190 tppabs=" http://www.ulead.com/" ">http://www.ulead.com</a>

Tools needed:
- SoftICE Win95 3.01 (see +HCU's <a href="project2.htm" tppabs="http://members.xoom.com/tsehp_/project2.htm">project 2</a>)
- W32Dasm 8.9 (any version will do... see +HCU's <a href="project0.htm" tppabs="http://members.xoom.com/tsehp_/project0.htm">project 0</a>)
- Hex Editor (I like <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#37" tppabs="http://fravia.org/tppmsgs/msgs0.htm#37">PSEdit</a> and Hex Workshop)

I didn't realize it when I set out to crack this program, but it had
already been cracked by plushmm.  Should have checked first.  Anyway,
I did crack it and I'd like to share what I found so that others may
benefit from this knowledge.

I started out by running the program to get a feel for the protection.
The program pops in the beginning with a nag screen.  Anything you try
to print or save has the word SAMPLE &quot;smeared&quot; on it.  Finally, we get
another nag upon exiting the program.  The nag tells us that if we are
good people and buy the registered version, we will be free to use it
without the lovely nag screen and that our output won't have the SAMPLE
banner.  There is no option to &quot;enable&quot; the program by entering a name
and registration code, so we're going to have to crack this babe.  Ok,
sounds like we're up against the nag(s) and the smear.

I like to &quot;dead list&quot; a program before I whip out the ice (SoftICE).
So, I fired up W32Dasm and let 'er rip.  If you're using a registered
version of W32Dasm, you'll end up with a file called u3dedit.alf in your
W32Dasm\wpjfiles directory.  This file will be about 12 Mb.  You can use
W32Dasm to search the listing or save the file and use your favourite word
processor or text file lister.  In my listing I found a few interesting
items in the imports section:

   Import Module 005: About.dll

Addr:000B52C6 hint(0002) Name: IsFullVersion    ; here
Addr:000B52B6 hint(0004) Name: ShowAboutBox     ; here
Addr:000B52D6 hint(0001) Name: InitAboutDll

Let's look deeper at our listing to see where these functions are called.
Here's the first spot.  I've included a little extra code prior to the
ShowAboutBox because something interesting lurks here...

* Reference To: USER32.IsWindowVisible, Ord:016Ah
|
:00410552 FF15784F4B00            Call dword ptr [004B4F78]
:00410558 85C0                    test eax, eax
:0041055A 7418                    je 00410574
:0041055C 833DD0F64A0000          cmp dword ptr [004AF6D0], 00000000    ;here
:00410563 740F                    je 00410574
:00410565 8B45F0                  mov eax, dword ptr [ebp-10]
:00410568 FF701C                  push [eax+1C]

* Reference To: About.ShowAboutBox, Ord:0004h
|
:0041056B FF15C0494B00            Call dword ptr [004B49C0]
:00410571 83C404                  add esp, 00000004

* Referenced by a Jump at Addresses:0041055A(C), :00410563(C)
|
:00410574 8D45BC                  lea eax, dword ptr [ebp-44]
:00410577 8B4DF0                  mov ecx, dword ptr [ebp-10]
:0041057A C745BC2C000000          mov [ebp-44], 0000002C
:00410581 50                      push eax
:00410582 E84BE20400              call 0045E7D2

Hmm, that location [004AF6D0] looks a lot like a good guy/bad guy &quot;flag&quot;
to me.  Why?  Well, the je 00410574 following the compare jumps right
over the ShowAboutBox (nag).  We need to find out where the flag gets set.
So, let's find out where that memory location gets written to.  Clear or
disable any existing breakpoints in SoftICE.

sICE command: bd * (to temporarily disable all breakpoints)
or: bc * (to clear all breakpoints)

Set a breakpoint on memory write to our suspect location.

sICE command: bpm 004AF6D0 w

Now run the program.  SoftICE should pop at the following code section:

* Reference To: About.IsFullVersion, Ord:0002h
|
:00439979 FF15BC494B00            Call dword ptr [004B49BC]
:0043997F 83C404                  add esp, 00000004
:00439982 8DBED8000000            lea edi, dword ptr [esi+000000D8]
:00439988 C786C000000001000000    mov dword ptr [esi+000000C0], 00000001 ;here
:00439992 6800010000              push 00000100
:00439997 83F801                  cmp eax, 00000001
:0043999A 1BC0                    sbb eax, eax
:0043999C 57                      push edi
:0043999D F7D8                    neg eax
:0043999F 6A00                    push 00000000

* Reference To: KERNEL32.GetModuleFileNameA, Ord:00FBh
|
:004399A1 FF15AC4B4B00            Call dword ptr [004B4BAC]
:004399A7 57                      push edi

Ok, the instruction mov dword ptr [esi+000000C0], 00000001 is setting
the &quot;flag&quot; to 1.  Remember, our previous code segment would have jumped
over the ShowAboutBox (nag) if this flag was zero.  This is the first
part of our crack.  We need to change the instruction into:

:00439988 C786C000000000000000    mov dword ptr [esi+000000C0], 00000000

This puts a 0 into our flag location and should make the program happy!

You can try it live in SoftICE by placing a breakpoint on the line that
sets the flag.  Run the program again and when it breaks on the line,
assemble in the new instruction.

sICE command: A
sICE command: mov dword ptr [esi+000000C0], 00000000
sICE command: Esc

Press F5 to continue running and you should be in, without the nag.

What's left?  Remember the nag said that the registered version did not
have the nag and that it did not print the SAMPLE banner across all the
output.  If you do a print or print preview, you'll see SAMPLE overlaid
on top of your nice 3D letters.  Not very appealing...  So, let's search
and destroy.

Back to our &quot;dead listing&quot; now...  Let's just search for SAMPLE.  Lo and
behold!  Could it be so easy?  Sure it could.  Again, I've included some
of the code from above because again it holds something interesting...

* Referenced by a Jump at Address:00423C55(C)
|
:00423C7A 8D45E0                  lea eax, dword ptr [ebp-20]
:00423C7D 8D4DB8                  lea ecx, dword ptr [ebp-48]
:00423C80 50                      push eax
:00423C81 E80A260400              call 00466290
:00423C86 8945E8                  mov dword ptr [ebp-18], eax
:00423C89 85C0                    test eax, eax
:00423C8B 7523                    jne 00423CB0                          ;here
:00423C8D C645FC01                mov [ebp-04], 01
:00423C91 E89E020000              call 00423F34
:00423C96 C645FC00                mov [ebp-04], 00
:00423C9A E89D020000              call 00423F3C
:00423C9F C745FCFFFFFFFF          mov [ebp-04], FFFFFFFF
:00423CA6 E8A3020000              call 00423F4E
:00423CAB E9A6020000              jmp 00423F56                          ;hmm?

* Referenced by a Jump at Address:00423C8B(C)
|

* Possible StringData Ref from Data Obj -&gt;&quot;SAMPLE&quot;
|
:00423CB0 BBB8994A00              mov ebx, 004A99B8
:00423CB5 53                      push ebx
:00423CB6 E8B5360200              call 00447370
:00423CBB 83C404                  add esp, 00000004
:00423CBE 8D4DB0                  lea ecx, dword ptr [ebp-50]
:00423CC1 51                      push ecx
:00423CC2 50                      push eax
:00423CC3 53                      push ebx
:00423CC4 FF75C0                  push [ebp-40]

* Reference To: GDI32.GetTextExtentPointA, Ord:0108h

Ok, so we are dropped right into the routine to setup for the SAMPLE
banner by this line:

:00423C8B 7523                    jne 00423CB0

If we hadn't taken this jump and continued down through the code, we would
have ended up at this line:

:00423CAB E9A6020000              jmp 00423F56

Let's see what's at :00423F56

* Referenced by a Jump at Addresses:00423AF8(C), :00423B03(C), :00423B6E(C), :00423BBE(U), :00423C75(U), :00423CAB(U), :00423D4D(U), :00423D96(U)
|
:00423F56 33C0                    xor eax, eax

* Referenced by a Jump at Addresses:00423B1E(U), :00423F0A(U)
|
:00423F58 8B4DF4                  mov ecx, dword ptr [ebp-0C]
:00423F5B 5F                      pop edi
:00423F5C 64890D00000000          mov dword ptr fs:[00000000], ecx
:00423F63 5E                      pop esi
:00423F64 5B                      pop ebx
:00423F65 8BE5                    mov esp, ebp
:00423F67 5D                      pop ebp
:00423F68 C3                      ret

Just tidying up a bit and preparing to RETurn.  This looks like it
might just jump right over the whole SAMPLE banner mess.  Let's try
it.  We could change the jne 00423CB0 from line :00423C8B in several
ways.  Two of the more common would be:

1) Blatantly NOP out the instruction(s).  NOP stands for No-Operation.
As the name implies, it basically does nothing.  NOP is a single byte
instruction so it would take 2 NOPs to wipe out our jne 00423CB0.  Some
programs &quot;sniff&quot; out multiple NOPs and will not behave correctly if they
detect &quot;tampering.&quot;  So perhaps a better way is something a little less
obvious.

2) Our master, +ORC teaches us that INC EAX, DEC EAX works quite nicely.
So we change:

:00423C8B 7523                    jne 00423CB0

into:

:00423C8B 40                      inc eax
:00423C8C 48                      dec eax

Which fills the space perfectly.  Our next instruction number is
:00423C8D which is correct.

You can try this live in SoftICE, or patch the program with your favorite
hex editor.  I, like +ORC, prefer the good old <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#37" tppabs="http://fravia.org/tppmsgs/msgs0.htm#37">PSEdit</a>.  It's small, fast 
and runs in DOS.

That should take care of our program.  The opening and closing nags are
gone and the annoying SAMPLE banner has been removed from our output.
This should make your evaluation far more enjoyable.

Note: The ShowAboutBox still lives behind the Help/About menu selection.
I tried opening the program in Borland's Resource Workshop to see if there
was a &quot;nicer&quot; about dialog that I could enable.  However, BRW choked on the
program and said it was an unrecognized format.

We could eliminate it altogether, though.  Search your dead listing again
for ShowAboutBox.  The first occurrence is the opening nag which we've fixed
by setting the flag to 0.  The second occurrence is the Help/About.  You can
tell because there are no conditional jumps into or over it.  Here is the
code segment.

:0043A2C6 8B411C                  mov eax, dword ptr [ecx+1C]
:0043A2C9 FF701C                  push [eax+1C]

* Reference To: About.ShowAboutBox, Ord:0004h
|
:0043A2CC FF15C0494B00            Call dword ptr [004B49C0]
:0043A2D2 83C404                  add esp, 00000004
:0043A2D5 C3                      ret

Let's try eliminating the call.  Again, this could be done any number of
different ways.  Here's the approach I took.

Change:

:0043A2CC FF15C0494B00            Call dword ptr [004B49C0]

into:

:0043A2CC 40                      inc eax
:0043A2CD 48                      dec eax
:0043A2CE 40                      inc eax
:0043A2CF 48                      dec eax
:0043A2D0 40                      inc eax
:0043A2D1 48                      dec eax

This makes :0043A2D2 our next instruction, which is good.  This trick
works here, but will not work in all circumstances.  You need to watch
what gets PUSHed onto the stack prior to the call.  A &quot;stack heavy&quot; call
usually cannot be eliminated in this way.  A more creative approach must
be taken under those circumstances.

Disclaimer: THIS ESSAY IS FOR EDUCATIONAL PURPOSES ONLY.  ANY USE, MIS-USE
OR ILLEGAL ACTIVITY IS THE SOLE RESPONSIBILITY OF THE READER.

GreetZ: Everyone in [Me'97/C4N], PC'97, UCF, reverser+ and +ORC.

Drlan

</pre><font color="green">
(c) Drlan, 1997. All rights reversed.</font>
		<hr size="2">
<center><i>You are deep inside reverser's page of reverse
engineering, choose your way out:</i></center>


<p><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#79" tppabs="http://fravia.org/tppmsgs/msgs0.htm#79">homepage </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> <a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#53" tppabs="http://fravia.org/tppmsgs/msgs0.htm#53">links
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"> <a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#78" tppabs="http://fravia.org/tppmsgs/msgs0.htm#78">students' essays </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser 
</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">is reverse engineering legal? </a></font></center></p>

<p><center><font SIZE="-1"><hr></font></center>
</body>
</html>
<HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>Howto41</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<H1 ALIGN=CENTER>HOW TO CRACK, by +ORC, A TUTORIAL</CENTER></H1>
<HR ALIGN=CENTER WIDTH=100% SIZE=1>
<center>
Lesson 4 (1): Time protections - An introduction</CENTER>
<CENTER>

<HR ALIGN=CENTER WIDTH=100% SIZE=1>
[PCFILE] [WLCHECK 16 bit] [WLCHECK 32 bit]
</CENTER>
<CENTER>
<TT>
<FONT SIZE=2>A short history of time</FONT>
</TT>
</CENTER>
<CENTER><HR ALIGN=CENTER WIDTH=50% SIZE=1></CENTER></P>
<center>
***********<BR>
+HCU material FEBRUARY 1997<BR>    
LECTIO IN FIERI<BR>                          
***********<BR>
</center>
<pre>
  (Hic sunt tabulae: Best viewed with good old Courier).
                A short history of time
                     (Lesson 4)
            Time protections in Windows, by +ORC

For 'time protections' we intend a serie of protection schemes
which are aimed to restrict the use of an application 
ONE
-to a predetermined amount of days, say 30 days, starting with
the first day of installation... 'CINDERELLA' TIME PROTECTIONS
TWO
-to a predetermined period of time (ending at a specific fixed
date) independently from the start date... 'BEST_BEFORE' TIME
PROTECTIONS
THREE
-to a predetermined amount of minutes and/or seconds each time
you fire them... 'COUNTDOWN' TIME PROTECTIONS 
FOUR
-to a predetermined amount of 'times' you use them, say 30 
times. Strictly speaking these protections are not 'time' 
dependent, but since their schemas are more or less on the 
same lines as in the cases ONE, TWO and THREE, we will examine
them inside this part of my tutorial. Let's call them 'QUIVER'
protections since, as with a quiver, you only have a 
predetermined amount of 'arrows' to shoot (and if you never 
went fishing with bow and arrows, on a mountain river, you do 
not know what's real zen... the fish springs out suddendly, but 
you 'knew' it, and your fingers had already reacted... a lot of 
broken arrows on the rocks, though :=)

     As first example I have chosen a double protected
application: it has a time protection (of the 'Cinderella' type,
limited to 90 days) as well as a 'quiver' protection
scheme, which is the other -not time bounded- current variante
of the shareware protections... i.e. you should use this program
only 25 times before a protection lock.
It's a relatively 'old' windows protection (april 1995). I found
the program on a cheap cd-rom, which I bought (in a bunch with
9 others) a month ago: 6000 megabytes of bad protected software
for the price of a good glass of wine! PCPLUS SUPER CD nø13,
originally edited in July 1995. I believe it should be pretty
easy to find it or to find this program on the Web if you do not
already have it inside your collection of cheap CD-ROM. Another
advantage of this program, from our perspective, is that the
whole PCFILE.EXE represents de facto the protection scheme
itself... not excessively overbloated: only 8912 bytes, when the
'real' application works inside the (huge and overbloated)
pcf.dll, which will be called only if the user passes the
protection. You can easily print the WHOLE disassembled listing
of PCFILE.EXE (46 Wordperfect pages), that you'll quickly get
through wcb (for instance). For once you'll have a COMPLETE and
COMPLICATED protection scheme under your eyes.
     Basically we'll study here the 'beginning' of more complex
time protection schemes, the ones we'll crack with our later
lessons. Some protection elements are here still 'na‹v', but the
protectionists have -at least- worked a little against easy
cracks... which makes this protection even more interesting for
us :=)
     This program shows even a 'nasty' behaviour: should you use
it after the locking snapped, it will obliterate the whole (main)
pcf.dll from your harddisk, without any warning. This obviously
does not mean anything at all here, but it's the secret to more
advanced (and nastier) protection schemes, so you better have a
look at it too. Nice, enough let's start now. 
[PCFILE] (aka the 'dll counter' method)
PCFILE, version 8, (PCFILE.EXE, 8912 bytes, 17 apr 1995, Atlantic
Coast software) is a database program which will be disabled
after having 90 days from its first use or after having used it
25 times, whichever comes first.
     We'll begin as usual: just use your wordprocessor search
capacities to search inside the whole directory (and
subdirectories) of PCFILE for words like 'demo' 'order' 'contact'
'expire' 'disabling' 'evaluation' and so on (alternatively, like
I do, you can write your own little C utility to do it even more
quickly and automatically on the whole 600 megabytes CD-ROM you
have inserted on your drive :=)... You'll see immediately that
only two of the PC-files can interest us: PCFILE.EXE and
PCFRES.DLL. A quick 'turbodumping' of PCFILE.EXE itself will
fetch all filenames and nagstrings we need to be happy from the
end of the file... here they are: 
A)   010C      PCF.DAT
B)   0114      PCF.DLL
1)   2.011C    PC-FIle demo has been disabled... 
2)   2.01A2    The PC-File demo program has reached the maximum
               allowable 25 sessions...
3)   2.0298    This demo version of PC-File 8 is designed...
4)   2.035A    The PC-File demo program has reached... 90 days
5)   2.0474    This is the last demo session...

When I see something like this I know that the crack is already
made... it's so easy I can't understand why they don't just give
their software away for free... money I suppose, people seem to
be obsessed with this prepuberal problem... how stupid, besides:
neminem pecunia divitem fecit. 
Beside, snooping inside files can be graet fun! At times you find 
some 'real' info inside them... Have a look at lotus Wordpro, 
for instance, you'll read something like: 'You idiot! Can't flow 
a partial paragraph!'; 'Yow! Need to SetFoundry() on this object!'; 
'Dude! I couldn't find myself!'; 'Ain't nothing to pop!' and many 
other amenities which throw a crude light on the life (and possible 
blunders) of commercial programmers and on the well know fact 
that most application are throw out FULL of bugs just in order 
to make money ('bugs for bucks').
OK, back to our cracking: let's just search for the above NUMBERS 
inside the code of PCFILE:
1)   PC-File has been disabled: 011C

  1.1100 >C8040100         enter   0104, 00
  1.1104  56               push    si
  1.1105  C70632060000     mov     word ptr [0632], 0000
  1.110B  6A00             push    0000
  1.110D  B81401           mov     ax, 0114; THIS is PCF.DLL
  1.1110  8946FE           mov     [bp-02], ax
  1.1113  50               push    ax
  1.1114  9A2E0D0212       call    1:0D2E ;what happens here?
  1.1119  83C404           add     sp, 0004
  1.111C  40               inc     ax
  1.111D  7532             jne     1151
  1.111F  1E               push    ds
  1.1120  681C01           push    011C  ;HERE****
  1.1123  8D86FCFE         lea     ax, [bp-0104]
  1.1127  16               push    ss
  1.1128  50               push    ax
  1.1129  9A6E110000       call    USER._WSPRINTF

Therefore this target will be disabled after a check at the
beginning of WinMain (1.1100) if ax, after having been
incremented is non zero. We should have a look at the routine at
1:0D2E to see what happens... but let's first check the other
nagstrings... no point in delving immediatly inside routines.

2) The PC-File demo has reached the maximum allowable 25
sessions... 01A2
  1.11C9 >807EFC66                 cmp     byte ptr [bp-04], 66
  1.11CD  7C0F                     jl      11DE
  1.11CF  6AFF                     push    FFFF
  1.11D1  9A36120000               call    USER.MESSAGEBEEP
  1.11D6  6A00                     push    0000
  1.11D8  1E                       push    ds
  1.11D9  68A201                   push    01A2 ; HERE ****
  1.11DC  EB62                     jmp     1240
Therefore 25 sessions if byte ptr [bp-04] >= 66 (as you can see,
the protectionists did not use anything vaguely similar to 25dec,
which is 19hex).

3)   This demo version of PC-File 8 is designed... : 0298

  1.11DE >807EFC4D         cmp     byte ptr [bp-04], 4D
  1.11E2  7518             jne     11FC
  1.11E4  6A00             push    0000
  1.11E6  1E               push    ds
  1.11E7  689802           push    0298 ;HERE ****
  1.11EA  1E               push    ds
  1.11EB  FF361000         push    word ptr [0010]
  1.11EF  6A00             push    0000
  1.11F1  9A48120000       call    USER.MESSAGEBOX
  1.11F6  C70632060100     mov     word ptr [0632], 1 ;Flag 632!
This 'Welcome nagged user' message appears therefore only THE
FIRST time you run, when our byte ptr [bp-04] has been set to 4D.
That figures: 66h - 4Dh = 19h, which are the 25 times allowed...
the programmers from Atlantic Coast must have thought something
like 'Stupid crackers will not fetch our nice clever protection:
he'll be searching for byte 19h! Ah!' Note the flag set in
location [632] if it's the first run :=)

4)   The PC-File demo program has reached... 90 days : 035A
  1.1211  833E320600               cmp     word ptr [0632], 0000
  1.1216  7565                     jne     127D
  1.1218  A13406                   mov     ax, [0634]
  1.121B  8B163606                 mov     dx, [0636]
  1.121F  2B062C06                 sub     ax, [062C]
  1.1223  1B162E06                 sbb     dx, [062E]
  1.1227  83FA76                   cmp     dx, 0076
  1.122A  7251                     jb      127D
  1.122C  7705                     ja      1233
  1.122E  3D00A7                   cmp     ax, A700
  1.1231  764A                     jbe     127D

  1.1233 >6AFF                     push    FFFF
  1.1235  9A3C130000               call    USER.MESSAGEBEEP
  1.123A  6A00                     push    0000
  1.123C  1E                       push    ds
  1.123D  685A03                   push    035A ; HERE!
  
There, location [634] in ax and location [636] in dx.
ax subtracts location [62C] and dx subtracts with carry location
[62E]. Is it more than 76h? (Which is 118 dec), Tell user he has
reached 90 days. Is it exactly 76h? Then have a look at ax, if
it is more than A700 then tell user the same.

5)        This is the last demo session... : 0474

  1.132D >56               push    si
  1.132E  9AFFFF0000       call    KERNEL._LCLOSE
  1.1333  807EFC66         cmp     byte ptr [bp-04], 66
  1.1337  7C19             jl      1352
  1.1339  6AFF             push    FFFF
  1.133B  9AFFFF0000       call    USER.MESSAGEBEEP
  1.1340  6A00             push    0000
  1.1342  1E               push    ds
  1.1343  687404           push    0474 ;HERE****
  1.1346  1E               push    ds
  1.1347  FF361000         push    word ptr [0010]
  1.134B  6A10             push    0010
  1.134D  9AFFFF0000       call    USER.MESSAGEBOX

  1.1352 >1E               push    ds
  1.1353  681401           push    0114 ;this is PCF.DLL
  1.1356  6A01             push    0001
  1.1358  9AFFFF0000       call    KERNEL.WINEXEC ;exec PCF.DLL

     And here, finally we have our good old [bp-04] -once more-
compared to 66h. Notice that there is no Jumpequal nor
jumpgreater check. This means that the program ALREADY KNOWS that
the user has reached here for the first time the fatidic 66. This
means (of course) that this code will be examined AFTER having
incremented the counter of the protection, which must therefore
happen somewhere between 1.123D and 1.132D (the end of routine
4 and the beginning of routine 5). If you have printed the whole
disassembled listing of PCFILE.EXE and if you have read my other
lessons about dead listing (-> 9.3 and 9.4) you do not need any
more to read the following part of this lesson. Choose your
armchair and sit there with a pen, your listing and a good
cocktail (may I suggest a good Martini-Wodka? Don't use anything
else but Moskowskaja). The moment to start 'feeling' the code has
come! You can do everything alone. Write colored arrows on your
listing! The first (or the fourth) simphony of Mahler on your CD!
Everything will appear!
     Indeed, if you prefer to follow here, behold: at 1.12B2 we
have a call KERNEL._LOPEN wich opens the file PCF.DLL (0114):

  1.12AD  681401      push    0114 ;want pcf.dll
  1.12B0  6A01        push    0001
  1.12B2  9AFFFF0000  call    KERNEL._LOPEN ;open it

and at 1.12CD we have the exact point where, inside pcf.dll, a
byte will be modified (at 10AF8):

  1.12C6  6A01                     push    0001
  1.12C8  68F80A                   push    0AF8
  1.12CB  6A00                     push    0000
  1.12CD  9AFFFF0000               call    KERNEL._LLSEEK

The only modification takes place therefore inside PCF.DLL, a
monstruosity of 1088832 bytes, where location 10af8 grows WITHOUT
any change in the date of the dll. You can easily check this: 
*    copy pcf.dll pcf.ded
*    (run pcfile a couple of time)
*    fc /b pcf.dll pcf.ded
fc /b is file compare /binary, good old (and quick) dos, duh?
And this is what you get... 

     Comparing files PCF.DLL and PCF.DED
     00010AF8: 55 50

Et voila mesdames et messieurs, found the other way round, please
note that this more 'practical' method can also be used *before*
beginning the dead listing examination of the file (and would
have given you the '0AF8' string to search for).

Well, what did we learn? A lot: an hidden counter grows in
another file without leaving many traces. The 'quiver'
protection snaps after growing more than 66h, having started at
4Dh. The flag for first time user is inside [0632]. [0634] and
[0636] are used for the current date, [062C] and [062E] are the
original date against which they are checked in a funny way.
     There are two different protections, therefore we'll need
two different cracks to deprotect this cram. Let's begin with the
easiest one.
Our FIRST crack, must destroy the counter that increases inside
pcf.dll (the '25' session allowance). This will be made cracking
following instruction:
  1.12F3  FE46FC                   inc     byte ptr [bp-04]
which is obviously the increasing instruction we are searching
for (BECAUSE it's the only 'inc byte ptr' in the whole stupid
program, AND because it is located short after the _LLSEEK, AND
because it's incrementing nobody else than our good old [bp-
04]... what do you want more, a neon green flashing arrow light
on the top of it?)
We'll very simply "noop" this instruction, transforming it, for
instance, in 40 90 48 (inc ax, nop, dec ax = do nothing). Well,
yes, that was it for the '25 sessions' lock protection, thankyou,
you may use the program a zillion times now. What now? Ah, yes,
the DATE lock, let's have a look once more at it:
  1.1218  A13406           mov     ax, [0634]
  1.121B  8B163606         mov     dx, [0636]
  1.121F  2B062C06         sub     ax, [062C]
  1.1223  1B162E06         sbb     dx, [062E]
  1.1227  83FA76           cmp     dx, 0076 ;118 (-90=1c)
  1.122A  7251             jb      127D
  1.122C  7705             ja      1233
  1.122E  3D00A7           cmp     ax, A700 ;(42572)
  1.1231  764A             jbe     127D

  1.1233 >6AFF             push    FFFF
  1.1235  9A3C130000       call    USER.MESSAGEBEEP
  1.123A  6A00             push    0000
  1.123C  1E               push    ds
  1.123D  685A03           push    035A ;HERE! 90 days!

Therefore, if location [636] is > than 76, the nag snaps.
This 76 is calculated through what SEEMS a simple comparison
between the actual date and the installation date.

  1.1218  A13406   mov     ax, [0634] ;load date ax
  1.121B  8B163606 mov     dx, [0636] ;load date dx
  1.121F  2B062C06 sub     ax, [062C] ;subtract first date
  1.1223  1B162E06 sbb     dx, [062E] ;subtract first date
  1.1227  83FA76   cmp     dx, 0076   ;allowed limit (?)
  1.122A  7251     jb      127D       ;ok: you may
  1.122C  7705     ja      1233       ;beggar off
  1.122E  3D00A7   cmp     ax, A700   ;well, what's this
  1.1231  764A    jbe     127D        ;then?

     In the reality there are various mathematical checkings
going on here, as the second check on ax = A700 shows. This DOES
NOT need to concern us much (we'll crack this code, later,
changing the 'first time user' flag), but it's useful you have
a rough understanding of what goes on inside these schemes,
therefore let's delve a little inside it. 
     Basically, the good old dos function GetSystemDate (21/2A)
works like this: On entry: ah = 2a
On return:
al = day of the week (0 = Sunday, 1 = Monday...)
cx = year
dh = month
dl = day
Short before the 90 days check, the protection calls two
routines:
1:09B4 (GetSystemDate) and 1:0D64 (FetchInstallationCode)
     The first one fetches the date (1.9D3-1.9D7) and the Time
(21/2C, at 1.9E2), get's ONCE MORE the system date (1.9F7)
subtracts the years against 1980 (1.A20: sub cx, 07BC) and then
makes quite a lot of maniuplation of these data (around 1.C7D,
where one year LESS than the current year will be stored in
[SI+03], in order to calculate the total amount of days). The
second one prepares the numbers for the sub ax and sbb dx of the
90 days check.
     As I said all this does not need to concern you much, coz
the protectionists have mad a 'protecion blunder': they have made
every time snapping depending on a flag, the one in [0632].
     What happens is: THE FIRST THING this program makes, smack
at the beginning of WinMain, is to set to zero (FALSE) the
abovementioned flag:
  1.1105  C70632060000             mov     word ptr [0632], 0000
Only in case of first time use, this flag will be set to TRUE at
  1.11F6  C70632060100             mov     word ptr [0632], 0001
knowing that, anyway, as soon as the program runs again this flag
will be reset to FALSE by Winmain.
And, as we saw, this flag is checked both for the 90 days snap:
  1.1211  833E320600               cmp     word ptr [0632], 0000
and for the 'This is your last day Cinderella' Warning:
  1.1315 >833E320600               cmp     word ptr [0632], 0000
A good fundamental crack will therefore be the 'automatical'
setting to TRUE of this flag by our Winmain:
  1.1105  C70632060100             mov     word ptr [0632], 0001
Everytime the program runs it will believe that's the first time
it does it.
I know, theoretically, having nooped the increase inside PCF.DLL,
the counter should remain always at 4D, which would set ANEW the
flag to true every run... but we do not want the first 'welcome'
nagscreen either, do we? Therefore:
****** Crack for PCFILE version 8, by +ORC, march 1997 ***
psedit pcf.dll
search         4E 49 44 4D   (4D only if you did not run it)
modify in      4E 49 44 50        (second time run)
psedit pcfile.exe
search         83 C4 06 FE 46 FC
modify in      83 C4 06 40 90 48  (nooped increase)
search         C7 06 32 06 00 00
modify in      C7 06 32 06 01 00  (flag always true)
*********************************************
As second example I have chosen a fairly interesting 'CINDERELLA' 
protection scheme of a Window application which can be useful for
our purposes: Link Check (Version 5.1), an application written
in august 1996. I'll crack here the Windows 3.1 version, for
reasons explained in lesson 9.4, but you'll easily find the Win95
version on the net, whose protection scheme works on the same
lines.
Link Check is a suite of three (3) diagnostic programs which
allows the user to examine different areas of the system.
1) Link Check (WLCHECK.EXE) enables the user to view the links
between an executable file and the modules it requires to run on
the system.
2) Memory Check (WMCHECK.EXE) allows the user to view, load and
unload modules currently in memory.
3) Function Check (WFCHECK.EXE) allows the user to view actual
function calls inside modules. 
WLCHECK  EXE     40400 24/08/96    5:10
WMCHECK  EXE     37104 18/08/96    5:10
WFCHECK  EXE     45424 24/08/96    5:10
WLCCOMM  DLL     46960 18/08/96    5:10
KSLHOOKS DLL     29568 15/08/96    1:00
The protection scheme inside this program allows a 21 days use
of the program, then 'disables' it. Even in the first 21
'allowed' days there are some functions that are disabled,
anyway. Another interesting feature of the protection scheme, is
that once you register, an 'electronic key' will be created and
sended to you in order to unlock Link Check for the full retail
version (which, as usual, means that the shareware version you
are using CAN be unlocked).
Therefore this application:
is TIME-LIMITED
has been CRIPPLED
has some DISABLED functions
can be UNLOCKED.
A wonderful world of cracking possibilities! Let's rub our hands!
So much to find! So much to learn! Thanks, Karri Software Ltd!
(100422.3521@compuserve.com)
For these protection schemes we must use both the 'Winice' live
approach and the 'dead listing' one. (both described elsewhere
in my tutorial).
Let's begin at the beginning, i.e. searching for strings inside
the WLCHECK.EXE we'll find nothing.
You'll soon realise that the protection scheme hides inside the
two *.dll WLCCOMM.DLL & KSLHOOKS.DLL... the real problem, with
this kind of protections, is that the 'modalities' to unlock it
are not known, i.e., that you cannot just crack the unlock
procedure itself, but you must reverse engineer the program long
enough to find the 'switch' that fires your cracked 'unlock'
procedure, in order to 'register' this program and in order to
be able to use it ad libitum.
What happens with time protections?
The first problem for the protectionists is the tampering with
the system date. Even a stupid user could set the system clock
backwards in order to use a program of the CINDERELLA sort. 
Your target would be easily fooled by any stupid user if it did
just set a variable [START_DATE] and then simply check the system
time with something like
     IF SystemTime > [START_DATE+30] then beggar off 
     ELSE OK
Therefore (almost) all this program use some sort of 'diode'
location. Like diodes, which let current through in only one
direction, these locations can only grow... i.e, if you set the
system time to 1 January 2000 and then run the program, it will
throw you off, as expected, but even when you go back to your
current year and date this will be 'remembered'...and the
protection will NOT allow you any more to use the program even
should you (theoretically) still have some free 'try me' days...
your setting at year 2000 screwed up your license for ever.
     IF SystemTime > [START_DATE+30] then [MARK_HERE]
     ELSE continue
     If [MARK_HERE] = TRUE then beggar off
     ELSE OK
Let's try altering the system date on our WLCHECK.EXE target...
Woa! As I said... it does not work anymore.

It's fairly easy to get at this part through Winice: Just bpx
WritePrivateProfileString (which is a very interesting function
indeed) and then have a good look at the pointers: You'll quick
find out that KSLHOOKS (Segment 0B) writes his own xCLSID value
inside system.ini. The block of KSLHOOKS.DLL's code responsable
for this is the following:
11.0569  9AE4013500  call    7:01E4   ;'Value' and 'SYSTEM.INI'
11.056E  83C408      add     sp, 8    ;adjusting stack
11.0571  8D843901    lea     ax, [si+0139]
11.0575  57          push    di     
11.0576  50          push    ax         ;pushing 'xCLSID'
11.0577  8D46FA      lea     ax, [bp-06]
11.057A  16          push    ss    
11.057B  50          push    ax         ;pushing 'Value'
11.057C  8D468A      lea     ax, [bp-76]
11.057F  16          push    ss     
11.0580  50          push    ax    ;pushing '{6178-0503...}'
11.0581  8D46EE      lea     ax, [bp-12]
11.0584  16          push    ss     
11.0585  50          push    ax         ;pushing 'SYSTEM.INI'
11.0586  9AFFFF0000  call    KERNEL.WRITEPRIVATEPROFILESTRING
11.058B  33C0        xor     ax, ax
11.058D  5E          pop     si
11.058E  5F          pop     di
11.058F  C9          leave  
11.0590  CB          retf   
 
The call to 7.01E4 fetches the strings 'Value' and 'SYSTEM.INI'
which are 'hardwired' there byte by byte, for instance, 'INI' is
fetched like this:
  7.0234  26C6440749    mov     byte ptr es:[si+07], 49 ;I
  7.0239  26C644084E    mov     byte ptr es:[si+08], 4E ;N
  7.023E  26C6440949    mov     byte ptr es:[si+09], 49 ;I

What is really interesting in this part of the protection scheme,
is that the function WritePrivateProfileString is one of the MOST
COMMON functions used for this kind of protections, being the
function normally used in order to 'keep track' inside an 'INI'
file of the particular configuration of an application that the
user has chosen... as a matter of fact this program creates an
hidden WLCHECK.SWL file inside c:\windows where it writes its
data, it also writes, through the above code,

[xCLSID]
Value={0000006236-0017105173-6326000000}
inside system.ini

and then it writes ANOTHER string inside the reg.dat 'register'
of the windows directory. A short digression, about registrations
in the reg.dat of the Windows directory. If you never had a look
at the reg.dat file (wich you should not have only firing
regedit.exe, but using the switch /v TROUGH THE COMMAND LINE
run!) you are in for a big surprise. If you are used to install
and de-install programs as much as I do, you'll be able to see,
for instance, real BATTLES between big or widespread software
packages (for instance Coreldraw and PaintShopPro) fought
there... but you'll also find some cryptic messages like 
WB_10=VMWB20
  FILTER = 000000000e
  OPTION = 0000000005
  TAG    = 0000001857
  KEY    = 0000184F
or, even more cryptic:
VxDSettings = {0000006178-0419758349-4326000000}
And this is actually our target, as you can see... the first
thing you should know is that some protection schemes hyde the
date checking part of their protection inside reg.dat.
The above value is the 'ID' of our target, and the ciffer in the
'middle' varies with the date and with the passing of the time.
     As we said, once the protection snaps, there is no 'normal'
way to reinstall a working copy of the program, even substituting
ALL the files with fresh ones and deleting the 'secret'
WLCHECK.SWL will not help... in order to reinstall this program
or to use it for the eternity (in 21 days chunks) you would have
to do the following every time the limit snaps:
A) regedit /v  
   delete key VxD
B) edit system.ini 
   manually delete the block
"[xCLSID]
 Value={0000006236-0017105173-6326000000}"
C) attrib c:\windows\wlcheck.swl -r -s -h
   del c:\windows\wlcheck.swl
D) reinstall everything anew and run 21 more days... clearly not
a satisfactory solution, exspecially given the fact that some
routines are disabled... therefore let's delve a little more
inside this protection scheme... we'll find a much neater crack,
you'll see... :=)
Since the 'legitimate' user will get 'an electronic key' from the
protectionists, there must exist, somewhere, a small menu of the
kind 'Enter your electronic key, legitimate sucker'... we could
find it searching with a little imagination (and/or zen) inside
our listings, but in these cases, it's much more quicker a small
run with WRT (Windows Resource Toolkit) by borland. Since we are
already inside KSLHOOKS.DLL, let's begin with this one.
Wrt loads kslhooks.dll and shows you immediatly that there are
only three dialog items, the last one, tagged as 'dialog 503'
represents the 'Unlock' little window: ('Please enter your key'),
which has two buttons: OK (1) and Cancel (2). Let's use WRT
'ID_tagging' option: we'll immediatly fetch the ID number of the
'Please enter your key' field: 2035.
2035 dec is 7F3 hex, therefore we now just need to search 07F3
inside our listing... and we land immediatly here:
  6.00DE >8B760A             mov     si, [bp+0A]
  6.00E1  FF760E             push    word ptr [bp+0E]
  6.00E4  6A08               push    0008
  6.00E6  9AFFFF0000         call    USER.GETWINDOWLONG
  6.00EB  8946FC             mov     [bp-04], ax
  6.00EE  8956FE             mov     [bp-02], dx
  6.00F1  83FE01             cmp     si, 0001
  6.00F4  7556               jne     014C
  6.00F6  FF760E             push    word ptr [bp+0E]
  6.00F9  68F307             push    07F3           ;HERE! ****
  6.00FC  9AFFFF0000         call    USER.GETDLGITEM
  6.0101  50                 push    ax
  6.0102  8D4698             lea     ax, [bp-68]
  6.0105  16                 push    ss
  6.0106  50                 push    ax
  6.0107  6A63               push    0063
  6.0109  9AFFFF0000         call    USER.GETWINDOWTEXT
  6.010E  8D4698             lea     ax, [bp-68]
  6.0111  16                 push    ss

This block of code is part of an Exported function from
kslhooks.dll: KSLHOOKPROC4 - Ord:0006h
Here is the whole sequence:
     :CALL_PLEASE_ENTER_ELECTROKEY
     6.00DE >8B760A       mov     si, [bp+0A]
     ...
     6.00F9  68F307       push    07F3 ;HERE ***
is called (being at 6.00DE) from
     :ENTER 68
     6.0082  C8680000     enter   0068, 00
     ...  
     6.009B  7441         je      00DE  ;HERE ***
which (being at 6.00082) is called from
     :PUSH_82
     6.000F  68FFFF          push    selector KSLHOOKPROC4
     6.0012  688200          push    0082  ;HERE ***
     6.0015  FF36200C        push    word ptr [0C20]
     6.0019  9AFFFF0000      call    KERNEL.MAKEPROCINSTANCE
Much interesting, but we are not yet there...
let's see if we have other occurrences of our 7F3h instance
(which, as we saw through WRT, corresponds to the 'Enter your
Key' field of the 'Unlock' window). Yes, we have one more
occurrence (always inside KSLHOOKS.DLL):

 4.030A >81FEF307    cmp   si, 07F3   ;HERE ***
 4.030E  7515        jne   0325       ;don't care if not unlock
 4.0310  FF760E      push  word ptr [bp+0E]  ;nID
 4.0313  56          push  si         ;=7F3, =unlock, =hDlg
 4.0314  9AFFFF0000  call  USER.ISDLGBUTTONCHECKED
 4.0319  0BC0        or    ax, ax     ;mashed button?
 4.031B  7408        je    0325       ;Yeah, jump...
 4.031D  C45EFC      les   bx, [bp-04]      
 4.0320  2689B7B104  mov   es:[bx+04B1], si 
 4.0325 >83FE02      cmp   si, 0002   ;...here
    
Now, IsDlgButtonChecked is a 'typical' windows function with
following structure:
          UINT IsDlgButtonChecked(HWND hFlg, int nID)
where the handle of the dialog box contaning the button control
is specified in hDlg. The ID value of the desired button is
passed in nID. For two-state buttons this function returns zero
if the button is unchecked and non zero if it is checked, -1 if
an error occurs.
What else can we do?
Let's search for the limit (21 days, that corresponds to 15h)
inside our code. Well, we'll find two interesting occurrences
inside the OTHER dll module: WLCCOMM.DLL:
  :OCCURRENCE_1_OF_21_DAYS_LIMIT
  1.3E25 >80BEFFFE15   cmp     byte ptr [bp-0101], 15 ;here***
  1.3E2A  7403         je      3E2F  ;Please restart...
  1.3E2C  E9B900       jmp     3EE8  ;xor ax and retf
and now, look what we have immediately afterwards...
  1.3E2F >FF760E       push    word ptr [bp+0E]
  1.3E32  1E           push    ds
  1.3E33  681306       push    0613 ;Please restart...
  1.3E36  1E           push    ds
  1.3E37  68EE05       push    05EE ;Retail version...
  1.3E3A  6A40         push    0040
  1.3E3C  9A90080000   call    USER.MESSAGEBOX
  1.3E41  FF760E       push    word ptr [bp+0E]
  1.3E44  6A01         push    0001
  1.3E46  9AE03E0000   call    USER.ENDDIALOG
  1.3E4B  E99A00       jmp     3EE8  ;xor ax and retf
                                       
Now, string 0613 is
"Please restart the program for the reatil version to take
effect"
and string 05EE is
"Retail version successfully unlocked"                         
...clearly we have found the part of the code where the user gets
the appropriate message once he has digited the correct key
inside the unlock window in KSLHOOKS.
But let's use a little more our 'new' WRT approach. Examining the
'dialog' items through WRT, we'll see that inside WLCCOMM.DLL
there are 'two' About Link check templates, a 'nice' one (for
registered users) and a 'nag' one (for Cinderella's users). 
The nice one is WLCCOMM.DIALOG 130, and its second part reads
'This copy of Link check is licensed to'
FIELD 1 = 603 (25bh)
FIELD 2 = 604 (25Ch)
The 'nag' one is WLCCOMM.DIALOG 131 and its second part reads
'UNREGISTERED Shareware notice...' with two buttons:
'How do I register' which is 601 (259h) and
What do I get for it which is 602 (25ah).
Well... let's have a look around our code... and here is
(obviously) the relevant part of it inside WLCCOMM.DLL:

  1.3C60 >8B760E                   mov     si, [bp+0E]
  1.3C63  FF7606                   push    word ptr [bp+06]
  1.3C66  6AF4                     push    FFF4
  1.3C68  9A8A1D0000               call    USER.GETWINDOWWORD
  1.3C6D  56                       push    si
  1.3C6E  685B02                   push    025B ;here***
  1.3C71  9A803C0000               call    USER.GETDLGITEM
  1.3C76  394606                   cmp     [bp+06], ax
  1.3C79  7421                     je      3C9C
  1.3C7B  56                       push    si
  1.3C7C  685C02                   push    025C ;here***
  1.3C7F  9ADA3C0000               call    USER.GETDLGITEM
  1.3C84  394606                   cmp     [bp+06], ax
  1.3C87  7413                     je      3C9C
  1.3C89  FF760A                   push    word ptr [bp+0A]
  1.3C8C  FF7608                   push    word ptr [bp+08]
  1.3C8F  FF7606                   push    word ptr [bp+06]
  1.3C92  6A01                     push    0001
  1.3C94  9A08039E3D               call    KSLCONTROLCOLOR
  1.3C99  E94E02                   jmp     3EEA

Whereby, here is the part for the shareware user:
  1.3EA6 >81FE5902        cmp     si, 0259 ;How do I register?
  1.3EAA  7513            jne     3EBF
  1.3EAC  FF760E          push    word ptr [bp+0E]
  1.3EAF  1E              push    ds
  1.3EB0  688B06          push    068B
  1.3EB3  6A01            push    0001
  1.3EB5  6A00            push    0000
  1.3EB7  687217          push    1772
  1.3EBA  9AD43E0000      call    USER.WINHELP
  1.3EBF >81FE5A02        cmp     si, 025A ;What do I get for it?
  1.3EC3  7523            jne     3EE8
  1.3EC5  FF760E          push    word ptr [bp+0E]
  1.3EC8  1E              push    ds
  1.3EC9  689706          push    0697
  1.3ECC  6A01            push    0001
  1.3ECE  6A00            push    0000
  1.3ED0  687117          push    1771
  1.3ED3  9AFFFF0000      call    USER.WINHELP
  1.3ED8  EB0E            jmp     3EE8

and as you can easily see, here lays the 'working' for the two
mushbuttons of the shareware version.
Shareware starts at 1.3EA6 and will be called from here
  1.3DB9 >81FE5802                 cmp     si, 0258
  1.3DBD  7403                     je      3DC2
  1.3DBF  E9E400                   jmp     3EA6

Unlocked version starts at 1.3C60 and will be called from here:
    
  1.3C3E  C8FE0400        enter   04FE, 00
  1.3C42  57              push    di
  1.3C43  56              push    si
  1.3C44  1E              push    ds
  1.3C45  B87938          mov     ax, selector 2:0000
  1.3C48  8ED8            mov     ds, ax
  1.3C4A  8B460C          mov     ax, [bp+0C]
  1.3C4D  2D1900          sub     ax, 0019
  1.3C50  740E            je      3C60 ;***here! UNLOCKED
  1.3C52  2DF700          sub     ax, 00F7
  1.3C55  7465            je      3CBC ;copyright, 1st part
  1.3C57  48              dec     ax
  1.3C58  7503            jne     3C5D ;(jmp 3EE8) out
  1.3C5A  E94901          jmp     3DA6

Well... if [bp+0C] is 19 (dec25) then we'll jump to our unlocked
routine? 
</pre>
<h3><center>
********************************************<br>
BELOW IS WORK FROM THE STUDENTS OF THE +HCU<br>
<b>wlcheck for windows 3.1</b><br>
********************************************<br>
</center></h3>
<center><i>
Well readers, this was the second +HCU lesson, as we got it 
at mid-February 1997. You'll see below the work of our unit 
on it (+gthorne wawes breaking, reverser+ following up and 
cleaning)
</i></center>
<pre>
Starting with the nag screen, here is a silly fix for it that works on many programs
that use windows resource windows (such as an about box) as the nag screen.

Load up the file with the nagscreen in it (as listed above) with WRT (I am using
borland resource workshop - same program, different version) and delete it.
I am serious; try it: it works!

save the .DLL and it recompiles the binary without the nagscreen.
(Those borland people scare me sometimes)
---------------------------------------------------------
Back to more serious work...
Since we are learning methods here, this is where I get to go 
after individual parts of the protection and defeat them. I will 
work on finding the flag to register the program later, first I 
want to do a little digging.

Looking through our dead listing of kslhooks.dll:

Going through our lesson so far, our file included a file reference 
to SYSTEM.INI by means of a byte-at-a-time string creation rather 
than a full data statement

(Note: i do this sometimes to make it hard for simpletons to change 
my name in my programming
---but i at lest jumble the lines around so it isnt so obvious)

I will show you two ways of removing this particular hurdle, here is 
the first, and most obvious: (THE NULL TERMINATOR)
---------------------------------------------------------
here is the full code from the disassembly:
---------------------------------------------------------
:0007.01E3 90                     nop
:0007.01E4 55                     push bp
:0007.01E5 8BEC                   mov bp, sp
:0007.01E7 57                     push di
:0007.01E8 56                     push si
:0007.01E9 8B7E06                 mov di, [bp+06]
:0007.01EC 8B760A                 mov si, [bp+0A]
:0007.01EF 8E4608                 mov es, [bp-08]

:0007.01F2 26C60556               mov byte ptr es:[di], 56		;V
:0007.01F6 26C6450161             mov byte ptr es:[di+01], 61	;a
:0007.01FB 26C645026C             mov byte ptr es:[di+02], 6C	;l
:0007.0200 26C6450375             mov byte ptr es:[di+03], 75	;u
:0007.0205 26C6450465             mov byte ptr es:[di+04], 65	;e
:0007.020A 26C6450500             mov byte ptr es:[di+05], 00	; <00>    (end of string)

:0007.020F 8E460C                 mov es, [bp-0C]

:0007.0212 26C60453               mov byte ptr es:[si], 53		;S
:0007.0216 26C6440159             mov byte ptr es:[si+01], 59	;Y
:0007.021B 26C6440253             mov byte ptr es:[si+02], 53	;S
:0007.0220 26C6440354             mov byte ptr es:[si+03], 54	;T
:0007.0225 26C6440445             mov byte ptr es:[si+04], 45	;E
:0007.022A 26C644054D             mov byte ptr es:[si+05], 4D	;M
:0007.022F 26C644062E             mov byte ptr es:[si+06], 2E	; .
:0007.0234 26C6440749             mov byte ptr es:[si+07], 49	;I
:0007.0239 26C644084E             mov byte ptr es:[si+08], 4E	;N
:0007.023E 26C6440949             mov byte ptr es:[si+09], 49	;I
:0007.0243 26C6440A00             mov byte ptr es:[si+0A], 00	;<00> (end of string)

:0007.0248 5E                     pop si
:0007.0249 5F                     pop di
:0007.024A C9                     leave
:0007.024B CB                     retf

---------------------------------------------------------------------------

to me this looks like an easy section to defeat - this because the full 
filename is here, and because it is in a standard string format 
terminating in hex zero (00) a.k.a.: NULL

as with programs with unencrypted passwords (yes even some programs 
you may use.. like X-WING have no encryption whatsoever - just try 
scanning FRONTEND.OVL for DANTOOINE with a hex editor, and all the 
passwords are sitting there for you to zero-out)

in other words, why bother disabling the function that calls this 
data when you can simply change each character in SYSTEM.INI to a 
hex zero

i did and just as i suspected, out of the three places that are 
causing us hassles, SYSTEM.INI, WLCHECK.SWL, and the registry (REG.DAT) 
I no longer have to deal with one of them

just run it, you will see: no more added line in system.ini

NOW FOR THE OTHER WAY:
(This one is more useful for a cracker point of view since good 
protections tend to be smarter than letting you view filenames 
like we saw above)

This is where we go back to the WRITEPRIVATEPROFILESTRING function 
and check it out.

A text search of the dead listing reveals quickly:

:0011.0535 90                     nop
:0011.0536 C8760000               enter 0076, 00
:0011.053A 57                     push di
:0011.053B 56                     push si
:0011.053C 8B7606                 mov si, [bp+06]
:0011.053F 33C0                   xor ax, ax
:0011.0541 B93200                 mov cx, 0032
:0011.0544 8D7E8A                 lea di, [bp-76]
.
.
.

:0011.0584 16                     push ss
:0011.0585 50                     push ax
:0011.0586 9AFFFF0000             call KERNEL.WRITEPRIVATEPROFILESTRING
:0011.058B 33C0                   xor ax, ax
:0011.058D 5E                     pop si
:0011.058E 5F                     pop di
:0011.058F C9                     leave
:0011.0590 CB                     retf

notice the end of the function and how it exits...

5E	POP SI
5F	POP DI
C9	LEAVE
CB	RETF

In order to give the function a little meat to play with but still 
return early, lets insert this code right at the start of the function, 
right after push si.

:0011.0536 C8760000               enter 0076, 00
:0011.053A 57                     push di
:0011.053B 56                     push si
:0011.053C 5E	       pop si
:0011.053D 5F	       pop di
:0011.053E C9	       leave
:0011.053F CB	       retf

and it really works out, the function gets called, it starts, quits, 
and returns... veni, vidi, crakki.

a quick hex edit of the dll to alter this..
searching for a good string to replace, we get 2 occurrances of:

     8b760633c0b93200

They are GETPRIVATEPROFILESTRING  and   WRITEPRIVATEPROFILESTRING  respectively.
Go ahead and do the same damage that you did above to both of them. You will notice that
they are very similar functions, with exactly the same method of beginning 
and ending.

so we can change both occurrances toto:
     5e5fc9cbc0b93200

NOTE:
This patch takes care of the system.ini change, so no need to do a 
zero-out of the file.
It didnt do any good for the .swl file however, because does some 
other method of storing it's data. 
**********************************************
Here is a little clue in how to find the other filenames that may be 
hidden in the file.

From the SYSTEM.INI example, which has a period (hex 2E) and a file 
extension, i knew to look for ", 2E" (COMMA SPACE 2E) in the text 
editor while reading kslhooks.alf 
i decided to give it another  whirl and see if there were any other 
surprises

Just looking for 2E will work, but you will find many occurrances of 
it in hex data, so it is best to try to differentiate it as much as 
possible for sanity reasons.

Apparently it bears fruit...
--------------------------------------------------------------------------
Here is the first block of code i landed in:
--------------------------------------------------------------------------
:0003.00B0 F3                     repz
:0003.00B1 A5                     movsw
:0003.00B2 13C9                   adc cx, cx
:0003.00B4 F3                     repz
:0003.00B5 A4                     movsb
:0003.00B6 1F                     pop ds
:0003.00B7 39460A                 cmp [bp+0A], ax	COMPARE AND JUMP...
:0003.00BA 7516                   jne 00D2

:0003.00BC C646FA2E               mov byte ptr [bp-06], 2E	; .	<----- A .SWL FILENAME EXTENSION
:0003.00C0 C646FB53               mov byte ptr [bp-05], 53	;S
:0003.00C4 C646FC57               mov byte ptr [bp-04], 57	;W
:0003.00C8 C646FD4C               mov byte ptr [bp-03], 4C	;L
:0003.00CC 8846FE                 mov [bp-02], al 
:0003.00CF EB0E                   jmp 00DF

:0003.00D1 90                     nop
:0003.00D2 8D7EFA                 lea di, [bp-06]

* Possible StringData Ref from Data Seg 013 ->".LIC"	<---- A NEW FILENAME EXTENSION ".LIC"
                                  |
:0003.00D5 BE1800                 mov si, 0018

--------------------------------------------------------------------------
what it looks like to me is that WHEN registered, the
.SWL file extension is replaced by a .LIC file extension

though changing the name of the SWL file to LIC 
does not seem to have any beneficial result at this time

it may once the other file checks have been disabled
regardless, it is apparent that there is a file with a .LIC
extension that gets created upon successfully registering
this software
--------------------------------------------------------------------------
note that because there appears only once a .SWL reference in 
the KSLHOOKS.DLL, my guess is that if i hex-zero the .SWL like i
did the SYSTEM.INI reference, it would not matter because the file
write command and file read command apparently use the same
string for their data. in other words, changing .SWL to anything, 
the file would just have a different name.

testing this out, i found that i was correct. hexing out .SWL with 
zeroes resulted in a file in my windows directory called WLCHECK 
with no extension, rather than .SWL (sometimes it would be nice if 
my theories wouldnt be quite so correct)

so we are at least in the ballpark, but no real improvements yet.

It is still going to take more looking to do anything with this yet

----------------------------------------------------------

Now let's try for the registry...
Scan the file for REG, and you will inveitable find quite a few 
registry commands. which are registry key edit functions.


:0011.033A C8300100               enter 0130, 00
:0011.033E 57                     push di
:0011.033F 56                     push si

:0011.0340 8B5E06                 mov bx, [bp+06]
:0011.0343 8B4E08                 mov cx, [bp+08]
:0011.0346 81C32D01               add bx, 012D
:0011.034A 1E                     push ds
:0011.034B 8BFB                   mov di, bx
.
.
:0011.037D 9AFFFF0000             call SHELL.REGCREATEKEY
.
.
and it ends JUST LIKE the previoous functions
with a:

5E	POP SI
5F	POP DI
C9	LEAVE
CB	RETF

so we just hexedit the changes...

2 occurrances of:
     010057568b5e068b

(regopenkey and regcreatekey respectively - feel free to 
look for yourself in the dead listing)

it is just fine to change both to:
      010057565e5fc9cb

and just like in the case of the writeprivateprofilestring, 
we have cracked the registry.

NOW -

2 out of 3 of the hoops have been jumped
Now it is time to test the .SWL file and afterwards we will 
deal with the NAG feature itself.

Here is where i get curious to see the differences in the 
before and after... i want to see exactly what i have left 
to conquer, and the resultant file differences in wlcheck.swl 
BEFORE the 21 day date expires, and AFTER it expires.

I wrote a program a while back to datecrack stuff like this - 
but as we already know, this program is a little smarter than 
the average 'check today's date' type of protection.

The way my program (cdate.exe) works is relatively simple: 
it alters the system date upon program  entry, and changes it 
back to normal. The interesting thing about this is that it 
allows future dates to be set as well as past ones since i 
didnt care to put a block on WHICH dates could be set with it.

Note that this one works fine past midnight because it has a 
calendar built in, so if you are to write one yourself
remember that when midnight comes and your calendar strangely 
goes off  by a day every time you pass midnight while using a 
datecracked program.

CDATE USAGE:
cdate <YOUR PROGRAM> mm dd yyyy

So, since all that is left to crack is the swl file, i can 
delete it with my handy RM command - which like all of
my little unix tools strips all attribs from the file 
(ignores them really)...

rm c:\windows\wlcheck.swl

...And i can run wlcheck.exe again (this time with false 
future date)

cdate wlcheck 9 9 1999      (it's now 1997 so this works fine)

note the result: expired program!!!

exit wlcheck and try running it normally (no funky date this time)
guess what... STILL expired.
that means it records not only date info, but EXPIRED info as 
well, exactely as +ORC said.

Do the little effect of RM C:\WINDOWS\WLCHECK.SWL again and run 
wlcheck

It isn't expired now

That means that the ONLY recorder for 'expired software' is in that 
file... doing a little dos file compare between a copy of the swl 
file before, and after (the BAD one), here are my results
again i used CP.EXE to copy the swl file since it strips attribs 
and i dont have to worry about them now.
-----------------------------------------------------------
C:\WLCHECK\>     FC WLCHECK.SWL WLCHECK.BAD

Comparing files wlcheck.swl and wlcheck.bad shows them to be quite 
different (you can try this for yourself if you like)
------------------------------------------------------------

There are a few ways we could go about this. 
We could either try to make it so the 21 day period cannot 
expire, or remove the command that records the info to the 
file. In all honesty,  we will probably have to do both in 
order to deprotect it completely.
**********************************************************

maybe we should do a little windows directory listing just 
to see if there are any more surprises

dir /a c:\windows\wlc*

what do we see:
wlcheck.ini, wlcheck.ord, and wlcheck.swl

that is all fine, no more surprises yet (if you didnt expect 
a wlcheck.ini file: WHY NOT?

if you edit wlcheck.ord, it is just your order blank from when 
you filled out the wlcheck form nothing impressive, but at least 
it has the product serial number listed at the bottom - sometimes 
handy
*********************************************************
I cannot seem to find any more windows file commands, so i decided
to see if they had included in the dll their own file access commands
that means... look for int21 

(there are a TON of int21 calls in this program! - and to think 
that some people think that dos cracking is dead...)

these are the KSL file i/o and system functions, with direct 
access to hardware through DOS.

upon searching for int21 calls - specifically int21 with ah=2a
b42a (mov ah, 2a) = get system date

I found 3 instances

2 occurrances of:
 008C D89045558BEC1E8ED856 B42A

changed to 
 00CB D89045558BEC1E8ED856 B42A

(CB = retf)

an interesting thing happens, on the first run, it works fine,
writes the .swl file, and goes on it's merry way

on any subsequent runs, it says expired
that tells me that the changes i made, set the date to a nothing value
in the wlcheck.swl file

in easier to understand lingo, i hit the nail on the head.
i found the date checker - in old int21 style.

if you wish to play with this more yourself, go ahead. by all means.

i still havent worried with the 3rd date check, which is the hex string:
  9045558BEC1E8ED856 B42A

About this time, I begin to think - maybe there is a better way...
(I have gotten a bit tired of playing around, and I want to fully crack it)
----------------------------------------------------------
Now we get down to the nitty gritty.

The above is necessary work.. handy for other protection schemes.
It is, however, not incredibly useful here in this one. If you run wlcheck
or one of the other executables, you will notice something frustrating:
you cannot print. Only registered users get that option. That means we
either have to crack more functions, like above, or just go ahead and
register the thing and get it over with.

So we shall.
------------------------------------------------------------
Time to go into the WLCCOMM.DLL...

remember how i said +ORC mentioned 2 occurrances of 15 that were interesting?
i search for " 15" (a space in front so it didn't get every 15 in the 
wsccomm file listing)

i didnt find what i wanted other than the original one, so i looked for 0015
and i found one that looked promising..

:0001.3F5D C786E7FB1500           mov word ptr [bp-0419], 0015
:0001.3F63 B001                   mov al, 01
:0001.3F65 8886CEFB               mov [bp+FBCE], al 
:0001.3F69 8886E9FB               mov [bp+FBE9], al 
:0001.3F6D 8886EAFB               mov [bp+FBEA], al 
:0001.3F71 C68648FC15             mov byte ptr [bp-03B8], 15

(I must remember to check for bgoth from now on)

just below all that, i saw something strange...
several 'set value to 1' - in other words, it looks like we see a bunch 
of flags 

changing the below statement to 00 returns this error: this is an old 
version (and quits) - not extremely useful, but a green light shall we say.

:0001.3F63 B001                   mov al, 01
:0001.3F65 8886CEFB               mov [bp-0432], al 
:0001.3F69 8886E9FB               mov [bp-0417], al 
:0001.3F6D 8886EAFB               mov [bp-0416], al 

going further down...
we have a comparison (in the form of an 'OR')

:0001.3F86 9AFFFF0000             call KSLHOOKS.Ord{0038h}

:0001.3F8B 8BF8                   mov di, ax    <--- backing up ax

  This program apparently wants to save whatever came out of the strange
   kslhooks call above before making this compare...

:0001.3F8D 0BF8                   or di, ax     <--- COMPARE BOTH 

  Note the special nature of this compare.. since both values are
  the same, it is basically the same as saying if ax is zero, it
  stays zero, if it is not, it becomes a 1 since the result of any
  compare is stored in ax

  di still has the saved value in it however... for future use by the program
  as you will see below, it is flag containing error codes

:0001.3F8F 750F                   jne 3FA0	<--- FIRST JUMP IF NONZERO

  This smells to me like a 'beggar off jerk'...
  (i already know what i have here, do you?)

:0001.3F91 B80100                 mov ax, 0001  <--- SET A FLAG?!?

  This just gets better and better, but i still look before i try anything,
  I don't want to jump the gun and assume anything without proof...

:0001.3F94 C45E06                 les bx, [bp+06]
:0001.3F97 268987A400             mov es:[bx+00A4], ax

:0001.3F9C E9D600                 jmp 4075      <--- 2nd JMP 
:0001.3F9F 90                     nop

  HERE is where jmp 1 takes me...

:0001.3FA0 8B760A                 mov si, [bp+0A]
:0001.3FA3 83FF0A                 cmp di, 000A
:0001.3FA6 7510                   jne 3FB8
:0001.3FA8 56                     push si
:0001.3FA9 1E                     push ds

* StringData Ref from Data Seg 002 ->"An upgrade is required. 
					Continuing as shareware only."
                                  |
:0001.3FAA 68CF06                 push 06CF

  AND WOULD YOU LOOK AT THAT EVIL MESSAGE!
  it is very clear that the beggar off guess was correct...

just go down a few lines and you will see ALL SORTS of nasty 
error messages, including the shareware expiry message we get 
when we try to run after 21 days (note that it would have been 
much easier had we scanned the text for keywords like shareware, 
reg, exp, or others we could imagine... but that would not work
with all programs, and we are here to learn how to crack ALSO 
protections that do not do us the favour of carrying their doom
inside... therefore the approach above is much more solide :-)


paging down a little we see this at the location JMP 2 sent us at 4075...

:0001.4075 1F                     pop ds
:0001.4076 5E                     pop si
:0001.4077 5F                     pop di
:0001.4078 C9                     leave
:0001.4079 CA0600                 retf 0006

it just quits... but if you remember up above, it set a flag before it 
did so!

now how do we get it to ignore those nasty error messages and we ALWAYS 
jump to 4075 with the flag set?

looking back at our decision code from above:


:0001.3F86 9AFFFF0000             call KSLHOOKS.Ord{0038h}

:0001.3F8B 8BF8                   mov di, ax
:0001.3F8D 0BF8                   or di, ax
:0001.3F8F 750F                   jne 3FA0	<---- evil jump

:0001.3F91 B80100                 mov ax, 0001
:0001.3F94 C45E06                 les bx, [bp+06]
:0001.3F97 268987A400             mov es:[bx+00A4], ax
:0001.3F9C E9D600                 jmp 4075      <---- good jump

notice the jne? there are quite a few ways of attacking this, but think 
about it, there are a few things that must be done.

first, the jne could be changed to a je (or jz) but if we do that, we 
have to WAIT 21 days to be able to use the program, or screw up the date 
at install, or something dumb like that (not a good crack)

if AX is set to anything, it is deemed an error by the program and the error
code "is.class" tppabs="http://fravia.org/is.class" saved in DI. So we need to make sure ax is zero, and it might be 
smart to cover our bases and set di to zero as well (you never know if some
value had been sitting in it to be confused as an error for our crazy 
program wlcheck to find and complain about)

so if we set both to zero, then the jne CANNOT ever jump out and we stay long
enough for us to set the AX flag and go along happily.

it just so happens that there is a simple way to set any variable to zero
(if you are familiar with assembly, ignore this, i am putting this in 
here for those who havent become as familiar with it as the rest of us - 
this is a tutorial after all isnt it?)

xor ax, ax                <---  sets ax to zero
xor di, di                <---  sets di to zero

if you are lazy like i am, you can search your dead listing for both
(the listing is so large, that you can probably find examples of many byte
values that you need)

it turns out that the values are:

33 C0        xor ax, ax
33 FF        xor di, di

and here's how our code will look:


:0001.3F86 9AFFFF0000             call KSLHOOKS.Ord{0038h}

:0001.3F8B 33C0                   xor ax, ax
:0001.3F8D 33FF                   xor di, di

:0001.3F8F 750F                   jne 3FA0

:0001.3F91 B80100                 mov ax, 0001
:0001.3F94 C45E06                 les bx, [bp+06]
:0001.3F97 268987A400             mov es:[bx+00A4], ax
:0001.3F9C E9D600                 jmp 4075


simply enough, now we just need to make the changes in the wlccomm.dll

*****************************************************

Crack for 16-bit wlcheck by +gthorne of the +HCU:

pop into your favorite hex editor and load WLCCOMM.DLL
(File Size: 46,960 bytes)

search for byte pattern:
  8BF80BF8750F

replace with:
  33C033FF750F

and run it...
it is registered!
----------------------------------------------------------
Note for showoffs:

If you wish it to say that it is registered to you, go to 
the about box, and run the "registration" part of the program 
BEFORE you crack it, entering data in the order form as you 
want it to be registered.

The target stores this info in the windows directory, in 
the file: WLCHECK.ORD. 
After cracking, that info is displayed proudly in the about box.
*****************************************************

None of the many changes listed at the beginning of this
section are necessary now, not since we have a good, clean 
crack. 
Don't disregard the work though, some programs I've seen are
defeatable with the kind of work done before the register flag
was found.

If this were a program with no flag to register, it would have
REQUIRED all that work anyway, and then some.

</pre><h2>
********************************************<br>
<b>wlcheck for windows 95</b><br>
********************************************<br>
</h2>
<pre>
Ok, building on my fellow +cracker's good work it was 
pretty easy to defeat the Win'95 protection, which follows 
the same lines as the 16 bit one above... I lost 
some time on a stupid beta version of wlcheck for win 95, 
that I had inside my collection though... how stupid. 
This will teach me to ALWAYS work methodically.
Therefore:
FIRST OF ALL 
perform an archie or ftp search for wlck95, you'll find a 
whole bunch of servers carrying it, choose a ftp-server 
near you and get it ftpmailed to you or download it (as 
you prefer).
You'll soon find all the relevant data:
WLCHK955.ZIP 213.156 bytes

SECOND
You have it, unzip it and examine it:
FILE_ID  DIZ           438  23/08/96   5:10 FILE_ID.DIZ
WLCHK95  EXE        70.656  23/08/96   5:10 WLCHK95.EXE
KSLHKS95 DLL        52.224  21/08/96   1:00 KSLHKS95.DLL
WMCHK95  EXE        63.488  23/08/96   5:10 WMCHK95.EXE
WLCHK95  HLP        33.759  23/08/96   5:10 WLCHK95.HLP
WFCHK95  EXE        77.824  23/08/96   5:10 WFCHK95.EXE
WMCHK95  HLP        32.463  23/08/96   5:10 WMCHK95.HLP
WFCHK95  HLP        29.696  23/08/96   5:10 WFCHK95.HLP
README   TXT         8.689  23/08/96   5:10 README.TXT
WLCCOM95 DLL        73.216  26/03/97  20:11 WLCCOM95.DLL

(ignore the date of the last dll, that's just because I tampered 
with it yesterday).

THIRD
Using what we have learned (quite a lot) let's work on
wlccom95.dll: here the relevant part of the dead listing:

* Referenced by a    Jump at Address:|:1C005B50(C)
|
:1C005B76 C685C3FBFFFF05          mov byte ptr [ebp+FFFFFBC3], 05
:1C005B7D C685C4FBFFFF01          mov byte ptr [ebp+FFFFFBC4], 01
:1C005B84 66C785DDFBFFFF1500      mov word ptr [ebp+FFFFFBDD], 0015
:1C005B8D C685DFFBFFFF01          mov byte ptr [ebp+FFFFFBDF], 01
:1C005B94 C685E0FBFFFF01          mov byte ptr [ebp+FFFFFBE0], 01
:1C005B9B C6853EFCFFFF15          mov byte ptr [ebp+FFFFFC3E], 15
:1C005BA2 8B450C                  mov eax, [ebp+0C]
:1C005BA5 66C780A80000000000      mov word ptr [ebx+000000A8], 0000
:1C005BAE 8D8598FAFFFF            lea eax, [ebp+FFFFFA98]
:1C005BB4 50                      push eax

* Reference To: kslhks95._KslHookProc1@4, Ord:0000h
                                  |
:1C005BB5 E872420000              Call 1C009E2C
:1C005BBA 66894598                mov [ebp-68], ax
:1C005BBE 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005BC2 85C0                    test eax, eax
:1C005BC4 0F8516000000            jne 1C005BE0
:1C005BCA 8B450C                  mov eax, [ebp+0C]
:1C005BCD 66C780A80000000100      mov word ptr [ebx+000000A8], 0001
:1C005BD6 B801000000              mov eax, 00000001
:1C005BDB E946010000              jmp 1C005D26

* Referenced by a    Jump at Address: |:1C005BC4(C)
|
:1C005BE0 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005BE4 83F80A                  cmp eax, 0000000A
:1C005BE7 0F8516000000            jne 1C005C03
:1C005BED 6A40                    push 00000040

* Possible StringData Ref from Data Obj ->"License Expired"
                                  |
:1C005BEF 6828E8001C              push 1C00E828

* Possible StringData Ref from Data Obj ->"An upgrade is required. Continuing "
                                        ->"as shareware only."
                                  |
:1C005BF4 6838E8001C              push 1C00E838
:1C005BF9 8B4508                  mov eax, [ebp+08]
:1C005BFC 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005BFD FF151C04011C            Call dword ptr [1C01041C]

* Referenced by a    Jump at Address:|:1C005BE7(C)
|
:1C005C03 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005C07 83F807                  cmp eax, 00000007
:1C005C0A 0F8516000000            jne 1C005C26
:1C005C10 6A40                    push 00000040

* Possible StringData Ref from Data Obj ->"License Violated"
                                  |
:1C005C12 6870E8001C              push 1C00E870

* Possible StringData Ref from Data Obj ->"The license file has been changed. "
                                        ->"Continuing as shareware only."
                                  |
:1C005C17 6884E8001C              push 1C00E884
:1C005C1C 8B4508                  mov eax, [ebp+08]
:1C005C1F 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005C20 FF151C04011C            Call dword ptr [1C01041C]

* Referenced by a    Jump at Address:|:1C005C0A(C)
|
:1C005C26 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005C2A 83F808                  cmp eax, 00000008
:1C005C2D 0F8516000000            jne 1C005C49
:1C005C33 6A40                    push 00000040

* Possible StringData Ref from Data Obj ->"License Violated"
                                  |
:1C005C35 68C8E8001C              push 1C00E8C8

* Possible StringData Ref from Data Obj ->"This seems to be an unlicensed "
                                        ->"copy. Continuing as shareware "
                                        ->"only."
                                  |
:1C005C3A 68DCE8001C              push 1C00E8DC
:1C005C3F 8B4508                  mov eax, [ebp+08]
:1C005C42 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005C43 FF151C04011C            Call dword ptr [1C01041C]

* Referenced by a    Jump at Address:|:1C005C2D(C)
|
:1C005C49 8D8598FAFFFF            lea eax, [ebp+FFFFFA98]
:1C005C4F 50                      push eax

* Reference To: kslhks95._KslHookProc2@4, Ord:0001h
                                  |
:1C005C50 E8D1410000              Call 1C009E26
:1C005C55 66894598                mov [ebp-68], ax
:1C005C59 33C0                    xor eax, eax
:1C005C5B 8A853EFCFFFF            mov al , [ebp+FFFFFC3E]
:1C005C61 83F80D                  cmp eax, 0000000D
:1C005C64 0F8536000000            jne 1C005CA0

* Possible StringData Ref from Data Obj ->"Link Check evaluation license "
                                        ->"has expired."
                                  |
:1C005C6A 6820E9001C              push 1C00E920
:1C005C6F 8D459C                  lea eax, [ebp-64]
:1C005C72 50                      push eax
:1C005C73 E871030000              call 1C005FE9
:1C005C78 83C408                  add esp, 00000008
:1C005C7B 6A10                    push 00000010

* Possible StringData Ref from Data Obj ->"License Expiry"
                                  |
:1C005C7D 684CE9001C              push 1C00E94C
:1C005C82 8D459C                  lea eax, [ebp-64]
:1C005C85 50                      push eax
:1C005C86 8B4508                  mov eax, [ebp+08]
:1C005C89 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005C8A FF151C04011C            Call dword ptr [1C01041C]
:1C005C90 8B450C                  mov eax, [ebp+0C]
:1C005C93 50                      push eax
:1C005C94 E857E3FFFF              call 1C003FF0
:1C005C99 33C0                    xor eax, eax
:1C005C9B E986000000              jmp 1C005D26

* Referenced by a    Jump at Address:|:1C005C64(C)
|
:1C005CA0 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005CA4 83F804                  cmp eax, 00000004
:1C005CA7 0F8536000000            jne 1C005CE3

* Possible StringData Ref from Data Obj ->"This is an old version,"
                                  |
:1C005CAD 685CE9001C              push 1C00E95C
:1C005CB2 8D459C                  lea eax, [ebp-64]
:1C005CB5 50                      push eax
:1C005CB6 E82E030000              call 1C005FE9
:1C005CBB 83C408                  add esp, 00000008
:1C005CBE 6A10                    push 00000010

* Possible StringData Ref from Data Obj ->"License Violation"
                                  |
:1C005CC0 6874E9001C              push 1C00E974
:1C005CC5 8D459C                  lea eax, [ebp-64]
:1C005CC8 50                      push eax
:1C005CC9 8B4508                  mov eax, [ebp+08]
:1C005CCC 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005CCD FF151C04011C            Call dword ptr [1C01041C]
:1C005CD3 8B450C                  mov eax, [ebp+0C]
:1C005CD6 50                      push eax
:1C005CD7 E814E3FFFF              call 1C003FF0
:1C005CDC 33C0                    xor eax, eax
:1C005CDE E943000000              jmp 1C005D26

* Referenced by a    Jump at Address:|:1C005CA7(C)
|
:1C005CE3 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005CE7 85C0                    test eax, eax
:1C005CE9 0F8D2D000000            jnl 1C005D1C

* Possible StringData Ref from Data Obj ->"An unexpected error has occurred."
                                  |
:1C005CEF 6888E9001C              push 1C00E988
:1C005CF4 8D459C                  lea eax, [ebp-64]
:1C005CF7 50                      push eax
:1C005CF8 E8EC020000              call 1C005FE9
:1C005CFD 83C408                  add esp, 00000008
:1C005D00 6A10                    push 00000010

* Possible StringData Ref from Data Obj ->"System Error"
                                  |
:1C005D02 68ACE9001C              push 1C00E9AC
:1C005D07 8D459C                  lea eax, [ebp-64]
:1C005D0A 50                      push eax
:1C005D0B 8B4508                  mov eax, [ebp+08]
:1C005D0E 50                      push eax

* Reference To: USER32.MessageBoxA, Ord:0188h
                                  |
:1C005D0F FF151C04011C            Call dword ptr [1C01041C]
:1C005D15 33C0                    xor eax, eax
:1C005D17 E90A000000              jmp 1C005D26

* Referenced by a    Jump at Address:|:1C005CE9(C)
|
:1C005D1C B801000000              mov eax, 00000001
:1C005D21 E900000000              jmp 1C005D26

* Referenced by a    Jump at Addresses:|:1C005BDB(U), 
:1C005C9B(U), :1C005CDE(U), :1C005D17(U), :1C005D21(U)
|
:1C005D26 5F                      pop edi
:1C005D27 5E                      pop esi
:1C005D28 5B                      pop ebx
:1C005D29 C9                      leave
:1C005D2A C20800                  ret 0008
******************************************* 
OK! let's crack...
Well it's all pretty obvious:
After having prepared the call with a lot of parameters

:1C005B76 C685C3FBFFFF05          mov byte ptr [ebp+FFFFFBC3], 05
:1C005B7D C685C4FBFFFF01          mov byte ptr [ebp+FFFFFBC4], 01
:1C005B84 66C785DDFBFFFF1500      mov word ptr [ebp+FFFFFBDD], 0015
:1C005B8D C685DFFBFFFF01          mov byte ptr [ebp+FFFFFBDF], 01
:1C005B94 C685E0FBFFFF01          mov byte ptr [ebp+FFFFFBE0], 01
:1C005B9B C6853EFCFFFF15          mov byte ptr [ebp+FFFFFC3E], 15

note the two x15 parameters... that will of course be the 21
days limit... well, our target calls the kslhks95._KslHookProc1@4
function with all its params and upon return the 32 bit version 
uses the SAME protection scheme used in the 16 bit one: it has an
"evil" and a "good" jump:

* Reference To: kslhks95._KslHookProc1@4, Ord:0000h
                                  |
:1C005BB5 E872420000              Call 1C009E2C
:1C005BBA 66894598                mov [ebp-68], ax
:1C005BBE 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005BC2 85C0                    test eax, eax  ;is it zero?
:1C005BC4 0F8516000000    EVIL    jne 1C005BE0	;not 0: bagger off
:1C005BCA 8B450C                  mov eax, [ebp+0C]
:1C005BCD 66C780A80000000100      mov word ptr [ebx+000000A8], 0001 ;OK, guy
:1C005BD6 B801000000              mov eax, 00000001 ;eat another good flag
:1C005BDB E946010000      HOLY    jmp 1C005D26	    ;and be happy for ever

if you throw another look at the listing you'll see all the nasty 
messages following the evil jump
* Referenced by a    Jump at Address: |:1C005BC4(C)
|
:1C005BE0 0FBF4598                movsx word ptr eax, [ebp-68]
:1C005BE4 83F80A                  cmp eax, 0000000A

and the subsequent compare eax ARE intersting, they give
you an exact look upon the inner working of our target:
here 
eax=A means "License expired"
eax=7 means "License violated" (changed)
eax=8 means "License violated" (unlicensed)
eax=4 means "old version" etcetera...
as a matter of fact it may well be that the crack we
made goes crazy after 21 days (it won't if you push
the date around, we checked) use... in that case it
will be only a question of "fine tuning" of this crack, 
and you already know where the relevant protection scheme
dwells... We do not want to wait 21 days just to be
absolutely sure that the crack works perfectly... so it
seems, and so it should be... should it have another
check somewhere (that I do not see now), I promise you
that you'll find the crack for it in three weeks time,
but I'm pretty sure you will not need it :-)

Well, we learned a lot:
Time/Disabling protections may vary a lot, but even in 
apparently very complicated schemes (like the wlcheck one),
wich do tamper with a lot of more or less hidden files, 
there can be a very simple "hollow" point, where you 
can cut mustard with a neat targeted crack... you need to
understand and to "feel" a little the program, though, and
I'm now beginning to understand what +ORC means with his
zen mystique of "feeling" the code.
So here is the simple crack for wlcheck 32 bits:

search for 

:1C005BC2 85C0                    test eax, eax
:1C005BC4 0F8516000000            jne 1C005BE0
:1C005BCA 8B450C                  mov eax, [ebp+0C]
:1C005BCD 66C780A80000000100      mov word ptr [ebx+000000A8], 0001

85C00F8516000000            
and at the third occurrence of it 
(well, if you want -instead of searching the third occurrence of that
string- to type a long string... then search directly for the whole set 
85C00F85160000008B450C66C780A80000000100) do as you like, as far as 
you land where you should:
	:1C005BC2 85C0                    test eax, eax
	:1C005BC4 0F8516000000            jne 1C005BE0
it's the time to crack your target! Noop the first 8 bytes out, 
that is from 85C0 until the three subsequent zeros of instruction 
:1C005BC2 ... you may even use the nop=90x instruction like the
lamers if you fancy... here there is absolutely no checking-protection
that examine eventual patchings... noop as you like.
***************************************
Thinking about it we believe that the aim of this first lesson of 
the "4" series from +ORC was the following: +he found an apparently
overcomplicated protection only to show us that, hidden behind
everything, a single neat crack was needed... as the fellow +cracker 
of the 16 bit version observed, +he gave us a single (but decisive) 
hint: he spoke about the second occurrence of the 15x byte, which
proved decisive -as you already did read- in individuating the 
"hollow" point of our target. 
As this lesson 4.1 was intended as second "+HCU" lesson, we believe 
(and hope) that in finding the neat cracks for the 16 and the 32 bit 
versions of wlcheck (which is a damn useful program in our trade, btw) 
we have accomplished our task.
Now a question arises:
Should really all time protections be variations of this scheme?
(we do not know... we are awaiting the next "4" lesson of +ORC 
like everybody else). In that case there is not a single program
(now) able to elude us :-)
</pre>
<i>
And here a last "mysterious" snippet from +ORC's original 4.1, we 
did not figure out its exact meaning... should we have seeked 
and found and cracked the program(s) it refers to? Who knows? 
Sometime +his hidden messages are impossible to decipher :-(
</i>
<h3><center>
********************************************<br>
ABOVE IS WORK FROM THE STUDENTS OF THE +HCU<br>
<b>wlcheck for windows 3.1</b><br>
********************************************<br>
</center></h3>
<pre>

Another system: inside win.ini:
[License]
Installed=854824551
Expires=857416551
LastUsed=854824717
i.e. calculated in seconds,
Where 30 days allowance is 857416551 - 854824551 = 2592000
2592000/30 = 86400 (one day)
86400/24 = 3600 (one hour)
3600/60 = 60 (one minute)
</pre>
<BR>
Well, that's it for this lesson, reader. Not all lessons of my
<BR>tutorial are -or will be- on the Web.
<BR>You'll obtain the missing lessons IF AND ONLY IF you mail
<BR>me back (via anon.penet.fi) with some tricks of the trade I
may
<BR>not know that YOU discovered. Mostly I'll actually know them
<BR>already, but if they are really new you'll be given full
credit,
<BR>and even if they are not, should I judge that you
&quot;rediscovered&quot;
<BR>them with your work, or that you actually did good work on
them,
<BR>I'll send you the remaining lessons nevertheless. Your
<BR>suggestions and critics on the whole crap I wrote are also
<BR>welcomed. Do not annoy me with requests for warez, everything
is
<BR>on the Web, learn how to search, for Jimmy Olden sake.
<BR><BR><FONT COLOR=#007F00> &quot;If you give a man a crack
he'll be hungry again</FONT>
<BR><FONT COLOR=#007F00> tomorrow, but if you teach him how to
crack, he'll</FONT>
<BR><FONT COLOR=#007F00>     never be hungry
again&quot;</FONT><BR></PRE>
<CENTER>
<A HREF="mailto:na526164@anon.penet.fi">E-mail +ORC</A>
</CENTER>
<P ALIGN=CENTER>
<CENTER>+ORC na526164@anon.penet.fi</CENTER>
</BODY>
</HTML><HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>blackbo.htm reverser's silly rumblings and a lot of past updates of reverser's site</TITLE>
</HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<!-- FC HP BN1 START -->
<!-- Please do not remove the line above or the code within this section -->
<!-- Doing so may cause damage to your pages or insertion of multiple banners-- 
<center><p>
<table border="0" cellspacing="0" cellpadding="0">
<tr><td colspan="11"><img src="../../www.fortunecity.com/console2/newnav/top.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/top.gif" height="7" width="555"></td></tr>
<tr><td><img src="../../www.fortunecity.com/console2/newnav/left.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/left.gif" alt="FC Navigation Console" height="60" width="72" border="0" usemap="#fcleft"><map name="fcleft"><area shape="rect" coords="10,43,64,60" href="http://www2.fortunecity.com/cgi-bin/homepage/estate.pl?referer=navbar" target="_top"><area shape="rect" coords="9,21,61,36" href="http://www2.fortunecity.com/cgi-bin/showarea.pl?area=skyscraper&referer=navbar" target="_top"><area shape="rect" coords="8,0,62,15" href="http://www.fortunecity.com/" target="_top"><area shape="rect" href="http://www.fortunecity.com/" target="_top" coords="0,0,49,49"></map></td><td colspan="9"><A HREF="http://ad.doubleclick.net/jump/fc.us468/member/tech;s1=m;s3=tech;pos=1;tag=g;sz=468x60;mtile=1;num=47915?"><IMG SRC="../../a1896.g.akamaitech.net/n/1896/701/0001/216.34.88.210/Banners/eCOST/468x60_videogames.gif-950992135-84476136&950992135-84476136&8140038.gif" tppabs="http://ad.doubleclick.net/ad/fc.us468/member/tech;s1=m;s3=tech;pos=1;tag=g;sz=468x60;mtile=1;num=47915?" border=0 height="60" width="468"></A></td>
<td><img src="../../www.fortunecity.com/console2/newnav/right.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/right.gif" width="15" height="60"></td></tr>
<tr><td><img src="../../www.fortunecity.com/console2/newnav/left2.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/left2.gif" height="31" width="72" target="_top"></td><td><img src="../../www.fortunecity.com/console2/newnav/gap1.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/gap1.gif" width="17" height="31"></td><td><a href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/FortuneCitycom/NavBar1/47915" target="_top"><img src="../../adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar1/47915.gif" tppabs="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar1/47915" border="0" width="88" height="31"></a></td><td><img src="../../www.fortunecity.com/console2/newnav/gap2.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/gap2.gif" width="24" height="31"></td><td><a href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/FortuneCitycom/NavBar2/47915" target="_top"><img src="../../adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar2/47915.gif" tppabs="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar2/47915" border="0" width="88" height="31"></a></td><td><img src="../../www.fortunecity.com/console2/newnav/gap3.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/gap3.gif" width="24" height="31"></td><td><a href="http://adex3.flycast.com/server/socket/127.0.0.1:2800/click/FortuneCitycom/NavBar3/47915" target="_top"><img src="../../adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar3/47915.gif" tppabs="http://adex3.flycast.com/server/socket/127.0.0.1:2800/ad/FortuneCitycom/NavBar3/47915" border="0" width="88" height="31"></a></td><td><img src="../../www.fortunecity.com/console2/newnav/gap4.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/gap4.gif" width="19" height="31"></td><td><a href="http://www2.fortunecity.com/cgi-bin/homepage/navbarforward.cgi?from=nav4&referer=navbare" target="_top"><img src="../../www.fortunecity.com/console2/newnav/button4.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/button4.gif" border="0" width="88" height="31"></a></td><td><img src="../../www.fortunecity.com/console2/newnav/gap5.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/gap5.gif" width="32" height="31"></td><td><img src="../../www.fortunecity.com/console2/newnav/right2.gif.htm" tppabs="http://www.fortunecity.com/console2/newnav/right2.gif" width="15" height="31"></td></tr></table></p>
</center>
<!-- WARNING: under no circumstances remove the line below.  Doing so may damage your page.-->
<!-- FC HP BN1 END -->

<A NAME="anchortop"></A>
<!-- Begin Introdo --><center>


<table><tr><td>
<IMG SRC="images/ibcolumn.jpg" tppabs="http://members.xoom.com/tsehp_/images/ibcolumn.jpg" ALT="Thinking..." 
ALIGN=LINKS BORDER=0 VSPACE=0 HSPACE=0 width="200" height="455"></td><tD><center>
<H2>Welcome to Reverser's BLACKBOARD!</H2>(updated January 1999)<br>
<IMG SRC="images/blackbo.gif" tppabs="http://members.xoom.com/tsehp_/images/blackbo.gif" ALT="blackboard" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="114" height="43"><br><br>
<font color=red>[</fonT>go to the 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a href="blackbo.htm#anchor1997">1997 chronology</a><font color=red>]</fonT>
 ~ <font color=red>[</fonT>go to the 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a href="blackbo.htm#anchor1998">1998 chronology</a><font color=red>]</fonT>
 
<hr size=1>



Else just read on, I'll add sporadically some rumblings 
of mine.<br><br>

OK, I admit it: I'm sad. The more I visit the scene (and I routinely check all 
relevant links) the more I notice a creeping commercialisation roaring its ugly head even among us. 
I cannot understand this: people seem unduly obsessed by the possibility of making personal 
gains. Even capable reversers are now more and more seeking some sort of 
'monetary compensation' for their work. The subliminal effect of those millions of 
commercial banner ads is maybe taking control of their brains, like in a SF-film. Since I cannot understand this,  
I'm probably out of touch with the reality. Well, so be it: 
I'm fed up. My dream was to fullfill the task 
+ORC entrusted us long ago: <font color=purple>"knowledge is now free at last: let's use this for once to 
our advantage: let's spread real knowledge to anyone that cares. They spread shit ads and 
fake propaganda, we spread real knowledge. We will win"</font color=purple>. Yet we are 
not winning, or at least the other side is winning even more. And I'm tired..

<br>
<br></center></td></tr></table>
<hr><center>
<table border= "2" width=77%><tr><td bgcolor="#FFFFEA">
<center><H3>Ramblings</H3></center></tD></tr>
</table>
<bR><br>
<Font size=+1></center>
<TABLE CELLPADDING=1 CELLSPACING=2 BORDER=1>
<!-- insert here illuminations -->
<tr><td><center><b>Xmas 1998</b></center></td><td colspan=3 ALIGN=center bgcolor="#FFFFEA"><center><H2>
<a href="merryx.htm" tppabs="http://members.xoom.com/tsehp_/merryx.htm">Merry whatever</a> and a happy new year to all my readers!</H2></center></td></tr>

<TR><TD valign=center><Font size=+1>Winter 1998</Font><br>reversers boring rumblings</TD>
<TD VALIGN=center>reverser's boring rumblings
<bR>(about goebbelsian european propaganda, Clinton's 
sexual escapades and Iraq bombing)<i></center><br>
Na ja... merry Xmas (or Yanucca, or whatever your local ideology is) to all of you... since
we are reversers, and since I'm unfortunately editing nice essays, right now, during a 
barbarical air-attack against a population 
that has the only fault to live in a different dictatorial system than the ones 
we ourselves are enjoying, and since my kids are playing with nice new toys in 
the same room where a TV-set yells an awful sequence of idiotical 
propaganda in the attempt to cover the images 
of other kids being bombed and killed by the governments of my American and British 
friends, I'm afraid I just have to write these words, even if they sound silly and useless... 
it is just a question of being coherent with my (limited yet still existing) 
conscience: <font color=blue>Nossir: Your wars are not mine. Whatever  
your obscene propaganda says: your wars are not mine. 
I'm a reverser, I won't forget anything. You'll 
pay for these crimes</fonT>. Sorry, I know politics and web-teachings 
should be kept well apart... and 
I always sincerely did great efforts in this sense... but this time it was 
just a little too much for me. I flipped the moment I heard on CNN 
the american butcher-in-chief 
saying that "fortunately 
there have been no victims among US-citizens"... See: I had to write this small snippet, 
after all it's a sort of reversing effort as well...
</center>
</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>We reverse software while software kills</td>
</tr> 

<TR><TD valign=center><Font size=+1>Autumn 1998</Font><br>Should we 
crack or reverse?</TD>
<TD VALIGN=center><center><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=400 HEIGHT=5 BORDER=0
VSPACE=0 HSPACE=0><bR><br>See my <a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm" >Autumnal thoughts</a> special page with 
the comments and suggestions of many friends.<br><bR><center><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=400 HEIGHT=5 BORDER=0
VSPACE=0 HSPACE=0></center>
</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Crossing the wide wide web</td>
</tr> 



<TR><TD valign=center><Font size=+1>Mid May 1998</Font><br>Silly thoughts of a tired 
webmaster</TD>
<TD VALIGN=center>It's a difficult situation: for one contributor worth something there are more 
than TWENTY that only waste your time, most of them -moreover- as it seems completely 
"en mauvaise fois". So what? I could probably now close my site, 
maybe, there are now many others talented ones that would fill the gap: I reckon I have made enough my point: a non-commercial site can not only 
"survive", but 
become a reference and a source of knowledge for any other site on the web that deals 
with this kind of matter (yet the "nonchalance" by those who steal the knowledge on this site 
in order to sell it to the zombies keeps fascinating me... I believe that the mere 
existence of people so exclusively concentrated on money matters is one of 
the marvels of our 
world... like industrious little ants: instead of <u>living</u> these guinea pigs are 
furiously concentrated on their limited horizon: their useless GSM-appointments,  
the dutyful pathetical morning washing of their  
cars, the next career opportunity behind the shoulders of their collegues... hey... what remains for them 
later? A sense of fullfillment 
for having gained a little more money this way? 
To gain money, if not unimportant, is IMHO 
relatively easy (if you really don't know how to gain a lot of 
money just enter -for instance- any political party and conform until you do): the real difficult problem is what 
you will do <u>with your life</u>... how do you keep 'growing' and 'learning' all the way long... 
clearly most of the people working in this field have still a lot to understand... yet 
I'm VERY happy to have had the pleasure and the honor to meet (well, figuratively) 
people like +ORC, +gthorne, Sharp, Mammon, +ReZiDeNt, Quine, +Alistair, Hutch, +Aesculapius, 
+RCG and 
all the many 
other talented and clever 
ones that compensate '<i>ad abundantiam</i>' the zombie majority I'm at times compelled to come 
to terms with)
</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Nothing cool in this hot may</td>
</tr> 


<TR><TD valign=center><Font size=+1>Mid March 1998</Font><br>Evolution of this site, evolution of the 
cracker</TD>
<TD VALIGN=center>Should I push away from 'simple' cracking? It is difficult to judge, 
because there is a great 'turnover' of visitors, of course, and many people that land 
on my site are still 'cracker-conditioned', they don't yet grasp the beauty and the 
interest of reversing code that HAS NOTHING TO DO with protection schemes. On the other 
hand more and more valid reversers are growing up (one of the best: Quine, has recently 
decided to 'retire' and pass to more 'constructive' tasks :-( a very solide and powerful
approach: they are IMPROVING the targets they reverse... well, I believe that my site 
had in part a role in this development. I'll try to push even more. Crackers are finally 
getting 
down from their trees all over the planet. They are EXPLAINING and TEACHING. They are beginning to use TOOLS! They are approaching from 
underneath the codebushes, very powerful and very dangerous, with their sharp assembly 
blades, for the heavy 
and overbloated Windozed Appllicationosaurus, 
stupidly chewing its routines on the code planes. Poor brainless creatures, they cannot 
even run 
away with their huge and heavy commercial overbloated bodies. In this incredibly 
silly-frilly aera the new <i>Homo reversicus</i> will 
have plenty of food! Yumm! Burp!
</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Teacher cool</td>
</tr> 

<TD valign=center><Font size=+1>Mid February 1998</Font><br>About time on the web</TD>
<TD VALIGN=center>Web time and real time have few things in common: that what seems very important 
to one seems irrelevant to others, and messages that are very urgent (say on a maillist) get 
their answers many week afterwards... this depends from the fact, I believe, that our 
'community' is NOT real: messages sent by y for x arrives when he is gone for a week, he comes back and 
answers and y is upset for this delay. Z asks for help and many <u>months</u> later 
W answers, because he happens to have found Z's original email on dejavue seeking completely 
different things... funny web where there are still many pages linking to pages of mine 
that have disappeared in 1995! I find also the 'waves' curious, if you have a look at the 
<a href="blackbo.htm#anchor1998">chronology</a>, you'll realise that, for instance, dongle cracking 
seems to have been all the rage towards the end of january...
</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Proustian cool</td>

</tr> 

<TR>
<TD valign=center><Font size=+1>End January 1998</Font><br>Working in the 'cave'</TD>
<TD VALIGN=center>Keeping a site like this one remembers me of costantly adjusting and 
repairing things in a big house. At the moment, as you can see from the <a href="blackbo.htm#anchor1998">chronology</a>, I'm 
working somewhere in my Javascript section... Take a seat, sip a cocktail and read some 
essays, if you need me you'll find me there. ~ The new <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript entrances</a> section has collected 
a huge amount of interest... man! These things are indeed interesting! ~ 
I have also revamped my <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> after having received 
the 'cigarretes' essay by +ORC... hope to get this section up and running for this sommer (besides: I love 
Bilibin's pictures :-)

</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Techno<br>cool</td>

</tr> 
</table>


<hr><center>
<table border= "2" width=77%><tr><td bgcolor="#FFFFEA">
<center><H3>1997</H3></center></tD></tr>
</table>
<bR><br>

<TABLE CELLPADDING=1 CELLSPACING=2 BORDER=1>

<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>November 1997 ~ January 1998</Font></td>
<TD VALIGN=center>lotta things</TD>
<TD VALIGN=center>The Blackboard has been interrupted for a month. 
The new section has been improved and transformed in the (beginning) of a 
real <a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">Acadmey of anonimity</a>, we'll see if we get enough 
time free to follow it. 
The <a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >Steganography</a> section has collected a huge amount 
of ineterest</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Really cool</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>  
 
<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>8 November 1997</Font></td>
<TD VALIGN=center>Anonymity Academy</TD>
<TD VALIGN=center>A new <a href="noanon.htm#anchoranoaca" tppabs="http://members.xoom.com/tsehp_/noanon.htm#anchoranoaca">section</a> with an essay by LordCaligo!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Quite interesting</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>   



<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>7 November 1997</Font></td>
<TD VALIGN=center>Reverser+ & Snatch</TD>
<TD VALIGN=center>New interesting tool: <a href="anonma2.htm" tppabs="http://members.xoom.com/tsehp_/anonma2.htm" >Smartcheck 5.0</a></td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>pretty important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>    

<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>3 November 1997</Font></td>
<TD VALIGN=center>Thank denis</TD>
<TD VALIGN=center>PC Magazine november 97 (not the Hors serie edition) carries 
Delphi 2 trial and Intrabuilder</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Pretty important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>   


 
<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>29 October 1997</Font></td>
<TD VALIGN=center>+HCU preparation for the 1998 courses</TD>
<TD VALIGN=center>Well, this comes directly from <a href="newuni.htm" tppabs="http://members.xoom.com/tsehp_/newuni.htm" >+ORC</a>, so only those that
 passed the strainer (and the old hands) are requested to do it</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>MOST important for all +HCUkers<bR>
Quite important for all friends</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>   



<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>28 October 1997</Font></td>
<TD VALIGN=center>Thank +ReZiDeNt!</TD>
<TD VALIGN=center>PcPro (UK magazine) December issue: pcANYWHERE, Norton Utilities, Crashguard, Norton 
AntiVirus and  the 
full Corel Office 8 (with Paradox) for 3.50 UK pounds in Europe, even less in Britain</a></td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>TOOLS!<br>pretty important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>     
        
<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>28 October 1997</Font></td>
<TD VALIGN=center>+HCU Taxonomy</TD>
<TD VALIGN=center>Two new interesting sections: <a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm" >Advanced cracking</a> and 
<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >Snippets</a></td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Quite important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>   


<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
<TD valign=center><Font size=+1>28 October 1997</Font></td>
<TD VALIGN=center>Watcom11</TD>
<TD VALIGN=center>I know that some of you may be interested in the complete 
(201.008 bytes long) listing of 
all files contained in my <a href="http://acrigs.com/FRAVIA/zipped/watcom11.zip" tppabs="http://members.xoom.com/tsehp_/zipped/watcom11.zip" >WATCOM 11 CD-ROM</a>: here they are.
Watch it: no files here (of course you'll be able to find them on the 
Web, yet not on my site nor from my copy n.W31155), here have been zipped only the NAMES of all files!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>not much important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>       
  
   
           

<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center>
<Font size=+1>21 October 1997
</Font></td>
<TD VALIGN=center>
Java and C++
</TD>
<TD VALIGN=center>PCMag Hors-serie n.23 'Programmer Internet' issue "November 1997", a french 
magazine (only address: cdrom@planetepc.fr, price = 38 french francs) carries free (or easy to 
reverse :-) betas or trials of<br>
JavaStudio 1.0 (Sun); <font color=red>Java WorkShop 2.0</fonT> (Sun); JDK 1.14 (Sun); 
<font color=red>Visual Cafe</font> (Symantec);
<font color=red> Borland
C++ Builder</fonT> (Borland); Borland Intrabuilder (Borland); and other 
small "development" suites.</td>
<TD VALIGN=center>
		 ~
</td>
<TD VALIGN=CENTER>TOOLS!<br>
VERY<br>IMPORTANT
</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>  


<TR><TD VALIGN=center>
  <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD><TD valign=center><Font size=+1>12/19 October 1997</Font></td>
<TD VALIGN=center>Tough protections (letter from +Sync)</TD>
<TD VALIGN=center><i>
"I have spent several days looking at a VB3 program called POPIt, and
have had very little success.  I have talked to Razzia as well as
several others on IRC and it seems that this program has not yet been
cracked.  I was hoping you could possibly post a challenge on the HCU
page, looking for information on the scheme this program uses.  It
claims that it uses the hard drive serial number off of your computer as
part of the protection, but I have doubts as to the validity of this"</i>. 
The program is available at www.pro-pro.com
Thanks <a href="mailto:sync1@iname.com">+Sync</a><br>
And <a href="flip2syn.htm" tppabs="http://members.xoom.com/tsehp_/flip2syn.htm" >here you have a first anwer by flipper!</td>
<TD VALIGN=center>~</td><TD VALIGN=CENTER>pretty important</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>
                          


<TR><TD VALIGN=center>
  <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD><TD valign=center><Font size=+1>19 September 1997</Font></td>
<TD VALIGN=center>Thanks Rob!</TD>
<TD VALIGN=center>Hello, an update on PC plus giving away Borland C 4.5 Octobers issue 
which is in shops now in UK has repeated Borland C 4.5 disk due to public
demand. So another chance to get it for 4 pounds.</td>
<TD VALIGN=center>~</td><TD VALIGN=CENTER>TOOLS!<br>VERY IMPORTANT!</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>



<TR><TD VALIGN=center>
  <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD><TD valign=center><Font size=+1>16 September 1997</Font></td>
<TD VALIGN=center>general</TD>
<TD VALIGN=center>Hey, everyone... please start working on "demo" reverse 
engineering (yes: graphic 3D demos). We suppose that TREASURES of compact 
code (and assembly tricks) are to be found there!</td>
<TD VALIGN=center>~</td><TD VALIGN=CENTER>New project!<br>(Project B)</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>



  <TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>15 September 1997</Font></td>
<TD VALIGN=center><a href="solution.htm" tppabs="http://members.xoom.com/tsehp_/solution.htm" >solution.htm</a></TD>
<TD VALIGN=center>Solutions to the strainer: the new +crackers!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Quite<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>

<TR><TD VALIGN=center>
  <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD><TD valign=center><Font size=+1>10 September 1997</Font></td>
<TD VALIGN=center>general</TD>
<TD VALIGN=center>Hey, everyone... please send your FAVOURITE breakpoints 
for softice (Say <font color=blue>bpmb cs:eip rw if 0x30:0x43AA==1</font>)</td>
<TD VALIGN=center>~</td><TD VALIGN=CENTER>New project!<br>(Part of <a href="project2.htm" tppabs="http://members.xoom.com/tsehp_/project2.htm" >Project 2</a>)</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>




<TR><TD VALIGN=center>
  <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD><TD valign=center><Font size=+1>29 August 1997</Font></td>
<TD VALIGN=center><a href="pna1.htm" tppabs="http://members.xoom.com/tsehp_/pna1.htm" >pna1.htm</a></TD>
<TD VALIGN=center>The first +HCU 97 Training exercise</td>
<TD VALIGN=center>~</td><TD VALIGN=CENTER>Fairly<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>


  <TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>27 August 1997</Font></td>
<TD VALIGN=center><a href="astonish.htm" tppabs="http://members.xoom.com/tsehp_/astonish.htm" >astonish.htm</a></TD>
<TD VALIGN=center>Micro$oft's SERIOUS security holes exposed</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Quite<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>

<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>13 August 1997</Font></td>
<TD VALIGN=center>capered pages</TD>
<TD VALIGN=center>ATTN: Thomas! Thanks a lot!, may be wir werden 
uns treffen in Kreuzberg!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>NOT<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>



 <TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>09 August 1997</Font></td>
<TD VALIGN=center>bag' of tips (Rundus)</TD>
<TD VALIGN=center>Hexsearch nagscreen and place nop in front of the Nagwindow Title</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Fairly<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>



<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>06 August 1997</Font></td>
<TD VALIGN=center>Students' essays</TD>
<TD VALIGN=center>ATTN: Marta! Long ago promised lessons about dongles! still missing!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Fairly<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>

  <TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center><Font size=+1>31 July 1997</Font></td>
<TD VALIGN=center>bag'of tips (Lanor)</TD>
<TD VALIGN=center>Cookies begone with a new DIRECTORY cookies.txt! Just try it and 
re-enable cookies without any problem any more!</td>
<TD VALIGN=center>~</td>
<TD VALIGN=CENTER>Pretty<br>IMPORTANT</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD>
</tr>

<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center>
<Font size=+1>19 July 1997
</Font></td>
<TD VALIGN=center>
 Zmud
</TD>
<TD VALIGN=center>Wer getting nowhere with Zmud, please write if you got 
something</td>
<TD VALIGN=center>
		 ~
</td>
<TD VALIGN=CENTER>
NOT<br>IMPORTANT
</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>



<TR>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">
</tD>
<TD valign=center>
<Font size=+1>19 July 1997
</Font></td>
<TD VALIGN=center>
Borland Resource Workshop
</TD>
<TD VALIGN=center>
		    BRW (Borland Resource Workshop) Last version 4.5.!<br>
Buy IMMEDIATELY the UK Review PCPLus (Issue 130, August 1997), Price: 3.99 UK Sterlings<br>
You'll find inside it, THE COMPLETE Borland C++ version 4.5 <u>with BRW</u>!</td>
<TD VALIGN=center>
		 ~
</td>
<TD VALIGN=CENTER>TOOLS!<br>
VERY<br>IMPORTANT
</td>
<TD VALIGN=center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=LEFT BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></tD></a>
</tr>


</table>
<br>
<i>
 Well, you'll get a PERFECTLY LEGAL copy of BRW <u>and</u> the whole Borland 
 C compiler (a very good version BTW: 4,52, and the complete Windoze's API 
 reference, and a lot of other goodies (Netscape 
 4, for instance) for less than 4 pounds... should somebody dare to say 
 that Crackers are the ruin of the software industry you know what to answer :-)<br>
 <br>
 Some info about PcPlus (UK) for those of you outside the European Union:<bR>
 pcplus@futurenet.co.uk<br>
 <a href="http://www.futurenet.com/" >http://www.futurenet.com</a><br>
 Future publishing: United Kingdom: O1225-442244<br>
</i>
<br><a name="anchor1998"></a><hr size=6></prE>
<hr><center>
<table border= "2" width=77%><tr><td bgcolor="#FFFFEA">
<center><H3>1998</H3></center></tD></tr>
</table>
<bR><br>




<table border="1">
<!-- ************************************* -->
<!-- ************ Updates here *********** -->
<!-- ************************************* -->


<tr><td><center>23 December 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Merry Xmas <font color=red>~</fonT> Linguistic cracking <font color=red>~</fonT> Advanced searching <font color=red>~</fonT> chmod cracking <font color=red>~</fonT> OCX cracking <font color=red>~</fonT> 
Linux cracking <font color=red>~</fonT> mm2* neutralizing <font color=red>~</fonT> More about supermarket enslavment
</center></td>
<td><a href="merryx.htm" tppabs="http://members.xoom.com/tsehp_/merryx.htm">merryx.htm</a>: Merry Xmas! (a 
present for the good ones, 
a punishment for the bad ones :-) <font color=red>~</fonT> <a href="truber_1.htm" tppabs="http://members.xoom.com/tsehp_/truber_1.htm">truber_1.htm</a>: Trubert's <i>
Linguistic cracking ('Nationality' exegesis)
</I> part of the <a href="exegesis.htm" tppabs="http://members.xoom.com/tsehp_/exegesis.htm">text cracking</a> section, useful for stalking purposes as well <font color=red>~</fonT> 
<a href="kmart_s1.htm" tppabs="http://members.xoom.com/tsehp_/kmart_s1.htm">kmart_s1.htm</a>: Kmart's <i>More searching tips</i> (Advanced <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">searching</a>) <font color=red>~</fonT>

<a href="xdae_22.htm" tppabs="http://members.xoom.com/tsehp_/xdae_22.htm">xdae_22.htm</a>: +Xdaemon's <i>Cracking File Read Aloud v1.1 
(the chmod indicator)</i> <font color=red>~</fonT> <a href="blackbo.htm" tppabs="http://members.xoom.com/tsehp_/blackbo.htm">Blackboard</a> & 
<a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">Links</a> & <a href="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">Cocktails</a> 
& <a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm">Recent thoughts</a>  & <a href="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">howtouse</a> & <a href="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">protec.htm</a> updated <font color=red>~</fonT>
<a href="soz_li.htm" tppabs="http://members.xoom.com/tsehp_/soz_li.htm">soz_li.htm</a>: .sozni's <i>OCX cracking (Using LIC files)</i> 
<font color=red>~</fonT>
<a href="siul_333.htm" tppabs="http://members.xoom.com/tsehp_/siul_333.htm">siul_333.htm</a>: SiuL+Hacky's <i>Linux cracking: 
About Introducing Your Own Code</i> (<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">Advanced</a> cracking)
<font color=red>~</fonT>
<a href="mm_dat.htm" tppabs="http://members.xoom.com/tsehp_/mm_dat.htm">mm_dat.htm</a>: ZenGuy+:<i>Neutralizing MM256.DAT and MM2048.DAT files</i>                                
<font color=red>~</fonT>
<a href="cugeosup.htm" tppabs="http://members.xoom.com/tsehp_/cugeosup.htm">cugeosup.htm</a>: Curious George's 
<i>'the discount supermarket'</i> and reverser+'s "<i><a href="cugeosup.htm#eumoma" tppabs="http://members.xoom.com/tsehp_/cugeosup.htm#eumoma">European 
Motorroad malls</a></i>", as part of the 'supermarket enslavery' section of the 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> Lab
</td></tr>

<tr><td><center>12 December 1998<br><font
size=+1><b>Contents:</b></fonT><br>
More supermarket enslavement <font color=red>~</fonT> VBOX reversing <font color=red>~</fonT> rhetorical truths <font color=red>~</fonT> access any commercial site <font color=red>~</fonT> 
Cracking the impossible <font color=red>~</fonT> Things that happen <font color=red>~</fonT> corporate sniffing <font color=red>~</fonT> Dick & Drugs <font color=red>~</fonT> Crunching <font color=red>~</fonT> 
everlock revisited

</center></td>
<td>
<a href="slaves.htm" tppabs="http://members.xoom.com/tsehp_/slaves.htm">slaves.htm</a>: Dark One's ADDITION to the famous "supermarket enslaving tricks" by +ORC 
(a <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> essay <font color=red>~</fonT> <a href="porvbo1.htm" tppabs="http://members.xoom.com/tsehp_/porvbo1.htm">porvbo1.htm</a>: 
Victor Porguen's <i>Redirection Revisited -- Achieving Redirection Through API 
Spoofing</i> (part of 
the +HCU <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</a>) <font color=red>~</fonT> <a href="kuririrh.htm" tppabs="http://members.xoom.com/tsehp_/kuririrh.htm">kuririrh.htm</a>: 
Kuririn's <i>A "quick and dirty" look at rhetoric and persuasion</i>(a 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> essay <font color=red>~</fonT> <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm">Micro$oft bashing</A> & <a href="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktail.htm</a> & <a href="confnets.htm" tppabs="http://members.xoom.com/tsehp_/confnets.htm">confnets.htm</a> revamped <font color=red>~</fonT>  <a href="ideale7.htm" tppabs="http://members.xoom.com/tsehp_/ideale7.htm">ideale7.htm</a>: reverser's and A+heist's <i>How to seriously annoy smut sites... (How
 to allow any luser to 
access <u>any commercial smut site</u> for free :-)</i>, part of the <a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">Site busting</a>
 section <font color=red>~</fonT> <a href="owlimpo.htm" tppabs="http://members.xoom.com/tsehp_/owlimpo.htm">owlimpo.htm</a>: The Owl's <i>Cracking the impossible</i>, part of the 
<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">advanced</a> software reverse engineering lab <font color=red>~</fonT> 
<a href="anohisto.htm" tppabs="http://members.xoom.com/tsehp_/anohisto.htm">anohisto.htm</a>: reverser's <i>Things that happen</i>, part of the 
<a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">Anonymity Lab</a> <font color=red>~</fonT> <a href="enbecor.htm" tppabs="http://members.xoom.com/tsehp_/enbecor.htm">enbecor.htm</a>: 
Embedded's <i>Sniffing the Corporate and Institutional Network</i>, part of 
the <a href="corporate.htm" tppabs="http://members.xoom.com/tsehp_/corporate.htm">corporate survival techniques</a> section <font color=red>~</fonT> 
<a href="psycioff.htm" tppabs="http://members.xoom.com/tsehp_/psycioff.htm">psycioff.htm</a>: 
Cioff's <i>Psycho slimming
</i>, part of the <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> section <font color=red>~</fonT> <a href="crunchi7.htm" tppabs="http://members.xoom.com/tsehp_/crunchi7.htm">crunchi7.htm</a>: Joa's
<i>Little essay about the various methods and
viewpoints of crunching.
Part VII: Arithmetic Crunching (crunching bits apart...)</i> <font color=red>~</fonT> <a href="everlock.htm" tppabs="http://members.xoom.com/tsehp_/everlock.htm">everlock.htm</a>: 
Tomboy's <i>Everlock by Az-Tech: Reversing a Commercial Copy Protection Scheme - Part I</i> 
</td></tr>





<tr><td><center>2 December 1998<br><font
size=+1><b>Contents:</b></fonT><br>
anonymous emailing <font color=red>~</fonT> why crackers crack <font color=red>~</fonT> Java against javascript <font color=red>~</fonT> applets cracking <font color=red>~</fonT> 
search better <font color=red>~</fonT> The multi-pharmaindustrial conspiracy <font color=red>~</fonT> Windoze watches you? You watch windoze! 
<font color=red>~</fonT> Dangerous food additives (reversing labels) <font color=red>~</fonT> Cinderella <font color=red>~</fonT> Using BRW

</center></td>
<td>
<a href="anonema.htm" tppabs="http://members.xoom.com/tsehp_/anonema.htm">anonema.htm</a>: Anonymous emailing, reverser's golden tips
 <font color=red>~</fonT> <a href="corporate.htm" tppabs="http://members.xoom.com/tsehp_/corporate.htm">corporate.htm</a>: One for "public" computers 
<font color=red>~</fonT> <a href="whydwcr.htm" tppabs="http://members.xoom.com/tsehp_/whydwcr.htm">whydwcr.htm</a>: 
Why crackers crack? Reversing reversers' psychology (part of the <a href="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect 
better</a> section <font color=red>~</fonT> <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> revamped <font color=red>~</fonT> Advanced javascript page 
(restricted access... see "entrance" at <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascri.htm</a>): Gattman's Java approach <font color=red>~</fonT> 
<a href="codeliap.htm" tppabs="http://members.xoom.com/tsehp_/codeliap.htm">codeliap.htm</a>: <i>cracking codelink v4.0 by silkware</i> "applets cracking" by
douby <font color=red>~</fonT> <a href="surre_05.htm" tppabs="http://members.xoom.com/tsehp_/surre_05.htm">surre_05.htm</a>: <i>The continued irc experience, pro's and 
con's from a searching standpoint</i> by surreal5 (part of surreal5's 
<a href="surrsea1.htm" tppabs="http://members.xoom.com/tsehp_/surrsea1.htm">search tips</a>) <font color=red>~</fonT> <b>TWO</b> <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> 
essays!: <a href="pharma1.htm" tppabs="http://members.xoom.com/tsehp_/pharma1.htm">pharma1.htm</a>: 
Cioff's <i>The multi-industrial conspiracy</i> <font color=red>~</fonT> <a href="entran.htm" tppabs="http://members.xoom.com/tsehp_/entran.htm">entran.htm</a> revamped <font color=red>~</fonT> <a href="asparta1.htm" tppabs="http://members.xoom.com/tsehp_/asparta1.htm">asparta1.htm</a>: Kuririn's <i>Dangerous food additives 
(reversing labels)</i>  <font color=red>~</fonT> <a href="twdappl2.htm" tppabs="http://members.xoom.com/tsehp_/twdappl2.htm">twdappl2.htm</a>: TWD's 
<i>Looking inside your Windows 98...  (second part: "Tell me which applications you run and I tell you who you are")</i>, 
part of the <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm">Micro$oft bashing</a> section <font color=red>~</fonT> <a href="rhino.htm" tppabs="http://members.xoom.com/tsehp_/rhino.htm">rhino.htm</a>: 
 Sojourner's <i>What Time Does the Library Open?</i> (part of the <a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm">Most stupid protection</a> section) <font color=red>~</fonT> 
<a href="caligo4.htm" tppabs="http://members.xoom.com/tsehp_/caligo4.htm">caligo4.htm</a>: 
LordCaligo's <i>Using BRW: How to make passwords hidden by "stars" visible</i>, a 
<a href="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">How to use our tools</a> essay 
</td></tr>



<tr><td><center>25 November 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Safe surfing <font color=red>~</fonT> Site cracking for beginners <font color=red>~</fonT> Clever CD protection schemes <font color=red>~</fonT> 
anti-advertisement <font color=red>~</fonT> M$-logo subliminal brainwashing <font color=red>~</fonT> Information warfare <font color=red>~</fonT> reality 
cracking <font color=red>~</fonT> redirections <font color=red>~</fonT> searching

</center></td>
<td>
<a href="project5.htm" tppabs="http://members.xoom.com/tsehp_/project5.htm">project5.htm</a>: FOUR! contributions 
to 'safe surfing': <b>1)</b> <a href="iefafpro.htm" tppabs="http://members.xoom.com/tsehp_/iefafpro.htm">iefafpro.htm</a> & <a href="confnets.htm" tppabs="http://members.xoom.com/tsehp_/confnets.htm">confnets.htm</a>: 
Iefaf's <i>Two contributions to reverser's anonimity lab and also a reaction to
his autumnal feelings</i> <font color=red>~</fonT> <b>2)</b> <a href="http://acrigs.com/FRAVIA/zipped/netscape.zip" tppabs="http://members.xoom.com/tsehp_/zipped/netscape.zip">zipped/netscape.zip</a>: Awaiting_name: 
<i>Panzer your netscape browser (with C++ source code!)</i> <font color=red>~</fonT> 
<b>3)</b> <a href="twodisk.htm" tppabs="http://members.xoom.com/tsehp_/twodisk.htm">twodisk.htm</a>: -the_gonz's  <i>An easy way to stop 
the guys (from Redmond) to snoop data inside
your harddisk</i> <font color=red>~</fonT> 
<a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> & <a href="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktail.htm</a> 
& <a href="searmyst.htm" tppabs="http://members.xoom.com/tsehp_/searmyst.htm">searmyst.htm</a> 
& <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm">project9.htm</a>: slightly updated <font color=red>~</fonT> 
<a href="antsmut.htm" tppabs="http://members.xoom.com/tsehp_/antsmut.htm">antsmut.htm</a>:  Triple T's easy 
smut sites cracking tips for beginners (part of <a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">ideale.htm</a>!) <font color=red>~</fonT> 
<a href="securom1.htm" tppabs="http://members.xoom.com/tsehp_/securom1.htm">securom1.htm</a>: Pedro's <i>Securom's clever 
protection scheme debunked</i> (With a new "GrimFandango" Addendum) 
(<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">advanced</a> cracking!) with an Addendum by +Xoanon <font color=red>~</fonT> FOUR! 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> essays: 
<b>1)</b> Hal Cioff's <a href="advert1.htm" tppabs="http://members.xoom.com/tsehp_/advert1.htm">advert1.htm</a>: 
<i>A first stab against the advertisement lures</i> <font color=red>~</fonT> <b>2)</b> Felipe's 
<a href="sublimi1.htm" tppabs="http://members.xoom.com/tsehp_/sublimi1.htm">sublimi1.htm</a>: 
<i>Windows' logo subliminals</i> <font color=red>~</fonT> <b>3)</b> Cioff's 
<a href="cioff_21.htm" tppabs="http://members.xoom.com/tsehp_/cioff_21.htm">Reality cracking tools: suggestions</a> <font color=red>~</fonT> 
<b>4)</b> <a href="infowarf.htm" tppabs="http://members.xoom.com/tsehp_/infowarf.htm">infowarf.htm</a>: reverser's "The power of reversing" (1): <i>Reverse engineering, information warfare and cots</i>
<font color=red>~</fonT> The Owl's <a href="owlbook.htm" tppabs="http://members.xoom.com/tsehp_/owlbook.htm">Great 
books</a> of our trade <font color=red>~</fonT> <a href="javacral.htm" tppabs="http://members.xoom.com/tsehp_/javacral.htm">javacral.htm</a>: El Latigo's <i>Java cracking, reversing applets</i> 
<font color=red>java reversing for beginners</fonT> <font color=red>~</fonT> <a href="redirect.htm" tppabs="http://members.xoom.com/tsehp_/redirect.htm">redirect.htm</a>: 
Victor Porguen's <i> Defeating File Integrity Checks Through Redirection</i> (substituting an "unhacked" copy
of the target instead of our cracked copy) <font color=red>~</fonT> <a href="mamm_gip.htm" tppabs="http://members.xoom.com/tsehp_/mamm_gip.htm">mamm_gip.htm</a>: +Mammon's <i>The great IDA primer</i> 
updated (part of the <a href="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">How to Use our tools</a> section)
 <font color=red>~</fonT> <a href="mycod2.htm" tppabs="http://members.xoom.com/tsehp_/mycod2.htm">search reverser's site!</a>
</td></tr>



<tr><td><center>12 November 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Ida enhancing <font color=red>~</fonT> Chaos protections <font color=red>~</fonT> Linux cracking <font color=red>~</fonT> Timelock cracking <font color=red>~</fonT> <u>Politicians</u> do indeed 
<u>smell</u> badly at <u>times</u> <font color=red>~</fonT> legalities <font color=red>~</fonT> IDA &lt;&gt; softice <font color=red>~</fonT> site busting galore


</center></td>
<td>
Jean-Marc's <a href="enh_ida.htm" tppabs="http://members.xoom.com/tsehp_/enh_ida.htm">enh_ida.htm</a>: <i>An IDA enhancer (patching the IDA.WLL)</i>
<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">advanced</a>, <A HREF="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">htu-tools</A> <font color=red>~</fonT> 
   NiKoDeMoS' <a href="jn_essay.htm" tppabs="http://members.xoom.com/tsehp_/jn_essay.htm">jn_essay.htm</a> <i>The 
New Chaos Protection</i>, <a HREF="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm">our protections</a> <font color=red>~</fonT>
adq's <a href="adqlinu1.htm" tppabs="http://members.xoom.com/tsehp_/adqlinu1.htm">adqlinu1.htm</a> <i>Linux 
cracking <font color=red>~</fonT> How to crack in Linux without a
                 disassembler</i> <font color=red>~</fonT> Marigold's 
<a href="marigo_4.htm" tppabs="http://members.xoom.com/tsehp_/marigo_4.htm">marigo_4.htm</a>: <i>VBox 
The Hellraiser or the "paper tiger" by PreviewSystems</i>, 
<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">advanced</a>, 
    <a HREF="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm">timelock</a> 
<font color=red>~</fonT> Cioff's 
<a href="halcio.htm" tppabs="http://members.xoom.com/tsehp_/halcio.htm">halcio.htm</a>: <i>SHOULD THE COMPUTER INDUSTRY BE OUR PRIMARY TARGET?</i> 
("the politicians as the primary enemy"), <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">realicra.htm</a> <font color=red>~</fonT> 
NotAnne's <a href="timeperc.htm" tppabs="http://members.xoom.com/tsehp_/timeperc.htm">timeperc.htm</a> <i>Perception 
of Time, Calendars and Animals</i> 
Felipe's findinges: <a href="fragra_1.htm" tppabs="http://members.xoom.com/tsehp_/fragra_1.htm">fragra_1.htm</a>: <i>Fragrances smell badly!</i> <font color=red>~</fonT> 

<a href="legal1.htm" tppabs="http://members.xoom.com/tsehp_/legal1.htm">legal1.htm</a>: The+Starling's <i>THE 
LEGAL PROTECTION OF COMPUTER PROGRAMS</i> (part of <a href="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">legal.htm</a>) <font color=red>~</fonT> 
<a href="help.htm" tppabs="http://members.xoom.com/tsehp_/help.htm">help.htm</a> revamped <font color=red>~</fonT> _Al's <a href="http://acrigs.com/FRAVIA/zipped/idasym.zip" tppabs="http://members.xoom.com/tsehp_/zipped/idasym.zip">idasym.zip</a>: <i>Converts IDA map file to a SoftIce SYM file</i> (an 
<a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm">ourtools.htm</a> tool) <font color=red>~</fonT> <a href="servexpl.htm" tppabs="http://members.xoom.com/tsehp_/servexpl.htm">servexpl.htm</a>: Rudycarell's 
<i>Some nice 
site busting techniques</i> <font color=red>~</fonT>
</td></tr>


<tr><td><center>30 October 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Strainer's solutions! <font color=red>~</fonT> deep into the code <font color=red>~</fonT> Our tools galore <font color=red>~</fonT> 
different modes <font color=red>~</fonT> have a look at your dats! <font color=red>~</fonT> good old Cute <font color=red>~</fonT> 

</center></td>
<td><center><a
href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/THCU99.htm">THCU99.htm</a>: Master <font
color=red>+</font><a
href="mailto:aesculapius@stones.com" </a>Aesculapius</a>
' judgment 
<a href="99solu/soluhtm.htm" tppabs="http://members.xoom.com/tsehp_/99solu/soluhtm.htm">solved</a>  
by some of the most promising +crackers of the planet! GREAT 
READING! More solutions added... (for <u><font 
color=red>advanced</font> protectors and reversers</u> only)
 <font color=red>Advanced reversing</font>!<bR><br>
The above section is a MUST for all reversers and protectors alike. 
Read, study, keep cool, learn... you have enough material in there for a 
couple of weeks!
<hr width=33%>

<a href="coc_001.htm" tppabs="http://members.xoom.com/tsehp_/coc_001.htm">coc_001.htm</a>: Cup of Cats'
 <i>When one key code works, why can't the rest of
them?</i> <font color=red>~</fonT> <a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm">Our tools galore! 3 essays</a>: 1) 
<a href="swann_mm.htm" tppabs="http://members.xoom.com/tsehp_/swann_mm.htm">swann_mm.htm</a>: Swann's <i>A New 
Toy: reversing the different 'modes' of a target</i> <font color=red>~</fonT> 2)
<a href="laste_09.htm" tppabs="http://members.xoom.com/tsehp_/laste_09.htm">laste_09.htm</a>: adq's <i>isDcc: An installshield Decompiler</i> <font color=red>Advanced reversing</fonT> 
 <font color=red>~</fonT> 3) <a href="getinfo.htm" tppabs="http://members.xoom.com/tsehp_/getinfo.htm">getinfo.htm</a>: Nikodemos (Jayke): <i>The Quick Guide to Smashing those insidious *.DAT filez</i>  <font color=red>~</fonT>  <a href="cftp_pro.htm" tppabs="http://members.xoom.com/tsehp_/cftp_pro.htm">cftp_pro.htm</a>: 
The+Q's <i>CuteFTP KeyFile Protection</i> <font color=red>Advanced reversing</fonT>
<font color=red>~</fonT> 
<a href="jeremy1.htm" tppabs="http://members.xoom.com/tsehp_/jeremy1.htm">An encryption challenge</a>: Jeremy Likness's challenge to all readers of 
my site <font color=red>~</fonT> <a href="pilgrim.htm" tppabs="http://members.xoom.com/tsehp_/pilgrim.htm">pilgrim.htm</a>: Pilgrim's <i>How to crack a PC-based FlexLm license manager</I> <font color=red>~</fonT> 
<a href="fragas1.htm" tppabs="http://members.xoom.com/tsehp_/fragas1.htm">fragas1.htm</a>: Lone Runner's <I>WIN32 Api Hooks, The stub approach</i>, 
<font color=red>Advanced reversing</fonT>
<font color=red>~</fonT> <a href="tapu1.htm" tppabs="http://members.xoom.com/tsehp_/tapu1.htm">tapu1.htm</a>: Tapu's <i>Cracking The Information Curtain</i>, a 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A> essay! <font color=red>~</fonT> <a href="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">howtouse.htm</a>: how to 
use our tools added <font color=red>~</fonT> <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> revamped 
</td></tr>




<tr><td><center>21 October 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Strainer's solutions! <font color=red>~</fonT>
Should we crack
or reverse? <font color=red>~</fonT> Dongle cracking <font color=red>~</fonT> Text cracking <font color=red>~</fonT> data cracking <font color=red>~</fonT> IDA <font color=red>~</fonT> good 
protections <font color=red>~</fonT> outtiming time limits <font color=red>~</fonT> No, I don't agree <font color=red>~</fonT> bad and good essays

</center></td>
<td>
<a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm">septem.htm</a>: More autumnal 
thougts and even more feedback: Should we crack 
protections or just reverse? <font color=red>~</fonT> <a href="dongle_n.htm" tppabs="http://members.xoom.com/tsehp_/dongle_n.htm">dongle_n.htm</a>: 932452's 
<i>Two stupid dongle protections bite the dust</i>, <a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm">Dongle 
cracking</a> <font color=red>~</fonT> <a href="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">HCU essays</a> aca100, 200, 300 and 400 revamped 
<font color=red>~</fonT> <a href="project0.htm" tppabs="http://members.xoom.com/tsehp_/project0.htm">project 0</a> revamped as example <font color=red>~</fonT> 
<a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm">awards page</a> revamped <font color=red>~</fonT> <a href="ductusu1.htm" tppabs="http://members.xoom.com/tsehp_/ductusu1.htm">ductusu1.htm</a>: 
VK's <i>Landlord vs Tenant: a "text-exegesis" crack</i>... <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality 
cracking</a>'s text-reversing subsection! <font color=red>~</fonT> <a href="bulga_1.htm" tppabs="http://members.xoom.com/tsehp_/bulga_1.htm">bulga_1.htm</a>: SvD's 
<i>Data-reverse-engineering - Lesson 1</i> <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">HCU papers</a> <font color=red>~</fonT> 
<a href="idaprim.htm" tppabs="http://members.xoom.com/tsehp_/idaprim.htm">idaprim.htm</a>: +Mammon's (and <i>alia</i>): IDA PRIMER <a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm">How to use 
our tools</a> <font color=red>~</fonT> <a href="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">protec.htm</a>: A good 
protection is NOT an impossible dream! <font color=red>~</fonT> <a href="rebirth.htm" tppabs="http://members.xoom.com/tsehp_/rebirth.htm">rebirth.htm</a>: 
Douby's <i>Outtiming the time limit and stack defeating two CRC checks</i>, a very good 
beginners essay <font color=red>~</fonT> : <a href="scarecro.htm" tppabs="http://members.xoom.com/tsehp_/scarecro.htm">scarecro.htm</a>: reverser's <i>Scarecrow license agreements and how to 
defeat them</i>, 
<a href="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">legal.htm</a> <font color=red>~</fonT> <a href="acaele1.htm" tppabs="http://members.xoom.com/tsehp_/acaele1.htm">acaele1.htm</a>: Knotty Dread's 
LIST OF GOOD AND BAD ESSAYS <font color=red>Cleaning reverser's site</font>:-) 
</td></tr>


<tr><td><center>14 October 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Strainer's solutions! <font color=red>~</fonT>
Should we crack
or reverse? <font color=red>~</fonT> Bogus windows 98: Our own
tools <font color=red>~</fonT> McDonald's cracking
</center></td>
<td>
<a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm">septem.htm</a>: More autumnal 
thougts and even more feedback: Should we crack 
protections or just reverse? <font color=red>~</fonT> <a href="twdaplog.htm" tppabs="http://members.xoom.com/tsehp_/twdaplog.htm">twdaplog.htm</a>: TWD's 
<i>Looking inside your Windows 98... Finding an hidden incredible database 
inside your computer</i> 
<a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm">ourtools</a> & <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm">Micro$oft bashing</a> 
 <font 
color=red>concealed cracking</fonT> <font color=red>~</fonT> <a href="ffoodre.htm" tppabs="http://members.xoom.com/tsehp_/ffoodre.htm">ffoodre.htm</a>: ABe*'s <i>Know 
the shit you eat, or FAST FOODs</i>, a <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracing</a> 
essay <font 
color=red>fast food cracking</fonT> <font color=red>~</fonT> 
<a href="necrophi.htm" tppabs="http://members.xoom.com/tsehp_/necrophi.htm">necrophi.htm</a>: Gossip's <I>sexual tendencies
and practices of necrophiliacs</i> a first 'text cracking' essay! 
<font 
color=red>not for the sensible ones</fonT> <font color=red>~</fonT>


</td></tr>


<tr><td><center>04 October 1998<br><font
size=+1><b>Contents:</b></fonT><br>
Strainer's solutions! ~
Should we crack
or reverse? ~ "target unrelated" cracking ~ Our own
tools ~ Admin ~ Heisenberg ~ CD-Rom protections ~ dongles ~ retaliate ~
strings
</center></td>
<td><a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm" >septem.htm</a>: More autumnal 
thougts and even more feedback: Should we crack 
protections or just reverse? ~ <a 
href="crawicra.htm" tppabs="http://members.xoom.com/tsehp_/crawicra.htm" >crawicra.htm</a>: reverser's 
<i>Cracking without cracking: secrets of the 
operational art of war demo</i>, <font 
color=red>"Target unrelated" cracking</font> ~ <a 
href="twdrul1.htm" tppabs="http://members.xoom.com/tsehp_/twdrul1.htm" >twdrul1.htm</a>: TWD's <i>a simple 
utilitiy which is fine to look inside others people 
computers</i>  <font color=red>Our</fonT> <a 
href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >tools</a> <font 
color=red>section</font> ~ <a 
href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a>, <a 
href="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktail.htm</a>, <a 
href="aca100.htm" tppabs="http://members.xoom.com/tsehp_/aca100.htm" >aca100.htm</a> and <a 
href="private.htm" tppabs="http://members.xoom.com/tsehp_/private.htm" >private.htm</a> partly modified ~ <a 
href="reacrnn.htm" tppabs="http://members.xoom.com/tsehp_/reacrnn.htm" >reacrnn.htm</a>: Pantheon's <i>The 
exact science of guessing</i> <font 
color=red>Intermediate</fonT> <a 
href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality</a> <font 
color=red>cracking</fonT> ~ <a 
href="cdromch.htm" tppabs="http://members.xoom.com/tsehp_/cdromch.htm" >cdromch.htm</a>: grasshopper's <i>A 
CDRom check with a twist</i> ~ <font color=red>"Target 
unrelated" cracking</font> ~ <a 
href="hutcheq.htm" tppabs="http://members.xoom.com/tsehp_/hutcheq.htm" >hutcheq.htm</a>: Hutch's <i>get a full set of prototypes for ASM in a fast

                 and automated way</i> <a 
href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >Our tools</a> ~ 
<a href="fuhr_o1.htm" tppabs="http://members.xoom.com/tsehp_/fuhr_o1.htm" >fuhr_o1.htm</a>: Dr Fuhrball's <i>A slightly different kind of dongle cracking</i> 
<font color=red> 
Advanced dongle cracking</font> ~ 
<a href="sueall.htm" tppabs="http://members.xoom.com/tsehp_/sueall.htm" >sueall.htm</a>: im/mu's <i>Invoice EveryCorp for EveryThing</i> another 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> tip. ~ <a href="tech01.htm" tppabs="http://members.xoom.com/tsehp_/tech01.htm" >tech01.htm</a>: 
 +MaLaTTiA's <i>Reverse engineering techniques explained #01: string search</i> 
<font color=red>Beginners' basic</font>

</td></tr>


<tr><td><center>23 September 1998<br><font
size=+1><b>Contents:</b></fonT><br>Should we crack
or reverse? ~ DVD cracking ~ "target unrelated"
cracking ~ M$ bashing ~ email stalking ~ counter intelligence 
</center></td>
<td><center><a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm" >septem.htm</a>: contributions to
my September discussion ~
  <a href="dvdfuhr.htm" tppabs="http://members.xoom.com/tsehp_/dvdfuhr.htm" >dvdfuhr.htm</a>: Dr. Fuhrball's
<i>DIVX and DVD reversing</i>,
<a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >+HCU papers</a>;
<font color=red>DVD cracking</font> ~
 <a href="asc0.htm" tppabs="http://members.xoom.com/tsehp_/asc0.htm" >asc0.htm</a>: Asc0's <i>A crackme
based on Aesculapius' algos</i>,
<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a>;
<font color=red>"Target unrelated" cracking</font> ~
 <a href="wdasmcr.htm" tppabs="http://members.xoom.com/tsehp_/wdasmcr.htm" >wdasmcr.htm</a>: Lazy Crack's
<i>Some useful points in
using Wdasm89 as a debugger (Cracking Borland's
Sidekick 98)</i>
<font color=red>Intermediate software reversing</font>
~
 <a href="bypaswin.htm" tppabs="http://members.xoom.com/tsehp_/bypaswin.htm" >bypaswin.htm</a>: DeeEmAye's
<i>Bypassing Windows registrations</i>
<a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Microsoft bashing</a>
<font color=red>Useful snippets</font> ~
<a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft bashing</a> revamped ~
<a href="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm" >info.htm</a>: my public
PGP 5 key added ~
~
<a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >Gary Benson</a>'s
<i>Unconventional Access: My
way into the Advanced Steganography pages</i>
<font color=red>Advanced Steganography</fonT>
~ <a href="int_acc.htm" tppabs="http://members.xoom.com/tsehp_/int_acc.htm" >int_acc.htm</a>: MML's
<i>Reversing Governmental Polices: Internet access for
the masses</i>
(<a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">Anonymity Academy</a>) <font
color=red>Advanced anonimity</fonT> ~

<a href="staltec1.htm" tppabs="http://members.xoom.com/tsehp_/staltec1.htm" >staltec1.htm</a>: reverser's
<i>Simple email stalking techniques</i>
(<a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">Anonymity Academy</a>) <font
color=red>Enemy stalking</fonT>
~ there's now also an experimental <a
href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" >message board</a> for all 
people hanging around at reverser's
~ <a href="couninte.htm" tppabs="http://members.xoom.com/tsehp_/couninte.htm" >couninte.htm</a>: Crackers'
Counter intelligence: <i>An
interesting emailexchange between Brandon Van Every and
Russ Williams: <i>The Economics of Piracy</i>
~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Advanced javascript</a>:
+mISu's <i>A real solution
using backtracking</i> <font color=red>Advanced
javascript</fonT>
</td></tr>



<tr><td><center>16 September 1998<br><font
size=+1><b>Contents:</b></fonT><br>Should we crack or
reverse? ~
Advanced reality cracking ~ softice dump, version 4 ~
Sects and altruism cracking ~ Zip
and Rar reversing ~ "target unrelated" cracking
</center></td>
<td><center>
<a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm" >septem.htm</a>: contributions to
my September discussion ~
 <a href="reacraus.htm" tppabs="http://members.xoom.com/tsehp_/reacraus.htm" >reacraus.htm</a>:  <i>Getting
deeper into
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality
cracking</a></i>: (&lt;predator&gt;'s fascinating
rantings on an essay by Curious George) <font
color=red>Advanced reality
cracking</font> ~ <a
href="icedump4.htm" tppabs="http://members.xoom.com/tsehp_/icedump4.htm" >icedump4.htm</a>: release 4 of
TheOwl's
winice dumper, one of our <a
href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >tools</a>. <font color=red>Advanced
software reversing</font> ~

 <a href="joarea1.htm" tppabs="http://members.xoom.com/tsehp_/joarea1.htm" >joarea1.htm</a>: Joa's
<i>Sect cracking, a first attempt</i>
<font color=red>Reality cracking</font> ~ 

<a
href="altruis1.htm" tppabs="http://members.xoom.com/tsehp_/altruis1.htm" >altruis1.htm</a>:
Deep dt's <i>Altruism and charity, a reversing
attempt</i> <font color=red>Reality cracking</font> ~

<a href="crunchi6.htm" tppabs="http://members.xoom.com/tsehp_/crunchi6.htm" >crunchi6.htm</a>: Joa's
<i>Little essay about the various methods and
viewpoints of crunching.
Part VI: The secret of Zip and Rar (LZW explained)</i>
<font color=red>Software reversing Papers</font>
~ <a href="symbo_1.htm" tppabs="http://members.xoom.com/tsehp_/symbo_1.htm" >symbo_1.htm</a>: sYmbol's
<i>KeyLBE32.DLL, why would you use this to protect your
program?</i>
<font color=red>"Target unrelated" cracking</font> ~
 <a href="patch_1.htm" tppabs="http://members.xoom.com/tsehp_/patch_1.htm" >patch_1.htm</a>: Daniel's <i>A
Free Win32 Patching Utility</i>, <a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >Our
tools</a>;
<font color=red>"Target unrelated" cracking</font> ~

 <a href="cyberme.htm" tppabs="http://members.xoom.com/tsehp_/cyberme.htm" >cyberme.htm</a>: Sanity's
<i>Cracking an uninstaller</i>, [Filemonitor &
Deadlisting]
<a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm" >Most stupid protections</a>;
<font color=red>"Target unrelated" cracking</font> ~


 <a href="asc0.htm" tppabs="http://members.xoom.com/tsehp_/asc0.htm" >asc0.htm</a>: Asc0's <i>A crackme
based on Aesculapius' algos</i>,
<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a>;
<font color=red>"Target unrelated" cracking</font> ~

</td></tr>




<tr><td><center>08 September 1998<br><font
size=+1><b>Contents:</b></fonT><br>Reopening after a
long while: my site will change ~ windows 98 fooled ~
Hooking operating systems ~
A very stupid commercial protection ~ reality cracking
~ advanced site busting ~ Linux advanced cracking
</center></td>
<td><a href="septem.htm" tppabs="http://members.xoom.com/tsehp_/septem.htm" >septem.htm</a>: I now consider
"silly" protection cracking useless, therefore
the part of my site that deals with software protection
will change radically ~
<a href="ideale5.htm" tppabs="http://members.xoom.com/tsehp_/ideale5.htm" >ideale5.htm</a>:  server exploits
you can really use
<font color=red>Advanced site busting</font> ~ <a
href="win98tut.htm" tppabs="http://members.xoom.com/tsehp_/win98tut.htm" >win98tut.htm</a>:
Bypassing Win98 FULL Version's serial check "without
cracking", by IH8U (<a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft
bashing</a>)
<font color=red>Intermediate</font> ~
<a href="pna3.htm" tppabs="http://members.xoom.com/tsehp_/pna3.htm" >pna3.htm</a>: PNA's <i>How to hook
 any API function in kernel32.dll</i> <font
color=red>Advanced paper</font> ~

<a href="mre2.htm" tppabs="http://members.xoom.com/tsehp_/mre2.htm" >mre2.htm</a>: <i>About keyfiles,
generators and protections</i>
<font color=red>Beginners</font> ~ <a
href="shampa1.htm" tppabs="http://members.xoom.com/tsehp_/shampa1.htm" >shampa1.htm</a>: Makoli's <i>
Reversing Shampoo</i>, a short <a
href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality cracking</a> essay. ~
<a href="compro2.htm" tppabs="http://members.xoom.com/tsehp_/compro2.htm" >compro2.htm</a>: LSD's: <i>An
incredibly stupid "commercial" Protection</i>
<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm" >Programmer's corner</a> <font
color=red>Intermediate</font> ~
<a href="siulflex.htm" tppabs="http://members.xoom.com/tsehp_/siulflex.htm" >siulflex.htm</a>: SiuL+Hacky's
<i>Linux advanced cracking: flexlm</i>
<font color=red>Advanced</font> ~ <a
href="wdasmcr.htm" tppabs="http://members.xoom.com/tsehp_/wdasmcr.htm" >wdasmcr.htm</a>:
</td></tr>




<tr><td><center>31 July 1998<br><font
size=+1><b>Contents:</b></fonT><br>Preparing
for holydays  ~ stalking on the web ~ search engines'
vagaries ~ reversing information
~ ready made protections are weak  ~ some good ideas
for protectors
</center></td>
<td>
On friday 31 July I'll publish the LAST UPDATE until
september: I'm <a href="august.htm" tppabs="http://members.xoom.com/tsehp_/august.htm" >leaving
the web</a> for a whole month. +gthorne
(gthorne(at)cyberspace(point)com) has
the "keys" to this site if anything <b>REALLY
URGENT</b> needs to be updated/modified!

<hr width=33%>

<a href="enemy.htm" tppabs="http://members.xoom.com/tsehp_/enemy.htm" >enemy.htm</a>: a new introduction
about stalking people on the web  <font
color=red>Intermediate enemy tracking</font> ~
<a href="searmyst.htm" tppabs="http://members.xoom.com/tsehp_/searmyst.htm" >searmyst.htm</a>: reverser's
<i>search engines' vagaries (reversing SE's bots)</i>
 <font color=red>Intermediate</font> ~ <a
href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> revamped ~ <a
href="reveinfo.htm" tppabs="http://members.xoom.com/tsehp_/reveinfo.htm" >reveinfo.htm</a>:
reversing information, some examples from 'The
Economist' (as part of
the <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>
section). ~ <a href="dllshow1.htm" tppabs="http://members.xoom.com/tsehp_/dllshow1.htm" >dllshow1.htm</a>:
A+heist's <i>reversing
dllshow</i>, a very simple <a
href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippet</a> for beginners <font
color=red>Beginners</font> ~
<a href="xoano_27.htm" tppabs="http://members.xoom.com/tsehp_/xoano_27.htm" >xoano_27.htm</a>: +Xoanon's
<i>Another readymade sotware protection (Intellisecure
R2) dies</i>
  <font color=red>Intermediate</font> ~ <a
href="monitor.htm" tppabs="http://members.xoom.com/tsehp_/monitor.htm" >monitor.htm</a>: MisterE's Keyfiles:
Monitor/RA v1.80 and
the 'hidden protection' idea  <font
color=red>Beginners</font>  ~ <a
href="rcnewht.htm" tppabs="http://members.xoom.com/tsehp_/rcnewht.htm" >rcnewht.htm</a>: Cracking an
encrypted dll scheme: Virtual Turntables 1.5 (from the
<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm" >programmer's corner</a> section)

 <font color=red>Intermediate</font> ~

<a href="lanpat.htm" tppabs="http://members.xoom.com/tsehp_/lanpat.htm" >lanpat.htm</a>: Stalking people on
the web: reversing language patterns 
 <font color=red>Advanced enemy tracking</font>
</td></tr>


<tr><td><center>25 July 1998<br><font
size=+1><b>Contents:</b></fonT><br>Reversing stress ~
no nag screens please ~
A strategic great
game that
you probably already have ~ back to MKS toolkit ~
commercial protections are no-no-no
articles ~ nasty protections: are they useful?
</center></td>
<td><center>
<a href="paulwils.htm" tppabs="http://members.xoom.com/tsehp_/paulwils.htm" >paulwils.htm</a>: Wilson's
<i>REVERSING STRESS ("modern Zen" </i><a
href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality
cracking</a><i> methods)</i> ~
<a href="bbnag1.htm" tppabs="http://members.xoom.com/tsehp_/bbnag1.htm" >bbnag1.htm</a>: bb's <i>Simulating
User Input to Eliminate Nag Screens</i> 
(an +HCU <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >paper</a>) <font
color=red>Intermediate</font> ~
<a href="rezget_1.htm" tppabs="http://members.xoom.com/tsehp_/rezget_1.htm" >rezget_1.htm</a>: +ReZiDeNt:
<i>Reverse Engineering Gettysburg: Demos
can be more than they seem</i>  <font
color=red>Intermediate</font> ~
<a href="bbdrlan2.htm" tppabs="http://members.xoom.com/tsehp_/bbdrlan2.htm" >bbdrlan2.htm</a>: bb's <i>MKS
toolkit
revisited</i>  <font color=red>Intermediate</font> ~ <a
href="neto_01.htm" tppabs="http://members.xoom.com/tsehp_/neto_01.htm" >neto_01.htm</a>: Miguel Neto's
<i>How to crack another commercial "ready made"
protection (<a href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm" >timelock</A>
style)</i> <font color=red>Intermediate</font> ~
<a href="sealight.htm" tppabs="http://members.xoom.com/tsehp_/sealight.htm">sealight.htm</a> and <a
href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">searengi.htm</a> revamped ~
<a href="neto3.htm" tppabs="http://members.xoom.com/tsehp_/neto3.htm" >neto3.htm</a>: Miguel Neto's
<i>HTMLPad: A nasty protection  <font
color=red>Intermediate</font>

</td></tr>

<tr><td><center>20 July 1998<br><font
size=+1><b>Contents:</b></fonT><br>kill those popup
banners! ~
 ultraedit revisited ~ Linux/X reverse engineering ~
Micro$oft's machinations exposed
</center></td>
<td><center>
<a href="text/gtbankil.txt" tppabs="http://members.xoom.com/tsehp_/text/gtbankil.txt" >gtbankil.txt</a>: <font
color=red>+</font>gthorne's <i>javascript banner
killer</i>
<font color=red>Advanced</font>
~
<a href="uedilas.htm" tppabs="http://members.xoom.com/tsehp_/uedilas.htm" >uedilas.htm</a>: Miguel Neto's
<i>UltraEdit 5.1 ~ A time trial crack</i>
~
<a href="rezilin.htm" tppabs="http://members.xoom.com/tsehp_/rezilin.htm" >rezilin.htm</a>: +ReZiDeNt's
<i>Reverse Engineering a Linux/X Target</i>
~
<a href="entran.htm" tppabs="http://members.xoom.com/tsehp_/entran.htm">entran.htm</a>: reverser's entrance
page, and
<a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >index.htm</a>: reverser's front page
revamped ~
<a href="shellex.htm" tppabs="http://members.xoom.com/tsehp_/shellex.htm" >shellex.htm</a>: Mr. Shellex's
<i>ShellExecute and Your Default Browser</i>,
<a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft's bashing</a>
</td></tr>


<tr><td><center>15 July 1998<br><font
size=+1><b>Contents:</b></fonT><br>Publisher '97 and
'98 ~ more about
passwords ~ reality cracking ~ faul protections
</center></td>
<td><center>
<a href="salinas.htm" tppabs="http://members.xoom.com/tsehp_/salinas.htm" >salinas.htm</a>: Salinas'
<i>Micro$oft
Publisher 97: Crack it and Drop it!</i> <a
href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft's bashing</a> <font
color=red>beginners</font> ~
<a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">ideale.htm</a>: password
introduction revamped ~ <a
href="prophe2.htm" tppabs="http://members.xoom.com/tsehp_/prophe2.htm" >prophe2.htm</a>:
Prophecy: <I>Dirtbike: a cute protection scheme</I>
<font color=red>Intermediate</font>
~
<a href="withles1.htm" tppabs="http://members.xoom.com/tsehp_/withles1.htm" >withles1.htm</a>: Hedwig
Blastock's <i>Anti-consumistic frugality tricks</i>
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality Cracking tricks</a> ~
<a href="billboar.htm" tppabs="http://members.xoom.com/tsehp_/billboar.htm" >billboar.htm</a>: The Media
Foundation's <i>Adding the Blemish of Truth : How to
Alter a Billboard</i>
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality Cracking tools</a> ~ <a
href="snooty2.htm" tppabs="http://members.xoom.com/tsehp_/snooty2.htm" >snooty2.htm</a>: Snootys
<i>Unprotecting unprotectors ; or how AccessData failed
itself by
relying on StopCopy</i> <a
href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm" >Programmer's corner</a> <font
color=red>Intermediate</font>
</td></tr>


<tr><td><center>10 July 1998<br><font
size=+1><b>Contents:</b></fonT><br>HTML cracking ~
Linux
disassembling ~ Opera reversing ~ Crunching along ~
keygenerators ~ anti-advertising

</center></td>
<tD>
<a href="iebug2.htm" tppabs="http://members.xoom.com/tsehp_/iebug2.htm" >iebug2.htm</a>: Cryptopoulos'
<i>How to bypass Micro$oft Internet
Explorer security</i> <font color=red>html
cracking</font> ~ <a
href="siullin2.htm" tppabs="http://members.xoom.com/tsehp_/siullin2.htm" >siullin2.htm</a>: SiuL+Hacky's
<i>Ltrace. The Tool (Linux disassembling)</i> <font
color=red>Advanced</font> ~
<a href="help.htm" tppabs="http://members.xoom.com/tsehp_/help.htm">help.htm</a> revamped ~ <a
href="ozyma1.htm" tppabs="http://members.xoom.com/tsehp_/ozyma1.htm" >ozyma1.htm</a>: Ozymandias' <i><a
href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >Our tools</a>:
Opera 3.21 crack</i> <font color=red>beginners</font> 
~
<a href="newbies.htm" tppabs="http://members.xoom.com/tsehp_/newbies.htm">newbies.htm</a> revamped ~ <a
href="crunchi5.htm" tppabs="http://members.xoom.com/tsehp_/crunchi5.htm" >crunch5.htm</a>: Joa's <i>Little
essay about the various methods
and viewpoints of crunching</i> (5 - Interlude and the
Mystery of Lempel-Ziv Part I)
<font color=red>Intermediate</font> ~ <a
href="malamirc.htm" tppabs="http://members.xoom.com/tsehp_/malamirc.htm" >malamirc.htm</a>: +Malattia's
<i>mIRC 5.*  a key generator explained</i> <font
color=red>Intermediate</font> ~
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>: <a
href="conself2.htm" tppabs="http://members.xoom.com/tsehp_/conself2.htm" >conself2.htm</a>:
+Insiderbetraying's <i>Consumer self-defense: an
anti-advertisement tutorial</i>
<font color=red>Intermediate</font>
</td></tr>


<tr><td><center>29 June 1998<br><font
size=+1><b>Contents:</b></fonT><br>Commercial
stupidity one and two ~ search engines (and
inferences!) ~ Coprocessor's protection schemes
~ reversing
magazines</center></td>
<td><center>
<a href="xava_27.htm" tppabs="http://members.xoom.com/tsehp_/xava_27.htm" >xava_27.htm</a>, by XaVaX:
<i>PhotoShop 5.0 / Digimarc 1.6.82, Commercial
<a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm" >stupidity</a> is alive &
well</i> <font color=red>Codesilly example</font> ~
<a href="cynapp1.htm" tppabs="http://members.xoom.com/tsehp_/cynapp1.htm" >cynapp1.htm</a>: by cYnAppZ:
<i>Most <a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm" >stupid</a> protections
award:
copy your own working serial number from the *.cfg
file</i> <font color=red>Codesilly example</font>
 ~ <a href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">searengi.htm</a> revamped ~
<a href="wyatt_vb.htm" tppabs="http://members.xoom.com/tsehp_/wyatt_vb.htm" >wyatt_vb.htm</a>: Wyatt's
<i>Visual <a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm" >basic</a> cracking:
Wave Events v2.0</i> <font color=red>Intermediate
software reverser</font> ~
<a href="mammo_29.htm" tppabs="http://members.xoom.com/tsehp_/mammo_29.htm" >mammo_29.htm</a>: +Mammon_'s
<i>Page Faults</i> (<i>reversing
magazines</I>) a <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality
cracking</a> essay! <font color=red>Intermediate
reality cracker</font>

</td></tr>



<tr><td><center>18 June 1998<br><font
size=+1><b>Contents:</b></fonT><br>Crunching food for
your teeth
~
It's a long long way to get rid of M$IE ~ all the
agoras of the world</center></td>
<td><center>
<a href="crunchi3.htm" tppabs="http://members.xoom.com/tsehp_/crunchi3.htm" >crunch3.htm</a>: Joa's <i>Little
essay about the various methods
and viewpoints of crunching</i> (3 - Adapting to the
sources (Huffman revisited)
<font color=red>Intermediate</font> ~

<a href="uninstms.htm" tppabs="http://members.xoom.com/tsehp_/uninstms.htm" >uninstms.htm</A>: reverser's
<i>It's a long long way to get rid of M$IE</i>
(as part of the <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft
bashing</A> series) <font color=red>Intermediate</font>
~ <a href="crunchi4.htm" tppabs="http://members.xoom.com/tsehp_/crunchi4.htm" >crunch4.htm</a>: Joa's
<i>Little essay about the various methods
and viewpoints of crunching</i> (4 - Leaving Huffman
and entering the realms of R'lyeh
<font color=red>Intermediate</font> ~ <a
href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >howtosea.htm</a> revamped ~
<a href="boyd1.htm" tppabs="http://members.xoom.com/tsehp_/boyd1.htm" >boyd1.htm</a>: G.E.Boyd's list of
operational and defunct agora and mail
servers <font color=red>Advanced</font> ~ <a
href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >index.htm</a> revamped

</td></tr>

<tr><td><center>15 June 1998<br><font
size=+1><b>Contents:</b></fonT><br> D'you really know
what your software
is doing when you are asleep?
~
reality (food) cracking ~ how stupid is Nokia? ~
timelock revisited</center></td>
<td><center>
<a href="mmstory.htm" tppabs="http://members.xoom.com/tsehp_/mmstory.htm" >mmstory.htm</a>: reverser's
<i>What's behind the mm256.dat and mm2048.dat
files?</i> (as
part of the <a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Micro$oft
bashing</A> series) <font color=red>Intermediate</font>
~ <a href="danadd1.htm" tppabs="http://members.xoom.com/tsehp_/danadd1.htm" >danadd1.htm</a>:
Maxine's <i>Dangerous food additives (reversing
labels)</i> (part of the <a href=
"realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality
cracking</a> section) ~ <a
href="frogpr3.htm" tppabs="http://members.xoom.com/tsehp_/frogpr3.htm" >frogpr3.htm</a>: Frog's Print's
<i>The Simlock
saga</i> (<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippet</a> from
 a real 1998 +HCU seminar) <font
color=red>Intermediate</font> ~ <a
href="xoa_126.htm" tppabs="http://members.xoom.com/tsehp_/xoa_126.htm" >xoa_126.htm</a>:
Xoanon's <i>PreviewParadise R.I.P. (vboxed programs...
bye bye!)</i> (part of the
<a href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm" >timelock</a> project)
<font color=red>Intermediate</font> ~ <a
href="hutsting.htm" tppabs="http://members.xoom.com/tsehp_/hutsting.htm" >hutsting.htm</a>: SLH's <i>Applying
the
sting</i>(Last part of a great tutorial into windows
"tight" coding)
<a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >paper</a>
</td></tr>




<tr><td><center>10 June 1998<br><font
size=+1><b>Contents:</b></fonT><br> Crunching papers
first part
~  Windows for assembly buff, part six ~
reality (subliminal) cracking</center></td>
<td><center>
<a href="crunchi2.htm" tppabs="http://members.xoom.com/tsehp_/crunchi2.htm" >crunchi2.htm</a>: Joa's
<i>Little essay about the various methods
and viewpoints of crunching</i> (2 - Probability and
Crunching)
<font color=red>Intermediate</font> ~ <a
href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm">awards.htm</a> revamped ~
<a href="sublimi.htm" tppabs="http://members.xoom.com/tsehp_/sublimi.htm" >sublimi.htm</a>:  Dr. Lechnar's
<i>Subliminal Advertising: What's
hidden in the Microsoft's logo</i>, from the <a
href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> section!
~ <a href="hutchif1.htm" tppabs="http://members.xoom.com/tsehp_/hutchif1.htm" >hutchif1.htm</a>: SLH's <i>The
iron fist</i>(Keeping The Crackers Amused)
<a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >paper</a>
</td></tr>


<tr><td><center>06 June 1998<br><font
size=+1><b>Contents:</b></fonT><br> Crunching papers,
an introduction
~ keygen or not keygen? ~ Windows graphics from an
assembly viewpoint ~
reality (bodily) cracking</center></td>
<td><center><a href="crunchi1.htm" tppabs="http://members.xoom.com/tsehp_/crunchi1.htm" >crunchi1.htm</a>:
Joa's <i>Little essay about the
various methods and viewpoints of crunching</i> (1-
Introduction) 
<font color=red>Intermediate</font> ~
<a href="misu1.htm" tppabs="http://members.xoom.com/tsehp_/misu1.htm" >misu1.htm</a>: +mISu's <i>The
PicaView32 KeyGenerator (keygenerators in C++)</i>
<font color=red>Intermediate</font> ~
<a href="hutch_65.htm" tppabs="http://members.xoom.com/tsehp_/hutch_65.htm" >hutch_65.htm</a>: SLH's <i>The
Eye Of The Warrior</i> (a
"graphical" windows' <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >paper</a>) ~
<a href="rebodila.htm" tppabs="http://members.xoom.com/tsehp_/rebodila.htm" >rebodila.htm</a>:
+Azzeccagarbugli's <i>An attempt at reversing body
language</i>; from
the great <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>
section!
 </td></tr>

<tr><td><center>01 June 1998<br><font
size=+1><b>Contents:</b></fonT><br> Crackers that debug
and repare their own targets ~ stubborn
webmasters ~ digging to light disappeared +ORC's
lessons ~ CD-rom protections</center></td>
<td><center><a href="q_tv0601.htm" tppabs="http://members.xoom.com/tsehp_/q_tv0601.htm" >q_tv0601.htm</a> Q's
"<i>Fixing" AIMS-Lab's VH-TV Program</i>" <font
color=red>Intermediate</font> ~
<a href="kent_com.htm" tppabs="http://members.xoom.com/tsehp_/kent_com.htm" >kent_com.htm</a>:
"<i>How commercial trends are transforming the web from
a great provider of CONTENT
into a nightmare of utterly useless banner
clicking</i>" a small
real life lesson, by reverser+ ~ An old 1996
"disappeared" lesson by +ORC found
on the Web, read the whole story (and the lesson) on
<a
href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >greythorne</a>'s
site!
<font color=red>historically relevant!</font> ~ <a
href="q_tsr601.htm" tppabs="http://members.xoom.com/tsehp_/q_tsr601.htm" >q_tsr601.htm</a>:
Q's <i>A different approach cracking a DOS
CD-protection</i> <font color=red>Intermediate</font> ~
 </td></tr>



<tr><td>29 May 1998<br>Bie bie dongles, how to code
effectively in windoze and how
empty we all are</td>
<td><center>
<a href="bayu3.htm" tppabs="http://members.xoom.com/tsehp_/bayu3.htm" >bayu3.htm</a> "<i>Undocumented HASP
3 (no more
security through obscurity)</i>"
<font color=red>Advanced</font> ~ <a
href="history.htm" tppabs="http://members.xoom.com/tsehp_/history.htm" >history</a>: History of my site
revamped 
~ <a href="hutch28.htm" tppabs="http://members.xoom.com/tsehp_/hutch28.htm" >hutch28.htm</a>: SLH's fourth
paper! "<i>Software warriors
through the warp</i>" (+HCU <a
href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >papers</a>) ~ <a
href="reality1.htm" tppabs="http://members.xoom.com/tsehp_/reality1.htm" >reality1.htm</a>:
IcE's "<i>Reversing Reality, a first stab</i>", a <a
href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> small
essay
 </td></tr>


<tr><td>25 May 1998<br>How to search... more antismut
cracking... </td>
<td><center>
 <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >how to search</a> A
new (tenth)
<a href="sear0698.htm" tppabs="http://members.xoom.com/tsehp_/sear0698.htm" >lesson</a> by your +truly!
(light version) ~ <a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">ideale.htm</a>:
Crackers against
commercial smut section:
<a href="smutemai.htm" tppabs="http://members.xoom.com/tsehp_/smutemai.htm" >smutemai.htm</a> <i>A polite
conversation between a commercial smutsites
nuker and a commercial smutsite owner</i> ~ <a
href="sealight.htm" tppabs="http://members.xoom.com/tsehp_/sealight.htm">sealight.htm</a> The quick
search engines page ~ <a
href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">searengi.htm</a> revamped
search engines page ~ <a
href="winasm_1.htm" tppabs="http://members.xoom.com/tsehp_/winasm_1.htm" >winasm_1.htm</a>: Masta's <i>The
resurrection of
assembly programming - Essay nr. 1</i>
<font color=red>Intermediate</font>  ~ <a
href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a>: revamped links page
~ <a href="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm" >botstart.htm</a>: Reverser's
<i>bot trapping and agent reversing page</i>, add ons
</td></tr>



<tr><td>21 May 1998<br>How to search... a nice paper...
a taste of Hawaii... </td>
<td><center>
<a href="rude45.htm" tppabs="http://members.xoom.com/tsehp_/rude45.htm" >rude45.htm</a>: The RudeBoy's
<i>Reversing Packed Targets, an
exercise in reversing for reversing's sake</i> <font
color=red>Intermediate</font> ~ <a
href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</a>:
advanced
javascript page: reverser's <i>A sticky nice little
trick</i>  
<font color=red>Intermediate</font>
~ <a href="tek1.htm" tppabs="http://members.xoom.com/tsehp_/tek1.htm" >tek1.htm</a> Tek's <i>Palmpilot
reversing: Experience a brand new taste in cracking</i> 
<font color=red>Intermediate</font> ~ : Saruman's great
<i>The Penetration of CyberSitter'97</i> (deserved
death of a pathetical censorware)
<font color=red>Intermediate</font> ~ <a
href="hutquest.htm" tppabs="http://members.xoom.com/tsehp_/hutquest.htm" >hutquest.htm</a>
SLH's <i>THE QUEST:
Building the launch pad</i> (+HCU <a
href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >papers</a>) ~ Goth's
<a href="sales1.htm" tppabs="http://members.xoom.com/tsehp_/sales1.htm" >sales1.htm</a>: <i>SalesAgent
3.0: Rsagnt32.dll, TurnKey and Me</i> <font
color=red>Useful for programmers!</font>
</td></tr>


<tr><td>16 May 1998<br>A new "bot" section, various
essays (and the last BEGINNERS essay)... </td>
<td><center>
<a href="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm" >botstart.htm</a>: Reverser's
<i>BOT TRAPPING AND BOT WARS</i>,
a first attempt to trap web robots in order to reverse
them...
THE FIRST FOUR ESSAYS: <font color=red>Must read
section for all web warriors</font> ~ <a
href="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm" >student.htm</a>:
has been DISCONTINUED, and will not be updated in the
near future, redirect to
<a href="aca300.htm" tppabs="http://members.xoom.com/tsehp_/aca300.htm" >aca300.htm</a> <font
color=red>important</font> ~
<a href="prophe_1.htm" tppabs="http://members.xoom.com/tsehp_/prophe_1.htm" >prophe_1.htm</a>:
Prophecy's <i>BEGINNERS: An introduction to code
generation routines:
reversing Teleport Pro v1.29</i> <font color=red>the
LAST beginners' essay on my site</font>
 ~ <a href="hutch_61.htm" tppabs="http://members.xoom.com/tsehp_/hutch_61.htm" >hutch_61.htm</a>: SLH's
<i>The Bridge: In Pursuit Of Lost Knowledge</i>
The programmer... has no option but to go lower level
<font color=red>Must read</font>
</td></tr>



<tr><td>11 May 1998<br>
Two advanced essays! (and my daughter's fifth birthday
:-)
</td>

<td><center><a href="crlvent7.htm" tppabs="http://members.xoom.com/tsehp_/crlvent7.htm" >crlvent7.htm</a>:
JaZZ's
<i>Corel Ventura 7 trial: Crack it the hard way</i>
<font color=red>Advanced</font> ~ <a
href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >HCU papers</a>:
<a href="iceext1.htm" tppabs="http://members.xoom.com/tsehp_/iceext1.htm" >iceext1.htm</a>: Iceman's
"Extending
Softice serie" ("Zauberreversing"): <i>Extending
NuMega's SoftIce for Windows 95 using Protected Mode
                                   Debugger services
API </i> <font color=red>Advanced</font>
</td></tr>

<tr><td>8 May 1998<br>A new subsection, nice and
important essays... And our new Visual Assembler!</td>
<td><center>
<a href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">searengi.htm</a>: updated ~&nbsp; Reality cracking
"news": +Atheist has started
a new (interesting) subsection of my page...
contributions are welcomed  ~
<a href="rudebo21.htm" tppabs="http://members.xoom.com/tsehp_/rudebo21.htm" >rudebo21.htm</a>:
Rudeboy's <i>Four "atomic" cracking approaches</i>! 
<font color=red>Intermediate</font> ~
<a href="ether1.htm" tppabs="http://members.xoom.com/tsehp_/ether1.htm" >ether1.htm</a>: Ether's
<i>BEGINNERS, the PSP protection again</i> <font
color=red>Beginners</font> ~
<a href="marycri1.htm" tppabs="http://members.xoom.com/tsehp_/marycri1.htm" >marycri1.htm</a>: Marigold's
<i>Instant removing of CrypKey (together with a lock)
Unwrapping the wrapped</i> <font
color=red>Intermediate/advanced</font> ~
<a href="winasm_0.htm" tppabs="http://members.xoom.com/tsehp_/winasm_0.htm" >winasm_0.htm</a>: Masta's <i>The
resurrection of
assembly programming - Essay nr. 0</i>
<font color=red>Intermediate</font> ~
<a href="hutch1.htm" tppabs="http://members.xoom.com/tsehp_/hutch1.htm" >hutch1.htm</a>: SLH's <i>Future
Vision: The supression and resurrection of assembler
programming</i> Recent programming history
cracking for crackers!
<font color=red>Must read</font>
<hr width=33%><center>The +HCU is hiring c and asm
coders for our
new "<a
href="http://www.eccentrica.org/Mammon/visasm.html" >Vis
ual assembler</a>"
project, which is florishing thank to +Mammon
<u>and</u>
the mighty help of +ReZiDeNt!, have a look and
collaborate!<bR>
e-mail
+Mammon<br>(Mammon_(at)hotmail(point)com)</center>
</td></tr>



<tr><td>5 May 1998<br>Advanced and intermediate
readings! The 1999 strainer!</td>
<td><center><a href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/THCU99.htm" >THCU99.htm</a>: Master
<font color=red>+</font>Aesculapius' strainer,
a beautiful set of challenges for intermediate and
advanced crackers and protectors! 
<hr width=33%>
<a href="rezide7z.htm" tppabs="http://members.xoom.com/tsehp_/rezide7z.htm" >rezide7z.htm</a>: +Rezident's
<i>Reverse Engineering a Compressed Target (Phase
I)</i>
<font color=red>Intermediate</font> ~

<a href="marigbox.htm" tppabs="http://members.xoom.com/tsehp_/marigbox.htm" >marigbox.htm</a>: Marigold's
<i>Opening a Vbox full of worms:
PreviewParadise lost</i>
<font color=red>Advanced</font> ~
<a href="ind_tra1.htm" tppabs="http://members.xoom.com/tsehp_/ind_tra1.htm" >ind_tra1.htm</a>:
+Indian_Trail's <i>BEGINNERS:
Pluckit 3.0 Hip Hip Hurray for Smartcheck</i> (how to
fish a serial number from
any Visual Basic program)
<font color=red>Beginners</font> ~
<a href="casmw652.htm" tppabs="http://members.xoom.com/tsehp_/casmw652.htm" >casmw652.htm</a>: Shaman's
<i>How to crack an hardcore dongle-protected
program</i> <font color=red>Advanced</font> ~
<a href="littlejo1.htm" tppabs="http://members.xoom.com/tsehp_/littlejo1.htm" >littlejo1.htm</a>: Little
John's <i>Visual Basic Unprotection
(Programmers: don't protect with visual basic!)</i>
</td></tr>


<tr><td>3 May 1998<br>more essays, more
additions/corrections</td>
<td><a href="rezel1.htm" tppabs="http://members.xoom.com/tsehp_/rezel1.htm" >rezel1.htm</a>: ReZeL's
BEGINNERS: <i>A correction/addition to RudeBoy's
essay</i>
<font color=red>Beginners</font> ~ <a
href="hs2l_22.htm" tppabs="http://members.xoom.com/tsehp_/hs2l_22.htm" >hs2l_22.htm</a>:
Hs2L's <i>Web Browser emulation (Letting web pages get
less info about you)</i>
<font color=red>Intermediate</font> ~
<a href="origin_1.htm" tppabs="http://members.xoom.com/tsehp_/origin_1.htm" >origin_1.htm</a>: MML's
<i>Cracking MicroCal Origin 5.0 in 3 Simple Ways</i>
 (a <a href="project6.htm" tppabs="http://members.xoom.com/tsehp_/project6.htm" >crippled targets</a>
project)
<font color=red>Intermediate</font> ~
<a href="dynam_1.htm" tppabs="http://members.xoom.com/tsehp_/dynam_1.htm" >dynam_1.htm</a>: +dynamite's
<i>BEGINNERS: Why should
we crack a program that DOES NOT CHANGE if you register
it?</i>
<font color=red>Beginners</font> ~
<a href="sandma1.htm" tppabs="http://members.xoom.com/tsehp_/sandma1.htm" >sandma1.htm</a> Sandman's <i>How
to crack ANY
program that uses the TL32V2.DLL!</i> (Numega's own <a
href="project2.htm" tppabs="http://members.xoom.com/tsehp_/project2.htm" >project 2</a> an addition to
Harwi's essay)
<font color=red>Intermediate</font><hr width=33%>
</td></tr>

<!-- block -->

<tr><td>27 Apr 1998<br>some essays</td>
<td><a href="new_archi.htm" tppabs="http://members.xoom.com/tsehp_/new_archi.htm" >new_archi.htm</a>: <i>The total reset 
protection scheme</i>, by Archimede, <font color=red>Intermediate</font> ~ 
 <a href="new_0101.htm" tppabs="http://members.xoom.com/tsehp_/new_0101.htm" >new_0101.htm</a>: <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >How to search</a>: <i>The phf exploit</i>, by +Thor 
<font color=red>Intermediate</font> ~  
<a href="new_anor.htm" tppabs="http://members.xoom.com/tsehp_/new_anor.htm" >new_anor.htm</a>: <i>a short essay about usign a new type of protections: design your own cpu</i>, 
by anormal/kindergarten <font color=red>advanced</font> ~ <a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools.htm</a>: 
<i>Bare Hex Opcodes And Mnemonics</i>, a zipped, hlp format 
<a href="http://acrigs.com/FRAVIA/zipped/opcodhlp.zip" tppabs="http://members.xoom.com/tsehp_/zipped/opcodhlp.zip" >opcodhlp.zip</a> file. ~ <a href="canterbu1.htm" tppabs="http://members.xoom.com/tsehp_/canterbu1.htm" >canterbu1.htm</a>: Masher's 
<i>Getright: the beast within</i> <font color=red>Intermediate</font> ~ VucoeT's <a href="vuctut01.htm" tppabs="http://members.xoom.com/tsehp_/vuctut01.htm" >vuctut01.htm</a>: 
<i>BEGINNERS: CheckPop 1.1 for Windoze95/98/NT4 by Nevis Systems</i> 
<font color=red>Beginners</font> ~ <a href="ne_khab1.htm" tppabs="http://members.xoom.com/tsehp_/ne_khab1.htm" >ne_khab1.htm</a>: <i>Menu 
disable and active by Register Number</i> <font color=red>Intermediate</font>
</td></tr>




<tr><td>23 Apr 1998<br>Advanced steganography, et alia</td>
<td>(reverser's re-opens after a long holyday freeze) ~ <a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >Advanced steganography</a>: Caprine's 
work: <i>A great dragon known as Steganos</i>  <font color=red>Intermediate</font>
 ~ <u><font color=blue>Buy</u></font> PC-PLUS May 1998 (UK review) with 
the complete Borland C++ 4,52 (and BRW!!)... Borland PC Builder, usw... for just 
6 Euro :-) 
<font color=red>Very Important</font> (for all reversers that still don't 
have a legitimate copy of BRW) ~ <a href="netscan3.htm" tppabs="http://members.xoom.com/tsehp_/netscan3.htm" >netscan3.htm</a> <i>What's new with <a href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm" >timelock</a>3.1 ?</i>, 
by JaZZ  <font color=red>Intermediate</font> ~ <a href="new_kha.htm" tppabs="http://members.xoom.com/tsehp_/new_kha.htm" >new_kha.htm</a> Kabhoet's <i>BEGINNERS: NJWin 1.6 
Checksum Cracking</I>  <font color=red>Beginners</font>
</td></tr>


<tr><td>3 Apr 1998<br>Good old reversing techniques</td>
<td><a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >Microsoft bashing</a>: TWD's 
<a href="twd_ms_.htm" tppabs="http://members.xoom.com/tsehp_/twd_ms_.htm" >twd_ms_.htm</a> <i>BEGINNERS: Visual Sourcesafe</i> <font color=red>Beginners</font> ~
 <font color=blue>Software protection 
history!</fonT>: <a href="123dos.htm" tppabs="http://members.xoom.com/tsehp_/123dos.htm" >123dos.htm</a>: Tomboy's <i>Reinitializing Lotus 
1-2-3 DOS, historical versions</i> <font color=red>Intermediate</font> ~ <a href="kk_cunei.htm" tppabs="http://members.xoom.com/tsehp_/kk_cunei.htm" >kk_cunei.htm</a>: 
F__kingcrazy's <I>How to perform some magic reversing with good old BRW</i> 
<font color=red>Intermediate</font> ~ <a href="capedcr.htm" tppabs="http://members.xoom.com/tsehp_/capedcr.htm" >capedcr.htm</a>: CapedCrusader's 
A complete, nake protection code: Cracking WinZip32 <font color=red>Intermediate</font> ~ <a href="aitor003.htm" tppabs="http://members.xoom.com/tsehp_/aitor003.htm" >aitor003.htm</a>: 
+Aitor's <i>Reverse Engineering MATLAB 5  -  Part III: Licenses</i> 
<font color=red>Intermediate</font> ~ <a href="entropy1.htm" tppabs="http://members.xoom.com/tsehp_/entropy1.htm" >entropy1.htm</a>: Entropy's 
<i>DartPro 32 Cracking, a  crippled 'save' with encryption mechanism</i> <font color=red>Intermediate</font>

</td></tr>



<tr><td>26 Mar 1998<br>Advanced steganography, advanced javascript</td>
<td><a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >Advanced steganography</a>: Edi's 
work: <i>I had to reverse engineer steganos again, on my own</i> 
<font color=red>Advanced</font> ~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Advanced Javascript</a>: Tom's: 
<i>A "ponderated" vocabulary approach to advanced javascript</i> <font color=red>Advanced</font> 
~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Devious Javascript</a>: Tom's: <i>bozo cracks java</i> 
 <font color=red>Advanced</font> ~  <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Devious Javascript</a>: MR's: 
<i>myown511.htm: the DECIDING sentence</i> 
 <font color=red>Intermediate</font> ~ <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm">awards.htm</a>: new awards
</td></tr>


<tr><td>20 Mar 1998<br>Steganography, menial work and reversing</td>
<td>Advanced steganography page: <i>Steganography Thumbprinting</i> 
<font color=red>Advanced</font> ~ <a href="help.htm" tppabs="http://members.xoom.com/tsehp_/help.htm">help.htm</a>: revamped 
~ <a href="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm" >info.htm</a>: revamped 
~ <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a>: Frog's Print winshow added 
~ <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >papers.htm</a>: Iceman's 
<a href="iceman1.htm" tppabs="http://members.xoom.com/tsehp_/iceman1.htm" >WIN32 - Inside Debug API</a> added ~ 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>: <i>Pranks as introduction to 
reality cracking</i>, 
by <a href="pranks1.htm" tppabs="http://members.xoom.com/tsehp_/pranks1.htm" >Rhiddler</a> 
 ~ <a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm" >Advanced cracking</a>: <i>In memory patching:
Three approaches</i>, by <a href="stone1.htm" tppabs="http://members.xoom.com/tsehp_/stone1.htm" >Stone</a> <font color=red>Advanced</font>
~ <a href="redla1.htm" tppabs="http://members.xoom.com/tsehp_/redla1.htm" >redla1.htm</a>: Red Lantern's <i>Cracking Rightime: 
Encryption and checksums in a small DOS utility</i> <font color=red>Intermediate</font>
</td></tr>

<tr><td>16 Mar 1998<br>Reality, Papers and BEGINNERS galore</td>
<td><a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>: 
Martine Joly's <a href="marlbo2.htm" tppabs="http://members.xoom.com/tsehp_/marlbo2.htm" >Rhetoric of advertisement</a> (a "Marlboro Classic" 
Advertisement analyzed) 
<font color=red>Expert</font> ~ <a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm" >papers.htm</a>: HCU 
<font color=red>PAPERS</fonT>: 
Iceman <a href="iceman.htm" tppabs="http://members.xoom.com/tsehp_/iceman.htm" >work</a>: <i>Tweaking with memory in Window95</i> ~  
<a href="rudeboy.htm" tppabs="http://members.xoom.com/tsehp_/rudeboy.htm" >rudeboy.htm</a>: <i>Thinking Like 
a Cracker</i>, a lesson 
for BEGINNERS ~ 
<a href="panthe.htm" tppabs="http://members.xoom.com/tsehp_/panthe.htm" >panthe.htm</a>: <i>BEGINNERS: Big tent, little circus</i> by The Nameless (<a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm" >Most stupid protection</a> award) 
~ <a href="siceinst.htm" tppabs="http://members.xoom.com/tsehp_/siceinst.htm" >siceinst.htm</a>: 
<i>The Ultimate Beginner - Session 1: SoftICE Install for Beginners</i>, by i_magnus 

</td></tr>


<tr><td>12 Mar 1998<br>Protection and Encryption</td>
<td><a href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/freepag.htm" >Bram van Dartel</a>'s List 
of free page providers, free CGI scripts and whatever ~ 

<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >protecti.htm</a>: Jack of Shadows's <i>A modified <font color=red>+</font>Aesculapius 
<a href="http://acrigs.com/FRAVIA/zipped/zelazny.zip" tppabs="http://members.xoom.com/tsehp_/zipped/zelazny.zip" >protection</a></i> <font color=red>Advanced</font> ~ <a href="it_winr2.htm" tppabs="http://members.xoom.com/tsehp_/it_winr2.htm" >+Indian_Trail</a>'s 
Winrar [95] the other path (Encryption Mechanism) <font color=red>Intermediate</font> ~ 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality cracking</a>: Maxine+'s <i>Consumer trends cracking</i> 
<a href="jungle1.htm" tppabs="http://members.xoom.com/tsehp_/jungle1.htm" >some tricks</a> ~ <a href="bayunn2.htm" tppabs="http://members.xoom.com/tsehp_/bayunn2.htm" > bajunny</a>: 
<I>Undocumented HASP - Part II</i>   <font color=red>Advanced</font>
</td></tr>


<tr><td>08 Mar 1998<br>Java and freepages</td>
<td><a href="javdevio.htm" tppabs="http://members.xoom.com/tsehp_/javdevio.htm" >Devious javascript page</a> <i>how to land in 
devious 
the easy way</i>, by Roady & <i>Two Paths To Success</i> by JimBob & <i>FravBecca</i> by Gabtis 
~ <a href="omar.htm" tppabs="http://members.xoom.com/tsehp_/omar.htm" >Omar's List</a> of Free Page Providers ~ <a href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/freepag.htm" >Bram van Dartel</a>'s List 
of free page providers, free CGI scripts and whatever ~ 
<a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Advanced javascript page</A>: <i>javascript password brutecracker</i> 
by Roady ~ <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm">awards.htm</A>: updated ~ <a href="dukeess.htm" tppabs="http://members.xoom.com/tsehp_/dukeess.htm" >dukeess.htm</a>: 
<i>Inside the VB3 .EXE</i> (tokens and other marvels) <font color=red>Intermediate</font>
</td></tr>


<tr><td>04 Mar 1998<br>Stego, cracking and the good old dos times</td>
<td><a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >Advanced Steganography</a> page: <i>Steganos, The Duke of Earl, and The Dancing Men</i> by 
Joe Peschel ~ <a href="madlas1.htm" tppabs="http://members.xoom.com/tsehp_/madlas1.htm" >madlas1.htm</a>: <i>Dongle Dejavu</i>, by MaD ~ <a href="zee_inst.htm" tppabs="http://members.xoom.com/tsehp_/zee_inst.htm" >zee_inst.htm</a>: 
Zeezee's <i>Decompiling InstallShield scripts and guidelines for decompiler writers</i> ~ <a href="madmasu.htm" tppabs="http://members.xoom.com/tsehp_/madmasu.htm" >madmasu.htm</a>: 
madmax! <i>Cracking using KERNEL32.DLL</i>  <font color=red>Advanced</font> ~ <a href="oldiegoo.htm" tppabs="http://members.xoom.com/tsehp_/oldiegoo.htm" >oldiegoo.htm</a>: 
FootSteps' <i>Oldies but Goodies</i> ~ <a href="entra.htm" tppabs="http://members.xoom.com/tsehp_/entra.htm" >entra.htm</a> revamped ~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript</a>: an 
easier <a href="myown511.htm" tppabs="http://members.xoom.com/tsehp_/myown511.htm" >entrance</A> to the 'devious' javascript page!
</td></tr>


<tr><td>01 Mar 1998<br>Advanced Javascript, searching and protecting</td><td>Advanced Javascript page: Ken's 
mighty tool for <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript</a> password reversing.
<font color=red>Advanced</font> ~ Javascript '<a href="javdevio.htm" tppabs="http://members.xoom.com/tsehp_/javdevio.htm" >devious</a>' page: 
Azazel's solution: <i>reaching the protected part</i> <font color=red>Advanced</font> ~ 
<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a>: Master <a href="aescures.htm" tppabs="http://members.xoom.com/tsehp_/aescures.htm" ><font color=red>+</font>Aesculapius</a>' response 
to Jack of Shadows <font color=red>Useful for protectors!</font> ~ <a href="surrsea1.htm" tppabs="http://members.xoom.com/tsehp_/surrsea1.htm" >Surreal5's</a> 
advanced searching: Two <a href="4surreal5.htm" tppabs="http://members.xoom.com/tsehp_/4surreal5.htm" >snippets</a>
<font color=red>Advanced</font> ~ <A HREF="siulinux.htm" tppabs="http://members.xoom.com/tsehp_/siulinux.htm" >siulinux.htm</A>: SiuL+Hacky's reversing 
Linux: the chances <font color=red>Advanced</font>
</td></tr>




<tr><td>28 Feb 1998<br>Allerlei</td><td>
<a href="javdevio.htm" tppabs="http://members.xoom.com/tsehp_/javdevio.htm" >Advanced 'devious' javascript page</a>: Jack of Shadows's "<i>Devious snippets: Collection of different approaches</i>"
<font color=red>Advanced</font> ~ Zeezee's InstallShield scripts (1 of 2)... <a href="http://acrigs.com/FRAVIA/zipped/iscompil.zip" tppabs="http://members.xoom.com/tsehp_/zipped/iscompil.zip" >compiler DLL</a> ~ 
<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippets.htm</a>: The_Gimp's <a href="gimp1.htm" tppabs="http://members.xoom.com/tsehp_/gimp1.htm" >MORE DOS4GW 
STUFF: CD ROM / 3DFX Cracking</a> ~ <a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a>: 
<a href="jackrev.htm" tppabs="http://members.xoom.com/tsehp_/jackrev.htm" >Jack of Shadows</a>'s "<i>Reversing <font color=red>+</font>Aesculapius: A complete explanation of a very good 
assembler protection</i>" <font color=red>Advanced/Expert</font> ~ <a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm" >advanced.htm</a>: The Owl: 
beta release 3 of the winice dumper <font color=red>Expert</font>
</center>
</td></tr>


<tr><td>26 Feb 1998<br>Expert cracking</td><td><a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >Our tools</a>: Natzgul's 
"<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/wisdec.zip">wisdec</a>" (Installshield decompiler) 
<font color=red>Expert</font> ~ <a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a>: Master <font color=red>+</font>Aesculapius' 
100% assembly '<a href="crack_me.htm" tppabs="http://members.xoom.com/tsehp_/crack_me.htm" >future generation</a>' protection 
<font color=red>Expert</font> ~ Hs2L's <a href="smartc_2.htm" tppabs="http://members.xoom.com/tsehp_/smartc_2.htm" >smartc_2.htm</A>: An example of VB Cracking 
using SmartCheck ~ <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> Some links updated and added ~ 
<a href="bayu_2.htm" tppabs="http://members.xoom.com/tsehp_/bayu_2.htm" >bayu_2.htm</a>: Undocumented HASP - part I, by -bajunny <font color=red>Expert</font>
</td></tr>


<tr><td>24 Feb 1998<br>Searching, the sublime art</td><td><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >How to search</a>: Surreal5's search tips (<a href="surrsea1.htm" tppabs="http://members.xoom.com/tsehp_/surrsea1.htm" >introduction 
and 
first lesson</a>) <font color=red>Advanced</font> 
~ <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >How to search</a>: Cassandra's fetcher and Cassandra's stalker 
<font color=red>Advanced</font> ~
<a href="surrsea2.htm" tppabs="http://members.xoom.com/tsehp_/surrsea2.htm" > Surreal5's search tips</a>: (second lesson) <font color=red>Advanced</font> 
~ <a href="surrsea3.htm" tppabs="http://members.xoom.com/tsehp_/surrsea3.htm" > Surreal5's search tips</a>: (third lesson) <font color=red>Advanced</font> 
~ Advanced Javascript page: Jack of Shadows'<i>Know Thy Language!</i> 
<font color=red>Advanced</font>
</td></tr>




<tr><td>21 Feb 1998<br>javascript, dongles and reality</td><td>
Advanced ("devious") javascript page: <i>How to land in devious</i> by Peter Papazov 
<font color=red>Advanced</font> ~ <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>: <i>Fond 
manager
 cracking</i>, by Curious George and Maxine+ ~ <A HREF="jackos_1.htm" tppabs="http://members.xoom.com/tsehp_/jackos_1.htm" >Jack of Shadows</a>: 
Dongles are NOT dead! (programmers: use them!) <font color=red>Useful for protectors!</font>
</td></tr>



<tr><td>19 Feb 1998<br>javascript galore!</td><td><a href="what_new.htm" tppabs="http://members.xoom.com/tsehp_/what_new.htm">what_new</a> introduced ~ 
Advanced Javascript page: <i>Thru the Java Door</i> by WeLuv <font color=red>Advanced</font> ~ 
+HCU trainers and contests: <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a>: gettysburg cracking: 
a complete version "scn" file! <font color=red>Intermediate</font> ~ Advanced Javascript page: <i>The 'easy' javascript 
entrance: A recursive approach</i>, by 
SPLiCE <font color=red>Advanced</font> ~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript entrance</a>: 
New advanced page (<a href="javdevio.htm" tppabs="http://members.xoom.com/tsehp_/javdevio.htm" >javdevio.htm</a>: targeted access) <font color=red>Advanced</font> ~ <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript 
entrance</a>: new stupid password protection for beginners (j_ridcul.htm) <font color=red>Beginners</font>
</td></tr>

<tr><td>17 Feb 1998<br>soft and real 
reversing!</td><td><a href="hal_oper.htm" tppabs="http://members.xoom.com/tsehp_/hal_oper.htm" >hal_oper.htm</a>: 
Use Opera! (Bye Bye Navigator ?) with an add-on by 
Lord Lucifer <font color=red>Beginners</font> ~ <a href="maddon_1.htm" tppabs="http://members.xoom.com/tsehp_/maddon_1.htm" >maddon_1.htm</a>: DONGLES: The weak brothership 
between hard- and software <font color=red>Intermediate</font> ~ <a href="natz_mp2.htm" tppabs="http://members.xoom.com/tsehp_/natz_mp2.htm" >natz_mp2.htm</a>: 
How to access the memory of a process (i.e. Game Trainer, Process Patcher etc.) 
<font color=red>Advanced</font> ~ <a href="ath_sta1.htm" tppabs="http://members.xoom.com/tsehp_/ath_sta1.htm" >ath_sta1.htm</a>: Statistical cracking: basics: cracking 
lotteries (<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> section)
</td></tr>


<tr><td>13 Feb 1998<br>soft and steg reversing!</td><td><font color=red>BLACK FRIDAY attack</fonT>: all pages on 
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://207.30.50.126/">Sharp's server</a> have been <a href="censors.htm" tppabs="http://members.xoom.com/tsehp_/censors.htm" >censored</a>, have a look for yourself</font> 
<font color=red>awful</font> ~ <a href="halva_3.htm" tppabs="http://members.xoom.com/tsehp_/halva_3.htm" >halva_3.htm</a>: SOFTWrapper: wrapping galore  
<font color=red>Intermediate</font> ~ <a href="dong_mad.htm" tppabs="http://members.xoom.com/tsehp_/dong_mad.htm" >dong_mad.htm</a>: Unplugging
a dongle protection <font color=red>Intermediate</font> ~ <a href="mrf_steg.htm" tppabs="http://members.xoom.com/tsehp_/mrf_steg.htm" >mrf_steg.htm</a>: How to reverse engineer Steganos (First
step) <font color=red>Intermediate</font>
</td></tr>

<tr><td>12 Feb 1998<br>soft and steg reversing!</td><td><a href="jonla_13.htm" tppabs="http://members.xoom.com/tsehp_/jonla_13.htm" >jonla_13.htm</a>: 
BEGINNERS: KeyGenerator for AddItem, by Jon ~ <a href="natz51.htm" tppabs="http://members.xoom.com/tsehp_/natz51.htm" >natz51.htm</a>: 
InstallSHIELD Script Cracking, A tutorial by NaTzGUL <font color=red>Advanced</font> ~ 
Advanced steganography page: "<i>an answer to Flynn</i>", by Caprine ~ <a href="spirit_1.htm" tppabs="http://members.xoom.com/tsehp_/spirit_1.htm" >spirit_1.htm</a>: 
RealPlayer Plus 4.0: the "dummy code check" trick, by sPIRIT and HellRaiser <font color=red>Intermediate</font>
</td></tr>

<tr><td>11 Feb 1998<br>real, soft and steg reversing!</td><td><a href="real_geo.htm" tppabs="http://members.xoom.com/tsehp_/real_geo.htm" >real_geo.htm</a>: 
An Essay Attempting to Justify the Relationship Between
Code Cracking and Reality Cracking ~ <a href="xavax1.htm" tppabs="http://members.xoom.com/tsehp_/xavax1.htm" >xavax1.htm</a>: Cracking the 
ShareLock Protection System (SHRLK20.DLL), by XaVaX ~ Advanced Javascript page: "<i>a java class 
used to reach it</i>", by Chris
<font color=red>Intermediate</font>
</td>
</tr>
<tr><td>10 February 1998</td><td><a href="fly___01.htm" tppabs="http://members.xoom.com/tsehp_/fly___01.htm" >A Journey within 
Steganos</a> 'light  
version', by Jean Flynn <font color=red>Intermediate</font> ~ Advanced steganography page modified ~ 
<a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >stego.htm</a> page modified ~ "<i>A Journey within 
Steganos</i>" 'advanced  
version', by Jean Flynn <font color=red>Advanced</font> ~ New <a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippet</a> by Snatch: 
Numega use your brains (Cracking Installshield serials) 
<font color=red>Intermediate</font> ~ advanced javascript page: a new essay by Tomba: "<i>A deductive & recursive 
way into Reverser's java-pages</i>" 
</td>
</tr>


<tr><td>08 February 1998</td><td><A HREF="fuhrba_3.htm" tppabs="http://members.xoom.com/tsehp_/fuhrba_3.htm" >fuhrba_3.htm</A>: Dr Fuhrball's Marx Crypto Box, the most
Secure device ever made <font color=red>Intermediate</font> ~ <A HREF="drfuh5.htm" tppabs="http://members.xoom.com/tsehp_/drfuh5.htm" >drfuh5.htm</A> Dr Fuhrball's treatment on the hardware 
side of accessing eeproms (with three gifs) <font color=red>Advanced</font> ~ <A HREF="donjo2.htm" tppabs="http://members.xoom.com/tsehp_/donjo2.htm" >donjo2.htm</A> Fallen's Cracked Metal, 
runtime dll creation <font color=red>Useful for protectors!</font> ~ 
<a href="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm" >project9.htm</a> (Micro$oft bashing) revamped ~ 
<a href="entra.htm" tppabs="http://members.xoom.com/tsehp_/entra.htm" >entra.htm</a> revamped ~ <a href="formamus.htm" tppabs="http://members.xoom.com/tsehp_/formamus.htm" >formamus.htm</A> revamped
</td>
</tr>

<tr><td>02 February 1998</td><td>Advanced Javascript page: two C programs: "<i>how to build 
a password parser (english word-order)</i>", by Syko and "<i>how to reach the javascript advanced page</i>",  by EpicLord 
~ <A HREF="lordthu1.htm" tppabs="http://members.xoom.com/tsehp_/lordthu1.htm" >lordthu1.htm</A>: VXDennis the menace, fun with VRAMDIR v1.07 ~ 
<a href="entra.htm" tppabs="http://members.xoom.com/tsehp_/entra.htm" >entra.htm</a> revamped ~ <a href="dimit_12.htm" tppabs="http://members.xoom.com/tsehp_/dimit_12.htm" >dimit_12.htm</a>: TRAP Ver 1.13: 
Opcode generators and selfchanging code  <font color=red>Useful for protectors!</font> 
~ <a href="edi1.htm" tppabs="http://members.xoom.com/tsehp_/edi1.htm" >edi1.htm</a>: How to crack HTMLedPro32 2.0d: Destroy them to make them work
</td>
</tr>
<tr><td>29 January 1998</td><td><A HREF="fp_dong1.htm" tppabs="http://members.xoom.com/tsehp_/fp_dong1.htm" >fp_dong1.htm</A>: Frog's Print 
"Dongle Bashing" essay: Dongles bye bye <font color=red>Advanced</font> ~ <a href="robinsta.htm" tppabs="http://members.xoom.com/tsehp_/robinsta.htm" >New search lessons</a> 
by Robin Hood ~ <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm" >how to search</a> section <font color=red>Revamped</font> ~ 
<A HREF="quine_51.htm" tppabs="http://members.xoom.com/tsehp_/quine_51.htm" >quine_51.htm</A>: A new essay about IDA enhancing! <font color=red>Advanced</font> ~ 
help.htm and newbyes.htm slightly modified ~ New <a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippets</a> by Cybercurve and 
MAD '96 <font color=red>Beginners</font>
~ 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">Reality cracking</a>: a small answer to MrWho, by Bob
</td>
</tr>

<tr><td>27 January 1998</td><td><a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript 
section</a>: new material and <u><font color=blue>dark1.htm</fonT></u> another  
simple javascript site-protection ~ <a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">realicra.htm</a>: reality cracking 
section revamped ~ with a new essay by MrWho and a new Essay by +ORC
</td>

<tr><td>25 January 1998</td><td>index.html (this page) revamped ~
<a href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">searengi.htm</a> revamped search engines 
~ <a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links.htm</a> revamped links ~ <a href="sear0198.htm" tppabs="http://members.xoom.com/tsehp_/sear0198.htm" >sear0198.htm</a> 
new how to search the web lesson (and reversing competition :-) ~ New revamped <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript 
section</a> entrances and <a href="javhelp1.htm" tppabs="http://members.xoom.com/tsehp_/javhelp1.htm" >help</a>! ~ phony.htm modified ~ <a href="pageadvi.htm" tppabs="http://members.xoom.com/tsehp_/pageadvi.htm" >pageadvi.htm</a>: the new antispam section ~ snikkel.htm modified
</td>

<tr><td>22 January 1998</td><td><a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm" >project3.htm</a> 
~ "How to undongle" revamped ~ <a href="spyder_4.htm" tppabs="http://members.xoom.com/tsehp_/spyder_4.htm" >spyder_4.htm</a>: SSI Win32 Dongle 
Protection <font color=red>Intermediate</font> ~ <a href="mammo_ot.htm" tppabs="http://members.xoom.com/tsehp_/mammo_ot.htm" >Mammon's first 
findings</a> <font color=red>workshop</font> ~ 
<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >A new snippet</a> by +RMD: How to make a MSGBOX work for YOU ~ and I notice that 
my new <a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript web protection</a> is more strong that 
I would have thought... few came through it on the other side! :-)
</td>
</tr>
<tr><td>20 January 1998</td><td>New 
<a href="formamus.htm" tppabs="http://members.xoom.com/tsehp_/formamus.htm" >formamus.htm</a> for submitting essays... please CHANGE your 
older models, this one prints better <font color=red>Important!</font> ~
<a href="quine_h1.htm" tppabs="http://members.xoom.com/tsehp_/quine_h1.htm" >quine_h1</a>: Quine's long 
awaited terrific "De-HASPING" essay <font color=red>Expert!</font> ~ <a href="marigo_2.htm" tppabs="http://members.xoom.com/tsehp_/marigo_2.htm" >Marigold</a>  
is tackling timelock 3!: "tl303inj!PleaseTraceIntoMe_MrCracker" 
<font color=red>Intermediate</font> ~ New <a href="help.htm" tppabs="http://members.xoom.com/tsehp_/help.htm">help.htm</a> ~ <a href="aitor_45.htm" tppabs="http://members.xoom.com/tsehp_/aitor_45.htm" >aitor_45.htm</a>: InstallShield Packages 
Encryption <font color=red>Intermediate</font> ~ 
<a href="projunpa.htm" tppabs="http://members.xoom.com/tsehp_/projunpa.htm" >projunpa.htm</a> revamped  ~ <a href="dphman_p.htm" tppabs="http://members.xoom.com/tsehp_/dphman_p.htm" >dph-man</a>'s "thoughts on key checking methods that are hard to 
reverse engineer" <font color=red>Useful for protectors!</font>
</td>
</tr>
<tr><td>18 January 1998</td><td><a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">entrance</a> 
to the advanced (revamped) javascript page <font color=red>Advanced</font> ~ <a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a> 
~ +RCG new protection approach:  "how to take Softice on a boat ride" <font color=red>Advanced</font></td>
</tr>
<tr>
<td>17 January 
1998</td><td VALIGN="center"><a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm" >Our 
Tools</a> project started by +RCG <font color=red>Advanced</font>
~ 
more <a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm" >snippets</a> ~ New additions for the <a href="projunpa.htm" tppabs="http://members.xoom.com/tsehp_/projunpa.htm" >Packers & 
Unpackers</a> project 
~ a
new essay about <a href="popja_51.htm" tppabs="http://members.xoom.com/tsehp_/popja_51.htm" >OCX Control Highlights and 
Licensing schemes</a> (inter alia) 
<font color=red>Intermediate</fonT> ~ rcg_cmsp.htm and marigold.htm added ~ 
<a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm" >Visual Basic</a> project page updated
</td>
</tr>
<tr><TD>14 January 1998</td><TD><a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our protections</a> 
~ +RCG new "vxd" protection approach:  "A first introduction to vxd"; "Cryptography 
and mathematics of chaos"; crypto.exe, vxd.vxd and heavy.exe.<bR>An incredibly 
interesting new section, seen that Micro$oft's vxd documentation is laughable and 
that you wont be able to find all too much about on the web! 
<font color=red>Advanced</font> ~ snickel.htm, altF4j_a.htm, ajtor1.htm and banda7.htm 
added</td>
</tr>
<tr><td>8 January 1998</td><td><a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm" >hcu98_3.htm</a> 
~ Ringing the bell for this year's +HCU courses <font color=red>Restricted</font> ~ 
hr_ferr1.htm added</td>
</tr>
<tr><td>5 January 1998</td><td><a href="whatdika.htm" tppabs="http://members.xoom.com/tsehp_/whatdika.htm">whatdika.htm</a> added ~  
<a href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/finished.htm" >whoson.htm</a> added ~ 
 <a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">noanon.htm</a> modified ~ jongamcr.htm added</td>
</tr>

<tr><td>4 January 1998</td><td><a href="help.htm" tppabs="http://members.xoom.com/tsehp_/help.htm">help.htm</A> modified ~ 
<a href="formamus.htm" tppabs="http://members.xoom.com/tsehp_/formamus.htm" >formamus.htm</a>: rules for 
submitting essays modified ~ new essay 
by Fabian Hansmann (Steganos' Author): Fighting steganography detection ~ 
<a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm" >stego.htm</a> page modified ~ advanced steganography page modified ~ blackboard 
re-opened ~ x861.htm modified ~ little_1.htm 
(Little-John on Winrar) added ~ altf4cjw.htm modified</td>
</tr>


<tr><td>3 January 1998</td><td>stego.htm: new password for advanced URL ~ 
s-tools4 images added ~ advanced steganography page modified</td>
</tr>
</table>
</center></center>
<br><a name="anchor1997"></a><br><bR><center><hr><center>
<table border= "2" width=77%><tr><td bgcolor="#FFFFEA">
<center><H3>1997</H3></center></tD></tr>
</table>
<bR><br></center></center></center></center>
 <pre>- 01 dec: orc.htm: +ORC's C3 lesson ('Iabrowse revealed')
- 14 dec: orc.htm: +ORC's 9(2) lesson (psp)
- 18 feb: orc.htm: +ORC's 9(3) lesson ('dead listing')
- 20 feb: search7.htm: new search lesson
- 27 feb: student.htm: first three students lessons
- 12 Mar: stalking.htm: The stalking page
- 13 Mar: slaves.htm: the supermarket enslavement (An article by +ORC)
- 14 Mar: couninte.htm: the counter intelligence page
- 27 Mar: orc.htm: +ORC's lesson 4.1
- 15 Apr: ideale.htm: Crackers against commercial smut Updated!
- 27 Apr: corporate.htm:&nbsp; how to hyde your activities at work!
- 28 Apr: orc.htm:&nbsp; new lesson 4.2! (Micro$oft trial protections! Great!)
- 29 Apr: body.htm: enslavement techniques: body language and hypnotic tricks
- 05 May: tools.htm: NEW and POWERFUL tools&nbsp;
- 09 May: razzia.htm: Visual Basic *.dll cracking!
- 10 May: project2.htm: how to crack the 14 days Winice trial protecton
- 12 May: howto93.htm: +Orc sends a correction to the howto93.htm
- 13 May: javaco1.htm: Get rid of all people using Micro$oft Internet explorer
- 23 May: index.html: Two new tutorials!
- 30 Jun: Page reopens after a whole month freeze
- 08 Jul: orc.htm: link to the old Money demo v. 3.00 used in the strainer!
- 15 Jul: newbies.htm: a word for the confused ones
- 19 Jul: blackbo.htm: introduction of the blackboard
- 01 Aug: reverser.htm: a new reverse engineering lesson! (filemon1.htm and filemon2.htm)
- 17 Aug: project1.htm: new hexeditor project (project1) started
- 21 Aug: orc.htm: a letter from +ORC! +ORC reopens a bilateral channel!
- 27 Aug: astonish.htm: all Windoze NT users turned into System administrators
- 02 Sep: filemon5.htm: Vxd vagaries and mysteries (first part)
- 10 Sep: useful.htm: special tools&nbsp;
- 16 Sep: solution.htm: new +HCU graduates!&nbsp;
- 12 Oct: Page reopens after 15 days freeze (and gets 3000 hits per day :-)&nbsp;
- 13 Oct: academy.htm: academy database partitioned!&nbsp;&nbsp;
- 27 Oct: rules.htm: please read the "rules" for submitting essays! s
- 28 Oct: snippets.htm: new section: snippets
- 29 Oct: newuni.htm: +ORC alive and kicking :-)
- 04 Nov: sear1197.htm: how to search, a new lesson: combing and klebing&nbsp;
- 08 Nov: noanon.htm#anchoranoaca: Reverser's Anonymity Academy&nbsp;
- 09 Nov: tekles1.htm: Cracking for dummies 1: "Birth of a cracker"&nbsp;
- 13 Nov: progcor.htm: The 'shareware programmer' corner
- 25 Nov: migrating to http://fravia.org
- 27 Nov: ideale.htm: new CGI-script reversing page (ideale4.htm)
- 28 Nov: protecti.htm: New tough protection by +Rcg&nbsp;
- 29 Nov: wlcmaz.htm: New Database (Cracking The Maze Of Essays At reverser+ Web Site)&nbsp;
- 05 Dic: netles2.htm: Cracking for dummies 2: "The difficult years"&nbsp;
- 07 Dic: javascri.htm: Javascript section started&nbsp;
- 14 Dic: flipvb1.htm: some answer to flipper's "tough" visual basic protection&nbsp;
- 16 Dic: corporate.htm and noanon.htm revamped
- 22 Dic: stego.htm: basic (and may be advanced) steganography!</prE>


<HR ALIGN=CENTER WIDTH=100% SIZE=3>
<!-- Begin mover -->
<CENTER>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="blackbo.htm#anchortop">Back to the top of this jolly blackboard</A>
<hr width=33%>                          
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm" >counter measures</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI scripts</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">academy of anonymity</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm" >mail_fravia</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A> 

</CENTER>
<!-- End mover -->

<hr width=33%></Font><Font color=green>
<a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM BORDER=0 VSPACE=0 
HSPACE=0 width="13" height="13"></a>(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998. All rights reserved </Font>

</body>
</html><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>conseal.htm: How to crack Conseal PC Firewall in an 'unusual' way: Hooking 
API calls via IAT</title>

</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 ALINK=#405040 VLINK=#8850AA>

<table border="0" cellpadding="0" width="100%" align="center">
<tr>

<td colspan=3><p align="center"><font size="6">How to crack 
Conseal PC Firewall in an 'unusual' way<br>(Hooking API calls via IAT)</font></td>
<tR><td colspan=3><pre>  </prE></tD></tR>
</tr><tr>
<td width="22%" bgcolor="#FFFFEA"><p><font size="4" color="#00254A"><center>18 September 1999</center></font></td>
<td width="56%" bgcolor="#FFFFEA"><p><font size="4" color="#00254A"><center>By NeuRaL_NoiSE</center></font></td>
<td width="22%" bgcolor="#FFFFEA"><p><font size="4" color="#00254A"><center>a 1999 RingZ3r0 production</center></font></td>
</tr><tr>
<td><center><a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm"><IMG
SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" 
ALT="advanced" ALIGN=CENTER WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Advanced</FonT>
</center></td><td><center><font size=+3>tools used:</fonT></center></td>
<td width="56%"><table border="0" cellpadding="0" 
cellspacing="0" width="100%" align="Center">
<tr>

<td><ul type="disc">
<li><b>SoftIce v4.00</b> 
<li><b>BoundsChecker v6.01</b> 
<li><b>Hacker's View v6.15</b> 
<li><b>Procdump v1.5</b> 
<li><b>OpGen v1.0b</b> 
<li><b>Tasm v4.1</b> 
</ul></td>
</tr></table></td>
<td width="22%"><p>&nbsp;</td>
</tr><tr>
<td colspan=3 bgcolor="#FFFFEA"><center>
( )<B>Beginner</B> (X)<B>Intermediate</B> (X)<B>Advanced</B> ( 
)<B>Expert</B></FONT>
</center></tD></tr><tr>
<td width="22%"><p>&nbsp;</td>
<td width="56%"><p>&nbsp;</td>
<td width="22%"><p>&nbsp;</td>
</tr><TD BGCOLOR="898030" colspan=3><center>Courtesy of Reverser's page
of 
reverse engineering</center> 
</center></TD></table>
<pre>lo reverser,

i'm aware of your (correct imho) criteria of "non-targeted" essays...i find
it stupid that STILL now there are essays that won't teach you anything new,
and most of the tutorial writers cant come up with brand new ideas or
such...but, in this case i chose to write something target-related as this
conseal pc firewall tutorial just because...well, just because i followed a
non-usual approach, which is always a good thing...i implemented an IAT hook
trying to explain the basics of it, exploited a mempatcher to patch the hook
inside the import table, injected the hooking routine code in 00-byte caves
between the object table and the first section's raw data in order to avoid
an obvious decryption-due code modification, without actually adding a
bloated 200 bytes raw section...i mean, i think i came up with something
new...a more 'funny' way of cracking stuff...a 'reversive' approach that
hopefully will open most young reversers minds...woah,
well i'm floating a bit too high there, better to get down again ;)
anyway you get the drift: no matter which target it is, the important is
what i did here... <font color=blue>if only 2 more persons tomorrow will be aware that you CAN
hook api calls inside a pe file via IAT hooking thanks to this modest
writing, that would make me the happiest person on earth</fonT>.

laters,
nN.
</prE><center>
<i>A great essay by a fine reverser! Italian crackers sublimissimi and machiavellici!<br>Note how good reversers don't simply breakpoint everything in 
sight to patch a target, but actually STUDY its less common features 
in order to understand deeper truths! Wanna start to understand 
what's like to 
reverse as it should be? Read this. Enjoy!<bR>Of course, as you all (should) 
know, once you master such kind of 
import address table reversing you will <u>also</u> be able to work for 
your favourite "dll taming" projects... eheh... ad astra per aspera!</i></center><br><bR>
<table border="0" cellpadding="0" cellspacing="0" width="90%" align="center">
<tr>
<td align="center" bgcolor="#FFFFEA"><p><font size="5" color="#00254A"><b>Part 1: Intro</b></font></td>
</tr></table>
<p><br>
<table border="0" cellpadding="0" cellspacing="0" width="100%" align="center">
<tr>
<td><p><font face="Courier New" size="2"><b>Hi everyone...</b></font></p>
<p><font face="Courier New" size="2"><b>What does it mean &quot;in an unusual way&quot; ? If u're wondering about it, after reading the title, 
here is the explanation... it's quite some time that i don't crack anymore, like my friends 
know, and i prefer to dedicate to the (imho) much richest, more interesting and intriguing 
Reverse Engineering scenario... meanwhile, tho, among a chat and a nuke to a friend i 
happened to notice that my precious firewall (Conseal PC Firewall, i think it's one of the 
best ones even if i know shit about that) goes down... license has expired ?? ohh SHIT, my 
license has expired! =)</b></font></p>
<p><font face="Courier New" size="2"><b>Typical background for a common quick crack (i haven't been settling for long cracking 
sessions for quite a while...), neverthless i soon realized that there were some good aspects 
that led to something nicer than a plain serial or a jz/jnz check...</b></font></p>
<p><font face="Courier New" size="2"><b>Let me just say that this tute will be as short as possible (not for the fact that it's 
4.30am here and i'm quite tired, but because i don't really want to flood you with tons of 
text....let's try =)</b></font></p>
<p>&nbsp; 
<table border="0" cellpadding="0" cellspacing="0" width="90%" align="center">
<tr>
<td align="center" bgcolor="#FFFFEA"><p><font size="5" color="#00254A"><b>Part 2 : Da Crack.</b></font></td>
</tr></table>
<p><br></p>
<p><font face="Courier New" size="2"><b>Ok, this is the story.</b></font></p>
<p><font face="Courier New" size="2"><b>The program, once expired, and once ran, doesn't make you suspect anything, when, after like 
2/3 seconds, voila' a msgbox that tells us that we have finished our time =/... Oh btw i use 
version 1.37. As i was saying, there's a msgbox, but we won't break on messageboxa, we said 
we wanna have fun, no usual stuff. So let's open boundschecker and launch frw.exe, being 
careful to all the api's used... if u are careful enough and u collapse every thread created 
at the start of the program, u'll notice 6 initial threads and, right before the nag pops, 
the creation of a seventh thread. Interesting, let's take a look at this 7th thread... u'll 
notice an overwhelming amount of registry poking, quering and so on, well nothing strange, 
nothing changed, as bob marley put it... But let's take a look at the values being checked... 
uhm, u'll notice a certain repetition of LicenseInfo, LicenseID etc... let's open regedit for 
a second and look for LicenseID... deh, a nice trio of interesting keys... LicenseCode 
contains probably the encrypted version of the installation date + other various rubbish, 
LicenseID has a default string for our universal license, LicenseInfo with various 
unidentified trash... uhm, what are we gonna do ? a coupla bpm's, looking for the decrypting 
routine, and we write our l33t crack ? NO :)</b></font></p>
<p><font face="Courier New" size="2"><b>We said in an unusual way... so let's close regedit (dunno about you, but i'll reserve the 
decrypting routine for the next time, might be an interesting algo)... anyway, as we were 
saying, let's come back to our 7th thread, re-popping boundschecker again. Browsing a bit 
downwards among the api calls, we'll reach a zone where a heap gets allocated+freed, then OH! 
what's that GetLocalTime =) yup, it's this easy... GetLocalTime gets the current date and 
hour... then it's obvious that the program decrypts the LicenseCode key, gets the 
installation date, and then makes his calculations... What are we gonna do ? we could patch 
the checks in a quick and dirty way, but we talked about having fun, no?? So... let's close 
boundschecker after a quick look at the rest of the (useless) api calls... open the file with 
Hiew... wow a little surprise for us, there's a .WWP32 section... the file is packed with 
wwpack 32... procdump unpacks it i think... but we are hard headed... we want the packed 
file, wich is cooler and less space-consuming ;) at this point a little pervert thought 
crossed my mind... let's see... GetLocalTime. Gets year, month and day... I installed Conseal 
the 17th of July 1999... if i make him believe that it's always the 18th of July 1999 we'll 
all live in peace... it would be interesting, but how to do it ? uhm, the solution is easy... 
a IAT hook that intercepts every GetLocalTime call and that fakes the result... easy to do, 
just that the file is packed, so the problems are basically 2: one, how to install the hook, 
and two, WHERE to inject the hooking routine... well, installing the hook is as easy as 
smoking a cigarette, neverthless the situation was interesting and i thought i'd keep walking 
this path :)</b></font></p>
<p><font face="Courier New" size="2"><b>IAT hooking is basically, really, really easy in the concept. I assume that the reader has a 
medium knowledge of the PE structure, and that he/she knows what an Import Table is... if 
not, may i suggest you to read some good doc, the best ones are imo Pietrek's and 
Luevelsmeyer's (whose famous <a href="text/pe.txt" tppabs="http://members.xoom.com/tsehp_/text/pe.txt">pe.txt</a> i included)... Now, we know that in the 
Import Table there's an array called FirstThunk, which gets patched at runtime with the 
addresses of the functions that the program imports... the concept of IAT hooking is based on 
this: you retrieve the spot that concerns the function we want to hook, and you patch the VA 
of our hooking routine inside it. This done, when the program will call the function (and 
thus will pass for the deviation inside the Import Address Table (aka FirstThunk array)), 
instead of running straight towards the kernel woods, it'll run towards our injected 
routine's lair... at that point we'll quietly examine the passed params, we forward them to 
the kernel, or we keep them, or we reset the system, or we make a window pop up saying 
&quot;Moonshadow is gay =)&quot; or whatever else pleases us ;) (jk mun:P)... well, u got it. 
Obviously, we can as well fake the result of a call, in our case GetLocalTime, returning to 
our dear friend frw.exe the perpetual date of 18th July 1999 :)</b></font></p>
<p><font face="Courier New" size="2"><b>There's a problem anyway. The file is packed... how and where to inject a hooking routine ? 
Well, the first idea that popped in my mind was writing a small hooker .exe, then, from 
within a memory patcher (unavoidable as we'll see) mapping it into memory and access to it 
from the unpacked process... easy to do since MMF's are mapped in the shared region of the 
linear address space, thus we wouldn't need any additional context switching routine etc... 
but then i thought, is it really worth it ? let's make something quicker =)... i wanted to 
physically patch the routine inside frw.exe, and there was only one place safe from the fury 
of the storm caused by a decrypting stub that devastates the initial image of the file with 
his mathematcally cold decompression/patching... i'm talking about the so called caves... 
this term is particularly familiar to virii writers... caves are those empty spaces (in 
reality filled with 00-bytes) inside a PE file, in other words 'dead' spaces you can use for 
any code injection purpose... in our case, not viral code but a nice hooking routine :)</b></font></p>
<p><font face="Courier New" size="2"><b>Which cave are we gonna use ?? well, i'd say that the one between the Object Table and the 
first section's raw data will do fine... open the file with Hiew, just to make an idea... 
after the stub (this proggie can't be run in dos mode) and the PE,0,0 signature we get the 
first file header data, then the optional header etc... browsing downwards we find the object 
table (.text with the relative data, .rdata with its data etc...) ... then we have a 
succession of zero bytes (our cave) starting from offset 268h and finally we get to .text 
section at offset 1000h... all this space isn't used/relocated/modified at all, by wwpack32's 
loader... now you have an idea of what we're gonna do... you choose wether to keep reading or 
to destroy this htm file ;)</b></font></p>
<p><font face="Courier New" size="2"><b>So..so... what do we need now ? Well, considered that we have to install a IAT hook, we need 
the decrypted image of the file.. in reality we have a 'notionistic' need of a coupla virtual 
addresses, that we'll be able to stick as patchspots from a memory patcher, even if the file 
we'll use will always be the packed one... so we open procdump, and we start conseal... as 
soon as the process has been fired, press the right button inside procdump's tasklist and 
select Refresh list... here comes a new process, frw.exe... Quickly, right button on the 
taskname and then &quot;Dump (Full)&quot;... save the dump in a file, and close frw and procdump. That 
file contains the image of frw.exe exactly as it appears once mapped+decrypted... now the 
problem is climbing to the import table, and then dwelling inside it until finding the 
FirstThunk array's dword realtive to GetLocalTime's address... and this implies a DAMN BORING 
(at least for me) search... so what do we do ? well, some time ago i got really sick of this 
situation (i had to face it every time i wanted to patch an api call inside a process... 
which is a rather common thing when u reverse programs, and i had to manually look for the 
spot in the IAT), and i decided to write a small tool, that i called <a href="http://acrigs.com/FRAVIA/zipped/opgen.zip" tppabs="http://members.xoom.com/tsehp_/zipped/opgen.zip">OpGen</a>, which contains 
another quite useful function too, it pratically generates opcodes for patching far jumps, 
only given the starting and the destination VA/RVA (hiew sux when it comes to far jumps)... 
but we're not interested in such feature, neverthless the little IT scanner that i put into 
it is useful here, it gives you the patchspot for every function in a snap... seen that i 
included it in conseal.zip, open it and choose Lookup Imports for patching... select our 
dumped file and what u'll get (among other things) will be this:</b></font></p>
<p>GetLocalTime == call dword ptr [46459C]</p>
<p><font face="Courier New" size="2"><b>Oh, interesting :) that ([46459c]) is the place where we'll stick the address of our hooking 
routine... Here we are at the point where we face the need of a memory patcher. Having to 
patch the hook inside the decrypted image of the file, let's open our dear Ultraedit with 
Tasm support (tm;) and let's begin writing down some code...</b></font></p>
<p>&nbsp;</p>
<p><font size="2" color="blue">.386p<br>
.model flat, stdcall</font></p>
<p><font size="2" color="blue">extrn&nbsp;&nbsp;&nbsp;ReadProcessMemory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:PROC<br>
extrn&nbsp;&nbsp;&nbsp;WriteProcessMemory&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:PROC</font></p>
<p><font size="2" color="blue">UNICODE = 0<br>
include winsux.inc</font></p>
<p>&nbsp;</p>
<p><font size="2" color="blue"><br>
.DATA</font></p>
<p><font size="2" color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exe_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;frw.exe&quot;,0</font></p>
<p><font size="2" color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;processInfo &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROCESS_INFORMATION &nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ini_info &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STARTUPINFO &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt; </font></p>
<p><font size="2" color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iat_hooking_routine&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;04002A0h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; VA OF THE HOOKING ROUTINE (IN THE CAVE BETWEEN THE OBJECT TABLE AND 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; THE .TEXT SECTION)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;funct_va&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dummybuffer&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</font></p>
<p>&nbsp;</p>
<p><font size="2" color="blue"><br>
.CODE</font></p>
<p><font size="2" color="blue">start:</font></p>
<p><font size="2" color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;CreateProcessA, OFFSET exe_name, 0, 0, 0, 0, NORMAL_PRIORITY_CLASS,0 ,0 ,OFFSET ini_info,OFFSET processInfo<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test&nbsp;&nbsp;&nbsp;&nbsp;eax, eax<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@@end</font></p>
<p><font size="2" color="blue">; we'll wait for frw.exe to be loaded and unpacked with a little loop (even if we're not able to hook every GetLocalTime there's no problem, the 
; ones we effectively need are the ones in the 7th thread, remember)</font></p>
<p><font size="2" color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecx, 100000000<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.WHILE&nbsp;&nbsp;ecx != 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;dec&nbsp;&nbsp;&nbsp;ecx<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.ENDW</font></p>
<p><font size="2" color="blue">; we retrieve the effective address of GetLocalTime in the kernel directly from the IAT of the unpacked process<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;ReadProcessMemory, [processInfo].pi_hProcess, 046459Ch, OFFSET funct_va, 4, OFFSET dummybuffer</font></p>
<p><font size="2" color="blue">; now we patch this address in a dword (@ 4002dd) that we'll call from the hooking routine when we wanna call GetLocalTime<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory, [processInfo].pi_hProcess, 04002DDh, OFFSET funct_va, 4, OFFSET dummybuffer</font></p>
<p><font size="2" color="blue">; and finally we'll effectively install the hook in the FirstThunk array, modifying the address that the program will call inside the IAT<br>
; with the address of our function (in the iat_hooking_routine dword)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;WriteProcessMemory, [processInfo].pi_hProcess, 046459Ch, OFFSET iat_hooking_routine, 4, OFFSET dummybuffer</font></p>
<p><font size="2" color="blue">@@end:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;ExitProcess, 0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; our job is done... now everything is in the hooking routine's hands (bytes:) </font></p>
<p>&nbsp;</p>
<p><font size="2" color="blue">end&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;start</font></p>
<p>&nbsp;</p>
<p><font face="Courier New" size="2"><b>very good.</b></font></p>
<p><font face="Courier New" size="2"><b>At this point, once we compiled the program we'll have our mem patcher that creates the 
process, waits a bit, then retrieves GetLocalTime's address from the IAT, then patches it 
inside the hooking routine, and in the end installs the IAT hook in the decrypted image of 
the program.</b></font></p>
<p><font face="Courier New" size="2"><b>now we only have the problem of the hooking routine. What do we need to put inside of it ?</b></font></p>
<p><font face="Courier New" size="2"><b>enter Softice and put a bpx getlocaltime... start conseal pc firewall, and press f12 at the 
first pop. Write DD and then D ESP-4. This will show you the address that has been pushed on 
the stack before the call GetLocalTime (you can also find it by tracing thru kernel until 
that &quot;mov ecx, esp-c&quot; (the fifth codeline in the function) where u'll find, in ecx, the same 
address. Anyway, as i was saying, type &quot;d address&quot; and u'll get the dump of the SYSTEMTIME 
structure, that gets filled with data concerning current time and date. Let's take a look at 
it's definition:</b></font></p>
<p>typedef struct _SYSTEMTIME { &nbsp;// st &nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wYear; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wMonth; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wDayOfWeek; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wDay; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wHour; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wMinute; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wSecond; <br>
&nbsp;&nbsp;&nbsp;&nbsp;WORD wMilliseconds; <br>
} SYSTEMTIME; </p>
<p><font face="Courier New" size="2"><b>uhm, uhm... remember that we have to make the proggie believe that it's always the 18th of 
July 1999, in other words we have to modify the first, second and fourth Word in the 
structure... making them respectively 7CFh (1999 dec), 7, and 12h (18 dec)... if u wanna get 
a close look at the struct, give a DW and then analize it... u'll see how easy this concept 
is.</b></font></p>
<p><font face="Courier New" size="2"><b>So, let's make a lil summary. What will happen is this: the program will call the IAT 
thinking that it's calling GetLocalTime, while the control will be passed to our hook routine 
(at 04002A0h)... at that point our situation will be this: we'll save EAX pushing it and then 
[ESP+4] will hold the return address for the program's code, and we'll save it in a physical 
dword to call afterwards for the return (the same thing we did from the mempatcher for 
GetLocalTime's address)... then we'll pop EAX and we'll increase the stack pointer of 4 
bytes... at that point [ESP] will point to the SYSTEMTIME structure... so we'll effectively 
call GetLocalTime... at the return, we'll have, in [ESP-4], the address of the SYSTEMTIME 
structure, and we'll start modifying it... but first we'll save the value of EAX in a third 
physical dword (we can't push it because often, if you analize the code flow with softice, 
the VA of the structure is dangerously close to the stack pointer, so a badly placed push 
could ruin the struct and crash the program) and we'll stick the VA of the struct inside 
it... at this point, we'll modify the words relative to year, month and day, then we restore 
EAX and we jump to the return address, that we saved at the beginning of the routine...</b></font></p>
<p><font face="Courier New" size="2"><b>now let's write the code... open hiew and go to offset 2A0h (that'll become 4002A0h as soon 
as the file gets mapped and the imagebase gets added), and inject our hooking routine:</b></font></p>
<p><font color="blue">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push&nbsp;&nbsp;&nbsp;&nbsp;eax &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; save EAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [esp+4]&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; return VA in EAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4002E3h], eax&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; we save it in a variable X<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; restore EAX<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;esp, 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; [ESP] points to the SYSTEMTIME structure<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;&nbsp;&nbsp;&nbsp;dword [4002DDh]&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;; == call GetLocalTime (dword patched from the Mem Patcher)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[4002E9h], eax&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; save EAX in a variable Y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [esp-4]&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; EAX holds a pointer to the structure<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word [eax], 07CFh &nbsp;&nbsp;; WORD wYear<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word [eax+2], 07h &nbsp;&nbsp;&nbsp;; WORD wMonth<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;word [eax+6], 012h &nbsp;; WORD wDay<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eax, [4002E9h]&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; restore EAX from variable Y<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;jmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dword [4002E3h] &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; back to .text via the variable X</font></p>
<p><font face="Courier New" size="2"><b>gone :)</b></font></p>
<p><font face="Courier New" size="2"><b>for those among you not very familiar with Hiew and its barbarian way of handling byte, word 
and dword ptr, you must know that they are respectively B,[blabla] &nbsp;&nbsp;, &nbsp;&nbsp;W,[blabla] &nbsp;&nbsp;and 
&nbsp;&nbsp;D,[blabla].</b></font></p>
<p><font face="Courier New" size="2"><b>once u did this, you can run our mempatcher, and everything will work perfectly... your 
Conseal PC firewall will never expire again, and we made something unusual for sure... i had 
some fun, what about u ?? ;)</b></font></p>
<p>&nbsp; 
<table border="0" cellpadding="0" cellspacing="0" width="90%" align="center">
<tr>
<td align="center" bgcolor="#FFFFEA"><p><font size="5" color="#00254A"><b>Part 3: Shout Outz</b></font></td>
</tr></table>
<p><br></p>
<i>Greetings logorrhea shortened by reverser+, maybe not enough :-)</i>
<p><font face="Courier New" size="2"><b>For any question, comment, add-on, polemic etc etc my email is </b></font><font face="Courier New" size="2"><b><a href="mailto:neural@cryogen.com">neural@cryogen.com</a></b></font></p>
<p><font face="Courier New" size="2"><b>my nickname on IRC ~ #cracking4newbies (EFNet) or #crack-it (IRCNet) ~ is nuural_en.</b></font></p>
<p><font face="Courier New" size="2"><b>other stuff written by me can be found at </b></font><font face="Courier New" size="2"><b><a href="http://neudump.cjb.net/">http://neudump.cjb.net</a></b></font></p>
<p><font face="Courier New" size="2"><b>my preferred italian reverse engineering group's page is at </b></font><font face="Courier New" size="2"><b><a href="http://ringzer0.cjb.net/">http://ringzer0.cjb.net</a></b></font></p>
<p><font face="Courier New" size="2"><b>and my preferred international reversing group's page is </b></font><font face="Courier New" size="2"><b><a href="http://dread99.cjb.net/">http://dread99.cjb.net</a></b></font></p>
<p>&nbsp;</p>
<p><font face="Courier New" size="2"><b>'till next time,</b></font></p>
<p><font face="Courier New" size="2"><b>NeuRaL_NoiSE 1999 for RingZ3r0 and DREAD.</b></font></p>
<p>&nbsp;</td>
</tr></table>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even
bother explaining you 
   that you should BUY programs if you
intend to use them for a 
   longer period than the allowed one. Should you want
to STEAL  
   software instead (unlikely in this case :-) you don't need to
crack protection schemes at all: 
   you'll find everything on most Warez sites, complete and
already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of
reverse engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back
to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"
>homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to
protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how
to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is
reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow
automated retrieval -->
</BODY>
</HTML>

<HTML>

<HEAD>



<TITLE>snw_ad_c.htm:               

Hyperpro cracking, by sNv,  June 1999

</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<center>Hyperpro cracking, by sNv,  June 1999</center>

<hr>		

<br><br>

		Thanks for the "hyperprotections" challenge.  You did a wonderful and clever job of making it just

                difficult enough to appreciate the success and yet so easy that one doesn't toil for many hours or days.  I

                appreciate the balance!

<br><br>

                Due to the simplicity and your generosity, I do not feel others could learn from my success, but I will

                mention how I "solved" it.  Since I am not well versed in Russian literature or arts (if it is Russian), I

                resigned myself to the code.

<br><br>

                Basically, I figured the phrase was in English (from the rest of your website), and using a dictionary I

                created from M$Word a while back, I created a list of two-letter English words (thanks for the clue).  I

                used your decode() function and a simple "brute force" of the first 4 letters of the key (26^4 combos), to

                produce a list of about 100 possible combos which resulted in the first two two-letter phrases of the

                cipher text.   Of these 100 or so phrases, only about a dozen "made sense" ("go to", "it is", etc...)   The

                others were just bad English ("so ma", "hi pa", etc).

<br><br>

                When I tried the key, "baba" ("go to"), I saw the following:  "Go to kyr11jav.htp......Sae you tkete!"

<br><br>

                As you can see, you generosity in using a key with repeating characters helped "fill in the blanks" even

                more!  Anyway, it was clear to me that the last portion should read, "See you there!", so I worked on

                reversing the word "there" manually from the ciphertext.  In a matter of minutes, I had the complete key:

                "babayaga".  

 <br><br>                

                It kinda has a ring to it!

<br><br>

                Thanks again,

<br><br>

                sNw

<hr>

<bR><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=88% HEIGHT=6 BORDER=0

VSPACE=0 HSPACE=0><br><br>

<!-- Begin Javascript relocator <font color=red>~</fonT> Javascript code by fravia+ -->

<form name="FraviasForm">

<script language="JavaScript">

<!--



function FravPage(list) {

	      location.href = list.options[list.selectedIndex].value

}



// -->

</script>

<div align="center">

<center>

<p center="&lt;center&gt;&lt;/center&gt;">&nbsp;<select name="fraviale" size="1">



<option>Choose another page!</option>

<option value="index.htm">Main page</option>

<option value="academy.htm">Software reversing Lab</option>

<option value="realicra.htm">Reality cracking Lab</option>

<option value="noanon.htm">Anonymity Lab</option>

<option value="ideale.htm">Site busting Lab</option>

<option value="howtosea.htm">How to search Lab</option>

<option value="sealight.htm">--Search engines (light)</option>

<option value="searengi.htm">--Search engines (heavy)</option>

<option value="links.htm">Links</option>

<option value="tools.htm">Tools</option>

<option value="javascri.htm">Javascript reversing</option>

<option value="screamin.htm">Screaming truth</option>

<option value="entran.htm">Main entrance</option>

<option value="new_what.htm">What's new on fravia's</option>

<option value="info.htm">Mail fravia+</option>

<option value="http://greythorne.home.ml.org">+Greythorne's</option>

<option value="http://www.InsideTheWeb.com/mbs.cgi/mb186724">Tools of our trade msgboard</option>

<option value="http://www.InsideTheWeb.com/mbs.cgi/mb155985">Main msgboard</option>

</select>



<input type="button" value="Let's go!" onclick="FravPage(this.form.elements[0])">

<br>

</div>



</form>

<!-- end Javascript relocator -->

<bR><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=88% HEIGHT=6 BORDER=0

VSPACE=0 HSPACE=0><br><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0>

<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>

<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM

BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>



<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>



<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A>



<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A>



<bR>

<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A

HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>



<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13

BORDER=0 VSPACE=0 HSPACE=0><A

HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13

HEIGHT=13

BORDER=0 VSPACE=0 HSPACE=0><A

HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia </A><br>





<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0

VSPACE=0 HSPACE=0><A

HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?

</A></CENTER>

<hr size=4></fonT></center></center>





</body>

</HTML><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>crunchi2.htm: Little essay about the various methods and viewpoints of crunching</title>
</head>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>+HCU papers</fonT><br><br>
<font size=+6><font color=blue>Little essay about the various methods and viewpoints of crunching</font></font>
<br>
~ version June 1998 ~<bR>
by Joa
<br>


<hr>Courtesy of reverser's page of reverse engineering<bR>
<hR></center></center><p>
Here is the second part of Joa's essay.<br>
See also <a href="crunchi1.htm" tppabs="http://members.xoom.com/tsehp_/crunchi1.htm">the first part</a> (Introduction)<bR><hr width=33%>
<p>Joa's work is extremely clear and will guide and help you to 
understand these matters, that for obvious reasons no real reverser should ever 
underestimate. My advice: read, re-read and then -once you have understood the basis- 
search the web and deepen (and then contribute :-)<bR>

<hR><pre>
Little essay about the various methods and viewpoints of crunching.

Part II: Propability and Crunching (Huffman isn't the only way)



By Joa Koester (JoKo2000@HotMail.Com) 
This essay is free to be copied and read and spread as long as
you are decent enough to leave my name in it. 
If you have corrections, comments, better examples than the ones used 
in this essay, etc. - drop me a line.


OK, let's dive into the world of crunchers and munchers...

In the Intro i told you that crunching is a process of reducing
the SPACE data needs to be stored, but not the MEANING (the
informations transmitted in the symbols).
The meter 'Entropy' is used here like in the physics. The more
entropy a symbol has, the LESS information is transmitted thru it.
Less information compared to the whole of all symbols, that is.
This means of course there is a lot of redundancy in it - meaning
a big 'crunch me, crunch me' for us. So we should concentrate
on the symbols that have a very high entropy. How we calculate
an entropy for our means depends on the data we want to crunch
and with which algorithm we want to crunch it.
I also told you that a certain student called Huffman once came
up with an algorithm to compress data. His idea is based on the
fact that in data (escpecially speech) some symbols happen 
to be more often than others. Here one overstated example:

aaaaaaaaaabbbbbcccdd

What we have here is a algorithm based on propability. That means
that some symbols are not transmitted in the way they used to be,
because the algorithm will create new symbols in respect to the
propabilities of the symbols. Some of these new symbols will be
shorter. And those lesser apperaring symbols will be transformed
into longer symbols:

Before:

a = 61h = %0110 0001
b = 62h = %0110 0010
c = 63h = %0110 0011
d = 64h = %0110 0100

and 

after:

????

How do we compute such a new symbol table? OK, before we explore
this algorithm let me change the data from ASCII to the lower
nibble. That should be enough to explain the algorithm:

Before:

a = %0001
b = %0010
c = %0011
d = %0100

and we have the propability:

a = 10
b =  5
c =  3 
d =  2
   ===
    20 <- Overall value. Important when calculating entropy

To save this original sequence to disk we would need: 

10 * 4 = 40
 5 * 4 = 20
 3 * 4 = 12
 2 * 4 =  8
        ===
         80 bits


Lets crunch this:
The original algorithm works with a tree building up from the ground
to the top. You can of course try to optimize it in another way. But
here's the algorithm as Huffman intended it:

Step 1:

10   5   3   2       How often the symbol appears
                     Tree (empty at first)
10   5   3   2       The added sum of the actual part of the tree
(a) (b) (c) (d)      Symbol


Step 2:

Now we take the two lowest (that is lowest in the sum of the value) entries
of the tree and add the values thus giving a new knot with the former part
as right and left part:

10   5   3   2       How often the symbol appears
                     Tree
10   5   3   2       The added sum of the actual part of the tree
(a) (b) (c) (d)      Symbol
         ^   ^
         ^   ^
         Two lowest values (3 and 2). 
         Take them and add the values of the two actual 
         parts of the tree and give the sum to a new knot. The two former
         parts become a left and right treebranch. 

10   5   3   2       How often the symbol appears
10   5     5         The tree
(a) (b)	  / \
         3   2
        (c) (d)

This Step 2 repeats until no two values are left:


 a   b   c   d
10   5   3   2       How often the symbol appears
10   5     5         The tree
(a) (b)	  / \
         3   2
        (c) (d)
     ^     ^ 
     ^     ^
         Two lowest values (5 and 5). 
         Take them and add the values of the two actual 
         parts of the tree and give the sum to a new knot. The two former
         parts become a left and right treebranch. 


 a   b   c   d
10   5   3   2       How often the symbol appears
10      10
(a)    / \
     5     5
    (b)	  / \
         3   2
        (c) (d)
^       ^ 
^       ^
         Two lowest values (10 and 10). 
         Take them and add the values of the two actual 
         parts of the tree and give the sum to a new knot. The two former
         parts become a left and right treebranch. 

 a   b   c   d
10   5   3   2       How often the symbol appears
     20              The tree
    /  \
  10   10
  (a)  / \
     5     5
    (b)	  / \
         3   2
        (c) (d)


Step 3:

We have a tree, so what?
What we now have to do is to to transform the tree into 
sequences of 1 and 0. To do that we start at the root giving
the root a 0 and 
- all left branches a 0 
and 
- all right branches a 1:

                   20              The tree
                  /  \
                 /    \
            [0] /      \[1]
               10      10
               (a)    /  \
                     /    \
                [0] /      \[1]
                   5        5
                  (b)	   / \
                          /   \
                     [0] /     \[1]
                        3       2
                       (c)     (d)

(Of course you could give all left branches a 1 and all right
branches a 0. Just keep straight with the directions, that's
all).

So we have the followin codes for our symbols:

a: %0
b: %10
c: %110
d: %111

Well two things are to be mentioned here:
This tree is optimized in a way that you can not produce a more
condensed one. It is not possible to create a tree that gives
more respect to all symbols in the table, calculating in whole
bits (that's no joke. There is a algorithm which calculates with
fractals of a bit and is far more powerful than Huffman. 
I'll explain this, too). Try it for yourself.
Important:
The tree is value-unique, meaning that you can't interpret the
beginning of a certain symbol as another (shorter) symbol:

(Not unique and wrong table)
a: %00
b: %10
c: %101
d: %001

If you would read a '00' what would this be? A 'a' or the beginning
of a 'd'? With this table it is not possible to answer the question
giving only the solution of a GPF. 
It it utmost important that a tree is completely unique. 
Therefore a complete symbol cannot be the beginning of another symbol!!!
If you try to build up simple trees the unique way you'll quickly
realize that the Huffman-Algorithm is the method of your choice.



Our sequence

  aaaaaaaaaabbbbbcccdd

would now need:
10 * 1 = 10
 5 * 2 = 10
 3 * 3 =  9
 2 * 3 =  6
        ===
         35 Bit. Not bad, eh?



So that means that we can optimize codes that happen to show up
more frequently than others. Big Deal. Where does this sort of
thing happen, eh? Dr. Watson?

Here, Sir. 
Well we have a lot of interesting and probably crunchable data
in SPEECH. In a normal written english text for example the letter
'e' appears the most. If we were able to compress a normal text 
using the Huffman-method we would save a lot of diskspace.

Izzatso? Well, yes, Watson is right. The letter 'e' is dominating
(not only) the english language. Here the last two paragraphs with the 
letter 'e' deleted:

---------------------------------------------------------------
So that mans that w can optimiz cods that happn to show up
mor frquntly than othrs. Big Dal. Whr dos this sort of
thing happn, h? Dr. Watson?

Hr, Sir. 
Wll w hav a lot of intrsting and probably crunchabl data
in SPCH. In a normal writtn nglish txt for xampl th ltter
'' appars th most. If w wr abl to comprss a normal txt 
using th Huffman-mthod w would sav a lot of diskspac.
---------------------------------------------------------------
While some words are still easy read, others have become
totally senseless. 

All we have to do is count all normal letters, sort them
by their frequency and apply the Huffman-algorithm to the
table. Then we would use this tree to encode our data
enew and - voila. There we are.

But...

Yes, Watson?

In your last chapter (Intro) you mentioned that BOTH, the
sender AND the receiver must have the same MODEL of data
(de)coding for to understand each other. If we don't 
transmit the Huffman-tree with the data, how does the 
other program on the other side know our tree?

Good question, Watson. It can't!!! Yes, if the receiver
of the message has no knowledge of the data-specific
Huffman-tree all he will see is total garbage (and most 
probably a GPF will follow). 
The receiver MUST use the same tree. That means, that, 
either, one has communicated/transmitted the tree on 
a second way or one uses a more general Huffman-tree, 
which is of course not optimized for the specific file 
we have transmitted. A third way will be explained now.

In the early days of the C64 you could tell that a program
used a Huffman-like tree when you recognized a block consisting
of all 256 possible chars, sorted in a strange way in the 
beginning of the file. That meant that the BASIS for the
complete tree (all 256 chars in the sorted order) was transmitted WITHIN 
the crunched file (which of course was now the crunched size + 256 Bytes ;)

The BASIS?
Yes, the basis.


Hm, i have a little problem...

What is it, Watson?

I think i got the theoretical aspect. But: how do i programm this
in reality? And what is this basis, you are talking about?


All right. 
Well, we have to do with trees, you know. And the main part about
trees is the link to the other parts of the tree. When you want
to programm trees, you better get accomplished with languages 
supporting pointers. 

A typical C/C++ struct would look like this:

struct Tree
{
    Tree* zero;		//pointer to struct for zeros
    Tree* one;		//pointer to struct for ones
    long  value;	//value of the leaf
    long  sum;		//when getting linked and 
                        //becoming a knot here the sum, else 0.
    char  symbol;       //my symbol
};

You should build a tree consisting of 258 entries, with entry
257 as special EOF-signal and entry 258 as dummy for later
services.

One of the most important steps of the alg is the counting
of the bytes. With this the whole system stands or falls.
We also have to consider the DEcoding part. We can't transmit
1024 bytes, just because ONE character has to be encoded with
10 bits, leaving 500 bytes completely zero. 
And always think of it: Coder and DEcoder MUST use the same
model or else...GPF.

So, to ensure that both use the same model, the process with
the smaller data entry dictates how the coder has to work.
We decide that a table of 256 bytes, transmitted with the 
crunched file is enough overhead. What is in these 256
bytes, you ask? It's simple: It's the frequencies of the
symbols scaled down to 8 bits. Why?

Well, the general problem is: How do coder and decoder know
that, for example, the symbol 'y' is to be encoded with 10
bits and the symbol 'e' with 6 bits?
The best way is to let the coder and the decoder BOTH build 
up a tree. When this happens, we can be sure, that both use
the same model and everybody is happy ("ha- vannagila, 
havannagila, havannagila..." :-).
The only thing that both, the coder and the decoder have in
common is the frequency of the symbols. So the only thing
we can transmit are the frequencies. And to save space, we
just scale them down to 8 bit. Beware of having a symbol
with the frequency zero. It will never be encoded or decoded.
One good way of scaling down the table is the following:

Counting, which symbol appeared the most and put it into maxcounter
if (maxcounter == 0) maxcounter++;
maxcounter /= 255;
maxcounter++;
in a loop divide all entries by maxcounter
(if an entry, which had a positive value before and now has
been zeroed - move a 1 to it).

for example:

the maxcounter is 32767;
maxcounter = 32767 / 255 = 128;
macounter++ = 129;
freq[0] = 1234;
freq[1] = 23456;
freq[2] = 12;

freq[0] = 1234 / 129 = 9
freq[1] = 23456 / 129 = 181
freq[2] = 12 / 129 = 0; must be made 1;


So if we transmit the scaled down frequencies with the decoder,
all the decoder has to do is create the Huffman-tree from the
frequencies and start decoding the inputstream.
Yes. That means the both, coder and decoder use the same
routines. If you can reverse the algorithm of the decoder
you know at least half of the coding algorithm. In the huffman
case, you'll know ALL the important stuff. This behaviour will
be found in every decrunching routine. To decrunch something
the decruncher has - at least partly - reverse the steps that
the cruncher did. Step successfully thru a decruncher and you
have - with a little phantasy - the crunch-algorithm (at least
the theoretical aspect of it) reversed. I never found a cruncher
where this was not the case, so i suspect that all packers have
this weak spot. Weak, because a lot of crunching alg are packaged.
That means, that after some data a new cycle of crunched data 
begins. If you manage to isolate a single (best hint: in the
last part of the file) cycle, you can study the alg 
while decrunching just about 10-20 bytes. Good, eh?




These are some steps which should give you the general idea of 
creating a Huffman-tree:
- Build up a table consisting of 256 longs.
- Count up the bytes you want to crunch (the whole file for example)
  where you count up the frequency of all the bytes in your
  source. As there are only 256 possibilities, there are no probs.
- Scale the frequency down to 8 bit.

- Build up a second array consisting of 256 chars. Fill them
  with the chars 0...255. You will have the char 0 in entry [0],
  char 1 in entry [1], the char 'A' in entry[0x41] and so on.
- Sort the frequency table, but when you switch the values,
  do also switch the values in the second array, holding the
  chars. With that you'll create a sorted model of your input
  data.

- After sorting, proceed as follows:
   - create an array of 257 entries of type Tree.
     (If you have another service ready, use 258).
   - fill the .value of each entry with the frequency of the
     symbol. Fill the .symbol with the entry of the symbol char
     array. Fill the .zero and .one with NULL to mark them
     as leafes. This will seperate them from the knots where
     there will be the adresses of your next branches/leafes.
     fill .value of entry[256] (the 257th) with 1 as you will
     only one EOF, right?
   - recursively build up the tree. Don't forget, that you
     may have to add a last knot to link the last two partial-trees
     together. One way to do this:
     - Have a counter set to 257. 
     - repeat:
     - take the least two entries.
     - add up their value.
     - create a new entry of type Tree.
     - link the two entries to the new tree.
     - give the .sum of the new entry the added value
     - delete the two entries from the list (NOT FROM THE MEMORY) and add the new one.
     - reduce the counter by 1
     - resort the trees with criteria .sum
     - while counter &gt; 1
   - create a new array with the struct: char symbol, long bitsvalue, long number_of_bits_to_be_written
   - recurse thru the tree to get to every char to fill up the new array. 
     For every char you reached fill up the entries for symbol, bitsvalue and number_of_bits_to_be_written
   - nearly finished. 
   - Your encoding array is ready. All you have to do now is to read a char from the input
     and write the corresponding bitvalue to the outputstream with the number of bits,
     given from the array-entry. Send the EOF at last and you are done.

For decoding, the process is similar:

Create the tree. (thats the similar part)

unsigned char symbol = 0x00;
startknot = knot(0) //(of type Tree)
knot = startknot    //(of type Tree)

while (symbol != EOF)
   clear symbol.
   while (not symbol)
      
      get bit
      if ( (bit == 0) && (knot->zero != NULL) )
         knot = knot->zero
      else 
         if (knot->one != NULL) ) knot = knot->one

      if (knot.one == NULL) //is enough. knot.zero is NULL, too
         //symbol found. great. To the output with it
         symbol = knot.symbol
      end if
    end while   
    Do_Outpur_Char(symbol);
end while

Done. 


         
Hm, i have another little problem...

What is it, Watson?


I did as you told me. Took a table of 256 longs, counted the 256 chars,
sorted them and let the computer calculate an optimized Huffman-tree.
But all i got was a tree with all leaves having a length of 8 - all chars
are encoded with 8 bits and there is no crunching in that. What happened?

Ah, Dr. Watson,
you did not remember my sentence about Entropy. This file you examined
had all bytes nearly equally spread all over the length of the file.
So -statisticalwise- the file is equalized. No surprises here. With 
a Huffman-tree, which considers the whole file you won't get any 
crunching here, i fear.

But what do i do now?

Well, there are three scenarios that will satisfy your desire:
- We use a different algorithm
- We use a brutal tree
- We use an adapting technique

??? Tell me about the brutal tree.

Ok, i got this one from the 1001 Packer from the C64 (Anyone ringing a 
bell? 1001 Crew? No? Where are the old days gone to...)
They used a tree i just can label 'brutal tree'. Here's the idea:
When we have the case that we have data that is so equal that no
Huffman-tree will help us, we help us ourself. We take all the
Bytecounters and sort them. Then we create a table of the 256 chars
ordered by the sorted table, so that the still most frequent
chars appear on the top. Now we have the 256 possible bytes sorted.
So far so good.
Lets think about a byte. How do we read a byte? Isn't it:

#33 = $21 = %0010 0001  ?

What, if we we would change our view of the binary to a 2 + 6:

#33 = $21 = %00 100001

Our 256 chars would now be represented as 4 (00, 01, 10, 11) blocks
of 6 bits. What if we now 'huffman' these first two bits to:

0
10
110
111

So that we would have %0 100001 instead of %00 100001. Every byte that
is in the first 64Byteblock is coded with 7 bits, while the others
are coded either with 8 or with 9 bits. We can only hope that there
are enough bytes in the file to outweigh the two 9bit-chars. But it is
amazing how this little trick works. And the speed. It's so easy to
implement it and it is so fast. Even on the C64 it took only fractals of
a second to decode a programm as big as the main memory area (other 
packers took several seconds for the same size).


Wow, cool. But what about your different algorithms 
and this 'adapting technique' ?


Well, this is another story and will be told in the next chapter...




I hope you enjoyed this chapter. 
There will be more - i promise.
Just have a little patience.

Greetings from a programmer

Joa
</prE>
<center><hr size=3><p>In the meantime, after having read Joa's work above, you may 
enjoy a look at a <a href="sources/huf.c" tppabs="http://members.xoom.com/tsehp_/sources/huf.c" >huffer</a> and a <a href="sources/unhuf.c" tppabs="http://members.xoom.com/tsehp_/sources/unhuf.c" >unhuffer</a>, both 
written in C some time a go, and donated to the world, by Shaun Case... once you are done 
studying it, may be you'll want to have a look also at <a href="sources/sixpack.c" tppabs="http://members.xoom.com/tsehp_/sources/sixpack.c" >sixpack</a> another 
more advanced (adaptive Huffman encoding) compresser, written in C as well, by Philip Gage, 
for a data compression competition some time ago... since this code includes SIX different 
algorhitms, I believe it could be useful for readers as 'passage' to the next part of Joa's essay 
 (if Joa doesn't agree with me I'll kill these links of course).
<hr size=3><a href="mailto:JoKo2000@hotmail.com">
<IMG SRC="images/tellme.gif" tppabs="http://members.xoom.com/tsehp_/images/tellme.gif" width="140" height="21"></a>
<br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
 <br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A> 
 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER></center>
<HR SIZE=2>

</body>
</html>


<html>
<head>
<title>pape</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to crack CuteFtp 1.8 (32 bit version)<br>
(The hidden file algorhitm protection)</h2><h4><i>by +RCG</i></h4>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page of reverse engineering</center>
<hr size="2">
<pre>
	First of all I want to express my sincerely gratitude to +ORC, 
without his help I would never have been capable to write this document, 
and to +his students too, for their great pages and dedication, giving 
us all the info we need to learn.
	Secondly , my mother tongue is not english, so I am sure this 
document has a lot of grammatical and spelling mistakes. I made a great 
effort writing this in English, so please think about it and bear with 
me reading it.
	There are some kind of programs that check if you are a registered 
owner looking for a file more or less hidden in some place of your hard 
drive, then, if the program find that file, it makes some manipulations 
with the file data and then check if it is in correct place,or the 
checksum is correct, or many others things.
	Obviously, crack this protection is a hard work, and completely 
different to the other type of crack we have learned yet.
	Personally, I like much more &quot;trying&quot; to crack this protection 
type than the typical &quot;test eax,eax&quot; after a &quot;call Is_Correct?&quot;, because 
the programmer has lost more time protecting his program (usually 
splendid programs, like CuteFtp) than the other people that makes a 
program, who tell you what is the time is L.A. and ask 20$ for it, and 
protects the programs asking you for a number (could even be the date 
he began to go out with his girlfriend) and comparing it to your answer.
--------------------------------------------------------------

	Well,  lets go with our main purpose, &quot;learn&quot;.
	Normal Steps to crack this protection are:
	1) Stop the program went it opens the file, how?
	bpx CreateFileA (the last push is the pointer to the 
				     asciiz &quot;filename&quot;)
		
	Usually  programs makes the comparision to know if it exists:
		.
		.
		push	offset lpszFileName
		call	CreateFileA
		cmp 	eax,-1
		je	Unregisted_Version
		mov	offset File_Handle,eax	;Saves the file_handle
		.
		.

Let´s create a file with a few bytes with the name of &quot;reginfo.dat&quot;, 
for example with this bytes:

		2B  52 43 47 50  50  50 50  50  50 (10 bytes)
		+   R  C  G   P   P   P  P   P  P			 

	2) Stop the program when it reads the file, how?
		bpx ReadFile

 	Usually programs read the file using this funtion (not always), 
for example it can check the file lenght using the SetFilePointer 
funtion, or the date or the attributes, before reading it, stopping 
if some of these values are wrong.
	Take care for Dos Interrupts use, old Win3.x programs can use 
them to read files. 
	.
	.
	push 	offset Buffer  ;Here is where the funtion will left the data
	push	[File_Handle]
	call	ReadFile
	test	eax,eax
	jnz	No_errors
	.
	.

	3) Stop the program when it manipulates the file data, how?
	bpr ds:offset Buffer ds:offset Buffer+6 R (for example)

	Now, when SoftIce pops up, follow the data until they're left 
in a correct place and the manipulation begins. In the case of CuteFtp, 
there is only one intermediate movement before its final position. 
(look for a &quot;repz movsd&quot; ar &quot;repz movsb&quot;), in the CuteFtp case it 
is as follows:

137:00432F14		MOV	EDI,[ESP+10]	;Destination
137:00432F18		MOV	ESI,[EBX]		;Source
137:00432F1A		SUB	ESP,EDX
137:00432F1C		REPZ	MOVSD			;Desplacement
137:00432F1E		MOV	ECX,EAX
137:00432F20		AND	ECX,03
137:00432F23		REPZ 	MOVSB			;if any byte alone
		
	Now,
		 bpr ds:di ds:di+6 R
	 And you will pop up in the middle of the manipulation routine.

	4) Study the manipulation until you were capable of generate 
a valid file, how?
		It depens on your habitity, there are no rules. Look 
at this code fragment.
	
:00416430 81EC00010000            	sub esp, 00000100
:00416436 833DD04C470000          	cmp dword ptr [00474CD0], 0
:0041643D 53                   	push ebx
:0041643E 56                   	push esi
:0041643F 57                   	push edi
:00416440 55                   	push ebp
:00416441 7439                 	je 0041647C
:00416443 8B942414010000         	mov edx, [esp + esp + 00000114]
:0041644A 85D2                 	test edx, edx
:0041644C 7424                 	je 00416472
:0041644E BFE8514700              	mov edi, 004751E8
:00416453 B9FFFFFFFF              	mov ecx, FFFFFFFF
:00416458 2BC0                 	sub eax, eax
:0041645A F2                   	repnz
:0041645B AE                   	scasb
:0041645C F7D1                 	not ecx
:0041645E 2BF9                 	sub edi, ecx
:00416460 8BC1                 	mov eax, ecx
:00416462 C1E902                  	shr ecx, 02
:00416465 8BF7                 	mov esi, edi
:00416467 8BFA                 	mov edi, edx
:00416469 F3                   	repz
:0041646A A5                   	movsd
:0041646B 8BC8                 	mov ecx, eax
:0041646D 83E103                  	and ecx, 00000003
:00416470 F3                   	repz
:00416471 A4                   	movsb
:00416472 B801000000              	mov eax, 00000001
:00416477 E94B010000              	jmp 004165C7
:0041647C 8D442414                	lea eax, [esp + esp + 14]
:00416480 68FA000000              	push 000000FA
:00416485 50                   	push eax
:00416486 8B4960                  	mov ecx, [ecx+60]
:00416489 51                   	push ecx
:0041648A FF1534CA4700            	call GetModuleFileNameA
:00416490 8D7C2414                	lea edi, [esp + esp + 14]
:00416494 B9FFFFFFFF              	mov ecx, FFFFFFFF
:00416499 2BC0                    	sub eax, eax
:0041649B F2                      	repnz
:0041649C AE                     	scasb
:0041649D F7D1                    	not ecx
:0041649F 8D440C13                	lea eax, [esp + ecx + 13]
:004164A3 80385C                  	cmp byte ptr [eax], 5C
:004164A6 7406                    	je 004164AE
:004164A8 48                      	dec eax
:004164A9 80385C                  	cmp byte ptr [eax], 5C
:004164AC 75FA                    	jne 004164A8
:004164AE BFDC514700              	mov edi, 004751DC
:004164B3 B9FFFFFFFF              	mov ecx, FFFFFFFF
:004164B8 C6400100                	mov [eax+01], 00
:004164BC 2BC0                    	sub eax, eax
:004164BE F2                      	repnz
:004164BF AE                      	scasb
:004164C0 F7D1                    	not ecx
:004164C2 2BF9                    	sub edi, ecx
:004164C4 8BD1                    	mov edx, ecx
:004164C6 8BF7                mov esi, edi&nbsp;;String(&quot;reginfo.dat&quot;)
:004164C8 B9FFFFFFFF          mov ecx, FFFFFFFF
:004164CD 8D7C2414            lea edi, [esp + esp + 14]&nbsp;;Destination
:004164D1 2BC0                     sub eax, eax
:004164D3 F2                      	repnz
:004164D4 AE                      	scasb
:004164D5 4F                      	dec edi
:004164D6 8BCA                    	mov ecx, edx
:004164D8 C1E902                  	shr ecx, 02
:004164DB F3                      	repz
:004164DC A5                      	movsd
:004164DD 8BCA                    	mov ecx, edx
:004164DF 68D8514700              	push 004751D8
:004164E4 83E103                  	and ecx, 00000003
:004164E7 F3                      	repz
:004164E8 A4                      	movsb
:004164E9 8D442418                	lea eax, [esp + esp + 18]
:004164ED 50                 push eax	;Complete name with path
:004164EE E83DCB0100         call 00433030	;ReadFile
:004164F3 83C408                  	add esp, 00000008
:004164F6 8BF8                    	mov edi, eax
:004164F8 85FF               test edi, edi	;Is something wrong?
:004164FA 0F84C5000000       je 004165C5	;Bad Guy
:00416500 8D442414                	lea eax, [esp + esp + 14]
:00416504 57                      	push edi
:00416505 68FA000000              	push 000000FA
:0041650A 6A01                    	push 00000001
:0041650C 50                      	push eax
:0041650D E84EC90100         call 00432E60&nbsp; ;Check for file lenght
:00416512 83C410                  	add esp, 00000010
:00416515 8BF0               mov esi, eax   ;esi=file lenght
:00416517 57                      	push edi
:00416518 E8A3C80100              	call 00432DC0		
:0041651D 83C404                  	add esp, 00000004	
:00416520 83FE04             cmp esi, 00000004	;Is less than 4?
:00416523 0F8C9C000000       jl 004165C5		;Bad Guy

	** Look at the file data structure:(try to find it out 
by your own)
	? represents one byte.

	???????... 	  ?? 	      ??
	name		seed 	checksum	
	
	[esp+12] points to the fisrt character of the file.
	esi is the lenght, so: 
	[esp+esi+12] is the last word of the file (the CheckSum) 
	[esp+esi+10] is the first seed used 

:00416529 0FBF443412             movsx word ptr eax,[esp+esi+12] 
:0041652E 0FBF7C3410             movsx word ptr edi, [esp + esi + 10]
:00416533 83EE02                 sub esi, 00000002
:00416536 89442410               mov [esp + esp + 10], eax
:0041653A 8D46FF                 lea eax, [esi-01]
:0041653D 83EE02                 sub esi, 00000002
:00416540 50                     push eax
:00416541 33DB                   xor ebx, ebx   ;Clear CheckSum value
:00416543 E802D10200             call 0044364A
:00416548 83C404                 add esp, 00000004
:0041654B 8BE8                   mov ebp, eax
:0041654D 57                     push edi
:0041654E E82DC80100             call 00432D80
:00416553 83C404                 add esp, 00000004
:00416556 33FF                   xor edi, edi	;edi=0
:00416558 85F6                   test esi, esi	;Is esi&gt;0
:0041655A 7E19                   jle 00416575		

***This part of code is the most important.
	At this point the registers have:		
					edi=0
					esi=lenght of the file less 4.
					ss:[esp+edi+13] = &quot;+RCGPPPPPP&quot;

:0041655C 47                  inc edi
:0041655D E82EC80100          call Get_Next_Number&nbsp;;Get next number
:00416562 8A4C3C13            mov cl , [esp + edi + 13]
:00416566 32C8                xor cl , al 				
:00416568 0FBEC1              movsx byte ptr eax, ecx
:0041656B 03D8                add ebx,eax&nbsp;  ;Add to checksum number
:0041656D 884C3DFF            mov [ebp+edi-01],cl&nbsp;;Decrypted byte
:00416571 3BFE                cmp edi, esi	;Is finished?
:00416573 7CE7                jl 0041655C		;No, continue
:00416575 C644350000          mov [ebp+esi+00],00 ;Write end stringz
:0041657A 3B5C2410            cmp ebx,[esp+esp+10]&nbsp;;Is checksum ok?
:0041657E 753C                jne 004165BC	   ;Bad Guy

	**We can crack this program putting 2 NOP'S at the previous 
line and writing a few (lets say 5) junk bytes to &quot;reginfo.dat&quot; file.

:00416580 8B942414010000          	mov edx, [esp + esp + 00000114]
:00416587 85D2                    	test edx, edx		
:00416589 7421                    	je 004165AC	
:0041658B 8BFD                    	mov edi, ebp		
:0041658D B9FFFFFFFF              	mov ecx, FFFFFFFF
:00416592 2BC0                    	sub eax, eax
:00416594 F2                      	repnz
:00416595 AE                      	scasb
:00416596 F7D1                    	not ecx
:00416598 2BF9                    	sub edi, ecx
:0041659A 8BC1                    	mov eax, ecx
:0041659C C1E902                  	shr ecx, 02
:0041659F 8BF7                    	mov esi, edi
:004165A1 8BFA                    	mov edi, edx
:004165A3 F3                      	repz
:004165A4 A5                      	movsd
:004165A5 8BC8                    	mov ecx, eax
:004165A7 83E103                  	and ecx, 00000003
:004165AA F3                      	repz
:004165AB A4                      	movsb
:004165AC 55                      	push ebp
:004165AD E8CAD00200              	call 0044367C
:004165B2 83C404                  	add esp, 00000004
:004165B5 B801000000              	mov eax, 00000001 ;Good Guy
:004165BA EB0B                    	jmp 004165C7		
:004165BC 55                      	push ebp
:004165BD E8BAD00200              	call 0044367C
:004165C2 83C404                  	add esp, 00000004
:004165C5 33C0                    	xor eax, eax	;Bad Guy
:004165C7 5D                     	pop ebp
:004165C8 5F                     	pop edi
:004165C9 5E                     	pop esi
:004165CA 5B                     	pop ebx
:004165CB 81C400010000            	add esp, 00000100
:004165D1 C20400                  	ret 0004


Get_Next_Number PROC

:00432D90 E85B4D0000         call 00437AF0			
:00432D95 8B4814             mov ecx, [eax+14]	;Get previous seed
:00432D98 8BD1               mov edx, ecx
:00432D9A 8D0C89             lea ecx, [ecx + 4*ecx]
:00432D9D 8D0C89             lea ecx, [ecx + 4*ecx]
:00432DA0 03CA               add ecx, edx
:00432DA2 8D0CCA             lea ecx, [edx + 8*ecx]
:00432DA5 C1E108             shl ecx, 08
:00432DA8 2BCA               sub ecx, edx
:00432DAA 8D8C8AC39E2600     lea ecx, [edx + 4*ecx + 00269EC3]
:00432DB1 894814             mov [eax+14], ecx	  ;Saves next seed
:00432DB4 8BC1               mov eax, ecx
:00432DB6 250000FF7F         and eax, 7FFF0000
:00432DBB C1E810             shr eax, 10		;Only high word
:00432DBE C3                 ret


	Study it and you will see that the return value is:
	Next_Seed=Previous_Seed*0x343FD+0x269EC3
	Return_Value is:
	HighWord (Next_Seed-0x8000000);

	5) Now, that we understant the code, and we can make a 
correct &quot;reginfo.dat&quot; file.
		Lets take &quot;12&quot; as seed.	
		1,2 in ascii are 0x31,0x32
	First Seed is then 0x3231 (Remember bytes are low first 
and high second)
	1st Value Returned:
(0x3231*0x343FD+0x269EC3)=0xA40E0C30 (Next_Seed)
				  0xA40E0C30-0x8000000=0x240E0C30 
				  HighWord is 0x240E
	2nd Value Returned:
(0xA40E0C30*0x343FD+0x269EC3)=0x(217BB)F3C93A33
				  Now, only use the first 8 digits
				  0xF3C93A33-0x80000000=0x73C93A33
				  HighWord is 0x73C9
	3rd Value Returned:	0x46D9
	4th Value Returned: 	0x6513

	Now, you know that the low byte is xored with the file 
encrypted name, so if I want the program registered to +RCG, 
the encrypted values are:

	+ = 0x2B	==&gt; 0x2B=XOR(0x0E, ??) ==&gt; ??=0x25
	R = 0x52	==&gt; 0x52=XOR(0xC9, ??) ==&gt; ??=0x9B
	C = 0x43	==&gt; 0x43=XOR(0xD9, ??) ==&gt; ??=0x9A
	R = 0x47	==&gt; 0x47=XOR(0x13, ??) ==&gt; ??=0x54

	The checksum is (0x2B+0x52+0x43+0x47)=0x0107
	And seed used was &quot;12&quot; = 0x3132

	So our &quot;reginfo.dat&quot; file must contain the next 
bytes (remember that checksum bytes are inverted in a 
comparation, so we must invert them):

	25 9B 9A 54 31 32 07 01

That's it folk

(c) +Rcg 1997
</pre>
<br>

<br>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>


<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>donjo2.htm: Cracked Metal, runtime dll creation</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22"  WIDTH= "100%">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">Cracked Metal, runtime dll creation</fonT><br>
        <FONT SIZE="+1">How to crack HoTMetaL Pro 4 Evaluation</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm"><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" ALT="student" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Programmers</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
4 February 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Fallen
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td>
</tr>
<TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering ~ very 
slightly edited</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<pre> </prE></center></td>
</TR>
<tr><td><font color="#C4C0CF">fra_00E1<bR>980204<br>Fallen<br>1100<br>PC<br>XX<br></fonT></td><td><i><center>
<!-- Your truly+ will probably comment -->
Well, from what Fallen writes it seems that our protectionists friends are 
finally beginning to learn some (elementary) aspects of code protection, i.e. 
DO NOT give immediate signs that the protection has discovered that somebody 
is cracking it... as Fallen 
writes:</i></center><prE>when I ran the program everything worked fine until I 
tried to create a new document or load an existing HTML document. 
It would <u>THEN</u> give me a message about a corrupted rules file</prE><i><center>Nice! 
of course even this sort of messages is not necessary (if you are SURE that someone is 
fiddling with your code and that no poor luser is just trying to install your crappy 
software, that is, which you can only be sure if you are not programming in overbloated 
languages, that is :-) 
and anyway we can easily zen-crack all 
these schemes nevertheless in two minutes flat, yet it's a good sort of feeling to constate  
that at least some protectionists are listening and delivering us something more 
palatable (like a run-time encrypted dll-creation) than the usual boring flag_good_guy 
dinosaurier that still rule the earth :-(<br><br>
Bravo Hotmetal... that's the right way... only, s'il vous plaît, may be a little better implemented 
next time.<bR>Enjoy!
</i></center></td>
<td>
</td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
A very interesting protection scheme about an encrypted file used to 
create a DLL at runtime
<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
Cracked Metal, runtime dll creation
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
Cracking HoTMetaL Pro 4 Evaluation Version
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
Fallen
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
I fully agree with reverser+ that HTML should be written using a simple 
text editor.
I downloaded this target solely for cracking purposes and was quite 
pleased with it as 
a target.
I found the protection scheme both simple and interesting at the same 
time.  I feel 
that this was one of my more fun cracks!
<br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
SoftICE (of course.)<br>
BoundsChecker (Not necessary, but it was helpful.)<br>
Hex Workshop (or any other hex editor.)
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
Web Site: <a href="http://www.sq.com/" >http://www.sq.com</a> <br>
FTP Site: <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >http://ftp4.softquad.com</a> <br>
It took me numerous tries to get the complete application.  Keep trying. 
I also <br>
suggest getting the files by way of the web site.  I can't remember the 
path to <br>
the zip files and the FTP site will not allow access to directory lists.
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table>
I encountered HoTMetaL Lite a couple of years ago and decided to see how 
it had <br>
progressed since then.  I haven't much in the way of history... sorry.
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<prE>
I'm still new to cracking, and this is my first attempt at an essay, so 
forgive me if I seem a little bad at it.  I have cracked numerous DOS and 
Windows programs, a lot of them I was able to locate a password in memory,
and I've done a few Nag screen/Time Trial schemes also.  
This one however, I found very interesting, and fun!

<B>PART 1: </B>
When you first run HoTMetaL Pro you will see a message box saying 
something about file date inconsistencies, after this there will be 
a Dialog Box that will not allow you to close it for an agonizing 
amount of time. Then it will run the program.

Well, first lets find out where this NAG screen comes from.  
Once the OK button became enabled I popped into S-ICE and checked 
the window handle list.  
I placed a breakpoint on that handle for the message wm_destroy:

BMSG <I>Handle_you_ll_get_on_your_own_machine</I> WM_DESTROY

Now get back out of S-ICE and hit the OK button. 
You should pop into S-ICE somewhere in USER, if I remember right, now 
disable the breakpoints and press F12 a few times until you end up 
in a DLL that the name begins with EFY???? where the four question 
marks represent four numbers. This is where our protection scheme 
lies, but don't get excited, it's not that simple.
 
The first time I tried to crack this, I removed the call to this 
DLL and eliminated the Time Protection, Nag Screen and a MessageBox 
that pops up about file date inconsistencies all at once. 
However, when I ran the program everything worked fine until I 
tried to create a new document or load an existing HTML document. 
It would then give me a message about a corrupted rules file. 
So back to the cracking board.
 
If you search your hard drive for a matching DLL you will find that it 
exists in the system temp directory, usually C:\WINDOWS\TEMP, and that 
the four numbers at the end change every time you run the program. 

Hmmm... this could be a problem, nah not really.
 
I came to the obvious conclusion that this DLL was created by HMPRO4.EXE 
every time the program was run. Now to figure out how to alter the code 
it writes. For this I used BoundsChecker to find out how it creates the 
file. I tried using SmartCheck at first but for some reason it would 
crash every time I tried to run it in SmartCheck, so I used BoundsChecker.
 
I loaded it up in BoundsChecker and watched for the function CreateFile. 
I'm not going to get specific about BoundsChecker, but I found the portion 
of code where it created the DLL and looked above that for the ReadFile 
function. 
I found that it loaded it's information from a file named ASDFLKJH.IUY this 
is disguised to look like a temporary file, but it's not.

After examining this file you will see that this file is the DLL in an 
encrypted format.
So our problem lies here. How do we decrypt it, crack it, and re-encrypt 
it. No need, a simpler way exists.
 
The method I used of locating these functions in SoftICE may seem 
lengthy, but I wasn't having any luck using the addresses I retrieved 
from BoundsChecker. 
The first thing I did was set a breakpoint on LoadLibrary. I could see 
from my BoundsChecker listing that this was the first DLL that HMPRO4.EXE 
loads so of course we need to break on the first LoadLibrary and look at 
the code above it to see what we need.  

This is what I ended up with:

:00422A37 push 006309C8 - This address holds the name of the DLL to load

* Reference To: KERNEL32.LoadLibraryA, Ord:0021h
            |     
:00422A3C Call dword ptr cs:[0065032C] - and of course this loads it.
 
If you look up from this segment of code you will see this:

* StringData Ref from Data Obj ->"asdflkjh.iuy" - This is the name 
                                                  of the encrypted DLL.
            | 
:00422A0F mov edx, 005D537C 	- The address of the encrypted DLL filename.
... 				- Unimportant code. - Removed
:00422A27 call 004227E8 	- This call is shown below, it creates the 
                                  new DLL file.

The call from above ^.
:004227E8 			- Code to open the encrypted DLL, 
				  read it into memory and then 
				  close the handle.

:004228CE call 00411520 	- This call decrypts the file! 
				  This is what we need to eliminate for this crack.

Code to write the 
un-encrypted DLL to a file. 	- Removed

The point of the above section of the essay is to allow us to work with 
an unencrypted protection DLL. How? you may ask! Well, here's how we do it:

1. Run HoTMetaL Pro and let the Dialog Box pop up.
2. Make a copy of the efy????.dll file from you windows\temp directory 
   and place it in your HoTMetal Pro directory.
3. Rename it to the encrypted DLL file name, ASDFLKJH.IUY
4. Now patch HMPRO4.EXE at address 004228CE to eliminate the call that 
   decrypts the DLL. You choose your own method.

Well, I believe the point of this is self evident. 
We can now crack the file ASDFLKJH.IUY as a DLL and patch it accordingly.  
Since all of the protection scheme (ie. The messagebox about file date 
inconsistencies, Nag screen, and time protection) exist in ASDFLKJH.IUY,
that will be the target of the remainder of this essay.

<B>Part 2 </B>
The remainder of this crack is very simple.  
My first trip through, I patched the file ASDFLKJH.IUY in two places, 
once to eliminate the message box and Dialog Box, and another
to eliminate the time protection.  

However, writing of this essay, I found that if you apply the following 
patch, it eliminates both.
If you patch the time check call with this code:

:01D91BC6 XOR EAX,EAX
:01D91BC8 RET

It will prevent the program from exiting after March 1, 1998 and will 
also eliminate the messagebox and DialogBox Nag screens.
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
I found this program a lot of fun to crack and also learned something 
very useful during
the process of writing this essay.  I re-installed the software and as I 
went through the
cracking process, I entered my steps into the essay without applying the 
patches to the 
executable.  During this process I was able to eliminate one of the 
patches as I mentioned
above.<br><bR>

MORAL:  Document your cracks and you may learn an easier or more 
efficient way to crack them. This can also be useful, later, if you 
happen to find 
something interesting for the +HCU, btw.<br>
Also, pay attention to the code and you'll see a lot of things you may miss if 
you don't!
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table>
 <center>
   <i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a longer 
   period than the allowed one. Should you want 
   to STEAL this software instead, you don't need to crack its protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged, farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->


<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm"><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Programmer's corner</FonT>
<br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML><html>
<head>
<title>MemMonitor95 Standard Edition 4.0  and its ThunkConnect32 relations</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">MemMonitor95 Standard 4.0  and its ThunkConnect32 relations</font>
<br>(Half-crippled program / Unhiding an hidden window / Thunk vagaries)
<h2>by <font color="#5500AA">FootSteps</font></h2>
(24 November 1997, slightly edited by reverser+)</h4>
<!--<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/tough.gif" ALT="our protections" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><Font color= gray>Our protections</fonT>-->
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<hr>       
<i>Well, thunking (thunking up, thunking down, thunkconnect...) was about time to have a 
look at these thunks, don't you believe? Besides there is some 'intuition and luck' in this essay 
and, moreover, I like quite a lot little jewels like the following one:
</center></i><pre><font color="purple">bpx CreateWindowExA do &quot;dd *((ss:esp)+8)
     With that, each CreateWindowExA hooked by Winnie will show us the second
     parameter we need : lpClassName in the data window.</font></pre><i><center>
This kind of info is, IMHO, what makes an essay valuable for us: the targets 
are completely irrelevant... but the knowledge... Ahh, the knowledge... I could 
carry on drinking more and more of it, sitting here and awaiting a slow dawn that 
still hides inside the heavy clouds of november...
</i></center><hr size="6"><pre>
MemMonitor95 Standard Edition 4.0  and its ThunkConnect32 relations 
Half-crippled program / Hidden window / Thunked.
================================================

You'll need :

MemMonitor 95 Standard Trial 4.0 from Prudens <a href="http://www.spywindows.com/" >http://www.spywindows.com/</a>
MemMonitor 95 Professional Trial from Prudens <a href="http://www.spywindows.com/" >ibidem</a>
Winnie 3.01 to 3.22 (everywhere on the web)
BRW 4.5 to 5.2      (everywhere on the web)
Winsight 5.x        (everywhere with BC++5)
WDasm32 8.x         (everywhere on the web, use 8.9)
IDA 3.7             (everywhere on the web, don't miss it)
Windoze95           (everywhere on your HD)

Once upon a time I was cracking some interesting tools of the trade, the 
Prudens's trial toolz, (see below for a quick easy reversing snippet about 
ExeSpy95 and ComSpy95), when I found in the third one, <font color="blue">MemMonitor95</font>, 
a different protection scheme from the two others.
I thought at first: &quot;oh, no... back to trace&quot;, but I was happy: it was 
a good thing: I was beginning to bore myself without challenges.

Running the program, memmon95.exe, I was awaiting like with Exespy95 or
ComSpy95 a &quot;sympathic&quot; nag with something like 'Enter the drive where 
your registration key file is' (with these kind of nags sharewares you 
know immediately that the target is reversed! :-) but... here there was 
no sympathic nag.
Instead, a enormous bitmapped screen nag, with a irritating 'unregistered
user', and a very frustrating 'Not all hooks are available in this version'. 
Followed by a classic MessageBox with program presentation and bazaar.

In spite of my irritation, I played a little with memmon95.exe, you know 
we must always spy all the hints of the targets: where are placed on screen 
words like  'unregistered', when the NagMessageBoxes happen, what functions 
are disabled, etc...
This memmon95.exe is a nice tool, a little better than TechFacts to follow 
memory heap calls, because it show you these in real time (with TechFacts you 
must refresh).

I did not have to wait long in order to have my awaited nagscreen: I clicked 
on a Heap captured valor, and bingo! a nag with 
'This function is restricted to... etc, etc...'
I just thought: ha ha ha!, Gotcha! I will fire Winnie, put a classic
bpx MessageBoxA, press some F12 key, and land in a JZ opcode.

Yes, you can try. Fire Winnie. Bpx MessageBoxA. Click on the ListBox 
which makes the nag appear. 
You land obviously in User32!MessageboxA section.
But Press F12. Just once, go ahead.
You see where you land?
Yes, you land in the terrible <font color="red">Kernel32!ThunkConnect32</font>!
Like quicksand! Aaargh!
You can continue to press the F12 key. But you will sink more and more!
Press it 12 times, and you'll land inside... nothing! The darkest codewoods!
Because we have lost hand of Winnie's trace and we sprang back to Windows' 
normal execution...

Well, I jumped on the Win32 SDK. 
What the hell is this ThunkConnect32 API anyway? 
You won't find it in the SDK. You'll find it in the help files:
Windows's developer guide (Borland C++) or in the Microsoft Programmer's
guide to Windows 95 (Borland C++ Builder, M$VC++, and others compilers...).
If you want more information, you've only got a ridiculous article on it 
in the M$ Knowledge Base, and a serious one inside the 'guru' Schulmann's 
book 'Unauthorized Windoze95'. My! You would never believe HOW MUCH 
undocumented is this whole windoze bazaar!

It was the first time I met this API following our paths. 
In fact 'Thunking' is the relation between 32bits and 16bits applications, 
either executables or DLL.
And WindoZ95 makes indeed an overbloated use of that, especially with the 
User32 to the old User interface... You know, W95 swap all time from 32 
to 16bits, from 16bits to 32... Seems sometimes that Windows95 is in fact 
the worse monstrous shareware ever programmed... :-)

So, why could we not get the hand back to Winnie, after this thunk? Who knows?
First, probably because of the MeMonitor95 hooks. You see, MemMonitor hooks
when running some 16/32bits API like GlobalAlloc and GlobalRealloc for example,
ensuring to catch some old WindoZ31 applications, then calls ThunkConnect to
switch from 32bits OS to 16bits.
Second, probably too, because after the nagscreen, and after the ThunkConnect32
Kernel section, the system goes back in the WndProc of the program, more
exactly inside the switch(message) loop. 
Then, we intercept one, which displayed the nag, and the program is now waiting 
some other ones (for example, when you click on some functions of the program). 
Like it is waiting, and not running.
Winnie sleeps. Try, after landing in Kernel!ThunkConnect32, to press F12 a
little times: you will not land inside User32... you'll dwell inside the 'old' 
16bits User!WaitMessage boring loops.

Since I couldn't trace anymore, I disassembled memmon95.exe with W32Dasm.
Well, I found quickly the right MessageBoxA references looking for
'this function is restricted...'. 
Yes, actually several references.
And looking closer to the dead-listing, it seems that that nag happens when
you click on some interesting function : A nag when you want to print, a nag 
when you want to heap process click, a nag when you want to save...
<u>When you want to save?</u> Hey, that isn't at all inside the buttons of 
the trial version!
It was time for a deeper examination of this thunked executable with BRW.

I fired therefore the heavy artillery: Borland Resource Workshop. 
More exactly, with version 5, run your compiler and open memmon95.exe using 
edit resources as a viewer.
And a lot of interesting things should appear in front of your child'eyes:
The enormous bitmap which serves as nag intro.
A registration window.
A registration window?? Well, then...
But wait... you better wait before crying victory. 
Something was terribly wrong.
Yes, I know something was wrong because I already spyed the OTHER 
executable (cracked below), ExeSpy95. 
And ExeSpy95 got TWO NagBitmapScreens.
And the file we study, memmon95.exe, has only ONE NagBitmapScreen. 
A big one with  the sad message 'No hooks are available' printed on it.
ExeSpy95 had the same, AND another one, without any inscriptions, the 
good one, the one we want: the registered one.
Perhaps memmon95 could then paint over these words with a FillRect() or 
some other graphic tricks in order to cover the bitmap when registered? 
No, Let's not be ridiculous... :-)

At this point, I had big doubts about cracking this target. 
Seems that it was a &quot;really crippled&quot; trial version... and that 
there were nothing to do.
But I continued a little. You know, for the fun, never give up!
And I fired Winsight, the window spy utility of the Borland C++.
And looked closer, once more, to my &quot;MEMMON95&quot; DialogBox.
Mmm, I verified all of my target, all the buttons, the ListBoxes, the
EditBoxes...
Suddenly, I jumped! 
In the Winsight detail, a second main window &quot;MEMMON95&quot; appeared!
Open it : you can remark all other child windows: a StatusBar one, a TBar one,
a Client one...
But all have the &quot;hidden&quot; attribute. This is why we just see the DialogBox.
I got an idea and looked at the readme.1st file that come with this appz 
(This is what I should have done from the beginning...)
There are two version of MemMonitor : the standard (we're studying)
and the Professional. I read :
<font color="purple">
STANDARD vs PROFESSIONAL (for Windows 95)
=========================================
The Professional Edition provides some advanced features:
  1. a view/log window is provided that displays captured calls
     - you can print the log
     - you can save the log to a file
  2. a setting window is provided that you can disable those APIs you are not
     interested
</font>
Well, the Pro version provides a view/log window? 
And what about the hidden window which lurk when we run the standard 
MemMonitor?
I then immediately wanted to un-hide this window. 
But it is not possible to change attributes when an application is 
running.
By the way, (<- I've written a BTW ;-), I did not want to intercept pushes. Then, I shut down memmon95.exe, quit my monitor, and sat down in front of a TRUE window looking the world outside... and started thinking... and fall quickly in complex metaphysics paths, all of that, you know, hidden windows, the life, computers, god, etc... my thoughts went about finding one day some 'Moskovskaja' vodka in the shops... I was even thinking that I would have never becomed a mighty +old red cracker, and that I would have remained a minable +young capitalist lamer... :-))) I stop my madness short before thinking of eventually buying this soft! Go back to the computer and look at the CreateWindow procedure : HWND CreateWindowEx( DWORD dwExStyle, // extended window style LPCTSTR lpClassName, // address of registered class name LPCTSTR lpWindowName, // address of window name DWORD dwStyle, // window style int x, // horizontal position of window int y, // vertical position of window int nWidth, // window width int nHeight, // window height HWND hWndParent, // handle of parent or owner window HMENU hMenu, // handle of menu, or child-window identifier HINSTANCE hInstance, // handle of application instance LPVOID lpParam // address of window-creation data ); We are not interested by the new dwExstyle of the window to be created but by the old dwStyle which must have the WS_VISIBLE style (Remark with Winsight that all non-hidden windows have the 'visible' attribute. Then we must ad this style to the hidden 'MEMMON95', the overlapped one. You'll remark, if you double-click in Winsight on the hidden overlapped 'MEMMON95' window, that window style is hex : 06CF0000 How will we know which one is the good window? There's a lot of CreateWindowEx in memmon95.exe. Fire Winnie. We know that we need the 'MEMMON95' class window, and we know that function parameters are passed on stack before the call. Then : bpx CreateWindowExA do "dd *((ss:esp)+8)" With that, each CreateWindowExA hooked by Winnie will show us the second parameter we need : lpClassName in the data window. Then, run memmon95.exe. We will break in : 4010E7 : MemmonScreen ; the NagBitmap 402131 : Memmon95 ; HERE! 40451C : TBAR_MEMMON95 404599 : STATUS_MEMMON95 ... (lot others) 4107B5 : Memmonptctls ; the main DialogBox ...(lot others) Well, the good call of the hidden overlapped window is at 402131. Look at the dead listing : :0040204A C745F80000CF06 mov [ebp-08], 06CF0000 ; here is stocked the dwStyle. ... ... :00402127 50 push eax :00402128 8B4D08 mov ecx, dword ptr [ebp+08] ; get up the dwStyle. :0040212B 8B5110 mov edx, dword ptr [ecx+10] ; :0040212E 52 push edx :0040212F 6A00 push 00000000 :00402131 FF15F0E64100 Call USER32.CreateWindowExA ; our hidden window. You see that dwStyle is initialized a little above. Remember, 06CF0000, we have seen inside Winsight. We need to add the WS_VISIBLE style. In WindoZ programming, when you add styles, messages and a lot of others parameters, for example, if you want a window which is maximized and overlapped, you'll write : WS_OVERLAPPED | WS_MAXIMIZED In our case, we want to add WS_VISIBLE to 06CF0000. Then, research your *.h include windoZ file for the hex valor of WS_VISIBLE. You quickly find, in winuser.h, the following association : #define WS_VISIBLE 0x10000000L Calculate then 06CF0000 | 10000000="16CF0000" All right. Let's go change this :0040204A C745F80000CF06 mov [ebp-08], 06CF0000 with :0040204A C745F80000CF16 mov [ebp-08], 16CF0000 And fire MemMonitor95, awaiting a pretty and marvelous new unhidden window... But... Instead of a magnifying new window, we got here a splendid new OS Windows 95 MessageBox with the sad 'General Protection Fault'... At this point of cracking too, I had desired to get up ; to throw my computer by the window and to go on hollydays at Katmandu with a bicycle, flowers in the mouth ; to exchange my big Pentium with a old good zx81 ; to work for Micro$oft... :-))) But I finally cutted the rope attached at the ceiling and wrapped round my neck coz I thought : hey, stop. There's always two others calls after a CreateWindow : ShowWindow() and UpdateWindow() ; after that, the created window is finally displayed on the screen. Why 16CF0000 did a bug 'GPF' ? I don't know. Not the first time I do this. Perhaps a hidden checking protection scheme well hidden? Well let's search dead listing for the ShowWindow calls. Mmm... To many. Then, we we'll use a good Winnie breakpoint as above. Run Winsight. Open the hidden overlapped window and look at the handle. I've got 43C ; sure you got something else, but write it. If you closed memmon95.exe, put a breakpoint on the creation we seen above : :00402131 FF15F0E64100 Call USER32.CreateWindowExA Step over with F10 and note the value placed in eax. This is the handle. (You can get too the handle using HWND with Softice). Then, CTRL-D, and enter the following breakpoint : bpx User32!ShowWindow if (*((ss:esp)+4)="=" 43C) Replace obviously 43C with you window's handle. Hit F5 to run. F12 to return. You'll break two times : :004025AB 6A01 push 00000001 ; nCmdShow :004025AD 8B4508 mov eax, dword ptr [ebp+08] :004025B0 50 push eax :004025B1 FF15C8E64100 Call USER32.ShowWindow ; hwnd and in : :00410756 6A00 push 00000000 ; nCmdShow :00410758 8B4DFC mov ecx, dword ptr [ebp-04] :0041075B 51 push ecx :0041075C FF15C8E64100 Call USER32.ShowWindow ; hwnd The first break is the ShowWindow called immediately after the window creation. The second update the window when program is running. BOOL ShowWindow( HWND hwnd, // handle of window int nCmdShow // show state of window ); Remark in the first break, the 00000001 argument for nCmdShow. If you look at the winuser.h, you'll remark that this stand for SW_SHOWNORMAL argument. More interesting is the second break, with nCmdShow="0," because 0 is the SW_HIDE parameter! Then change : :00410756 6A00 push 00000000 ; WS_HIDE with :00410756 6A03 push 00000003 ; WS_MAXIMIZE What about a new un-hidden and maximized window? :-) Run memmon95.exe and... Yeah! A new un-hidden maximized window! And a lot of other things : You can change all your memory hook settings, you can copy, you can clear, you can save, you can print... Err... No, you can't print anything at all. Because no hook-text are displayed on this new and beautiful but useless window. I can assure you I've search the code. I breakpointed the TextOutA, which land only in part where time is TextOuted and the boring 'Unregistered version' are flashing. There were nevertheless a lot of 'ExTextOutA' which seem to me useless in the prog. Useless? Not sure... Then, I've cracked (myself, not the program yet :-), and I've downloaded the MemMonitor Professional 4.0 Trial version. And proceded to a lot of comparison. First, the Pro version had the pretty window un-hidden. And, if you verify the dwStyle, it has right the 16CF0000 style... (?) Bizarre... What about the GPF? Second, the hooked API are well displayed on this pretty window. Then, I looked at the size of the files, to compare. That is here that I think, in regard of a lesson which +ORC has promised yet never released: 'Intuition and Luck' and that it seems to me that finally it is us that we are writing it on Reverser's site... look, three files comes with these sharewares: Smidgeon.vxd (same size for each), fhk95.dll (same size) and mem95dll.dll (42Ko) for standard version and mem95pro.dll (47Ko) for Pro version. A stupid idea came into my mind: try to replace the standard mem95dll.dll with the pro one, mem95pro.dll (bigger of 2Ko, I recall you). I awaited an monstruous "GPF of death" running the program with this new DLL and my funny idea, when... look! I cry Victory!, the API hooked were now displayed on the ex-hidden window in standard MemMonitor95. If you breakpoint now ExtTextOutA, you will land in memmon95.exe. Seems that the Pro DLL enable other functions in the program, a thing which makes me even more sure that the program is really a crippled one. Intuition and luck! The following was the less interesting: You can't save in this disabled target, and you can't print more than one line. You remark that you've got a nagscreen when you use these crippled functions. Then, let's go for the easy and classic one : bpx MessageBoxA. Choose Save. Hit F12 to go back. You land in : :00408CA6 E895E8FFFF call 00407540 ; you return here :00408CAB 85C0 test eax, eax :00408CAD 0F84F1010000 je 00408EA4 ; no error? :00408CB3 833D74AC410000 cmp dword ptr [0041AC74], 00000000 ; HERE! :00408CBA 7537 jne 00408CF3 ; jmp if good guy :00408CBC 8D85B4FDFFFF lea eax, dword ptr [ebp+FFFFFDB4] ; bad, prepare nag :00408CC2 50 push eax :00408CC3 8D8D74FCFFFF lea ecx, dword ptr [ebp+FFFFFC74] :00408CC9 51 push ecx :00408CCA 8B55FC mov edx, dword ptr [ebp-04] :00408CCD 52 push edx :00408CCE E8E8FDFFFF call 00408ABB :00408CD3 6830300000 push 00003030 :00408CD8 8D85B4FDFFFF lea eax, dword ptr [ebp+FFFFFDB4] :00408CDE 50 push eax :00408CDF 8D8D74FCFFFF lea ecx, dword ptr [ebp+FFFFFC74] :00408CE5 51 push ecx :00408CE6 6A00 push 00000000 :00408CE8 FF1554E64100 Call USER32.MessageBoxA ;nagscreen :00408CEE E9B1010000 jmp 00408EA4 * Referenced by Good Guy Jump at Address:00408CBA(C) | :00408CF3 6A00 push 00000000 :00408CF5 8D95F8FEFFFF lea edx, dword ptr [ebp+FFFFFEF8] :00408CFB 52 push edx :00408CFC FF15E4E44100 Call KERNEL32._lcreat ;beginning of writing file Well, you remark this JNZ 00408CF3 at 00408CBA, which go to the good code. And just before, the cmp dword ptr [0041AC74], 00000000. Well, search the dead-listing for [0041AC74]. You'll find 4 there are not some cmp, but some mov. We need, because of the JNZ, that [0041AC74] contain not 0. Then change the two following lines : :004077E9 C70574AC410000000000 mov dword ptr [0041AC74], 00000000 and : :00407E2B C70574AC410000000000 mov dword ptr [0041AC74], 00000000 with some mov dword ptr [0041AC74], 1 Now, you can print, you can save all your API hooks! Remark that it's even better that in the Pro trial, because none of the API choose are grayed in our un-crippled Standard settings! Finally for the fun, the two nagstrings which come before the application : Replace :004010E7 FF15F0E64100 Call CreateWindowExA with three 'inc eax, dec eax', to avoid the first NagBitmapScreen with his big delay. and replace : :004082A4 FF1554E64100 Call MessageBoxA with the same opcodes. Now, you've got a full unregistered MemMonitor95 Standard version, which work even better than a full registered one! At end, I don't say that this program CANNOT be registered with making a good *.INI file. It was much interressant to reverse it in order to have MORE functions than registering the standard one when making a INImaker. <hr><font color="blue"><font size="+1">Little digression about reversing MemMonitor95 with IDA 3.7 and W32Dasm8.9
</font></font>
There's a lot of the memmon95.exe code which would be interesting to see,
but let's just take one example: when you click on the 'Heap captured for the
process' ListBox. You remember, we've got a pretty nag then, with 'this 
function is...'

Well, I first reverse memmon95.exe with W32Dasm8.9. 
You find quickly that the nag is at :

:0040C1FD E96D050000              jmp 0040C76F                  ; a jmp here???
:0040C202 8B4510                  mov eax, dword ptr [ebp+10]   ; begin of the proc.
:0040C205 C1E810                  shr eax, 10
:0040C208 25FFFF0000              and eax, 0000FFFF
:0040C20D 25FFFF0000              and eax, 0000FFFF
:0040C212 83F801                  cmp eax, 00000001
:0040C215 7534                    jne 0040C24B
:0040C217 8D8D50FDFFFF            lea ecx, dword ptr [ebp+FFFFFD50]
:0040C21D 51                      push ecx
:0040C21E 8D9510FCFFFF            lea edx, dword ptr [ebp+FFFFFC10]
:0040C224 52                      push edx
:0040C225 A1CCAE4100              mov eax, dword ptr [0041AECC]
:0040C22A 50                      push eax
:0040C22B E88BC8FFFF              call 00408ABB
:0040C230 6830300000              push 00003030
:0040C235 8D8D50FDFFFF            lea ecx, dword ptr [ebp+FFFFFD50]
:0040C23B 51                      push ecx
:0040C23C 8D9510FCFFFF            lea edx, dword ptr [ebp+FFFFFC10]
:0040C242 52                      push edx
:0040C243 6A00                    push 00000000
:0040C245 FF1554E64100            Call USER32.MessageBoxA         ; nagscreen

If you put a breakpoint on the 'begin of the proc' location I've marked,
and clicking on it in MemMonitor95, SoftIce will obviously break in 40C202.
But look what's above this 40C202 :
:0040C1FD E96D050000              jmp 0040C76F
What? A jmp? Then how could we land at the line just after?
Code self modifying? No, scroll a little in Winnie when reaching this
breakpoint,
you see that above the 40C202, the jmp is right here.
Then?
Then, as we learned, never believe what you see. 
What is faked here is that W32Dasm hasn't put its<font color="blue"> 
* Referenced by a (U)nconditional or (C)onditional Jump at Addresses...</font>
as usual.
Then I thought : well, this is the procedure of the ListBox item of the
memmon95.exe. Perhaps the program change it when running with some API like
'SetProcAdress'. But there wasn't some of that. Then I lost a mad time to
search... 
To understand what's going on very quickly: let's reverse memmon95.exe with IDA.
You got at the same location :

40C1FDF         jmp     loc_40C76F      ; a jmp here?
; -----------------------------------------------------------------------
loc_40C202:				; CODE XREF: .text:0040BECFu  ; HERE!
					; DATA XREF: .text:0040C7B0o
		mov	eax, [ebp+10h]
		shr	eax, 10h
                ...
		call	ds:MessageBoxA  ; nagscreen

And you see, IDA has correctly reversed (and found) the caller at 0040BECF.
The DATA XREF: .text:0040C7B0 point to the different locations called
by this ListBox procedure :

off_40C7AC	dd offset loc_40BEFA	; DATA XREF: .text:0040BECFr
		dd offset loc_40C202    ; HERE is the one we study!
		dd offset loc_40C250
		dd offset loc_40C3FB
		dd offset loc_40C491
		dd offset loc_40C76F

We are in the 'Call Relocation Table', by the way (<- :-) a great <a href="frarul1.htm" tppabs="http://members.xoom.com/tsehp_/frarul1.htm">essay</a> 
from reverser+, read it!
Well, let's go to the caller, from our 40C202 location I repeat here :
loc_40C202:				; CODE XREF: .text:0040BECFu  ; HERE!
					; DATA XREF: .text:0040C7B0o
		mov	eax, [ebp+10h]

We land in :

40BECF          jmp      ds:off_40C7AC[edx*4]

This jmp choose the right procedure to jmp in regard of the edx valor.
IDA is a little boring coz it is DOS based and not very comfortable to 
use when debugging WindoZ programs. The interface is a little old and 
less comfortable to use than W32Dasm... but IDA 3.7 EXPLODES, literally, 
poor W32Dasm 8.9!
I was a little suspicious, at the beginning... I am not any more. No
wonder IDA has been chosen as the +HCU 'official' disassembler!
It is indeed very strong for us 'reversers' that we can, dead-listing, 
see an 'indexed-based reference' starting from a complex 
jmp ds:off_40C7AC[edx*4]!

Bravo Ilfak! Let's now wait the same approach (windozed) from PJ Urbanik...
<hr><font color="blue">Little snippet about others Prudens' targets: ExeSpy95 4.41 and ComSpy95 4.41 :
</font>
First, install ExeSpy95. 
Deadlist it:

Replace the
:004078B1 FF151C064200            Call USER32.DialogBoxParamA
which is the dialogBox asking you to choose the drive where is 
your registered file by :
:004078B1 E941060000              jmp 00407EF7
This jmp will register you, but now:
:00407F25 FF150C064200            Call USER32.MessageBoxA
which is the Nag saying you that you've got '0 days left'... 
with three 'inc eax ; dec eax'.

Same boring protection scheme with ComSpy95.
If these tools of the trades interest you.
Cya.

--FootSteps.</pre>
<font color="green">(c) <font color="#5500AA">FootSteps </font> All rights reversed</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!--<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm">Our Protections</A>            <hr width=33%>-->

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>

<HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>fp_dong1.htm : Dongle Bashing ~ End of the dongle old aera ~ first part</TITLE>
</HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22"  WIDTH= "100%">
<TR><td></td>
<td>
<center><FONT SIZE="+2">Dongle Bashing</fonT><br>
        <FONT SIZE="+1">End of the dongle old aera ~ Dongles bye bye</fonT><br>(re-uploade version October 1998)<bR>
<br><a href="fp_dong1.htm#firstpart">first part</a> ~ <a href="fp_dong2.htm" tppabs="http://members.xoom.com/tsehp_/fp_dong2.htm" >second part</a><bR>
"How a single +HCU reverser can easily blow a whole commercial sector out 
of history"

</center>
</td>
<td>
<center><a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm"><IMG SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" ALT="advanced" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Advanced</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
29 January 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>
by 
<font size=+3>
Frog's print
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm" ><IMG SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a></td>
</tr>
<TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0"
VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<prE> </prE></center></td>
</TR>
<tr><td></td><td><i><center>
Oh my... the dongle old aera is finished. Out.<bR>
That's it, nothing more to add...  let's hope we get a new dongle aera to work on.<br>
Awesome essay. Frog's Print's incredible work should be printed (44 pages !) 
and sipped slowly, it's 
'cracking for conoisseurs'... reverser's vintage 1998 "grand reserve"!<br>Bye bye to all 
those that wanted to do some quick bucks selling hardware protections that 
were NOT protections at all. This is good, nobody will mourn the disappearing of 
smoke-sellers and bogus protectors.  Bye bye to all those that never 
cared to study assembly. This is good.  
Bye bye to all the creations of the poor programmers that 
blindly trusted commercial (and THEREFORE bogus) dongle 
protections to defend their valuable software instead of writing 
their own much more solide protections. Tsch Tsch.<br>
You had better read +ORC's students essays first... next time. 
And learn. And now don't come to the silly idea to blame Frog's Print...  
blame those dilettantes that have sold you smoke. Blame yourself. A little 
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a> would have done you 
some good, probably. Well, one never ends learning, does one? I would 
never have believed myself that (almost) all implementations of the 
dongle protections scheme were so 
stupid. Oh my, how low, how deep have the programmers fallen, since Micro$oft introduced its 
frilly-dizzy rattamazz operating system :-)<bR>Of course anyone of my readers 
could now just 'go shopping' and download, fetch or get hundred thousand 
dongle protected software programs, each one of them -incidentally- 
extremely expensive. DO NOT DO IT. You'll only stuff your already exploding harddisks to 
death for <u>nothing</u> and bore yourself to death.<br> See, you don't 
need to do it: that poor   
software won't disappear, nor it will go away. It will always be there. It wont 
be dongle protected any more after this, oh no, no, no :-)<bR> Yet, probably 
it will be as poorly 
protected as before by some other charlatans, smoke-selling some other 'infallible' protection 
scheme... people never learn. Unless they study. That's why you are here, my good reader, 
to master a difficult but POWERFUL art: reversing.<bR>
So don't steal the software that Frog's Print has now stripped naked. Look at those 
protection schemes, pathetically whining and sobbing under Frog's streng and mighty 
reversing blick. They wont be ever able to run away, the poor scared things.<bR> 
Of course -as it happens- this essay could be useful AGAINST THEFT.. for our 
underfunded public universities for instance, where 
(as I very well know) hardware dongles are regularly and phisycally stolen from their 
parallel ports (it's difficult to find a way to fest them there and students don't 
show any respect for public property any more, having being corrupted by the 'sacrality' of 
private gains and property)... so this 
essay may be a good reading, for all colleagues in the public sector, in order to protect 
against stupid vandalic theft their legally bought software 
as well :-)<bR>See: +crackers bring solutions for the good ones and ruin for the evil ones :-)
</i></center></td>
<td><center>
Also in:<br><bR>
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm" ><IMG SRC="images/project3.gif" tppabs="http://members.xoom.com/tsehp_/images/project3.gif" ALT="+dongles" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Dongles</fonT><br><br>


<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm" ><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" ALT="+progcor" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Programmers<bR>Corner</fonT><br><br>

</center>
</td>
</tr>
<TR><td></td>
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> (x)<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- CORPUS  -->
<bR>
<a name="firstpart"></a>
<I>This essay covers 14 dongle
protected softs: they <FONT COLOR="#000000">ALL can be FREELY DOWNLOADED
from their respective companies home pages / sites (see links below).</FONT></I>
<center><hr size=1>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont proabbly be changed) -->
Dongle Bashing
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
End of the dongle old aera ~ Dongles bye bye
   </FONT><BR>

<FONT SIZE="+1">"How a single +HCU reverser can easily blow a whole commercial sector out 
of history"</fonT><br><bR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->
Written by Frog's Print
   </FONT>
</center>
<!-- INTRODUCTION STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT></fonT></center><bR>
</td></tr></table>


<TT>Due to the huge Dongle/Security advertisement
campaign overrunning the Net those days (may be the biggest ever), mostly
from Aladdin (Hasp) and Rainbow Technologies (Sentinel), I decided to start
a first approach on this kind of protection.</TT>&nbsp;
<BR><TT>For this, I needed Dongle programs.&nbsp;</TT>&nbsp;
<BR><TT>-Q: Where the hell could we find Dongle protected softs??&nbsp;</TT>&nbsp;
<BR><TT>-A: On the Net!</TT>&nbsp;
<BR><TT>Yes, on the Net and for FREE. It's just like sharewares: you download
them, sometimes as the fully working update/new version or as a demo you
can test, and, if you send money to the author, you get a dongle instead
of a password.</TT>&nbsp;
<BR><TT>I fetched 14 of them, all different kind :</TT>&nbsp;
<BR><TT>From Hasp, Sentinel, DesKEY, Activator/Unikey to 'home-made' dongles,
simple or not, cheap or very expensive softs, small or overbloated, useless
or useful, running under Windows 32bit, 16bit or DOS, cracked them using
Live approach, Dead Listing or Zen cracking : every one to his taste!&nbsp;</TT>&nbsp;
<BR><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>After that, I can already give you my conclusion:&nbsp;</TT>&nbsp;
<BR><TT>What a disappointment! Only one soft out of 14 had an interesting
protection (<A HREF="fp_dong1.htm#Micro Cap">MicroCap V</A>). So, dongles appear to
be a good "ready_to_use" protection but <B><U>they are NOT</U></B>. They
are as much complicated to program as they are to crack (sometimes even
more). If you are a programmer and want to use a dongle to protect your
soft, you must understand that you need to have real strong knowledge about
protection and programming. Otherwise just forget it (and you'll save money).&nbsp;</TT>&nbsp;
<BR>&nbsp;

<P><!-- PASTE HERE YOUR INTRODUCTION --><TT>So, Dongles could be a very
powerful and strong way to protect a soft...as long as the programmer willing
to utilize one knows how to use it. Unfortunately, most of them don't (note
that we are not talking about shareware programmers but professional guys!
) and are still using our "beloved" <I>Test eax,eax//jnz Bad_Guy</I> stupid
routine, thinking that they don't have to worry about the protection because
the dongle will take care of it (same old problem discussed so much often
here -: ). Some of them use ridiculous $5 shareware tricks to protect $4.000
professional softs (see <A HREF="fp_dong1.htm#Vision">Vision XXL</A>) and, worse, others
just forgot to read the Dongle documentation manual shipped with their
hardware key (see <A HREF="fp_dong1.htm#ABBCS31">ABBCS31</A>), you'll even find some
of the most amazingly stupid protections I can't find any words to describe
them (see <A HREF="fp_dong1.htm#read_and_forget">DigiSHOW</A>). Too bad...specially
when those programs are available for free download on the Net.&nbsp;</TT>&nbsp;

<P><TT>Sometimes it may be useful to know which dongle is needed for the
program you want to crack (Aladdin's Hasp, Rainbow Technologies' Sentinel,
Dinkey, Everlock...) or, <B>very important</B> if you plan to use SoftICE
and some Breakpoints, the type of dongle (parallel or serial key, internal
or PCMCIA card, Network dongle...), sometimes you won't even have to care
about that. And, finally, in just few cases, you may not be able to crack
a program if you don't have the right dongle (but if you have the dongle
why should you crack it? -: ) or because the program is strongly encrypted
and/or uses too many anti-debugger and anti-w32dasm/IDAPro protections
(usually, those anti-crackers protections are not written by the programer
himself :- ).&nbsp;</TT>&nbsp;
<BR><TT>For this, never forget to read carefully the program's doc or HLP
files, to visit it's company home page (specially the "installation help"
or "FAQ" pages) to collect the maximum infos about the dongle needed. You'll
find them most of the time, but sometimes you may only find that the program
needs a "green" or "red" dongle. So don't forget to monitor the program
installation on your Hard Drive : for all the programs of this essay, during
their installation I used CleanSweep, WinDelete and TechFacts, all 3 programs
running at the same time. Then check for new .Vxd, .Drv, .Sys and .Dll
files in you windows(/system) or the programs directories. Do the same
the first time you'll run the program because it may use/create and hide
a lot of "~x34_m-!.sys" or similar strange named files anywhere on your
HD. If you can identify the Dongle manufacturer, then visit its WWW/FTP
sites, newsgroups, read newspaper articles about it and visit programmers'
tools retailers companies sites like <A HREF="http://www.sosdevelopers.com/" >SOSdevelopers</A>
(if you can understand French), download their softs/demos (SOSdevelopers
<A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >download section</A>),
get their free catalogue where you'll find all products for programers
and the latest protections tools of the market (BTW, SOSdevelopers is probably
actually one of the rare place where you can still find SoftICE 3.01 and
all others Numega 14 days trial version products available for downloading
since Numaga lately removed their Download section from their WWW home
site -: ). And finally, if you plan to crack several dongle protected softs,
install and monitor the first one, crack it and then <B>delete</B> it before
installing the second one, third one... otherwise it'll be to messy and
complicated to monitor and crack.&nbsp;</TT>&nbsp;
<BR>&nbsp;

<P><TT>Here is now, for instance, some infos I found at <A HREF="http://www.aks.com/hasp" >Aladdin
SoftWares</A> (Hasp/NetHasp dongles). They wrote this to help programers
to write a "good" protection for their dongle (blue comments are mine of
course!):</TT>&nbsp;
<BR>
<HR SIZE=1 WIDTH="100%">
<BR><I><TT><FONT SIZE=+0>Tips and Tricks for Maximum Protection (from Aladdin
SoftWares)</FONT>&nbsp;</TT></I>&nbsp;

<P><I><TT>The golden rule of HASP-based software protection is that the
protection system is only as secure as the routines that call the key and
decide whether to allow execution of the protected program. In other words,&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>since the hardware of HASP keys is too complicated to break
or duplicate, <U>hackers will usually try to trace the protection code
and eliminate the protection routines</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Emulating the Dongle by re-writing its main
routine is much funnier than boring tracing and patching (and sometimes
a lot easier, specially the Hasp protection routine! )</FONT></TT><I>&nbsp;</I>&nbsp;
<BR><I><TT>While we supply you with the best hardware and software protection
tools available, and while the HASP Envelope can by itself provide an excellent
protection for application programs, if possible, <U>you should enhance
your protection system by implementing the Application Programming Interface
(API) as well</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">If only they knew how to do it...</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT>Please keep in mind that while no single technique can defeat
every hacker, the more traps and safeguards you use, the more difficult
it will be to break your software. In order to achieve maximum protection
with HASP, we suggest you implement at least some of the procedures outlined
below:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT><B>Issue as many calls as possible with many different Seed
Codes.</B>&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>The more calls and expected responses you use, <U>the more difficult
it will be to trace and remove them</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Boring yes, difficult not really.</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Perform logical divisions of the checking procedure.</B> Divide
the checking procedure, and if possible, spread it across your program
at far-away points.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>A logical division would be: calling, checking, and reacting
routines, each <U>situated in a different section of the program</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT><B>Hide parts of the checking code within a regular source code.</B>
For example, the calling routine can be <U>hidden within a general initialization
routine</U>.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Easy to find with a BPIO 278/378</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Use complicated mathematical expressions.</B> In order to
confuse hackers, check for the Return Codes <U>using complicated mathematical
expressions</U>. For example, if you are expecting a Return Code which
equals 26387, incorporate an expression such as the one below to perform
the check:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If (ReturnCode1 -
7)/4 = (ExpectedReturnCode1 - 6602)/3&nbsp; then...</TT>&nbsp;</I>&nbsp;
<BR><I><TT>To further enhance your level of security, follow the same procedure
throughout your software for any mathematical constants used in implementing
your HASP software protection solution.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Yes, and add a beautiful jnz_Bad_Guy at the
end...</FONT><I>&nbsp;</I></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Use delayed reactions.</B> Do not react immediately to a checking
call. For example,do not test for a certain value and then issue an error
message if you do not like the result. If you do, the hacker will easily
understand what you are doing.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>It is better to store the value in a variable A, check A's value
a few subroutine calls later, and set a new variable B to say whether or
not you like it. Several calls after that, test the value of B, and only
then issue the error message.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Force hackers to work backward to figure out how B got a certain
value and why the program fails because of that. The relation to the original
returned value should no longer be obvious.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">See above</FONT></TT><I>&nbsp;</I>&nbsp;

<P><I><TT><B>Perform check-sums.</B> Perform a check-sum on the program
to find out if it has been&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>tampered with. The most effective means to do this is with the
HASP Pro Kit.&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Otherwise, the simplest way to do so is to use the following
pattern:&nbsp;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Calculate check-sum.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Compare with correct
value.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; If the two do not
match,</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
issue an error message;</TT>&nbsp;</I>&nbsp;
<BR><I><TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
otherwise, continue.</TT>&nbsp;</I>&nbsp;
<BR><I><TT>Unfortunately, this technique is vulnerable to several attacks.</TT></I>&nbsp;
<BR><TT><FONT COLOR="#3333FF">Bad luck!</FONT><I>&nbsp;</I>&nbsp;</TT>&nbsp;
<BR><TT>etc,etc...&nbsp;</TT>&nbsp;
<BR>
<HR SIZE=1 WIDTH="100%">
<BR><TT>To crack a dongle, you must first locate the protection you'll
have to crack. Any means are good:</TT>&nbsp;
<BR><TT>-searching in the program or its DLLs the main dongle routine (I
wrote my own <I>haspfind.com</I>&nbsp; that search a directory for the
file where the Hasp routine is located).</TT>&nbsp;
<BR><TT>-Bpio with softICE. It will always work (as long as you don't forget
to install the driver and, most of the time, reboot to load it) but you
may easily get stuck/lost deep inside complex routines.</TT>&nbsp;
<BR><TT>-Since most programs will issue an error message ("Dongle not found"...)
you may just have to BPX the MessageBoxA functions or all other similar
ones and find the cross-references.</TT>&nbsp;
<BR><TT>-Disassembling the file to find some "Check_If_Dongle_OK" exported
functions.</TT>&nbsp;

<P><TT>After that, there are different ways to crack it:&nbsp;</TT>&nbsp;
<BR><TT>1/Reverse engineering the dongle protection main routine in order
to emulate the dongle (see <A HREF="fp_dong1.htm#ABBCS31">ABBCS31</A>).&nbsp;</TT>&nbsp;
<BR><TT>-This is very efficient specially if this routine is called dozens
or sometimes hundreds of times throughout the program (otherwise we would
have to patch all those cross-references!).&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>-With this method, you don't need to have the dongle driver loaded
(if you have 10 programs using different dongles, you'll need to have 10
different drivers always loaded).&nbsp;</TT>&nbsp;
<BR><TT>2/Patching some <I>Call</I>, <I>Test</I> or <I>jnz</I> instructions.&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>Not the most elegant method but useful if:&nbsp;</TT>&nbsp;
<BR><TT>-you don't know how the dongle protection routine works but you
quickly found the right <I>Bad_Guy </I>Flag.&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>-your program is to slow to start/run . Some overbloated EXE or
DLL will check for a dongle, dongle ID and Seed Code and, if they can't
find them, will check again and again before telling you that you don't
have the requested hardware key. For that reason, those programs may check
for the dongle for 15 or sometimes +30 seconds. This even happens sometimes
after you "emulated" the Dongle. A real waste of time! (see <A HREF="fp_dong1.htm#WellCAD">WellCAD</A>).&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>3/Brute force approach:&nbsp;</TT>&nbsp;
<BR><TT>Close to the above solution, this one may be quite useful for program
that may react strangely when they are modified. This method just force
them to work the way you want (see <A HREF="fp_dong1.htm#Ai Damage">Ai Damage</A>).</TT>&nbsp;
<BR><TT>4/You may use your own tips/findings like searching with Hiew the
bytes sequence 0xE900000000</TT>&nbsp;
<BR><TT>jmp Next_Instruction (see <A HREF="fp_dong1.htm#OmniMark">OmniMark</A>).</TT>&nbsp;

<P><TT>In this essay, we'll just assume that you are familiar with cracking
because I won't give a lot of comments about all usual protections routines/tricks...
that don't have anything to see with the dongle protection nor will I spend
time to explain how to crack it when it will be quite obvious (most of
the time).&nbsp;&nbsp;&nbsp;</TT>&nbsp;

<P><TT>As said above, all programs cracked in this essay can be found and
download on their companies homepages (see links below).&nbsp;&nbsp;&nbsp;</TT>&nbsp;
<BR><TT>You'll find plenty of dongle softs to download for free on the
Net. Just learn how to search and you'll see what I mean.</TT>&nbsp;
<PRE><TT>OK, now let's have some fun!</TT></PRE>

<!-- TOOLS REQUIRED STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT></fonT></center><bR>
</td></tr></table>


<P><B>Hiew 5.66</B>&nbsp;
<BR><B>SoftICE 3.22</B>&nbsp;
<BR><B>W32Dasm v6.x and W32Dasm8.5</B>&nbsp;
<BR><B>+IDA PRO v3.7</B>&nbsp;
<BR><B>A taste of Zen Cracking</B>&nbsp;
<!-- TARGET URL/FTP STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT></fonT></center><bR>
</td></tr></table>

<!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET -->
<B>Targets'
url:</B>&nbsp;

<P><B>1) Micro-Cap V </B>(Spectrum SoftWare) <B><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >v2.01</A></B>
900Kb&nbsp;
<BR><B>2) Vision XL/XXL <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm#Vision XL/XXL" >v2.0</A></B>
(Impuls)&nbsp; 9.5Mb&nbsp;
<BR><B>3) ABBCS31<A HREF="http://www.klinkmann.com/download.htm" > v1.02</A>&nbsp;</B>
Klinkmann Automation Softs (DDE Servers)&nbsp; 420Kb&nbsp;
<BR><B>4) WellCAD v2.30</B> : <A HREF="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Full" tppabs="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Full">Full
version</A>&nbsp; 10.5Mb or <A HREF="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Lite" tppabs="ftp://ftp.alt.lu/pub/wellcad2.30/Windows95/Release.Lite">Lite
version</A> 2.5Mb (similar but without help files and sample data files)&nbsp;
<BR><B>5) Label Craft <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >v6.01</A>
</B>(Axicon Softs)<B>&nbsp;</B> 1.2Mb&nbsp;
<BR><B>6) Ai Damage <A HREF="http://www.aitsuk.com/download.htm" >v1.4</A>
</B>(Ai Training Services Ltd)&nbsp; 185Kb (requires the DK2 DESkey dongle
drivers -dk2wn95.386, dk2win32.dll...- if not installed on your system,
you can download them here: <A HREF="ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers" tppabs="ftp://ftp.kcc.co.uk/pub/kcml/windk2drivers">Bdk2wn32.exe</A>
720Kb - read the essay for more infos-: )&nbsp;
<BR><B>7) Electro Chemistry <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >12
Nov.1997 version</A> </B>(Sycopel Scientific Ltd) 531Kb.&nbsp;
<BR><B>8) IPLab <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >v1.7</A></B>&nbsp;
(Signal Analytics Corp.) 1.5Mb&nbsp;
<BR><B>9) DigiSHOW.vld <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >v1.24</A></B>
1.59Mb&nbsp;
<BR><B>A) Axon Engineer Pro <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >v2.11e</A></B>
2.09Mb&nbsp;
<BR><B>B) FTI/DOE <A HREF="http://www.finite-tech.com/download.html" >v.2.3.1.4</A></B>
2.78Mb&nbsp;
<BR><B>C) S-Tagger for FrameMaker <A HREF="http://www.trados.com/prod/wbload.htm" >v2.0</A></B>
1.32Mb&nbsp;
<BR><B>D) XinTianMa <A HREF="http://www.cjkware.com/update.html" >C version</A>
</B>1.04Mb&nbsp;
<BR><B>E) OmniMark <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >V3R1a
Win95</A></B> 1.88Mb&nbsp;
<BR>&nbsp;</TD>
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT></fonT></center><bR>
</td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
unknown
except Micro-Cap V&nbsp; which used, in the past, the Sentinel dongle.
New version use the Hasp driver.

<!-- REAL ESSAY CORPUS STARTS HERE -->
<br><br>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT></center><bR>
</td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS! SHOULD NOT BLAST
     NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
<A NAME="Micro Cap"></A><B><U><FONT SIZE=+2>Micro-Cap
V v2.10</FONT></U></B>
<BR><B>-Description:</B>
<BR>Integrated schematic editor and mixed analog/digital simulator that
provides an interactive sketch and simulate environment for electronics
engineers.
<BR><B>-OS:</B>
<BR>Win95 / NT(?)
<BR><B>-Protection:</B>
<BR>Dongle (parallel). Driver: <I>Hasp95.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.
<BR>&nbsp;

<P><TT>Apparently, Micro-Cap V programmers are the only guys who understood
that the dongle will not do all the job. They tried to add some improvements
to the protection scheme:</TT>
<BR><TT>-Fake flags (Bad or Good_Guy).</TT>
<BR><TT>-Several flags hidden at different locations (using different registers).</TT>
<BR><TT>-Delayed reactions (calling, checking and reacting routines).</TT>
<BR><TT>-Mathematical expressions for checking the RetCodes (though they
could improve this part).</TT>
<BR><TT>-Several calls with different Seed Codes.</TT>
<BR><TT>...</TT>

<P><TT>This is the first Hasp dongle of this essay. I hope you read Zafer's
essay about the various hasp-dongle services because I will not explain
this again. However, I will show you the main Hasp routine from Micro-Cap
as it is just a little different from the one describe by Zafer, but it
works just the same:</TT>

<P><TT>:0054141A 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebp</TT>
<BR><TT>:0054141B 89E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ebp, esp</TT>
<BR><TT>:0054141D 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pushad</TT>
<BR><TT>:0054141E 88C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov bh, al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service called</FONT></TT>
<BR><TT>:00541420 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edx</TT>
<BR><TT>:00541421 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop eax</TT>
<BR><TT>:00541422 8B5508&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edx, dword
ptr [ebp+08]</TT>
<BR><TT>:00541425 8B750C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+0C]</TT>
<BR><TT>:00541428 8B3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edi, dword ptr [esi]</TT>
<BR><TT>:0054142A 80FF32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp bh, 32</TT>
<BR><TT>:0054142D 7205&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jb 00541434</TT>
<BR><TT>:0054142F 8B7518&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+18]</TT>
<BR><TT>:00541432 8B06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esi]</TT>
<BR><TT>:00541434 8B7510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov esi, dword
ptr [ebp+10]</TT>
<BR><TT>:00541437 8B36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, dword ptr [esi]</TT>
<BR><TT>:00541439 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ebp</TT>
<BR><TT>:0054143A E8B1D00000&nbsp;&nbsp; call 0054E4F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Haspreg</FONT></TT>
<BR><TT>:0054143F 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00541440 8B7D0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+0C]</TT>
<BR><TT>:00541443 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], eax&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>:00541445 8B7D10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+10]</TT>
<BR><TT>:00541448 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], ebx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>:0054144A 8B7D14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+14]</TT>
<BR><TT>:0054144D 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], ecx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>:0054144F 8B7D18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov edi, dword
ptr [ebp+18]</TT>
<BR><TT>:00541452 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [edi], edx&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>:00541454 61&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
popad</TT>
<BR><TT>:00541455 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00541456 C21400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ret 0014</TT>
<BR>&nbsp;

<P><TT>We will rewrite this routine in order to emulate the dongle because
there will be too may occurences to patch in this soft.</TT>

<P><TT>Running Micro-Cap will display the message box: '<I>Security Key
missing. Replace the key</I>'.</TT>
<BR><TT>With SoftICE, Bpx the above routine and run Micro-Cap.</TT>

<P><TT><U>The first break occures here</U>:</TT>

<P><TT>:00422C39 B801000000&nbsp;&nbsp; mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#1</FONT></TT>
<BR><TT>...</TT>
<BR><TT>:00422C5B E8BAE71100&nbsp;&nbsp; call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; IsHasp</FONT></TT>
<BR><TT>:00422C60 8B45F0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov eax, dword
ptr [ebp-10]&nbsp;&nbsp; <FONT COLOR="#3333FF">; Store RetCode1 in EAX</FONT></TT>
<BR><TT>:00422C63 89EC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esp, ebp</TT>
<BR><TT>:00422C65 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</TT>
<BR><TT>:00422C66 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</TT>
<BR><TT>:00422C67 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</TT>
<BR><TT>:00422C68 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00422C69 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>The caller:</TT>
<BR><TT>:00422AEC E82F010000&nbsp;&nbsp; call 00422C20</TT>
<BR><TT>:00422AF1 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check if OK</FONT></TT>
<BR><TT>:00422AF3 752D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy jump</FONT></TT>

<P><TT><FONT COLOR="#000000">Of course, the RetCode1 should be equal to
1.</FONT></TT>

<P><TT><FONT COLOR="#000000"><U>The second break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422E8D B805000000&nbsp;&nbsp; mov eax,
00000005</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#5</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E92 89542414&nbsp;&nbsp;&nbsp;&nbsp;
mov dword ptr [esp+14], edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E96 E87FE51100&nbsp;&nbsp; call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; HaspStatus</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E9B 8B442408&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esp+08]&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Parallel Port # (RetCode3)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E9F 8B7C2404&nbsp;&nbsp;&nbsp;&nbsp;
mov edi, dword ptr [esp+04]&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Type of Hasp (Retcode2)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EA3 A37CF65500&nbsp;&nbsp; mov dword
ptr [0055F67C], eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EA8 83FF01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp edi, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Is it a Memo-Hasp?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EAB 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422EBA</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EAD B8FCFFFFFF&nbsp;&nbsp; mov eax,
FFFFFFFC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB2 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB5 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB6 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB7 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB8 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EB9 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>
<BR><TT><FONT COLOR="#000000">* Referenced by a (C)onditional Jump at Address:00422EAB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBA 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBC 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EBF 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC0 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC1 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC2 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422EC3 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>

<P><TT><FONT COLOR="#000000">No surprises yet: after checking if there
is a Hasp dongle connected, it checks its type (Memo-Hasp). It doesn't
care if it is a Memo-Hasp-1 or a Memo-Hasp-4 as Retcode1 is not verified.</FONT></TT>
<BR>Both

<P><TT><FONT COLOR="#000000"><U>The 3rd break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422C0E B802000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000002</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#2</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C13 E802E81100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; HaspCode</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C18 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C19 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1A 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1B C20400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret 0004</FONT></TT>

<P><TT><FONT COLOR="#000000">The caller:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B5B E864000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422BC4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B60 8B1424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov edx, dword ptr [esp]&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Store RetCode1 in Edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B63 81EACA190000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sub edx, 000019CA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Edx-0x19CA</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B69 B905000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, 00000005</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B6E 89D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Store in Eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B70 C1FA1F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sar edx, 1F</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B73 F7F9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
idiv ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Eax/5 and store result in Eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B75 3D982D0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00002D98&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Is it correct?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B7A 7405&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422B81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; jmp over if OK</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B7C BE01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Set Bad_Guy#1 Flag discreetly so that stupid</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; crackers will never find it!</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B81 817C24046DF60000&nbsp; cmp dword
ptr [esp+04],F66D </FONT><FONT COLOR="#3333FF">; Check RetCode2</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B89 0F8566FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B8F 817C24086CD60000&nbsp; cmp dword
ptr [esp+08],D66C </FONT><FONT COLOR="#3333FF">; Check RetCode3</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B97 0F8558FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B9D 817C240C973B0000&nbsp; cmp dword
ptr [esp+0C],3B97 </FONT><FONT COLOR="#3333FF">; Check RetCode4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422BA5 0F854AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422AF5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy#2 jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422BAB EB80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00422B2D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; JUMP if OK and make him believe everything</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; is fine...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B2D 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test esi, esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; ...and check Bad_Guy#1 Flag!</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422B2F 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Bad_Guy_Jump.</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>RetCodes 2, 3 and 4 are displayed in the code (0xF66D, 0xD66C,
0x3B97). To check the RetCode1, the program uses simple mathematical expressions
from offset 422B63 to offset 422B75.</TT>
<BR><TT>Finding the RetCode1 value is simple.</TT>
<BR><TT>We have:</TT>
<BR><TT>0x2D98 = (RetCode1 - 0x19CA) / 5</TT>
<BR><TT>So:</TT>
<BR><TT>RetCode1 = (0x2D98 * 5) + 0x19CA)</TT>
<BR><TT>RetCode1 = 0xFDC2</TT>
<BR><TT>You can see that if one of the 3 last RetCodes is wrong, it will
clearly send you on the Bad_Guy#2.</TT>
<BR><TT>But it will discreetly set the Bag_guy#1 flag (mov esi,1) if the
first RetCode is wrong and will go ahead as if everything was fine before
checking it later at offset 422B2F.</TT>
<BR><TT>&nbsp;</TT>

<P><TT><FONT COLOR="#000000"><U>The 4th break</U>:</FONT></TT>

<P><TT>This time, the program will read a block from the dongle, and check
if no error occured (RetCode3)</TT>

<P><TT>:00422CE2 B832000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov
eax, 00000032&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service#32</FONT></TT>
<BR><TT>:00422CE7 31D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edx, edx</TT>
<BR><TT>:00422CE9 E82CE71100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; ReadBlock</FONT></TT>
<BR><TT>:00422CEE 807D02EA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp byte ptr [ebp+02], EA&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check correct
value</FONT></TT>
<BR><TT>:00422CF2 741F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422D13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp if OK</FONT></TT>
<BR><TT>:00422CF4 837D7A00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp dword ptr [ebp+7A], 0&nbsp;&nbsp; <FONT COLOR="#3333FF">; Check RetCode3
(status Code)</FONT></TT>
<BR><TT>:00422CF8 7519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jmp if NOT correct as well</FONT></TT>
<BR><TT>:00422CFA B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy flag</FONT>&nbsp;<FONT COLOR="#3333FF">
but make it looks</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; like a Good_Guy Flag!</FONT></TT>
<BR><TT>:00422CFF 8DA582000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea esp, dword
ptr [ebp+82]</TT>
<BR><TT>..</TT>
<BR><TT>:00422D0A C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:00422D13 8B457A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp+7A] <FONT COLOR="#3333FF">; store status code in
Eax</FONT></TT>
<BR><TT>:00422D16 8DA582000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea esp, dword
ptr [ebp+82]</TT>
<BR><TT>..</TT>
<BR><TT>:00422D21 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Back to caller</FONT></TT>
<BR><TT>...</TT>
<BR><TT>...</TT>
<BR><TT>:00422B22 E831030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422E58</TT>
<BR><TT>:00422B27 89C6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov esi, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; store in esi as well</FONT></TT>
<BR><TT>:00422B29 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check if OK</FONT></TT>
<BR><TT>:00422B2B 7418&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422B45&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; je Good_Guy</FONT></TT>
<BR><TT>:00422B2D 85F6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test esi, esi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Check again to confuse...</FONT></TT>
<BR><TT>:00422B2F 7507&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422B38&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jne Bad_Guy</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>We could think that the <I>mov eax,1</I> is our Good_Guy because
right above, it checks the RetCode3 (equal to 0x0 if no error) and jump
if an error was returned.</TT>
<BR><TT>But it stores this RetCode into Eax (:422D13) and later will store
it into Esi too, and will check both registers to see if it's OK. It is
clear that, if the dongle was connected, the program should never reach
offset :422CF4.</TT>
<BR><TT>0xEA is probably a byte calculated somewhere depending on the dongle
RetCode (it is not RetCode1, 2, 3 or 4).&nbsp; To crack this will have
to store 0xEa into ebp+2 and to ensure that the RetCode3 will be equal
to 0x0.</TT>
<BR>&nbsp;

<P><TT>Now, Micro-Cap V seems to work fine but it still check for the dongle
depending on which key is pressed.</TT>
<BR><TT>&nbsp;</TT>

<P><TT><FONT COLOR="#000000"><U>The 5th break</U>:</FONT></TT>

<P><TT>Here, the program will check again Service#1 (IsHasp) but in another
location.</TT>

<P><TT><FONT COLOR="#000000"><U>The 6th break</U>:</FONT></TT>

<P><TT>Now it calls again Service 2.</TT>

<P><TT><FONT COLOR="#000000">:00422C0E B802000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000002</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C13 E802E81100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C18 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebp</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C19 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1A 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422C1B C20400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret 0004</FONT></TT>

<P><TT><FONT COLOR="#000000">The Caller:</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D6A E855FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 00422BC4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D6F 6681FE8203&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 0382</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D74 7527&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D9D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D76 813C24C7710000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 000071C7</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D7D 75C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D7F 817C2404935B0000&nbsp; cmp dword
ptr [esp+04], 00005B93</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D87 75BE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D89 817C2408E1BF0000&nbsp; cmp dword
ptr [esp+08], 0000BFE1</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D91 75B4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D93 817C240C900D0000&nbsp; cmp dword
ptr [esp+0C], 00000D90</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D9B 75AA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422D9D 6681FEE486&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 86E4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DA2 752B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422DCF</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DA4 813C248BF60000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 0000F68B</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DAB 759A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DAD 817C2404D3B40000&nbsp; cmp dword
ptr [esp+04], 0000B4D3</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DB5 7590&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DB7 817C2408FE0E0000&nbsp; cmp dword
ptr [esp+08], 00000EFE</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DBF 7586&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DC1 817C240CD43F0000&nbsp; cmp dword
ptr [esp+0C], 00003FD4</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DC9 0F8578FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DCF 6681FE9907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 0799</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DD4 7537&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422E0D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DD6 813C2411560000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 00005611</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DDD 0F8564FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DE3 817C2404BB6E0000&nbsp; cmp dword
ptr [esp+04], 00006EBB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DEB 0F8556FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DF1 817C2408925C0000&nbsp; cmp dword
ptr [esp+08], 00005C92</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DF9 0F8548FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422DFF 817C240C8EB60000&nbsp; cmp dword
ptr [esp+0C], 0000B68E</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E07 0F853AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E0D 6681FE3E05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp si, 053E</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E12 7537&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422E4B</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E14 813C24EB6F0000&nbsp;&nbsp;&nbsp;
cmp dword ptr [esp], 00006FEB</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E1B 0F8526FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E21 817C2404945D0000&nbsp; cmp dword
ptr [esp+04], 00005D94</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E29 0F8518FFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E2F 817C24087D200000&nbsp; cmp dword
ptr [esp+08], 0000207D</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E37 0F850AFFFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E3D 817C240CCEAE0000&nbsp; cmp dword
ptr [esp+0C], 0000AECE</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E45 0F85FCFEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 00422D47</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E4B 31C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E4D 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E50 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E51 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E52 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E53 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422E54 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</FONT></TT>
<BR><TT><FONT COLOR="#000000">..</FONT></TT>
<BR><TT><FONT COLOR="#000000">..</FONT></TT>
<BR><TT>:00422D47 B8B13A0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00003AB1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy</FONT></TT>
<BR><TT>:00422D4C 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010</TT>
<BR><TT>:00422D4F 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi</TT>
<BR><TT>:00422D50 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edx</TT>
<BR><TT>:00422D51 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ecx</TT>
<BR><TT>:00422D52 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop ebx</TT>
<BR><TT>:00422D53 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Depending on the value of Esi ( 0x<FONT COLOR="#000000">0382, 0x86E4,
0x0799 or 0x053E) the program will check for different RetCodes (they all
are shown in the code) and if it's OK, will clear Eax (Good_Guy) otherwise
will make you jump to offset :422D47.</FONT></TT>
<BR><TT><FONT COLOR="#000000">If Esi has a different value (this shouldn't
happen) the program will get to the Good_Guy as well.</FONT></TT>
<BR><TT><FONT COLOR="#000000">To crack this, we will simply xor Ecx (on
the stack as it is saved there before the call to the Hasp routine) during
a call to Service 2 and therefore we will always reach our Good_Guy. Clearing
Ecx will not affect the call to Service 2 I described before this one as
it is unused (saved on the stack).</FONT></TT>
<BR>&nbsp;

<P><TT>There is a last break when exiting the program:</TT>

<P><TT><FONT COLOR="#000000"><U>The 7th break</U>:</FONT></TT>

<P><TT><FONT COLOR="#000000">:00422F38 B806000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, 00000006</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F3D EBDC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp 00422F1B</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F1B E8FAE41100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0054141A</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F20 8B45F8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [ebp-08]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F23 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">:00422F25 7418&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 00422F3F</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Here, the program just check if any error occured.&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>There are still few xrefs to the main Hasp routine (services 1,
6...) but it doesn't matter as we will 'emulate' the dongle and this will
work for thoses xrefs as well. However, one of them is a call to service
0x29 (HaspID) at offset :422BF6 that apparently the program doesn't reach.
We will not crack it.</TT>
<BR>&nbsp;

<P><TT>As there's not enough room in the main Hasp routine to write our
own one, we will do it mostly at offset :514E4F0 that is called by this
routine:</TT>
<BR><TT>All changes are shown in red:</TT>

<P><TT>.0514141A: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ebp</TT>
<BR><TT>.0514141B: 89E5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebp,esp</TT>
<BR><TT>.0514141D: 60&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pushad</TT>
<BR><TT>.0514141E: 88C7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; bh,al&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; bh=Hasp Service called</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141420</FONT>: 80FF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#2 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141423</FONT>: 0F8510000000&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00141439&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; jump over if not</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">05141429</FONT>: 66C745240000&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; w,[ebp][00024],00000&nbsp; <FONT COLOR="#3333FF">;
otherwise clear Esi</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514142F</FONT>: E905000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000141439&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Go ahead</FONT></TT>
<BR><TT>.05141434: 8B7510&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; esi,[ebp][00010]<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; unused</FONT></TT>
<BR><TT>.05141437: 8B36&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; esi,[esi]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<FONT COLOR="#3333FF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
; unused</FONT></TT>
<BR><TT>.05141439: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; ebp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; back to original code</FONT></TT>
<BR><TT>.0514143A: E8B1D00000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; call&nbsp;
.<U>00514E4F0</U>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; call our new routine</FONT></TT>
<BR><TT>.0514143F: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop&nbsp;&nbsp;&nbsp; ebp</TT>
<BR><TT>.05141440: 8B7D0C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][0000C]</TT>
<BR><TT>.05141443: 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.05141445: 8B7D10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00010]</TT>
<BR><TT>.05141448: 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>.0514144A: 8B7D14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00014]</TT>
<BR><TT>.0514144D: 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT></TT>
<BR><TT>.0514144F: 8B7D18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edi,[ebp][00018]</TT>
<BR><TT>.05141452: 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [edi],edx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode4</FONT></TT>
<BR><TT>&nbsp;</TT>

<P><TT><B><FONT COLOR="#000000">.</FONT></B><U><FONT COLOR="#CC0000">0514E4F0</FONT></U><B><FONT COLOR="#000000">:</FONT></B>
80FF01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cmp&nbsp;&nbsp;&nbsp;
bh,001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#1 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4F3</FONT>: 7505&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E4FA</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4F5</FONT>: B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FA</FONT>: 80FF02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#2 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FD</FONT>: 7519&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E518</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E4FF</FONT>: B8C2FD0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,00000FDC2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode1</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E504</FONT>: BB6DF60000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,00000F66D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E509</FONT>: B96CD60000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,00000D66C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E50E</FONT>: BA973B0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; edx,000003B97&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode4</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E513</FONT>: E925000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .00014E53D</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E518</FONT>: 80FF05&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,005&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#5 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E51B</FONT>: 750C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E529</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E51D</FONT>: BB01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode2</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E522</FONT>: B901000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,000000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; RetCode3</FONT>&nbsp;</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E527</FONT>: EB14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .00014E53D</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E529</FONT>: 80FF06&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,006&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#6 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E52C</FONT>: 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .00014E53B</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E52E</FONT>: 80FF32&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bh,032&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service#32 ?</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E531</FONT>: 0F8504000000&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .00014E53B</TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E537</FONT>: C6451CEA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; b,[ebp][0001C],0EA&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
store our 0xEA</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E53B</FONT>: 33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; ecx,ecx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; clear RetCode3 (NO error)</FONT></TT>
<BR><TT>.<FONT COLOR="#CC0000">0514E53D</FONT>: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; back to Hasp main routine</FONT></TT>
<BR><TT>.<FONT COLOR="#000000">0514E53E</FONT>: 8D3534FC5600&nbsp;&nbsp;&nbsp;&nbsp;
lea&nbsp;&nbsp;&nbsp; esi,[00056FC34]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; will never reach this part.</FONT></TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Everything works quite well but it may be safer not to forget the
call to Service 0x29 that we didn't patch, just in case the program would
reach it one of these days...&nbsp;</TT>
<BR><TT>&nbsp;</TT>

<P>
<HR WIDTH="100%">

<P><A NAME="Vision"></A><B><U><FONT SIZE=+2>Vision XL/XXL v2.0</FONT></U></B>
<BR><B>-Description:</B>
<BR>High performance image processing and image analysis system.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel or serial key). Driver: <I>Hardlock.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Run as a DEMO if no dongle detected (Save, save as, copy disabled,
macros disabled after 30 program runs...).

<P><TT>Described as "seeing the invisible", this is a very sophisticated
and extremely expensive soft. For those reasons, we could only expect a
strong or at least, a good protection. Unfortunately, its protection is
really stupid, and then, the most amazing is that we won't even have to
care about the dongle to crack it!</TT>

<P><TT>During its installation, the program added the file <I>Hardlock.vxd</I>
and told us that we need to restart Windows before running it (to load
the dongle driver!).</TT>

<P><TT>Put a BPIO -H 378 with SoftICE and then run VisionXXL.</TT>
<BR><TT>Nothing happens!&nbsp;</TT> <TT>The program doesn't seem to check
the parallel port.&nbsp;</TT>

<P><TT>After a quick check at the huge documentation (25Mb is MS-Word format!),
I found this:</TT>
<BR><TT><FONT COLOR="#3333FF">"The security key can be reversed to be used
on a serial interface port...".</FONT></TT>
<BR><TT><FONT COLOR="#000000">I read that there are some lines to add to
your <I>Autoexec.bat</I> as well (SET HL_SEARCH=2f8s,...where 2f8 denotes
the IO address of the serial port,and s denotes the serial port. The ellipsis
... is used to indicate that you can check several ports one after the
other.).</FONT></TT>

<P><TT><FONT COLOR="#000000">OK, but let's just forget the dongle for now!</FONT></TT>
<BR><TT><FONT COLOR="#000000">Re-run the program. You'll get the big nagscreen/bitmap
telling you that the program is running in demo mode.</FONT></TT>
<BR><TT><FONT COLOR="#000000">As the "Save" feature is disabled, press
it in the target's toolbar. The following message box pops up:</FONT></TT>
<BR><TT><FONT COLOR="#3333FF">"Sorry, this function is not available in
demo mode"</FONT></TT>
<BR><TT><FONT COLOR="#000000">Put a BPX MessageBoxA and press "Save" again.</FONT></TT>
<BR><TT><FONT COLOR="#000000">SoftICE pops. Press &lt;F11>, click 'OK'
and press &lt;F12> 3 times. You'll land here:</FONT></TT>
<BR>&nbsp;

<P><TT><FONT COLOR="#000000">.000CA432: E899820600&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .0001326D0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Check if Full or Demo mode</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA437: 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; eax,eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA439: 740A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0000CA445&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy_Jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA43B: E840EBF4FF&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .000018F80&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Our MessageBoxA</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA440: E975040000&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .0000CA8BA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Bad_Guy_Exit</FONT></TT>
<BR><TT><FONT COLOR="#000000">.000CA445: E8127D0B00&nbsp;&nbsp;&nbsp;&nbsp;
call&nbsp; .00018215C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Good_Guy_Go_Ahead</FONT></TT>

<P><TT><FONT COLOR="#000000">Those who are familiar with "disabled features"
cracking won't need to read my comments to understand this: this is a stupid
typical protection used so much often for this kind of program.</FONT></TT>
<BR>&nbsp;
<BR><TT><FONT COLOR="#000000">Let's have a look at the .0001326D0 routine:</FONT></TT>

<P><TT><FONT COLOR="#000000">001326D0: 8B81E8000000&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
eax,[ecx][0000000E8]</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326D6: 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; eax,eax</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326D8: 740D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0001326E7&nbsp;</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DA: 8B4804&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[eax][00004]</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DD: 85C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test&nbsp;&nbsp; ecx,ecx</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326DF: 7406&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .0001326E7&nbsp;</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E1: B801000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,000000001&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E6: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E7: 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</FONT><FONT COLOR="#3333FF">; Good_Guy_Flag</FONT></TT>
<BR><TT><FONT COLOR="#000000">001326E9: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
retn</FONT></TT>

<P><TT><FONT COLOR="#000000">This routine is called as soon as you run
the program (to decide if it's a Demo or full working version) and each
time you'll press or try to use one of the disabled features.</FONT></TT>
<BR><TT><FONT COLOR="#000000">Obviously, patching the first <I>test eax,eax</I>
or changing the <I>mov eax,1</I> will be enough to crack this dongle protection.</FONT></TT>

<P>
<HR WIDTH="100%">
<BR>&nbsp;

<P><A NAME="ABBCS31"></A><B><U><FONT SIZE=+2>ABBCS31 v1.02</FONT></U></B>
<BR><B>-Description:</B>
<BR>DDE (Dynamic Data Exchange) Server allowing other Windows application
programs to access the data from the ABB Procontic CS31 automation system.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: <I>Hasp95.vxd</I> (c:\windows\system).
<BR><B>-Misc.:</B>
<BR>Run as a time-limited DEMO if no dongle detected (will only run 1 hour).
<BR>&nbsp;

<P><TT>At the end of the installation setup, we get a "reboot to activate
HASP driver!" message. So we know where we are and where we going! The
program added the file <I>C:\Windows\System\Hasp95.vxd</I> and the following
line in the Registry: <I>'HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\VxD\HASP95'</I>.</TT>

<P><TT>With HIEW5.66, we can quickly find the Hasp main routine located
in the <I>Abbcs31.exe</I> file (193Kb).&nbsp;</TT>
<BR><TT>It starts at offset :00001AC9. Now we can BPX it with SoftICE (don't
forget to add 0x400000 to the offset from Hiew to SoftICE ):</TT>
<BR><TT>&nbsp;&nbsp; BPX 401AC9</TT>

<P><TT>Running ABBCS32, we'll get 3 breaks. Callers are:</TT>
<BR><TT>:401C9D</TT>
<BR><TT>:401D0C</TT>
<BR><TT>:401D8A</TT>

<P><TT>Here is the code (again from Hiew):</TT>

<P><TT>.00001C97: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x05</FONT></TT>
<BR><TT>.00001C9C: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001C9D: E827FEFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #5</FONT></TT>
<BR><TT>.00001CA2: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001CA5: 8B45CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[ebp][-0034]</TT>
<BR><TT>.00001CA8: A3A0204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [0004220A0],eax</TT>
<BR><TT>.00001CAD: 837DD000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-0030],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it a Hasp-3 (RetCode2=0)?</FONT></TT>
<BR><TT>.00001CB1: 0F850C000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001CC3&nbsp;</TT>
<BR><TT>.00001CB7: C745C401000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],1&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Yes: Good_Guy_Flag</FONT></TT>
<BR><TT>.00001CBE: E907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000001CCA&nbsp;</TT>
<BR><TT>.00001CC3: C745C400000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT>.00001CCA: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it OK?</FONT></TT>
<BR><TT>.00001CCE: 0F8446000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .000001D1A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; No, send_Him_Away...</FONT></TT>
<BR><TT>.00001CD4: C705C40A420001000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC4],1&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise Go_Ahead</FONT></TT>
<BR><TT>...</TT>
<BR><TT>.00001D06: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x01</FONT></TT>
<BR><TT>.00001D0B: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001D0C: E8B8FDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #1</FONT></TT>
<BR><TT>.00001D11: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001D14: 8B45D4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[ebp][-002C]</TT>
<BR><TT>.00001D17: 8945C4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; [ebp][-003C],eax</TT>
<BR><TT>.00001D1A: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Is it a Hasp Dongle (RetCode1=1)?</FONT></TT>
<BR><TT>.00001D1E: 0F84E7000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je&nbsp;&nbsp;&nbsp; .000001E0B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump...</FONT></TT>
<BR><TT>.00001D24: C705C40A420002000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC4],2&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; otherwise Go_Ahead</FONT></TT>
<BR><TT>...</TT>
<BR><TT>.00001D84: A1C40A4200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[000420AC4]&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
eax=0x02</FONT></TT>
<BR><TT>.00001D89: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push&nbsp;&nbsp; eax</TT>
<BR><TT>.00001D8A: E83AFDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">call&nbsp; .000001AC9</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Hasp routine service #2</FONT>&nbsp;</TT>
<BR><TT>.00001D8F: 83C424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add&nbsp;&nbsp;&nbsp; esp,024&nbsp;</TT>
<BR><TT>.00001D92: C705C00A420000000000&nbsp; mov&nbsp;&nbsp;&nbsp; d,[000420AC0],0</TT>
<BR><TT>.00001D9C: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DA1: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DA4: 8B4DD4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-002C]</TT>
<BR><TT>.00001DA7: 398818204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422018],ecx<FONT COLOR="#3333FF">; Is RetCode1=0x7A17
?</FONT></TT>
<BR><TT>.00001DAD: 0F8551000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT></TT>
<BR><TT>.00001DB3: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DB8: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DBB: 8B4DD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0030]</TT>
<BR><TT>.00001DBE: 39881C204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][00042201C],ecx<FONT COLOR="#3333FF">; Is RetCode2=0x768A
?</FONT></TT>
<BR><TT>.00001DC4: 0F853A000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DCA: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DCF: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DD2: 8B4DCC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0034]</TT>
<BR><TT>.00001DD5: 398820204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422020],ecx<FONT COLOR="#3333FF">; Is RetCode3=0x554C
?</FONT></TT>
<BR><TT>.00001DDB: 0F8523000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DE1: A1AC204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; eax,[0004220AC]</TT>
<BR><TT>.00001DE6: C1E004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
shl&nbsp;&nbsp;&nbsp; eax,004</TT>
<BR><TT>.00001DE9: 8B4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ecx,[ebp][-0038]</TT>
<BR><TT>.00001DEC: 398824204200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; [eax][000422024],ecx<FONT COLOR="#3333FF">; Is RetCode4=0xE6EB
?</FONT></TT>
<BR><TT>.00001DF2: 0F850C000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy_Jump</FONT>&nbsp;</TT>
<BR><TT>.00001DF8: C745C401000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],1&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Good_Guy_Flag</FONT></TT>
<BR><TT>.00001DFF: E907000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmp&nbsp;&nbsp; .000001E0B&nbsp;</TT>
<BR><TT>.00001E04: C745C400000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Bad_Guy_Flag</FONT></TT>
<BR><TT>.00001E0B: 837DC400&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-003C],0</TT>
<BR><TT>.00001E0F: 0F8515000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001E2A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Dongle_OK</FONT></TT>
<BR><TT>.00001E15: 837DC002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; d,[ebp][-0040],2&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
No_Dongle</FONT></TT>

<P><TT>This routine is <B>INCREDIBLY STUPID</B>!!</TT>
<BR><TT>As I said at the very beginning of this essay, the programmer just
forgot to read the Hasp documentation shipped with his dongle:</TT>
<BR><TT>Usually, you first check if there is a Hasp dongle connected to
the parallel port (Service #1) and then, if there is one, the type of Hasp
(Service #5).</TT>
<BR><TT>We can see here that the program check the type of Hasp before
verifying if there is a dongle connected.</TT>
<BR><TT>And so?</TT>
<BR><TT>The only problem is that we can see that ABBCS32 is expecting a
Hasp-3 dongle (RetCode2=0). But, after a call to Service #5, if you <U>don't
have any dongle connected</U> the RetCode2 will be equal to... 0x00 as
well!</TT>
<BR><TT>This just means that if you have the correct dongle or nothing
at all, the program will just assume that you have the right Hasp-3! Unbelievable...</TT>
<BR><TT>Fortunately, it checks Service #1 later.</TT>
<BR>&nbsp;

<P><TT>There are a lot of different ways to crack this crap (patching the
Bad_Guy_Flag...) but let's emulate the dongle by reverse engineering the
main Hasp routine again:</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>Offsets changed are shown in <FONT COLOR="#CC0000">red</FONT> :</TT>

<P><TT>.00001AC9: 55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ebp&nbsp;</TT>
<BR><TT>.00001ACA: 8BEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ebp,esp&nbsp;</TT>
<BR><TT>.00001ACC: 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
eax&nbsp;</TT>
<BR><TT>.00001ACD: 53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ebx&nbsp;</TT>
<BR><TT>.00001ACE: 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
ecx&nbsp;</TT>
<BR><TT>.00001ACF: 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
edx&nbsp;</TT>
<BR><TT>.00001AD0: 57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
edi&nbsp;</TT>
<BR><TT>.00001AD1: 56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; push&nbsp;&nbsp;
esi&nbsp;</TT>
<BR><TT>.00001AD2: 8B751C&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
esi,[ebp][0001C]&nbsp;</TT>
<BR><TT>.00001AD5: 8B3E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[esi]&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AD7:</FONT> B900000000 mov&nbsp;&nbsp;&nbsp;
ecx,000000000&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">; Clear ecx.</FONT></TT>
<BR><TT><FONT COLOR="#000000">.00001ADC: </FONT>8B5D08&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ebx,[ebp][00008]&nbsp; <FONT COLOR="#3333FF">; bl=Service
called.</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001ADF:</FONT> 80FB02&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bl,002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service #2?</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE2:</FONT> 7512&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001AF6&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE4:</FONT> 66B8177A&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,07A17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#1</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AE8:</FONT> 66BB8A76&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
bx,0768A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#2</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AEC:</FONT> 66B94C55&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
cx,0554C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#3</FONT>&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF0:</FONT> 66BAEBE6&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
dx,0E6EB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#4</FONT>&nbsp;&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF4:</FONT> EB0F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .000001B05&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF6:</FONT> 80FB01&nbsp;&nbsp;&nbsp;&nbsp;
cmp&nbsp;&nbsp;&nbsp; bl,001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is it Service #1?</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001AF9:</FONT> 7506&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne&nbsp;&nbsp; .000001B01&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AFB:</FONT> 66B80100&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
ax,00001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
correct RetCode#1</FONT>&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001AFF:</FONT> EB04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jmps&nbsp; .000001B05&nbsp;</TT>
<BR><TT><FONT COLOR="#CC0000">.00001B01:</FONT> 33DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; ebx,ebx&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Xor unused registers</FONT></TT>
<BR><TT><FONT COLOR="#CC0000">.00001B03:</FONT> 33C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor&nbsp;&nbsp;&nbsp; eax,eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; just in case.</FONT></TT>
<BR><TT>.00001B05: 8B7D1C&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][0001C]&nbsp; <FONT COLOR="#3333FF">; Back to original code.</FONT></TT>
<BR><TT>.00001B08: 8907&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],eax&nbsp;</TT>
<BR><TT>.00001B0A: 8B7D20&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00020]&nbsp;</TT>
<BR><TT>.00001B0D: 891F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],ebx&nbsp;</TT>
<BR><TT>.00001B0F: 8B7D24&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00024]&nbsp;</TT>
<BR><TT>.00001B12: 890F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],ecx&nbsp;</TT>
<BR><TT>.00001B14: 8B7D28&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
edi,[ebp][00028]&nbsp;</TT>
<BR><TT>.00001B17: 8917&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mov&nbsp;&nbsp;&nbsp;
[edi],edx&nbsp;</TT>
<BR><TT>.00001B19: 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
esi&nbsp;</TT>
<BR><TT>.00001B1A: 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
edi&nbsp;</TT>
<BR><TT>.00001B1B: 5A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
edx&nbsp;</TT>
<BR><TT>.00001B1C: 59&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ecx&nbsp;</TT>
<BR><TT>.00001B1D: 5B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ebx&nbsp;</TT>
<BR><TT>.00001B1E: 58&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
eax&nbsp;</TT>
<BR><TT>.00001B1F: 5D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pop&nbsp;&nbsp;&nbsp;
ebp&nbsp;</TT>
<BR><TT>.00001B20: C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; retn&nbsp;</TT>
<BR>&nbsp;
<BR><TT>Abbcs31 is cracked.</TT>
<BR>
<HR WIDTH="100%">
<BR><A NAME="WellCAD"></A><B><U><FONT SIZE=+2>WellCAD v2.30</FONT></U></B>
<BR><B>-Description:</B>
<BR>Data repository, geophysical and geological reporting tool.
<BR><B>-OS:</B>
<BR>Win95/NT
<BR><B>-Protection:</B>
<BR>Dongle (parallel key). Driver: Hasp95.vxd
<BR><B>-Misc.:</B>
<BR>Does NOT run if no dongle detected.
<BR>&nbsp;

<P><TT>Searching for the main Hasp routine, we easily find it at offset
:44D528 in the main program (wellcad.exe 1.42Mb). It has 2 X-refs and then,
the 14 X-refs (called several times) calling the Hasp services.</TT>
<BR><TT>Here are two of them:</TT>

<P><TT>:0049ECFE 6A01&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service #1</FONT>&nbsp;</TT>
<BR><TT>:0049ED00 E87B080000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F580&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_It_A_Hasp_Dongle ?</FONT></TT>
<BR><TT>:0049ED05 8B442408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, dword ptr [esp+08]&nbsp;</TT>
<BR><TT>:0049ED09 8D4C2410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [esp+10]&nbsp;</TT>
<BR><TT>:0049ED0D 48&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
dec eax&nbsp;</TT>
<BR><TT>:0049ED0E 8D54240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea edx, dword ptr [esp+0C]&nbsp;</TT>
<BR><TT>:0049ED12 83F801&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cmp eax, 00000001&nbsp;</TT>
<BR><TT>:0049ED15 8D442414&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [esp+14]&nbsp;</TT>
<BR><TT>:0049ED19 1BFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
sbb edi, edi&nbsp;</TT>
<BR><TT>:0049ED1B 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:0049ED1C 8D44240C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea eax, dword ptr [esp+0C]&nbsp;</TT>
<BR><TT>:0049ED20 51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push ecx&nbsp;</TT>
<BR><TT>:0049ED21 52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push edx&nbsp;</TT>
<BR><TT>:0049ED22 8BCE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov ecx, esi&nbsp;</TT>
<BR><TT>:0049ED24 F7DF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
neg edi&nbsp;</TT>
<BR><TT>:0049ED26 50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push eax&nbsp;</TT>
<BR><TT>:0049ED27 6868200000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00002068&nbsp;</TT>
<BR><TT>:0049ED2C 6A02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 00000002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Service # 2</FONT>&nbsp;</TT>
<BR><TT>:0049ED2E E84D080000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F580&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Get_Hasp_Code&nbsp;</FONT>&nbsp;</TT>
<BR><TT>:0049ED33 817C2408A5F70000&nbsp; cmp dword ptr [esp+08], 0000F7A5<FONT COLOR="#3333FF">;Is
RetCode1 OK ?</FONT></TT>
<BR><TT>:0049ED3B 7529&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED3D 817C240C8E420000&nbsp; cmp dword ptr [esp+0C], 0000428E<FONT COLOR="#3333FF">;Is
RetCode2 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED45 751F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED47 817C2410E54F0000&nbsp; cmp dword ptr [esp+10], 00004FE5<FONT COLOR="#3333FF">;Is
RetCode3 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED4F 7515&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_guy jump</FONT></TT>
<BR><TT>:0049ED51 817C24144E470000&nbsp; cmp dword ptr [esp+14], 0000474E<FONT COLOR="#3333FF">;Is
RetCode4 OK ?</FONT>&nbsp;</TT>
<BR><TT>:0049ED59 750B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
jne 0049ED66&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:0049ED5B 83E701&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
and edi, 00000001&nbsp;</TT>
<BR><TT>:0049ED5E 8BC7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Set Good_Guy flag (eax=0x01)</FONT></TT>
<BR><TT>:0049ED60 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi&nbsp;</TT>
<BR><TT>:0049ED61 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi&nbsp;</TT>
<BR><TT>:0049ED62 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010&nbsp;</TT>
<BR><TT>:0049ED65 C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>

<P><TT>* Referenced by a (C)onditional:0049ED3B(C), :0049ED45(C), :0049ED4F(C),
:0049ED59(C)&nbsp;</TT>
<BR><TT>:0049ED66 33FF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
xor edi, edi&nbsp;</TT>
<BR><TT>:0049ED68 8BC7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov eax, edi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy (clear eax)</FONT></TT>
<BR><TT>:0049ED6A 5F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop edi&nbsp;</TT>
<BR><TT>:0049ED6B 5E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
pop esi&nbsp;</TT>
<BR><TT>:0049ED6C 83C410&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
add esp, 00000010&nbsp;</TT>
<BR><TT>:0049ED6F C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ret&nbsp;</TT>
<BR><TT>&nbsp;</TT>
<BR><TT>&nbsp;Let's crack it:</TT>
<BR><TT>:<FONT COLOR="#000000">0049ED66</FONT> 66B80100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
mov&nbsp;&nbsp;&nbsp; ax,00001</TT>

<P><TT>Now if you run the program, it will ask you for your name and company
name to type in. Then, it will take about 12 seconds on a P233 before WellCAD
main window appears on your screen. Let's solve this problem.</TT>
<BR><TT>As there a too many checks and comparisons occuring even before
the calls to the dongle, with SoftICE, BPX the main Hasp routine (:44D528)
and try to find some interesting cross references that we'll lead us to
the fatal(s) <I>jnz_Bad_Guy.</I></TT>
<BR><TT>Without any problem, we find several of them but only 2 seem very
interesting:</TT>
<BR>&nbsp;

<P><TT>:004C01E7 E8684A0200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MFC40.MFC40:NoName0713</TT>
<BR><TT>:004C01EC 8D8BC8000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lea ecx, dword
ptr [ebx+000000C8]</TT>
<BR><TT>:004C01F2 E829E6FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049E820&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Verify_Dongle&nbsp; (+ Misc routines)</FONT></TT>
<BR><TT>:004C01F7 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK ?</FONT></TT>
<BR><TT>:004C01F9 0F8455FDFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; je 004BFF54&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT>:004C01FF 68C8030000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
push 000003C8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Good_Guy go ahead</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">...</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C025F E8E4490200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MFC40.MFC40:NoName0711</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0264 8D8BC8000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebx+000000C8]</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C026A E881F0FDFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
call 0049F2F0</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Verify_Dongle&nbsp; (+ Misc routines)</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C026F 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
test eax, eax</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Is_Dongle_OK ?</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0271 0F84DDFCFFFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
je 004BFF54</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<FONT COLOR="#3333FF">; Bad_Guy jump</FONT></TT>
<BR><TT><FONT COLOR="#000000">:004C0277 8D4DC8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
lea ecx, dword ptr [ebp-38]</FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <FONT COLOR="#3333FF">;
Good_Guy go ahead</FONT></TT>
<BR>&nbsp;

<P><TT>Just get rid of the two <I>Verify_Dongle</I> calls and replace them
with <I>mov eax,1</I>.&nbsp;</TT>

<P><TT>This will considerabely speed up the program (just 1 little second
to start) and the crack is done.&nbsp;</TT>
<BR><TT>OK, it seems very easy to crack but it takes longer that you may
think. The protection is not too bad: a lot of calls to sub-routines that
will call other sub-routines etc.. and then comparisons in one of them
with the conditional jump in another one... It may fool or confuse you
during a Live approach, but could not resist a good Dead listing.</TT>
<BR>
<hr width="100%">
<center>
End of first part<br>
<a href="fp_dong2.htm" tppabs="http://members.xoom.com/tsehp_/fp_dong2.htm" >I want the second part</a>
</center>

<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>
private.htm: reverser's private links
</title>
</head>
<body   BACKGROUND="images/book.jpg" tppabs="http://members.xoom.com/tsehp_/images/book.jpg" bgcolor="CCCCCC" text="#001010" vlink="#405040 Alink=#00FF50">

<a name="anchortop">

<table BORDER="0" CELLPADDING="0">

<td>
<pre>           </pre>
</td>

<td> 
<pre>            </prE>
</td>

<td width=300>

<!-- Begin Introdo -->

<center><h1>reverser's private links</h1></center>

<cennter><img SRC="images/spicy.jpg" tppabs="http://members.xoom.com/tsehp_/images/spicy.jpg" WIDTH="199" HEIGHT="272" ALT="spicy"></a></cennter><p>
<cennter>Poetry, Bettie, Hentai, Medusae, Escher and other <i>et ab hic et ab hoc</i> connections</cennter><br><hr size="3">
<br><cennter><i>The Web is immense. If you only spent a minute per page and devoted ten<bR> 
hours a day to it, it would take four and a half years to explore a million Web pages,<br> 
a lifetime to explore just a part of it</i></cennter><br>


<cennter><b>This page is an exerpt from one of my own 'navigation' pages</b>
<p><i>A good trick is to prepare a page like this ON YOUR OWN HARDDISK<br> 
there is no need to begin your browsing from a homepage on the Web, and <br>
this kind of system is much more useful than the clumsy &quot;bookmarks&quot;<br> 
inside your browser... as a matter of fact you'll only need to bookmark there<br> 
YOUR OWN HARDDISK PAGES, where you'll slowly add, all your <font COLOR="red">identities</font> <br>
and all your <font COLOR="red">passwords</font> (yes, all your counters/accesses/avatars <br>
will have a name and a password, all your web pages will have passwords, <bR>
all the special gates you'll find will have password... you'll forget some of them<br> 
if you don't write them down somewhere) (or you will be compelled to the very dangerous<bR>
game of using always the same 5/6 passwords.<bR>
On these naviagtions pages you can also prepare (and have ready) your <font COLOR="red">&quot;queries&quot;</font><br>
in order to get the stats from your counters and spiders, or to repeat automatically<br>
useful queries.<br></i>
</cennter>
<hr size="1">
<cennter><h1>reverser's private links</h1></cennter>
<cennter><b>Here they are</b></cennter><hR>


<cennter><h3><font COLOR="GREEN">__A taste of Rhetoric</font></h3></cennter>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" 
HSPACE="0"><a href="http://www.uky.edu/ArtsSciences/Classics/rhetoric.html" >A Glossary of Rhetorical Terms with Examples</a><bR>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" 
HSPACE="0"><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Handbook of Rhetorical Devices</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" 
HSPACE="0"><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >silva rhetoricae</A> (The Forest of Rhetoric)<bR>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" 
HSPACE="0"><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Ancient Rhetoric Online</a>

<br>
<hr size=3>

<cennter><h3><font COLOR="GREEN">__A taste of Poetry__</font></h3></cennter>

<cennter><i>Not to read poetry is tantamount to be enslaved... as +ORC 
wrote (in howto51.htm):<p>
&quot;Why don't they read any poems any more? No poetry any more,<br>
in the grey society of the publicity-spots slaves...<br>
poetry will soon be forbidden, coz you cannot CONSUME as you read poems,<bR>
and in this farce of a society you are BOUND to consume, that's<br>
the only thing they want you to do... you are CULTIVATED to consume...<br>
no books worth to read any more... stupid american conventional cram<br>
everywhere... boy, at times I'm missing some well placed neutron bombs,<br>
the ones that would kill all these useless zombies and leave noble books<bR>
and good Wodka untouched.&quot;</i><p></cennter>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.theatlantic.com/atlantic/atlweb/poetry/poetpage.htm" >Atlantic</a> USA poetry pages
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.augustea.it/~banfi/poesia/Info/Ictus.htm" >An explanation</a>, in italian, of the &quot;rules&quot; used in poetry
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.franceweb.fr/poesie/rimbaud1.htm" >Arthur RIMBAUD</a>, hope you can read french: these poems are *juwels*
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://metalab.unc.edu/dykki/poetry/" >the Internet Poetry Archive</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Representative poetry on-line</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Glossary of poetic terms</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >A Handbook of Terms for Discussing Poetry</a>

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.link.cs.cmu.edu/dougb/rhyme-doc.html" >The semantic rhyming dictionary</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >A Handbook of Terms for Discussing Poetry</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >A Handbook of Terms for Discussing Poetry</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >A Handbook of Terms for Discussing Poetry</a>

<!-- End Info -->
<hr size="3">


<cennter><h3><font COLOR="GREEN">__Medusae__</font></h3></cennter>
<cennter><i>
The Web is so deep that you will not actually need to buy any book any more,<bR> 
and this is true for ANY argument. Here an example about medusae... just confront<br> 
this information with the information available in the best bookstore of your town...<bR>
you'll understand what I mean</i></cennter><br>

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" 
HEIGHT="13"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Class Hydrozoa</a> Hydrozoan medusae all have a distinctive structure called a velum<br> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" 
HEIGHT="13"></a><a href="http://www.ucmp.berkeley.edu/cnidaria/hydrozoamm.html" >Berkeley's 
Hydrozoa</a>

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Class Scyphozoa</a> The medusae of this class 
lack a velum<bR> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.ucmp.berkeley.edu/cnidaria/scyphozoa.html" >Berkeley's Scyphozoa</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.ucmp.berkeley.edu/cnidaria/scyphozoamm.html" >Scyphozoan morphology</a>


<pre>
The Scyphozoa is currently divided into the following four orders:
Order Stauromedusae   These are sessile cup-shaped forms, and lack 
		      a free-swimming medusa.
Order Coronatae       Most of these are deep-dwelling jellyfish, and 
		      are thus rarely seen.
Order Semaeostomae    The so-called disc jellyfish, including the most 
		      common as well as the largest of the jellyfish.
Order Rhizostomae     These jellyfish lack tentacles, and have eight
		      oral arms instead of four. The oral arms, often
		      highly branched, have become fused in the center, 
		      closing off the central mouth and giving the 
		      jellyfish multiple mouth openings at the ends 
		      of the lateral arms. 
The Cubozoa, or box jellies, were at one time included as 
an order of the Scyphozoa, but are now considered to be the
sister group of the jellyfish</pre>

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Class Cubozoa</a> &quot;box&quot; jellyfish... a subclass of Scyphozoa (?)
<br>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Aurelia aurita</a> (Saucer Jelly)
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Cassiopeia andromeda</a> (Upside-down Sea Jelly)



<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Carybdea alata</a> These jellyfish eat fish usually larger than themselves
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Chironex fleckeri</a> Feeds in shallow water, which has led to contact with humans
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Taxon search</a> Unesco marine species database

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Order a moon jelly</a> you'll get it delivered 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >A japanese</a> page about medusae

<hr width=33%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://altavista.digital.com/cgi-bin/query?pg=aq&kl=XX&r=medusae+|+jellyfish&q=&d0=&d1=&search=Search" >Medusae: never ending links</a>


<hr size="3">
<br><cennter><h3><font COLOR="GREEN">__Maurits Cornelis ESCHER__</font></h3></cennter>
<cennter><i>There's just something about his drawings that appeals to thinking people</i><br></cennter>


<img SRC="images/homebut.gif" tppabs="http://members.xoom.com/tsehp_/images/homebut.gif" align="right" width="98" height="123"></a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Meredith's</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Wally's</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Maurer's</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Pioch's</a> 

<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Climbing and descending (Dutch: Klimmen en dalen)</a> 

<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://www.texas.net/escher/index.html" >World of Escher</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="ftp://ftp.rrze.uni-erlangen.de/pub/pictures/Artists/M.C.Escher/" tppabs="ftp://ftp.rrze.uni-erlangen.de/pub/pictures/Artists/M.C.Escher/">Directory of /pub/pictures/Artists/M.C.Escher</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >M.C. Escher's Virtually Gone Gallery</a>
<br>

</cennter>
<br>
<hr size=3>
<br><cennter><h3><font COLOR="GREEN">__Tamara de Lempicka__</font></h3></cennter>
<cennter><i>You may not be excused for not knowing her paintings</i><br></cennter>
<!-- <IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/androm.jpg" align=right WIDTH= 137   HEIGHT=223> -->
<img SRC="images/t_tamra7.jpg" tppabs="http://members.xoom.com/tsehp_/images/t_tamra7.jpg" align="right" width="82" height="100"></a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Sappho Art server</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Grafica &amp; disegno</a>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://www.primenet.com/~byoder/artoftdl.htm" >Brian Yolder's gallery</a>
</cennter>
<br><br>
<hr width=33%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://altavista.digital.com/cgi-bin/query?pg=q&kl=XX&q=%22tamara+de+lempicka%22&search=Search" >Tamara: never ending links</a>


<hr size="3">

<cennter><h3><font COLOR="GREEN">__Bettie Page's pages__</font></h3></cennter>
<cennter><i>the &quot;Pin Up Queen&quot; of the 1950's... as you can see there are some american things I like</i><br></cennter>
<br><img SRC="images/BETTY12_sm.jpg" tppabs="http://members.xoom.com/tsehp_/images/BETTY12_sm.jpg" align="right" width="63" height="120"></a>
<br>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm#olivia" >Bettie_1</a> (with the &quot;Crackers in Bed&quot; picture by Olivia)
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Bettie_2</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Images_1</a> 
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Images_2</a> 


<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://weber.ucsd.edu/~dmckiern/bettie_page.html" >All links</a> 
<hr width=33%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://altavista.digital.com/cgi-bin/query?pg=q&what=web&fmt=&q=%22bettie+page%22" >Bettie: never ending links</a>

<hr size="3">
<br><cennter><h3><font COLOR="GREEN">__Hentai links__</font></h3></cennter>
<cennter><i>This is sort of cracking your own thoughts</i><br></cennter>
<cennter><i>As you can see, the fact that I hate (and struggle against) 
&quot;commercial smut depots&quot;<br>(see my <a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut</a> page) 
does not mean that I am a bigot!</i><br></cennter>

<img SRC="images/yui2.jpg" tppabs="http://members.xoom.com/tsehp_/images/yui2.jpg" align="right" width="137" height="214"></a>

</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Do</a>  
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >not</a> 

<!-- <a href="http://cc.usu.edu/~slb2p/hentai/links.htm" >follow</a> --> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >follow</a> 

<!-- <a href="http://www.worldnet.fr/~gilh/mnggb01.htm" >these</a> -->
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >these</a> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >links</a>, 
 <a href="http://www2.usa1.com/~treason/picture.html" >they</a> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >have</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >nothing</a> 
<br><a href="http://animecca2.com/overfiend/hentai.html" >to</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >do</a> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >with</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >cracking</a>,  
<br><a href="http://www1.usa1.com/~miclyn/squash.htm" >and</a> 
 <a href="http://www1.usa1.com/~miclyn/inju-04.gif" >you'</a>
<a href="http://www1.usa1.com/~miclyn/inju-09a.gif" >ll</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >never</a> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >come</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >back</a> 
<br><a href="ftp://www.bigfire.com/gfx/" tppabs="ftp://www.bigfire.com/gfx/">if</a> 
 <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm#list" >you</a> 
<br><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >do,</a> 
<br>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a>
because you'll like it too much. You have been warned.
<!-- End Hentai -->

<br><br>
<hr width=33%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://altavista.digital.com/cgi-bin/query?pg=q&kl=XX&q=%22hentai%22&search=Search" >Hentai: never ending links</a>
<hr>
<center><H3>Other low-level thoughts (and reversing material)</h3><br>(Some of these sites are <u>great</u> for fake identities fishing :-)</center><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.jailbabes.com/white/index-26-35.html" >Something exciting for your thoughts</a>
<br><hr width=22%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.lifetimepartners.com/" >buy a woman</a>, fake identities galore... :-)
<hr width=22%>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Wanna an elastic,  
     heat and 
     water (and
     stain) resistant,
     durable, 
     odorless and flavorless woman? 
And moreover quite flexible :-)</a>... for those that love plastic a lot.


<hr size="3">
<br><cennter><h3><font COLOR="GREEN">__Pinups and pulp covers__</font></h3></cennter>
<cennter><i>Well, these are the real fifties</i><br></cennter>
<!--<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/buratti.gif" align=right></a>-->
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >
<img SRC="images/campus.gif" tppabs="http://members.xoom.com/tsehp_/images/campus.gif" align="right" WIDTH="107" HEIGHT="153"></a></a>

<img SRC="images/myster.gif" tppabs="http://members.xoom.com/tsehp_/images/myster.gif" align="right" width="107" height="153"></a></a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://www.ip.pt/pulp/index.htm" >The pulp</a> zone (uses this same paper)
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://thepulp.net/index.html" >.pulp</a> (now "The pulp net")


<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://www.atomicbooks.com/catalog/pinup.html" >Atomic books</a> pinups
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Paperback</a> Cover Art Illustrators

<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a>
<a href="http://www.cybercomm.nl/~vandeijk/eaindex/eaindex.htm" >Jaap van Deijk 's</a>

<br><br><br><br>




<hr size="3">

<cennter><h3><font COLOR="GREEN">__Et ab hic et ab hoc__</font></h3></cennter>
<cennter>
<!-- Javascript code by Reverser, Yeah, go ahead, steal my code, sucker -->
<script language="JavaScript">
    var id,pause=0,position=0;
    function banner() {
    var m1 = "  I did not yet order these links  ";
    var m2 = " But I will... ";
    var i,k,msg=m1+m2;
    k=(70/msg.length)+1;
    for(i=0;i<=k;i++) msg+=" "+msg;
    document.announce.display.value=msg.substring(position,position+120);
    if(position++==msg.length) position=100;
    id=setTimeout("banner()",100); 
    }

</script>
<body onload="banner()">
<form name="announce"><input type="text" name="display" size="50"></form>
<!-- Javascript code by Reverser, Yeah, go ahead, steal my code, sucker -->
</cennter>
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.thecase.com/thecase/" >The case</a> Could be interesting
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Diplomacy</a> Great board game!
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Geo's upload</a> I use it a lot
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://ourworld.compuserve.com/homepages/POde/" >The Independent Player</a> Wargames and Strategy Games
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Homo ludens</a> Only during the night
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Scott Pakin's</a> complaint-letter generator
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Cyd Charisse</a> the only page I found on Cyd Charisse
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >Icones</a> &quot;en vrac&quot;
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Inju 1</a> Hentai
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.faxaway.com/testdrive/testdrive.cgi?20060" >Faxaway</a> Send a fax for free
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.uiah.fi/internetguide/surf.htm" >Surfer's</a> List to Art on the Web
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.vmedia.com/books/offnet/toc.htm" >Netscape</a> Navigator, online manual! (Learn!)
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Expanding Universe</a> A Classified Search Tool for Amateur Astronomy
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >Scout Report</a> The Scout Report's Web page:
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://erau.db.erau.edu/~tjd/log_faq.html#Part2" >Tim</a> Drozinski's Access Logs FAQ: Hit counts for the tremendously stupid
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >The browser survival guide</a>  offers detailed information on the available browsers
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.stoli.com/" >Freedom of Wodka</a>  This is Stolichnaya central, +ORC might like this place

<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm" >All the books</a>  you'll ever want to read
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.cs.cmu.edu/People/spok/banned-books.html" >All the banned books</a>  you'll ever want to read
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.silent-movies.com/Ladies/Ladies.html" >Silent Ladies</a>  a very intersting site







<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.marx.org/" >Marx</a> The Marx/Engels Internet Archive
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.eskimo.com/~joelm/" >Joel McNamara's</a> journal of internet privacy
<br><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a href="http://www.eskimo.com/~joelm/tools.html" >and his tools!</a> (some of them may be very useful in our trade)
<hr>
<cennter>
<strong><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="http://www.penet.fi/fund.html" >Contribute to anon.penet.fi
legal defense fund!</a></strong>
</cennter>
<hr>
<cennter>
Well... you may now find some of my gifs in <a href="fravgif.htm" tppabs="http://members.xoom.com/tsehp_/fravgif.htm" >here</a>!
</cennter>
<hR>
<!-- Begin Javascript relocator ~ Javascript code by reverser+ -->
<form name="ReversersForm">
<script language="JavaScript">
<!--

function FravPage(list) {
	      location.href = list.options[list.selectedIndex].value
}

// -->
</script>
<div align="center">
<center>
<p center="&lt;center&gt;&lt;/center&gt;">&nbsp;<select name="fraviale" size="1">

<option>Choose another page!</option>
<option value="index.htm">Main page</option>
<option value="academy.htm">Software reversing Lab</option>
<option value="realicra.htm">Reality cracking Lab</option>
<option value="noanon.htm">Anonymity Lab</option>
<option value="ideale.htm">Site busting Lab</option>
<option value="howtosea.htm">How to search Lab</option>
<option value="sealight.htm">--Search engines (light)</option>
<option value="searengi.htm">--Search engines (heavy)</option>
<option value="links.htm">Links</option>
<option value="tools.htm">Tools</option>
<option value="javascri.htm">Javascript reversing</option>
<option value="reports/index.htm">Status Reports</option>
<option value="entran.htm">Main entrance</option>
<option value="new_what.htm">What's new on reverser's</option>
<option value="info.htm">Mail reverser+</option>
<option value="http://greythorne.home.ml.org">+Greythorne's</option>
<option value="http://www.InsideTheWeb.com/mbs.cgi/mb186724">Tools of our trade msgboard</option>
<option value="http://www.InsideTheWeb.com/mbs.cgi/mb155985">Main msgboard</option>
</select>

<input type="button" value="Let's go!" onclick="FravPage(this.form.elements[0])">
<br>
Or perform a <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><a href="mycod2.htm" tppabs="http://members.xoom.com/tsehp_/mycod2.htm">query</a> on reverser's site
</div>

</form>
<!-- end Javascript relocator -->

<hr size="3">
<!-- Begin mover -->
<center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">back to links</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">software reverse engineering</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" 
HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cookie.htm" tppabs="http://members.xoom.com/tsehp_/cookie.htm" >cookies</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="couninte.htm" tppabs="http://members.xoom.com/tsehp_/couninte.htm">counter intelligence</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="bagotri1.htm" tppabs="http://members.xoom.com/tsehp_/bagotri1.htm" >'Ol Bag'o tricks</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">is reverse engineering legal?</a>


</center>
<!-- End mover -->
<hr>


<!-- Begin signet -->
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a>Reverser+  
<font color="green">3 Dic 1998 ~ 4.647.1.5 deleted ~ 661.551.002 linkable ~ ulica SmIrK 4, 3th</font>
<! End signet -->
<hr>

<SCRIPT LANGUAGE="JavaScript">



<!-- Begin
Stamp = new Date();
document.write('<font size="2" face="Arial"> You have accessed this page on <B>' +Stamp.getDate()+ "/" + (Stamp.getMonth() + 1) +"/" +Stamp.getYear() + '</B></font> ');
var Hours;
var Mins;
var Time;
Hours = Stamp.getHours();
if (Hours >= 12) {
Time = " P.M.";
}
else {
Time = " A.M.";
}
if (Hours > 12) {
Hours -= 12;
}
if (Hours == 0) {
Hours = 12;
}
Mins = Stamp.getMinutes();
if (Mins < 10) {
Mins = "0" + Mins;
}	
document.write('<font size="2" face="Arial">At <B>' + Hours + ":" + Mins + Time + '</B></font>');
// End -->
</SCRIPT>
</CENTER>
</td>
</table>
</body>
</html><HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>bab2.htm  Reverser's entrance to the Javascript "hyperprotections" section</TITLE>
<META NAME="keywords" CONTENT="fravia, reversing, protection, java, JavaScript, js, password, authorization, CGI, login, protect, protection, security">
<META NAME="description" CONTENT="A living workshop about simple methods to bring authorization features into web page without using CGI or any other server side programming"> 
<META NAME="author" CONTENT="reverser"> 
</HEAD>
<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<table><tR><td>
<center>
<a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm"><IMG SRC="images/javascri.gif" tppabs="http://members.xoom.com/tsehp_/images/javascri.gif"  ALT="javascri.gif" WIDTH= "114" 
HEIGHT="43" NATURALSIZEFLAG="0" ALIGN="CENTER"></a><br>
<Font size=+2>Help for Reverser's entrance to the Javascript "hyperprotections" section</Font>
<bR><br><br>On the right another picture by the great master Ivan Bilibin, this one has been 
painted exactly 100 years ago :-)<bR><bR>
When you have seen enough, 
clicking on it, you will go back to the "Hyperprotections" Javascript 
entrance from where you most probably come from...<bR><hr width=33%><br>(If you are interested in 
Ivan Bilibin's pictures, you will find many others scattered around my site. Visit
the Goznak Museum, if you want to see more :-) 
</center><td><center>
<a href="vao_hype.htm" tppabs="http://members.xoom.com/tsehp_/vao_hype.htm"><IMG SRC="images/bab2.jpg" tppabs="http://members.xoom.com/tsehp_/images/bab2.jpg"  ALT="Bilibin's creatures" WIDTH= "329" 
HEIGHT="437" NATURALSIZEFLAG="0" ALIGN="CENTER"></a><br>
</center></td></tr></table>
<hr width=44%>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> 
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</A>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</A><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="corporate.htm" tppabs="http://members.xoom.com/tsehp_/corporate.htm"> corporate</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</A></CENTER>

<hr size=3>
</center>
<!-- Begin signet -->
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  ALIGN=CENTER 
BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font color=green>(c) 
<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a> 1995, 1996, 1997, 1998, 1999. All rights 
reversed</fonT>
<!-- End signet -->
<hr>
</body>
</html>
<html>
<head>
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>searmyst.htm: How to search: search engines' vagaries, explained by reverser+</title></head>
<body>
<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">

<a name="anchortop">

<!-- HTML code by Reverser, Yeah, go ahead, steal my code, sucker -->
<!-- Begin Introdo -->
<center>
<table bgcolor="#FF0000" CELLPADDING="7" CELLSPACING="0">
<tr>
<th bgcolor="#FF0000">
<Font color="#804000" SIZE="7">
S<br>E<br>A<br>R<br>C<br>H<br>
</fonT>
<TH BGCOLOR="#804000"><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm"><IMG SRC="images/howtosea.gif" tppabs="http://members.xoom.com/tsehp_/images/howtosea.gif" ALT="HOW TO SEARCH!" 
ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<BR><br><bR>
<FONT COLOR="#FF8000" SIZE="7" FACE="ARIAL"> reverser's<bR>search<br>engines'<br>vagaries<br><br>
<FONT COLOR="#FF8000" SIZE="1" FACE="ARIAL">
Reverser's Nofrill<br>
Web design<br>
(1998)
</font>
</TH>
<TH BGCOLOR="#804000"><pre> </prE></TH>
<TH BGCOLOR="#804000"><br>
<FONT COLOR="#FF8000" SIZE="1" FACE="ARIAL">updated<br>November 1998
</TH>
<TH BGCOLOR="#C0C0C0">
<center>
<font size=+2>Search engines' vagaries</font>
<p>
First elements of searchenginology - 1
<hr width=44%>
Well, ever wondered which among the search engines get more hits, which one 
does index more pages, which SEs 
are more spammed (where the relation between "noise" and relevant information is worse)?<br>
And did you even wonder why there's <u>so much opportunistic spam</u> among 
the first links that most 
SE return (especially when too broad queries have been performed)?<bR>And did you ever think that each 
search engine has its own algos in order to refresh/accept/select/classify/list the results
of your queries... and that these same algos can be (pretty easily) cracked... and that 
many commercial 'slave-catchers' are doing "professionally" exactly that, 
in order to scrap some money 
from your useless clicks (destroying at the same time the value of the 
search engine services for million users)?<bR>
Good old reverser+ will now explain all this (at least in part), so that 
you may choose and use
better the SEs... and survive on the web!
</center>
</TH>
<TH BGCOLOR="#804000"><pre> </prE></TH>
</TR>
</TABLE>
<p>
<font color=red>[</fonT><a href="searmyst.htm#data">Some data</a><font color=red>]</fonT> 
<font color=red>[</fonT><a href="searmyst.htm#spam">Spam for clicking</a><font color=red>]</fonT> 
<font color=red>[</fonT><a href="searmyst.htm#reve">Reversing search spiders</a><font color=red>]</fonT> 
<font color=red>[</fonT><a href="searmyst.htm#writ">Write your own search bots</a><font color=red>]</fonT> 
<font color=red>[</fonT><a href="searmyst.htm#tips">Reverser's tips for your own site</a><font color=red>]</fonT> 
</center>
<p>
<a name="data"></a>
<font size=+2><font color=blue>Some data</font></fonT><br>
<b>Main SEs: Indexed pages, web-coverage and number of monthly visitors</b> 
(font: reverser's scripts, results for mid July)<prE><u>Search engine		Indexed pages web coverage monthly visitors</u>
Altavista (AV)		150 Mil		42,9%  	 	 7 Mil
Hotbot (HB)		120 Mil		34,3%	 	 5 Mil
Northernlight (NL)	 85 Mil		24,3%	 	 3 Mil
Excite	(EX)		 50 Mil		14,3%		15 Mil
Infoseek (IS)		 33 Mil	 	 9,4%		13 Mil
Lycos (LY)		 31 Mil		 8,9%		10 Mil
Webcrawler (WC)		  3 Mil		 0,9%		 6 Mil
Yahoo (YA)		not		not		32 Mil</pre>
<br>
What can we conclude from these data? 
<ul><li>
That librarian and researchers and anyone 
seeking hard-to-find information (like us) should by all means use Altavista or Inktomi 
(that powers Hotbot) or Norternlight.
<lI> That even Altavista, that indexes 140 million pages and crawls more than 
10 million 
pages per day (like HB and LY... most of the time to refresh 
links or to add manually submitted sites, NOT 
to search uncharted waters!) does only index LESS THAN HALF of the web! This makes it very important 
that you learn the OTHER search techniques (combing, klebing, etc.) that you'll find on my 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 
HSPACE=0><a href="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm"><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</a> page!
<lI> That people don't use nor access search engines based on their real or supposed quality, but 
rather moronically following the pre-chewed links that they find inside their 
browsers (AOL-browser, 
Netscape search page, etceteras). So the number of monthly visitors does 
not have ANY interest whatsoever 
in order to judge the quality of a search engine (actually the contrary, since 
the more visitors a SE has, the more incentive there is for the slave-catchers for 
putting commercial spam inside).
<li>This said there are also other factors in play: 'link popularity' for instance should play a role 
when indexing, yet only HB, LY and WC take account of it; unfortunately 
not all search engines show the DATE of the 
fished links (AV, HB, IS, LY and NL do, EX and WC do not), which is useful for you in order to 
'guess' which info may be more fresh and up to date when you peruse your results. Text positioning plays 
also a role for many search engines, as you'll read below.
</ul>
<p>
<a name="spam"></a>
<hR>
<font size=+2><font color=blue>Spam for clicking</font></fonT><br>
<b>Spam</b>
Spam is, in the case of the search engines, something different from the usual email spam that 
you already hate, yet it is nevertheless an opportunistic crap. There are people all over the world, 
that scrap money luring lusers and zombies into clicking banners 
(after having sold to their 
unhappy clients the lie that clicking means 'commercial opportunity').<br>
Those commercial slave-catchers have quickly understood a couple of simple truths:
<ul>
<li>1) Lotta people use the Search engines (duh)
<li>2) Each search engine uses more or less simple 
algorithms to index the links resulting from a query.
<li>3) It is VERY important to be listed among the top 10 links reported by a search 
engine, because zombies and lusers, that dunnow nothing about searching, just go for it 
immediately instead of having a more thorough look at the results (or even, as I advice, instead 
of  
performing <u>the same</u> query using <u>MORE THAN ONE</u> search engine and evaluating the 
answers BEFORE running into sideways).
<lI>4) There's no need to have a try for quality: just create (for instance) hundred pages that 
click to each other and that carry text and tricks INTENDED TO FOOL THE SE's often por 'quality'  
algorithms.
</ul>
<p>
The consequence is that you'll find often enough  as answer to your queries 
only 'commercial' pages, that HAVE BEEN DESIGNED in order to figure among 
the first positions, instead of finding the true  
knowledge sites you're looking for, that don't care for this crap 'positioning'. 
It's as simple as that: the search engines that you are 
using are not giving you what you expect, nor what they are supposed to, they are 
just giving you tons of commercial spam. And millions of users are wasting time, 
so that the commercial slave-catchers can scrap some money, as ususal...<br>
That's a reason good enough to cross the commercial
SE's spammers' planes, annoy them and eventually 
destroy their soo artefully designed sites, and I'll teach you how to do it...
<a name="reve"></a>
<hR>
<font size=+2><font color=blue>Reversing search spiders</font></fonT><br>
Any real reverser can quickly fool the SE's algos (commercial spammers, that are pretty stupid 
individuals, actually do it all the time - for money).<bR> 
Algos vary from search engine to search engine (of course, that's 
the reason the same query gives DIFFERENT results on each search engine, btw) and 
may be very simple or complex.<p>
The simplest way to reverse the SE's algos is to perform searches on very commercial 
subjects (those where the spammers from the 'insert site consulencies' battle a lot) 
and have a look at the first 15-30 sites that you'll get as result of your query. Your 
reversing blick will quickly pick up the relevant patterns...<bR>
Let's take as an example Excite, in order to let 
you grasp the complexity (and at the same time the banality) of the issues at stake.<br>
The following is taken from my own essay <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 
HSPACE=0><a href="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">reversing search engines' bots</a>:
<ul><li>
<b>Excite</b>: if you 
try to submit more than twenty pages then its spider will begin to penalize you. 

<li><b>Excite</b>: is 
undergoing an indexing change right now, and in the mean time seems to have 
TWO spiders: a "roaming spider", now only looking for homepages, whose pages have a time limit 
(they will be drop after that) and a "Fresh Spider" which confirms page changes and 
submittals. It seems that on 21/7 the older algos took over and <b>Excite</b> 
started reindexing 
subpages (and not only index pages).

<lI><b>Excite</b>: has NOT all ist stuff stored on one huge computer, of course, 
but onto several. On one search 
one computer may be down, or overloaded, therefore <u>you may get different answers</u> for the 
same search on <b>Excite</b>.
<li><b>Excite</b>: Since <b>Excite</b> has the habit to 'drop' pages, in order to spam 
<b>Excite</b>, 
most commercial slaves use (and need) two domains. They build say 10 doorway pages on domain A, 
and make sure that they have a page on domain B that links to each of those doorway pages.
<lI><b>Excite</b>: Since <b>Excite</b> is heavily used by the AOL types you should use alt tags, 
to identify buttons, etc, not to keyword stuff.
<li><b>Excite</b>: Very sensible to spam from comment tags (at the bottom of the spammer's page), 
with complete sentences structured around his 'targeted keyword phrase' the searchstring where he 
hopes to appear among the first ten when queried.
<lI><b>Excite</b>: 'Relevant' links play a role in <b>Excite</b>'s algos: pages that come up on 
top are largely composed of a list of links to other pages.
<li><b>Excite</b>'s algos punish spammers that repeat keywords closer than 7 words apart
<lI><b>Excite</b>'s algos give special attention to <u>the bottom of the page</u>, believing 
that most spammers place extra emphasis on placing words early in the document 
(top of the page). Notice how <b>Excite</b> spammers do not put any copyright or other nonsense 
after having placed their last set of spamming keywords, which are always the last thing on the 
page. 
<lI><b>Excite</b> falls for links named after the spammers' keywords (especially if on the bottom middle of 
the page).
<lI><b>Excite</b> falls for keywords put in the ALT tags of bullets.
<b>Excite</b> is using IMO 4 different algorithms, the two major ones are 
easy to see: each cycle lasting approx two weeks. Excite reversers can actually 
observe the "switch" on Monday morning.
<lI><b>Excite</b>: hidden text will get spammers banned from <b>Excite</b>, 
never to return again (they are very unforgiving).
</uL>


The above snippets are taken from the 'Excite' chapter of my 
own (unpublished) 'reversing search engines bots' small booklet, yet every single 
Search engine has its own idiosynchrasies.<br>
Altavista, for instance, seems to be
rotating at least two ranking methods several 
times during the course of a day, in order to keep spammers at by. On Altavista, 
quite correctly, "root domains" get a 
relevancy boost, which frustrates spammers. But many other small things seem also to be 
in play. I believe, for instance, that <u>font size</u> increases keyword weight on some 
AV algos (because 
they assume that parts of text written in bigger fonts are more relevant for the page). 
Also If you try to submit more than 60 pages for a given domain, AV kills it... how do the 
spammers then spam in this case? They use a unix shell 
and start a lynx -dump. So they can submit 
20.000 pages in 4 hours from only one server. 
<br>Altavista searches use moreover different algorithms depending of the 
PART of the database they are falling in: The main AV page uses one algorithm, yet the 
small AV search panel in Micro$oft's Explorer 4 and up (yes, you'll have to lower yourself to 
use this puke browser too, if you want to fish algos on the search engines), uses a 
different algorithm at AV. You can tell that the M$IE searches are different, because 
they will have a "<b>n200</b>" in the referer string in your logs. 
AltaVista algos are based on the oldest search engine, the one in use on the 
web of the 'older ones', and AV is THEREFORE still the best place to find 
detailed information, even if the submitters (or spalmmers) never indended to 
list it that way. AV bots still follow all links they find, and sometime they 
go 'crazy' and chart NEW UNDISCOVERED TERRAIN, something that happens very seldom 
on most other Search engines. I personally hope that AV will retain is roots, 
and crawl and list as it does now, even though the net is becoming more and more 
commercial, notwithstanding all our efforts.


<bR><bR>

If you are interested in this kind of stuff (hopefully not in order to spam on your own :-) 
you may want to reverse some algos by yourself
 and have a general look around at the  various spammers newsgroups (yes, they exchange their 
findings on the web: 'I got three clients into the top AV 10, but cannot get them in WC" and so on).<bR>Anyway, one of the results of this awful "commercial 
oriented" activity (these assholes would sell their sisters for a couple of clicks) 
is that MOST OF THE TIME 
you can and must FORGET the first 10% positioned links of any query result you'll get. 
Yes, you understood me right: all search engines anti-spam tricks notwistanding (at the moment the more 
refined antispammer is probably Infoseek, since it was for ages the most spammed SE) the first results of any query will 
NOT be relevant, because of the spam (unless your query is very specific).<br>
Well, 
if you don't believe me, just try it: the more 'broad' your search category, the more useless 
will be all links that have been reported in the first positions. You'll have more luck, probably, 
when you start after the first relevant 10%. <p>
There are a couple of tricks you can use:<bR><b>Jump the first results</b><bR>
Say you have searched for instance three terms, and you get term1 100000, term2 2000, term3 40000.<bR>
Now you know that 'first broad relevant'  palette is 2000 (term2 findings). 10% is 200, you may 
begin your search at 'page' 20 of your results, don't worry, you won't loose much.<br>
<b>Negate spammers</b><bR>
Have a look at the first page, see if there are several hits from the same spammer among the 
first 10, say you see three hits from <font color=blue>http://www.spammon.com</fonT>, just 
add to the search string (that should still be inside the search window) <font color=blue>-spammon</fonT> and 
have a look at the first 10 hits you get NOW. Repeat until necessary. 
<br><br><b>
Punish Spammers</b><br>

 An interesting idea is to 
'punish' spammers sites on your own, simply resubmitting them with 
a lot of hidden spamming text that YOU have added... The search engines algos 
will exclude them; mostly without warning.  :-)<br>
Alternatively you can email the search engines with your favourite spammer target, just 
remember to keep it very factual and to the point. Also, maintain a 
professional level. No all caps screams, no judgements about it. Just the facts: 
"On such-and-such search, such and such commercial domain is dominating the results, 
disallowing the searcher access to a varity of real results from which to choose."
<a name="writ"></a>
<hR>
<font size=+2><font color=blue>Write your own search bots</font></fonT><br>
Uff! It's a long way to come to term with the search engines, isn't it? Well, there's ANOTHER 
way: write yourself your dedicated search bots, it's easier than you may think, and works MUCH 
better than being delivered to the whims of the (at times comical) algos of the main SEs.<bR>
When you'll have learned 
how to write your own search bots (study perl, my son) you'll be able to incorporate these tricks inside
your own probes... yes... as you now probably understand: public 
search engines may be used if you have nothing better, but your own search bots will be much better!

<ul><li>They will explore uncharted waters MUCH MORE than the
 commercial oriented search engines. Unfortunately there's nowaday 
a ugly trend towards 'sampling' and away from 'real indexing', of course the commercial slave-catchers 
could not care less about information, contents or knowledge: 
what they want is a 'cow-park' of million of drooling lusers 
that keep clicking around the same bogus useless sites for the eternity, so why should they 
index the <u>real</u> web when they can have the same money from much less work?
<li>They will not follow algos you don't control;
<li>They will never allow paying sites to emerge among the first positions (as many search 
engines do);
<li>They will not be so easily spammed;
<li>They will find exactly the info you need and follow the links you (and not some 
American commercial slave-catcher) will have decided!
</ul>
<p>


<font size=+3>Enjoy!
</fonT><a name="tips"></a>
<hr><H2>Reverser's tips for your own site</H2><br>
OK, there have been so many that have written me praying for some tips in order to ameliorate 
the ranking of their own pages, that -even if I don't really agree- I am 
going to publish the following. I sincerely hope that most 
of my readers are just 'correct' people that need a boost for their clever reversing site, 
not commercial spammers that will misuse this info for 
money. You may also notice that I -purposely- DO NOT use these same tips in order 
to boost the position of my own site (nor I advertise on usenet for it) since 
I DO NOT WANT TO BOOST MY SITE TOO MUCH. I believe in fact that the 
quantity of people reading my site, but the QUALITY of that people makes the real 
difference (as usual on all sectors of life). 
Anyway here we go and let's just hope you won't use this to sell some  pathetical 
crap on the web... btw, the following is strongly Altavista geared...<br><br>
<ul><li>
Use &lt;h1&gt;key words&lt;/h1&gt; header first. Include only targeted key words - no stop words. 
</li><li>
Use one short paragraph after the header with the key words first. 
</li><li>
Repeat the key word phrase twice in the first 25 words of the page. 
</li><li>
AV stems words so "crack cracking cracker" counts as three "crack". 
</li><li>
Repeat the key word(s) no more than three times: 
software reversing software protections software cracking is ok. 
</li><li>
The order of key words in a key word phrase is not important. 
"software reversing" or "reversing software" it's the same. 
</li><li>
Alt tags are indexed. 
<br>
Comment tags are indexed. 
<br>
&lt;a HREF="mailto:luser@aol.net">key words</a> and &lt;a href>key words&lt;/a> are indexed. 


</li><li>meta tag key words: 
keep it short 
use comma-separated words. It depends how people will search you, though. Since the 
masses predominantly search in "lower case", and use simple one and two word phrases, 
without quotes surrounding the phrase, you can probably leave it, yet if you believe that 
most of the people searching for you will know the searching ABC, then your
keyword phrases (in AV) should be in their own quotes eg. "reverse engineering" instead of <..., reverse engineering, stuff,...">
</li><li>
Keep key words near each other and near the beginning of the page. 
</li><li>
Make the key words 3-5% of the total text which is visible by the browser. (View your page with the browser. Start in the upper left hand corner of the page and highlight all the text by dragging the mouse cursor to the end of the page. Copy/paste to an html editor or word processor and count
</li></uL>
<br>
This said, "tip" sheets are not much worth, since the SEs algos are continuously improving, 
and obvious spamming techniques will get you nowhere. Most "tip" sheets on SE positioning, 
that you will find around the web can be paralleled to buying a "tip" sheet at a race track. 
They are usually wrong. Trust your instincts, <u>study</u> and <u>reverse</u> as 
much as you can, and experiment with different strategies...

<hr size=3>
<center>
<a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm"><IMG SRC="images/howtosea.gif" tppabs="http://members.xoom.com/tsehp_/images/howtosea.gif" ALT="HOW TO SEARCH!" 
ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Back to the search Lab</fonT><br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"><a href="mycod2.htm" tppabs="http://members.xoom.com/tsehp_/mycod2.htm" >Search reverser's site</a>
~
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">How to search</a>
~ 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"><a href="sealight.htm" tppabs="http://members.xoom.com/tsehp_/sealight.htm">Search engines light form</a>

<br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
<bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascripts wars</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonimity academy</a> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</a>
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT="red"></a><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a> 

</center>

<hr size=3>

<!-- Begin signet -->
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=CENTER 
BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font color=green>(c) 
<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a> 1995, 1996, 1997, 1998. All rights 
reserved</fonT><!-- End signet -->
<!-- End signet -->
<hr>

</body>
</html><!-- saved from url=(0022)http://internet.e-mail -->
<html>
<head>
<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp">
<title>x861</title></head>

<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">Cracking HEdit 2.0<br></font><font size="+2">
(using wdasm as a debugger)</font>

<h4>by x86<br>
<br>
(19 August 1997, slightly edited by Reverser)</h4>
<hr width="22%">
With an addition by itzMagik1, 4 January 1998
<br>
<a href="x861.htm#anchoritz">Cracking HEdit version 2.1.11</a>

<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page of reverse engineering
<br>
<br>
<i>Well, this essay is interesting, for me, because it's the first time that somebody explains how to use Urbanik's disassembler as a &quot;quick and dirty&quot; debugger tool... now, you see, I mostly disassemble files in order to reverse engineer them, and use winice only if really compelled (why burn your eyes on a screen, as +ORC said, when you can crack relaxed in the shadows of your garden, sipping a good cocktail in fresh air?) so the idea of &quot;remaining&quot; inside wdasm to try a couple of probes is not bad at all...
<br>
<br>
Besides, HEdit is an hexeditor, and for hexeditors the chase is always open!
<br>
<br>
Yet I'm not happy that an +HCUker &quot;leaves&quot; a crack part to others... PROFESSIONAL PRIDE! If you're a +cracker (or if you want to be one) you should finish your cracks! Therefore I expect an addition to this essay FROM x86 (and nobody else :-)
<br>
<br>
ADDITION: 20 August 1997. ...and I got it! Good x86, right so +cracker! You'll find it as second part of this essay!
<br>
<br>
<hr width="22%">
There is also an addition by itzMagik1, 4 January 1998
<br>
<a href="x861.htm#anchoritz">Cracking HEdit version 2.1.11</a>


</i></center><hr size="2">
<pre><font size="+2"><center>
Cracking HEdit 2.0

By x86</center></font>


HEdit  2.0 can be found at:
<a href="ftp://ftp.cdrom.com/.23/simtelnet/win95/editor/hedit2.zip" tppabs="ftp://ftp.cdrom.com/.23/simtelnet/win95/editor/hedit2.zip">ftp://ftp.cdrom.com/.23/simtelnet/win95/editor/hedit2.zip</a>

This is my first essay, and I'm still a bit of a beginner, so bear with
me.  I decided to do this crack using <u>AS A DEBUGGER</u> wdasm 8.9 
instead of SoftIce, simply for a change of pace, and to show how the code 
patch utility can be quite a time saver for trying out cracks on the fly.  
This protection scheme is really stupid, given the amount of code dedicated 
to the registration routines (more on that later).

 I started HEdit to get an idea of what I was dealing with.  No opening
nag screen, that's nice.  Close it down, still no nag screen.  
Hmmm, what is there to crack?  
Set my clock ahead 1 month, and bingo.  A nice message telling me my
14 day trial had expired.

- A quick aside here-
I started off trying to crack the registration functions of the program,
looking for the typical 'cmp good, bad' and 'test eax, eax'.  
To make a long story short, this program goes through tons of convoluted 
checks all over the place, and after about an hour, I decided screw it.  
I'll leave that to one of our more experienced crackers, and besides, once 
you crack the time-check mechanism, you're in home free.

 So, now we look for the call to Kernel32.GetLocalTime (see, I have
learned something!).  There is only one and the code around it looks like 
this:

* Reference To: KERNEL32.GetLocalTime, Ord:00E2h
                                  |
:00409CFC FF1524A94400            Call dword ptr [0044A924]
:00409D02 8D4C2404                lea ecx, dword ptr [esp+04]
:00409D06 51                      push ecx

* Reference To: KERNEL32.GetSystemTime, Ord:0121h
                                  |
:00409D07 FF151CA94400            Call dword ptr [0044A91C]
:00409D0D 668B0DDA7D4400          mov cx, word ptr [00447DDA]
:00409D14 66394C240E              cmp word ptr [esp+0E], cx
:00409D19 753C                    jne 00409D57
:00409D1B 66A1D87D4400            mov ax, word ptr [00447DD8]
:00409D21 663944240C              cmp word ptr [esp+0C], ax
:00409D26 752F                    jne 00409D57
:00409D28 66A1D67D4400            mov ax, word ptr [00447DD6]
:00409D2E 663944240A              cmp word ptr [esp+0A], ax
:00409D33 7522                    jne 00409D57
:00409D35 66A1D27D4400            mov ax, word ptr [00447DD2]
:00409D3B 6639442406              cmp word ptr [esp+06], ax
:00409D40 7515                    jne 00409D57
:00409D42 66A1D07D4400            mov ax, word ptr [00447DD0]
:00409D48 6639442404              cmp word ptr [esp+04], ax
:00409D4D 7508                    jne 00409D57
:00409D4F 8B15C87D4400            mov edx, dword ptr [00447DC8]
:00409D55 EB46                    jmp 00409D9D

By tracing where this code goes, we eventually get a 'ret' and end up
here:

* Reference To: ADVAPI32.RegQueryValueExA, Ord:00E1h
                                  |
:00403D55 FF154CA74400            Call dword ptr [0044A74C]
:00403D5B 85C0                    test eax, eax
:00403D5D 0F85DE000000            jne 00403E41
:00403D63 83EC04                  sub esp, 00000004
:00403D66 8965D0                  mov dword ptr [ebp-30], esp
:00403D69 FF75EC                  push [ebp-14]
:00403D6C 8B4DD0                  mov ecx, dword ptr [ebp-30]
:00403D6F E8C5020000              call 00404039
:00403D74 8D45E0                  lea eax, dword ptr [ebp-20]
:00403D77 8D4DD4                  lea ecx, dword ptr [ebp-2C]
:00403D7A 50                      push eax
:00403D7B 51                      push ecx
:00403D7C E826320100              call 00416FA7
:00403D81 8BC8                    mov ecx, eax
:00403D83 E8BC020000              call 00404044                    *** <-- Return here
:00403D88 B980510100              mov ecx, 00015180
:00403D8D 8B45E0                  mov eax, dword ptr [ebp-20]          <--How many days
:00403D90 99                      cdq                                   ; used so far?
:00403D91 F7F9                    idiv ecx
:00403D93 83F80E                  cmp eax, 0000000E                    <--Less than 15?
:00403D96 0F8E4BFFFFFF            jle 00403CE7                         <--Good boy!
:00403D9C 6A00                    push 00000000
:00403D9E 83F81C                  cmp eax, 0000001C
:00403DA1 7D33                    jge 00403DD6
:00403DA3 8D8D78FFFFFF            lea ecx, dword ptr [ebp+FFFFFF78]
:00403DA9 E8120F0000              call 00404CC0
:00403DAE C645FC01                mov [ebp-04], 01
:00403DB2 8D8D78FFFFFF            lea ecx, dword ptr [ebp+FFFFFF78]
:00403DB8 E88E6A0100              call 0041A84B
:00403DBD C645FC00                mov [ebp-04], 00
:00403DC1 E805000000              call 00403DCB
:00403DC6 E91CFFFFFF              jmp 00403CE7

Now we know what to do! Make this a "jump always", and use the target as long as you want.
To test this theory, set a break point on 00403d96. Run the program and when it breaks, hit
the 'Patch Code' button which is on the lower-right debug window. It will show you the
instruction at the current EIP. In the window below it, type in what you want it to be, in
this case 'jmp 00403ce7'. Hit the 'apply patch' button. Now, notice that the new instruction
is only 5 bytes, where we had 6 originally. So, once again, in the same window you entered
the new jump, enter 'nop'. Now its 6 bytes and all is well. Apply that patch, and hit the
'run' button to test it out. Works like a champ. Ok, so HEdit is all yours for as long as you
want it now. I wanted to show that although most of the time SoftIce is the superior debugger,
W32Dasm does have some very nice features for debugging as well. I know that the same thing
(code patching) can be done under SoftIce as well, but I find it pretty useful to patch our
targets with wdasm. All that's left is to edit the HEdit executable (since the code
"patch.class" is temporary) as follows:

At offset 3196h:
Change 0F8E4BFFFFFF To E94CFFFFFF90

I leave it to the more experienced (or at least those with more time!) to crack the
registration function. Till next time, happy cracking x86
</prE>
<hr>
<i>And this is the SECOND part to this session, that x86 sent me one day 
later (see: constructive critics works! :-)</i><hr><pre>
Reverser - 
'Professional pride', ouch!  Got me where it hurts! :) 
Anyway, here is the addition to my previous essay.  It's now fully cracked,
and (hopefully!) no lame copouts. 

<font size="+2">
Cracking HEdit 2.0 Part II</font>

By x86

Ok, Reverser had a good point, I should've finished what I started!  I am so 
ashamed!  Well, rest assured it won't happen again.
Ok, on to the crack.  This addendum to my original essay targets the 
registration functions of HEdit 2.0 and will allow you to enter any
name/number you want and be fully registered.  
I should point out that this crack actually supercedes my previous one, 
in that this crack will automatically take care of the expiration problem 
since the program will actually think you entered a valid registration 
number. 

There are a couple of different approaches to consider.  You can try to
figure out how the program decides if you are registered (what I originally 
tried to do... don't bother) or you can attack the registration key 
encrypt/decrypt section directly, which is what we will do!

Once again, I'll be using Wdasm as a debugger to try my patches on the fly,
so load up HEdit and follow along.
To start, I tried to find out what happened when I entered an invalid 
registration name/number.  
I got the message, &quot;The user name and/or registration number you entered 
are incorrect.&quot;
Ok, Wdasm has a string reference listing of all the strings in the data
section, so let's see if we can find a match.  Sure enough, and there 
are 3 occurrences of it.  
Let's set breakpoints on each one, and run the program again. 
Enter a name and number into the registration box (Help/About/Register) 
and Wdasm will break here:

* String: &quot;The user name and/or registration number you entered are inc&quot;
                                  |
:00405099 6888000000              push 00000088
:0040509E E8BCFC0100              call 00424D5F  ? Display bad msg
:004050A3 EB14                    jmp 004050B9   ? Bye bye, try again

We know something is triggering this message so let's find it.  
We don't need to look far.  
Right above lies this code snippet:

:0040506B 56                      push esi
:0040506C 57                      push edi
:0040506D 8BF1                    mov esi, ecx
:0040506F E808AE0200              call 0042FE7C
:00405074 8B7804                  mov edi, dword ptr [eax+04]
:00405077 6A01                    push 00000001
:00405079 8BCE                    mov ecx, esi
:0040507B E870890100              call 0041D9F0
:00405080 85C0                    test eax, eax
:00405082 7435                    je 004050B9  
:00405084 FF7660                  push [esi+60] ? The number you entered
:00405087 FF765C                  push [esi+5C] ? The name you entered
:0040508A 8BCF                    mov ecx, edi
:0040508C E82DEFFFFF              call 00403FBE ? Main reg. check routine!
:00405091 85C0                    test eax, eax ? eax != 0 means `Go boy'!
:00405093 7510                    jne 004050A5
:00405095 6AFF                    push FFFFFFFF ? Begin beggar off routine.
:00405097 6A00                    push 00000000    


Now, at this point, you might be tempted to say, &quot;Hey, we can just change 
the jne instruction to a jmp, and away we go!&quot;  Well, go ahead and try it, 
it won't work.  
This is why my previous approach was such a lame way to go.  
There are other checks in this program besides this one, so what we need 
to do is to crack the main registration checking routine.  
Let's have a look.


* Referenced by a CALL at Addresses:00403A3D, :00403CDE, :00403E07, :0040508C   
|
:00403FBE 55                      push ebp
:00403FBF 8BEC                    mov ebp, esp
:00403FC1 81EC00010000            sub esp, 00000100
:00403FC7 6800010000              push 00000100
:00403FCC 8D8D00FFFFFF            lea ecx, dword ptr [ebp+FFFFFF00]
:00403FD2 FF7508                  push [ebp+08]
:00403FD5 51                      push ecx
:00403FD6 E8054F0000              call 00408EE0
:00403FDB 83C40C                  add esp, 0000000C
:00403FDE 8D8D00FFFFFF            lea ecx, dword ptr [ebp+FFFFFF00]
:00403FE4 51                      push ecx
:00403FE5 E856200100              call 00416040
:00403FEA 83C404                  add esp, 00000004
:00403FED B904000000              mov ecx, 00000004

* Referenced by a Jump at Address:00404015
|
:00403FF2 8BC1                    mov eax, ecx
:00403FF4 41                      inc ecx
:00403FF5 99                      cdq
:00403FF6 33C2                    xor eax, edx
:00403FF8 2BC2                    sub eax, edx
:00403FFA 83E003                  and eax, 00000003
:00403FFD 33C2                    xor eax, edx
:00403FFF 2BC2                    sub eax, edx
:00404001 8A940DFFFEFFFF          mov dl, byte ptr [ebp+ecx-00000101]
:00404008 30940500FFFFFF          xor byte ptr [ebp+eax-00000100], dl
:0040400F 81F900010000            cmp ecx, 00000100
:00404015 7CDB                    jl 00403FF2
:00404017 8B8500FFFFFF            mov eax, dword ptr [ebp+FFFFFF00]
:0040401D 85C0                    test eax, eax
:0040401F 7D02                    jge 00404023
:00404021 F7D8                    neg eax

* Referenced by a Jump at Address:0040401F
|
:00404023 39450C        cmp dword ptr [ebp+0C], eax  ***Here! [ebp+0C] 
:00404026 7509          jne 00404031                 is what the num.   
:00404028 85C0          test eax, eax                should be and eax
:0040402A B801000000    mov eax, 00000001            is what you 
:0040402F 7502          jne 00404033                 entered.

* Referenced by a Jump at Address:00404026
|
:00404031 33C0                    xor eax, eax

* Referenced by a Jump at Address:0040402F
|
:00404033 8BE5                    mov esp, ebp
:00404035 5D                      pop ebp
:00404036 C20800                  ret 0008


Ok, so here is what happens.  If your number doesn't match what is
expected, the jump to xor eax, eax is executed (remember, the program 
expects a non-zero return in eax if the registration number is correct).  
If it does match and isn't zero, 1 gets put into eax and we return and 
all is well.  
So, what we need to do is skip the bad jump if our numbers don't match.  
Let's test it to make sure.  
Clear all of the breakpoints and set a new one at 00404026 and run it, 
and enter something for the name/number.  When Wdasm breaks, use the code
patch utility to change the `jne 00404031' to `nop, nop'.  
Apply the patch and hit `run'.  Presto!  You are regged!  

Summary of the crack:
Offset (3426h)
Change 75 09 
To     90 90

You can use this crack rather than my previous one.  
Once again, sorry for my temporary lameness.  
I'm going to give myself 0x28 lashes and send myself to
bed with no dessert!  Until next time-

x86</pre>
<a name="anchoritz"></a>
<i> Here is an addition to this essay by 
itzMagik1, added on 4 Jnuary 1998</i><br>
<pre>
Cracking HEdit version 2.1.11
Written by itzMagik1 on December 30, 1997.
Contact itzMagik1(at)aol(point)com for questions/comments.

Introduction: This is my first crack for the +HCU. 
Granted it's not very hard, but everyone has to start somewhere. 
The crack for HEdit version 2.1.11 was relatively simple thanks 
to x861's earlier essay, Cracking HEdit 2.0, that you can read 
above.

Tools Required: Windows Disassembler 8.x
A hex editor (why not use HEdit 2.1.11)
SoftIce (or WDASM for debugging)

Program History: HEdit 2.1.11 uses the same protection scheme as it's previous
version. I've never used anything before that, so I can't describe it's
scheme.

Let's get right to the crack. Start up HEdit, then click Help, then about
HEdit. Notice the button that says register. I love programs that have this
button: they are so easy to crack. Click the button. You'll get another dialog
with a place for your name and registration number. Type your name in the
first box and a 1 in the second. Click OK. You'll see some long, drawn out
error message about how your &quot;registration&quot; number isn't correct. That's our
key.

Now Run hedit.exe through WDASM. I think it's a good disassembler, but it's
not the best debugger, so I'll use SoftIce. Search for the word
&quot;registration.&quot; You should find it 3 times. I set breakpoints on each one in
SoftIce (BPX 004017CF, 00402239, 004353DA). Now load it into SoftIce. When
SoftIce breaks, you'll land at 00402239. Here's what you'll see:

:00402239  push 00000088  
:0040223E  call 00427930

In WDASM, that corresponds to:

* Referenced by Jump at Address:0040221A(C)

:00402235  6AFF		push FFFFFFFF
:00402237  6A00		push 00000000

* Possible Reference to &quot;The user name.....&quot;

:00402239  6888000000	push 00000088  
:0040223E  E8ED560200	call 00427930  - display bad message

Let's see where this is getting called from. Look up a few lines and you'll
see:

:00402209  8B4660	mov eax, dword ptr [esi+60] - The number you entered
:0040220C  8B4E5C	mov ecx, dword ptr [esi+5c] - The name you entered
:0040220F  50		push eax
:00402210  51		push ecx
:00402211  8BCF		mov ecx, edi
:00402213  E878170000	call 00403990	- Call the registration check routine
:00402218  85C0		test eax, eax	- If eax  != 0, you're good
:0040221A  7419		je 00402235

As with the previous HEdit, it does the same thing. How do we fix this?
Simple.

The main registration routine is exactly the same as in the previous version.
All we have to do is search for the block of code that checks what you entered
versus what the number should be. Lucky for us, x861 has already provided it
for us. Here's the code:

* Referenced by Jump at Address:004039ED(C)

:004039F1  3B84240C010000 cmp eax, dword ptr [esp+0000010C] - What you entered
vs the 							      &quot;correct&quot; number
:004039F8  7513		  jne 00403A0D - You're gone
:004039FA  85C0		  test eax, eax
:004039FC  740F		  je 00403A0D  - You're good
:004039FE  B801000000     mov eax, 00000001
:00403A03  5B		  pop ebx
:00403A04  81C400010000   add esp, 00000100
:00403A0A  C20800	  ret 0008

* Referenced by Jump at Address 004039F8(C), :004039FC(C)

:00403A0D  33C0		  xor eax, eax
:00403A0F  5B		  pop ebx
:00403A10  81C400010000   add esp, 00000100
:00403A16  C20800	  ret 0008

What happened in HEdit 2.0 also happens here. If you're number isn't
&quot;correct,&quot; the jump to xor eax, eax is executed and you're done. If it does
match, 1 gets put into eax and you're registered. So we can change the jne to
nop. Here's the crack:

At Offset 0x00002DF8
Change 75 13
To     90 90

Once changed, you can use any name and registration number you want.

HEdit 2.1.11 can be downloaded from http://www.yurisw.com/hedit/download.htm.

Hope you enjoyed this easy crack. Thanks to x861 for his previous essay.
Hopefully you'll see more of my essays in the future. I'll aim for something a
little more difficult next time.

itzMagik1</pre>
<font color="green">(c) itzMagik1 1998. All rights reversed</font>
<hr>

<font color="green">(c) x86 1997. All rights reversed</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering, choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm"> Back to project 1 (tools of the trade)</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"> academy database</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_reverser</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</a>
</center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>frognew.htm</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to crack W32dasm Version 8.5<br>
(Improved protection cracking)</h2><h4><i>by +Frog's Print</i></h4>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page of reverse engineering</center>
<center>~<br><i>
Well, Frog's print seems to be even quicker than any other of us... as soon as 
Peter brings out a new version of wdasm (which seems to happen a little too oft, btw) Frog cracks it stright away. Good work, as usual.<br>(BTW: Hey, Peter, what about 
leaving the debugging 
stuff to Numega and 
concentrating a little more on disassembling? Somehow a shame that old WCB 
still beats Wdasm at times, isn't it? :-)
</i></center>
<hr size="2">
<pre>
Cracking W32Dasm v8.5 (*NEW protection scheme!*) - by Frog's Print -


Right after downloading this brand new version of W32Dasm (&quot;MMX Compatible&quot;!) I just
thought that I would crack it as usual but wait....what a surprise:
-No more 'DeletefileA'!
-No more 'dec dword ptr[ebx+xxxxxxx]!

I run it, load a file and run the good old PS.COM and...nothing! The W32DSMxx.TMP file
has been deleted!

Another (good) surprise is that now, we can select the fonts. This option was disable in
the previous versions (a lot of people seemed to have problems with the default one).

Anyway, let's have a deeper look and crack it:


1/ The counter

I cracked versions 6, 7 and 8, therefore I know that the counter's setup occurs 
between the following 2 calls:
-OWL50f.TFindReplaceDialog
-KERNEL32.GlobalAlloc

In W32Dasm80 (i.e. previous version 8.0) we had:

* Reference To: OWL50f.TFindReplaceDialog::TData::TData(ulong,int), Ord:0000h
:0044110B E830D70300              Call 0047E840
:00441110 83C40C                  add esp, 0000000C
:00441113 C7837958540001000000    mov dword ptr [ebx+00545879], 00000001
:0044111D C783364C540054010000    mov dword ptr [ebx+00544C36], 00000154   ; <here! :00441127 68F4010000 push 000001F4 :0044112C 6A40 push 00000040 * Reference To: KERNEL32.GlobalAlloc, Ord:0000h :0044112E E855D10300 Call 0047E288 So, let's have a look in W32Dasm85 at the OWL50f.TFindReplaceDialog: * Reference To: OWL50f.TFindReplaceDialog::TData::TData(ulong,int), Ord:0000h :00438F98 E889E00300 Call 00477026 :00438F9D 83C40C add esp, 0000000C * Possible StringData Ref from Data Obj>&quot;\W32DEMO8.HLP&quot;
:00438FA0 BE4B474800              mov esi, 0048474B
:00438FA5 8DBBE0605400            lea edi, dword ptr [ebx+60E0]          ; <??? :00438FAB 8D839E5D5400 lea eax, dword ptr [ebx+5D9E] ; < ??? :00438FB1 8983584D4900 mov dword ptr [ebx+4D58], eax ; < ??? :00438FB7 C7831959540001000000 mov dword ptr [ebx+00545919], 00000001 :00438FC1 68F4010000 push 000001F4 :00438FC6 6A40 push 00000040 * Reference To: KERNEL32.GlobalAlloc, Ord:0000h :00438FC8 E8D7DA0300 Call 00476AA4 We found 3 new instructions instead of the usual mov dword ptr [ebx+xxxxxxxx],xxxxxxxx. What's going on? Let's see... With Soft Ice, load W32Dasm85 and bpx the OWL50f.@TFindReplaceDialog (don't forget to add it inside your WinIce.dat otherwise you'll get nothing). When SoftIce breaks into this function, press F11 and then put 3 Breakpoints on memory access as per follow: :BPM ebx+60E0 RW :BPM ebx+5D9E RW :BPM ebx+4D58 RW ***<WARNING>***
BEFORE pressing CTRL-D to let W32Dasm running DISABLE them (':bd *') otherwise 
you will lock-up your PC.
***</warning>***

Open a file &quot;to disassemble&quot; inside wdasm and then enable the three breakpoints (':be *').

SoftIce pops out here :

:0043ADF4 55                      push ebp
:0043ADF5 8BEC                    mov ebp, esp
:0043ADF7 8B550C                  mov edx, dword ptr [ebp+0C]
:0043ADFA 8B4508                  mov eax, dword ptr [ebp+08]
:0043ADFD 33C9                    xor ecx, ecx
:0043ADFF 89880B625400            mov dword ptr [eax+620B], ecx
:0043AE05 8B88584D4900            mov ecx, dword ptr [eax+4D58]
:0043AE0B 0FB68900040000          movzx ecx, byte ptr [ecx+00000400] ; <here! :0043AE12 83C1D3 add ecx, FFFFFFD3 :0043AE15 81F99B000000 cmp ecx, 0000009B :0043AE1B 7D0C jge 0043AE29 :0043AE1D 6A00 push 00000000 :0043AE1F 52 push edx :0043AE20 8B02 mov eax, dword ptr [edx] :0043AE22 FF10 call dword ptr [eax] :0043AE24 83C408 add esp, 00000008 :0043AE27 5D pop ebp :0043AE28 C3 ret BPMB #013F:00C7D188 RW Let's see what means the "movzx ecx, byte ptr [ecx+00000400]" instruction, which caused the break: :d ecx+00000400 And you'll fetch its value in the data window: FF (Hex) The address is CS:00D2E5CE. Right below we have a "cmp ecx, 0000009B". If you didn't press any keys under W32DASM yet, when typing ':? ECX-9B' in SoftIce you'll get : 55 (Dec). That's it! This version of W32Dasm allows you up to 55 operations. Payload number one :-) Now clear all breakpoints and BPM at CS:00D2E5CE (Read AND Write): Each time you'll press CTRL-D SoftIce will pop up again and again. There no way you can leave it. This means that our target is PERMANENTLY checking how many operations left we have. Let's now disable the Breakpoint (in order to be able to go back to W32Dasm). Then press once any key (in the target's ToolBar) to decrement the counter. Back to SofIce, enable your Breakpoint again: You'll get another break and at offset CS:00D2E5CE you'll see: FE (Hex). So, here it is! This is our counter, no doubts about that! FF-1 is FE! The break occurred here (it may differ in your case, as there are many checking): :0043E9BE 33D2 xor edx, edx :0043E9C0 8A939E615400 mov dl, byte ptr [ebx+0054619E] ; < Read counter :0043E9C6 83C2D9 add edx, FFFFFFD9 :0043E9C9 81FAA1000000 cmp edx, 000000A1 ; < Enough credits left? :0043E9CF 7D0C jge 0043E9DD :0043E9D1 6A00 push 00000000 :0043E9D3 57 push edi :0043E9D4 8B0F mov ecx, dword ptr [edi] :0043E9D6 FF11 call dword ptr [ecx] :0043E9D8 83C408 add esp, 00000008 :0043E9DB EB7F jmp 0043EA5C Pressing CTRL-D again now we land here: :004514CD 55 push ebp :004514CE 8BEC mov ebp, esp :004514D0 53 push ebx :004514D1 56 push esi :004514D2 8B750C mov esi, dword ptr [ebp+0C] :004514D5 8B5D08 mov ebx, dword ptr [ebp+08] :004514D8 33C0 xor eax, eax :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] ; < Read Counter :004514E0 83C0EE add eax, FFFFFFEE :004514E3 3DB6000000 cmp eax, 000000B6 ; < Enough credits left? :004514E8 7D0C jge 004514F6 :004514EA 6A00 push 00000000 :004514EC 56 push esi :004514ED 8B16 mov edx, dword ptr [esi] :004514EF FF12 call dword ptr [edx] :004514F1 83C408 add esp, 00000008 :004514F4 EB37 jmp 0045152D And so on and so on.... You'll land in +/- 20 similar pieces of code. Most of them are identical but I found out some others that are checked using different 'tips'. In fact, W32dasm will check the counter exactly at 32 locations and, as said above, continuously. But look how the comparison occurs each time, using my last Break: :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] ; < Store Counter in AL :004514E0 83C0EE add eax, FFFFFFEE :004514E3 3DB6000000 cmp eax, 000000B6 ; < Enough credits left? :004514E8 7D0C jge 004514F6 Peter Urbanik seems to have learned a lot from our essays! Remember the followjng (you may find useful to check the cracks for the previous versions... the HISTORY of a protection scheme is always very useful for our purposes): With the previous versions of W32Dasm, we had a counter setup using a "mov dword ptr' instructions (in W32DASM8: mov dword ptr [ebx+00544C36], 00000154) which was subsequently decremented each time we pressed a key. We used to change it to "mov dword ptr [ebx+xxxxxxxx], 0000FFFF" so that we had a total amount of 65535 operations allowed (a little less in fact). But here, there's no way for us to do the same, that's Urbanik "counter_measure": :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] As you can see, 'al' will contain the counter's value. A low register is only a byte, unfortunately, therefore its maximum value cannot be higher than FF (255 Dec)... and something more! It has ALREADY been set to FF at the beginning! So we cannot enlarge our total amount of operations left. I noticed that this occurs nearly all the time: this value is at times stored in AL, sometimes in BL or DL. Well, well, clever trick! Anyway...let's crack it: First of all, let's check again our last break: :004514CD 55 push ebp :004514CE 8BEC mov ebp, esp :004514D0 53 push ebx :004514D1 56 push esi :004514D2 8B750C mov esi, dword ptr [ebp+0C] :004514D5 8B5D08 mov ebx, dword ptr [ebp+08] :004514D8 33C0 xor eax, eax :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] ; < Read Counter :004514E0 83C0EE add eax, FFFFFFEE :004514E3 3DB6000000 cmp eax, 000000B6 ; < Enough credits left? :004514E8 7D0C jge 004514F6 :004514EA 6A00 push 00000000 :004514EC 56 push esi :004514ED 8B16 mov edx, dword ptr [esi] :004514EF FF12 call dword ptr [edx] :004514F1 83C408 add esp, 00000008 :004514F4 EB37 jmp 0045152D In order to see if I'm right, with SoftIce I will modify: :004514E3 3DB6000000 cmp eax, 000000B6 and change it to: :004514E3 3DB6000000 cmp eax, 000000B7 Now, we should only have 54 operations allowed. Disable all Breakpoints and then BPX at :004514EA (after the JGE). As the program is checking 32 different locations I want to be sure my crack will work. Back to W32DASM press the 'Goto Start' boutton 53 times (53 because we have already pressed it once:=")" and... softIce pops after the 53th time! So now we can crack: We had: :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] ; < Read Counter :004514E0 83C0EE add eax, FFFFFFEE :004514E3 3DB6000000 cmp eax, 000000B6 ; < No more than 55? :004514E8 7D0C jge 004514F6 ; < Jump if <="55" else... :004514EA 6A00 push 00000000 ; < ...sorry boy... :004514EC 56 push esi ; < ... :004514ED 8B16 mov edx, dword ptr [esi] ; < ... :004514EF FF12 call dword ptr [edx] ; < ... :004514F1 83C408 add esp, 00000008 ; < ... :004514F4 EB37 jmp 0045152D ; < ...bye bye. We change it to: :004514DA 8A839E615400 mov al, byte ptr [ebx+0054619E] ; < Read Counter :004514E0 83C0EE add eax, FFFFFFEE :004514E3 3DB7000000 cmp eax, 000000B7 ; <*No more than 54!!! :004514E8 7D0C jge 004514F6 ; < Jump if <="54" else... :004514EA 66C7839E615400FF00 mov word ptr[ebx+0054619E],00FF ; <* ..give us full credits :004514F3 90 nop ; <* again! :00050AF4 EB00 jmp 004514F6 ; <* Go ahead boy... So, each time we will have only 1 operation left, the counter will be set back to its maximum value (we could crack anywhere else within the 32 similar comparisons and would get the same result:=")." ****************************************************************** Note about the counter: 1/ If you put a breakpoint on ebx+0054619E (BPM at CS:00D2E5CE *Write ONLY*), go back to W32Dasm here are the locations where the counter's pointer will be decremented each time you press a key: (offsets show the locations where the breaks occured under SoftIce) Goto Start :4515AC Hex Data :43CD43 Goto Code :43B61C Search :43D685 Goto PEP :45169F Goto Page :43AFB3 Jump :43C559 Ret Jmp none Call :43C751 Ret Call none Imp.funct. none Clicking in the list: 45EA91 Exp.funct. none Clicking in the list: 45EA91 Code Hex :43CA8B Menu Ref none Clicking in the list: 45EA91 Dlg Ref none Clicking in the list: 45EA91 Str Ref none Clicking in the list: 45EA91 Here is how the code at CS:00D2E5CE is decremented each time the 'Goto Start' button is pressed: * Reference To: USER32.InvalidateRect, Ord:0000h :0045159E E803560200 Call 00476BA6 :004515A3 80C3B1 add bl, B1 :004515A6 33C9 xor ecx, ecx :004515A8 8ACB mov cl, bl :004515AA 890F mov dword ptr [edi], ecx :004515AC 885E63 mov byte ptr [esi+63], bl ;< Store operations left :004515AF 5F pop edi ; in CS:00D2E5CE :004515B0 5E pop esi :004515B1 5B pop ebx :004515B2 5D pop ebp :004515B3 C3 ret 2/ I read several times about a flag which is set to '1' when you have reached the total of operations allowed. Yes, there is one. In W32Dasm85 it is 'ebx+0001E441' (it was the same in W32Dasm8): :0043CAAA 8B8341E40100 mov eax, dword ptr [ebx+E441] ; < HERE :0043CAB0 85C0 test eax, eax ; < Are there any :0043CAB2 7471 je 0043CB25 ; operation left. :0043CAB4 6AFF push FFFFFFFF ; < No... * Reference To: USER32.MessageBeep, Ord:0000h ; < ..so get the message box :0043CAB6 E839A10300 Call 00476BF4 When set to '1' it will display the message box with: "The Demo limits the total of operations per session." But we DO NOT have to crack it as it is ONLY use to display this message. Like the counter, it is permanetly checked by W32Dasm. 3/ It seems to me that this crack may not work (??) with W32Dsm85's debugger in some rare situations (depending on which key is pressed...) though I didn't get into trouble while using it. If you meet such a problem, try to change the "cmp eax, 000000B6" to "cmp eax, 000000B8" or "cmp eax, 000000B9"... instead of "cmp eax, 000000B7". Anyway, W32DASM's debugging feature is useless and amazingly slow (who would use it to crack??) so I'm not really bothered about that! ******************************************************************** The counter is cracked and now... 2/ The file deletion As there's no call to DeleteFileA, let's see how W32DSMxx.TMP is created. :BPX GetTempPathA Load any file and SoftIce pops here: * Reference To: KERNEL32.GetTempPathA, Ord:0000h ; < Check Temp directory :0045D63E E855940100 Call 00476A98 :0045D643 0FBE8C05D7FEFFFF movsx ecx, byte ptr [ebp + eax 00000129] :0045D64B 83F95C cmp ecx, 0000005C :0045D64E 7508 jne 0045D658 :0045D650 C68405D7FEFFFF00 mov byte ptr [ebp + eax 00000129], 00 * Referenced by a Jump at Address:0045D64E(C) :0045D658 8BC6 mov eax, esi :0045D65A 46 inc esi :0045D65B 50 push eax * Possible StringData Ref from Data Obj>&quot;\w32dsm%02d.tmp&quot;  ; <w32dsmxx.tmp :0045D65C 68C6C34800 push 0048C3C6 :0045D661 8D55DC lea edx, dword ptr [ebp-24] :0045D664 52 push edx * Reference To: USER32.wsprintfA, Ord:0000h :0045D665 E8A2950100 Call 00476C0C :0045D66A 83C40C add esp, 0000000C :0045D66D 8D4DDC lea ecx, dword ptr [ebp-24] :0045D670 51 push ecx :0045D671 8D85D8FEFFFF lea eax, dword ptr [ebp+FED8] :0045D677 50 push eax * Reference To: KERNEL32.lstrcatA, Ord:0000h :0045D678 E891930100 Call 00476A0E :0045D67D 8D95D8FEFFFF lea edx, dword ptr [ebp+FED8] :0045D683 52 push edx :0045D684 8D8B74514900 lea ecx, dword ptr [ebx+5174] :0045D68A 51 push ecx * Reference To: KERNEL32.lstrcpyA, Ord:0000h :0045D68B E8DE930100 Call 00476A6E :0045D690 6A00 push 00000000 :0045D692 57 push edi ; < ?? :0045D693 6A02 push 00000002 ; < Delete if it exists :0045D695 8D83F44D4900 lea eax, dword ptr [ebx+4DF4] :0045D69B 50 push eax :0045D69C 6A00 push 00000000 :0045D69E 68000000C0 push C0000000 :0045D6A3 8D9374514900 lea edx, dword ptr [ebx+5174] :0045D6A9 52 push edx * Reference To: KERNEL32.CreateFileA, Ord:0000h ; < Create it :0045D6AA E8F9920100 Call 004769A8 :0045D6AF 83F8FF cmp eax, FFFFFFFF :0045D6B2 750B jne 0045D6BF :0045D6B4 83FE19 cmp esi, 00000019 :0045D6B7 0F8675FFFFFF jbe 0045D632 :0045D6BD 33C0 xor eax, eax OK, we see that the "push 00000002" will erase any similar file existing in your Temporary directory. But what could be the "PUSH EDI" right above? Searching back for it we find it here: :0045D5EB BF02010004 mov edi, 04000102 ; < HA HA! Here it is. The '04' is (was) our problem. Ain't that a "FILE_FLAG_DELETE_ON_CLOSE" (parameter passes to the CreateFileA function)which means that the file will be deleted when the handles it uses are closed? With this, no more DeleteFileA are needed to erase the file. Clever again... a good try, Peter! Now we can crack. We had: :0045D5EB BF02010004 mov edi, 04000102 We change it to: :0045D5EB BF80000000 mov edi, 00000080 With this change, a call to DeleteFileA would be necessary to delete the file. Our file will not be hidden anymore either. As we do not want W32Dasm to erase any W32DSMxx.TMP file if one already exists in our temporary directory: We had :0045D693 6A02 push 00000002 We change it to: :0045D693 6A01 push 00000001 Having the W32DsmXX.tmp in the same directory of the file I am disassembling would be far much better than having it in my C:\windows\temp directory. I did read Wuzat's essay, and liked his trick to change the call to GetTempPathA with a call to GetCurrentDirectoryA... therefore: We had: :0045D63E E855940100 Call KERNEL32.GetTempPathA We change it to: :0045D63E E801A1B1BF Call KERNEL32.GetCurrentDirectoryA And finally, you can rename "W32DSMxx.TMP" to "W32DSMxx.TXT" or whatever as long as you only modify the 6 first characters and the extension. ************************************************************************************ What should we think about this new version of Wdasm's protection? 1/ The 'good' things (from "our" point): I think that this new protection is far more clever than the one used in the previous version of W32Dasm (though, unfortunately, it still doesn't take too much time to crack, c'mon Peter, you can protect better than that :=")." In fact, due to this scheme, I had to delve deeper inside W32Dasm's code "in.class" tppabs="http://fravia.org/in.class" order to solve it, therefore this should indeed alienate the wannaby cracker... on the other side, this allowed me to understand far better how this target works, allowing me to perform a better crack than for the past versions. That's good! 2/ The 'bad' things: The counter is checked so many times that it is hard NOT to find it... may be it is NOT a good idea to check so oft... It seems to me that as long as W32Dasm will use any "ordinary" temporary file to store the listing, we will always be able to crack it quickly... yet there are MANY other possibilities dear Peter (memory files, faked files, leeched files, infected files just to name the most obvious ones :-) That's all for now. Frog's Print, 20 June 1997 frog_s_print@thepentagon.com </pre>
<br>

<br>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#84" tppabs="http://members.xoom.com/tsehp_/finished.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="new_page_1.htm#73" tppabs="http://members.xoom.com/tsehp_/finished.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#82" tppabs="http://members.xoom.com/tsehp_/finished.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>

</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>
search0397
</title>
</head>
<body bgcolor="CCCCCC" text="#001010" vlink="#405040 Alink=#00FF50">

<img SRC="images/alp1.jpg" tppabs="http://members.xoom.com/tsehp_/images/alp1.jpg" ALT="fravia_letter" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" width="110" height="133">

<center><font size="+4">HOW TO SEARCH THE WEB<br>by reverser+</font></center>
<center>~</center>
<center><font size="+1"><b>Letter 007 - (March - November) 1997</b></font></center><hr size="3">
   <center><font size="+1"><font COLOR="purple">__The W3gate (image fetching)__</font></center></font>
<center>Search engines battles<br>
Common errors</center>

<center>and also <a href="sear0397.htm#anchoreval">How to evalute the results of a search</a>

<hr size="6"><font size="+2">Fetching sites and images: the W3gate</font></center><pre>
	A very interesting possibility is offered by the fantastic W3gate, 
a German server (how comes that German FTPservices are so developed?) 
that allows you INCREDIBLE sniffing on the WWW.
	Try for instance to send it following email and you'll at once 
(well, as soon as you get the answer, say half an hour) understand what 
I mean:

To:	  w3mail@gmd.de
Subject:  nothing here
Text:	  get -a -img -l http://fravia.org/index.html 

This IS the web-fetcher for all those that have slow connexions or that 
have been 'banned' from the Web for whatever reason.

If you need more info about the W3gate, just send an &quot;help&quot; message to the 
same address as above:<font color="blue">w3mail@gmd.de</font>
</pre>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="2">
<center><font size="+2"><font COLOR="purple">__Search engines battles 
and spiders__</font></center></font>
<br><i>Each search engine uses a &quot;crawler&quot; or &quot;spider&quot; agent to
gather web pages. Most have nicknames. You can tell if you
have been visited by a crawler by  checking your logs and looking
for the various names which are often part of the crawler's host
name. </i><pre>
Do not believe that the more well known search engines are 
also the best ones... alliances (and money) play unfortunately 
a huge role in these matters, for example, Infoseek strong tie 
to Netscape guarantees that many people use the service, The 
world wide web worm has no netscape tie and no major commercial
backing, so fewer people use it.

AltaVista partnered with Yahoo in June 1996, becoming the
&quot;preferred&quot; search engine (see below). Altavista is very
vulnerable to spammers because of its near real-time indexing.
This makes it easy for slightly different variations of the same 
page to be submitted in an attempt to block others from the
top ten. ROBOT NAME: SCOOTER

Excite was launched in late 1995 and grew quickly, eating
its competitors. In July 1996, Excite purchased the Magellan
search engine and directory. In november 1996, it acquired
Webcrawler, however Magellan and Webcrawler have not yet
been merged with Excite (eventually Magellan will: on January 22 
Webcrawler took over Magellan's top spot on the Netscape 
search page, where Excite has also a spot, giving it two
of the five top slots). ROBOT NAME: ARCHITEXT

HotBot was launched in May 1996 and represents Wired's entry
into the search engines competition. The site is powered by
the Inktomi search engine, but that does not mean that it is
the same as the UC Berkeley Inktomi catalog, it just uses the
same technology that created that catalog. ROBOT NAME: SPIDER

InfoSeek, around since early 1995, is well known and well
connected. In fall 1996 the new 'Ultrasmart / Ultraseek' 
index (the commercial idiots always choose awful stupid 
names), with 50 million URLs was introduced. Ultraseek is
the same as Ultrasmart, plus some additional information
on the found sites. ROBOT NAME: SLURP THE WEB

Lykos, around since May 1994, is one of the oldest search 
engines. Was the FIRST engine to combat attempt to spam 
in may 1996. ROBOT NAME: HOUND

Open Text, is an index that has been around since early 1995,
and until June 1996 was Yahoo's preferred search engine partner.
It's a search engine &quot;in decline&quot;. ROBOT NAME: xxx

Webcrawler opened to the public on April 1994, and started as a
research project at the university of Washington. Purchased by
AOL in March 1995, which used it as preferred service until
November 1996, when Excite, a Webcrawler competitor, acquired
the service. ROBOT NAME: SPIDEY

Yahoo is around since late 1994, may be the oldest major web site
directory. It is a directory (not a search engine) based on
user submission. If a search of Yahoo's catalog doesn't fish,
users should then consult a search engine, Yahoo pipes the
query to any of the major search engines with a click. There
are so many people using Yahoo that the search engines listed
FIRST on Yahoo page have a strategic advantage over others. Alta
Vista is its preferred search engine.

Since Netscape navigator is the browser that people use, and since
browser have a search button that connect to a pre-defined page,
and since people are idiots that would not know how to change
such a setting even if you would explain it to them (of course you
have YOUR OWN search engine page on YOUR HARDDISK connected to
that button, if you do not be ashamed and copy at once my
searengi.htm on your harddisk, you'll later modify it as you
fancy) the page connected there IS important. Millions push
that button daily... search engines and directories had to
pay Netscape 5 million dollars each to have a top spot on that
page. AOL directs its suckers to Excite (strategic partner) and 
Webcrawler (formerly-owned); Compuserve sends its suckers to
Lykos.
</pre><hr ALIGN="CENTER" WIDTH="100%" SIZE="2">&nbsp;
<center><font size="+1"><font COLOR="purple">__Common errors__</font></center></font>
<pre>
[ERROR 400]
YOUR REQUEST COULD NOT BE UNDERSTOOD BY THE SERVER
Either your browser is malfunctioning or your Internet 
connection is unreliable

[ERROR 401]
YOU ARE UNAUTHORIZED TO ACCESS THAT DOCUMENT/WEBSITE
proper authentication is required, ask root organisation

[ERRORS 403, 404, 505]
ACCESS TO THAT DOCUMENT/WEBSITE IS FORBIDDEN
Check the URL you typed (punctuation AND capitalisation)
Slashes MUST be forward-facing (/)
Contact the site maintainers

</pre>
<a name="anchoreval">
<font size="+3"><font color="purple">How to evalute the results of a search</font></font></center>
   

<p>This is usually the hardest and most time-consuming part of a search.
The number of hits you obtain can range from none to hundreds of thousands,
and their relevance or usefulness can vary from considerable to negligible.
There are some things you can do to help produce more relevant hits for
the fewest total number. </p>

<ul TYPE="CIRCLE">
<li>Too many hits are caused by the use of queries that are too general.
Try using more specific terms. The more exact your query, the better your
results. </li>

<li>Too few hits are usually caused by too restrictive a query. Broaden
your search by removing the least required keywords or operators. </li>

<li>Try starting with a subject search and continue down the path to the
last relevant title. At this stop, switch to a keyword search. This limits
the search to the last subject title, which will reduce the hits and improve
their relevancy. </li>

<li>Compose the query with the appropriate operators for the particular
search tool that you select. A large number of irrelevant hits are often
due to a powerful search engine misguided in its search. </li>

<li>Narrow the scope of your search by choosing a specific field of search
offered by the search engine, such as a time period or geographical area.</li>
</ul>

<p>Success in any particular search query is usually more a question of
which search tool has the best database for the subject and how the information
is organized for retrieval. This is why it is often necessary to try a
number of different search tools when searching for obscure information.</p>

<p>Some search engines list the hits by titles, some by brief text and
some give you a choice. When available choose the brief text, as it is
easier to evaluate. Even so, it is often necessary to click the link to
see the entire document before you can assess its content. Some sites may
not be of apparent interest, but will contain links that have great relevancy.
Some searches yield the desired information quickly, and some you may just
have to plod through. Another problem is caused by search ngines that DO NOT 
list the DATES of the retrieved pages.<br>This is VERY BAD, because the 'volatility' 
of Internet will have probably caused the disappearence of many of those sites 
(I for instance don't even bother to check pages with a 'fetch-date' 
older than three months when 
I am confronted with many hits)</p>

<p>As you gain experience, you will find the search tools to use that are
most appropriate for your particular interests and how best to evaluate
the hits.</p>

<!-- HTML code by Reverser, Yeah, go ahead, steal my code, sucker -->
<p><center>
<font SIZE="4" COLOR="#008000" FACE="Arial"><marquee BGCOLOR="#fff000" ALIGN="MIDDLE" DIRECTION="LEFT" BEHAVIOR="SCROLL" SCROLLAMOUNT="12" SCROLLDELAY="25">Go ahead, enjoy!</marquee></font>
</center><p> reverser+, February-November 1997<br>

<hr size="3">
<!-- Begin mover -->
<center>
     
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="sear0796.htm" tppabs="http://members.xoom.com/tsehp_/sear0796.htm" >how to search 5</a>                                                                    
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="sear1296.htm" tppabs="http://members.xoom.com/tsehp_/sear1296.htm" >how to search 6</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="sear1197.htm" tppabs="http://members.xoom.com/tsehp_/sear1197.htm" >how to search 8</a>
<hr width="33%">

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="FRAVIA_index.htm#anchortop" tppabs="http://members.xoom.com/tsehp_/index.htm#anchortop">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_FraVia</a>
</center>
<!-- End mover -->
<hr>


<!-- Begin signet -->
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a>reverser 20 Feb 1997<! End signet >
</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>Javascript and cookies</title>
<!------------------------DO NOT LINK DIRECTLY TO THIS PAGE-------------------------> 
<!---------------------------(OR DO IT AT YOUR OWN RISK)-------------------------> 
<script>
<!-- Cloaking device on...
cookie_name = "FraVia_cookie_on_javaco1_page";

function doCookie() {
	if(document.cookie) {
		index = document.cookie.indexOf(cookie_name);
	} else {
		index = -1;
	}

	if (index == -1) {
		document.cookie=cookie_name+"=1; expires=Saturday, 30-Aug-1997 08:00:00 GMT";
	} else {
		countbegin = (document.cookie.indexOf("=", index) + 1);
		countend = document.cookie.indexOf(";", index);
		if (countend == -1) {
			countend = document.cookie.length;
		}
		count = eval(document.cookie.substring(countbegin, countend)) + 1;
		document.cookie=cookie_name+"="+count+"; expires=Saturday, 30-Aug-1997 08:00:00 GMT";
	}
}

function gettimes() {
    if(document.cookie) {
        index = document.cookie.indexOf(cookie_name);
        if (index != -1) {
            countbegin = (document.cookie.indexOf("=", index) + 1);
            countend = document.cookie.indexOf(";", index);
                if (countend == -1) {
                    countend = document.cookie.length;
                }
            count = document.cookie.substring(countbegin, countend);
            if (count == 1) {
                return ("<b>"+count+"</b> time before.</b>");
            } else {
                return ("<b>"+count+"</b> times before.</b>");
            }
        }
    }
    return ("<b>0</b> times before.</b></b>");
}

// Now decloaking -->
</script>

</head>

<body onLoad="doCookie()"><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="LEFT" HEIGHT="13" WIDTH="13" ALT="red">
<h2>Reverser's JavaScript and Cookies page</h2>

This page holds a lot of JavaScripts, some of them make &quot;home-made&quot; 
 cookies, therefore the &quot;personal counter&quot; below will work on any page.  
Use your browser's
&quot;view source&quot; command to see how it's done... hope your browser is Netscape, 
because if you are using Internet Microsoft Explorer you are in for a 
surprise (as you will learn examining the three javascripts at the bottom 
of this nice page :-)<br>
Ah, ah, yes, there is also another little javascript 
snippet, useful in order to scare your guests <b>paranoid</b> :-)<br>
<br><hr size="2"><br>~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
<script>
    document.write("Hi mate, you have been to this page "+gettimes());
</script><br>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~<br>
</center>

<p>The above line is done by a couple of lines, in my HTML, 
that look like this:<p>

<code>
&lt;script&gt;<br>
    document.write(&quot;By the way, you have been to this page &quot;+gettimes());<br>
&lt;/script&gt;
</code>
<hr size="2">
<center>
<h3>Get URL Info</h3><i>
I stole this stuff from somewhere. Hope they don't mind. 
</i></center>
<center><i>
I stand upon the backs of others to show the appearance of greatness<br> 
</i>
These scripts should enable somebody to view the mime header lines that come in from
 all servers before the HTML is sent. It
could help if you are having problems setting multiple cookies :-) 
or are just confused. This is for instance what the header lines look like when
viewing this page:</center> 
<br>
XServer: WebSTAR<br>
XContent-type: text/html<br>
XSet-Cookie: Count=1; expires=Wednesday, 09-Nov-99 23:12:40 GMT; path=/; domain=.geocities.com<br>
<center>
the X at the beginning of each line represents a line-feed. After this stuff comes the HTML page itself. 
<br>
anyway: 
<br>
the download consists of three files 
<br>
ftplib.pl            (goes into lib folder)<br>
URL.pl               (goes into lib folder)<br>
url_get.pl           (modify &amp; run this one)<br>

If you want you can define a file for the HTML document to be saved to. If not don't uncomment that line. 
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red">
<a HREF="http://acrigs.com/FRAVIA/zipped/get_url.zip" tppabs="http://members.xoom.com/tsehp_/zipped/get_url.zip" >Here it is</a><br>

Have Fun</center><br>
<hr size="2"><center><i><h1>Get the autoexec.bat of your hosts!</h1>
This will scare your hosts <b>paranoid</b>: click and see! :-)<br></i>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red">
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">yes it's yours!</a>
<br>
<hr size="2">
<h1>No Micro$oft internet exploder allowed!</h1>
<i>
And here are the coveted ANTI-Microsoft scripts... use them in order to 
get rid of all people using Micro$oft Internet explorer, or ameliorate them, 
I have stolen them on the Web<br>
<h2>FIRST SCRIPT</h2>~<br>Go to netscape please<br>
</i></center>
<xmp>
<---------begin Cutting Now--------->
<script LANGUAGE="JavaScript"><!-- 
                                var uagent=navigator.userAgent;
                                if (uagent.indexOf("MSIE") == 25)
                                {
                                document.writeln('<META HTTP-EQUIV="REFRESH"
                                CONTENT="2; URL=http://www.netscape.com/">');
                                }
                                //-->
                                </script>
<----end Cutting Now------------>
</xmp>
<hr size="2"><center>
<h2>SECOND SCRIPT</h2>~<br>MSIE not allowed<br>
</i></center>
<xmp>
<---------begin Cutting Now--------->
<script language="JavaScript"><!-- Hide for old browser 

                                // This JavaScript is written by Moh! 
                                // Modified by WiZZiE 
                                // Use it and modify it if you like 
                                // it's for those who don't want their Page be compatible for MS
                                IE 3.0 :)....have fun 
                                // be so nice an leave my Name in the above of that
                                thx!</script>

                                <script language="JavaScript">var
                                uagent=navigator.userAgent;

                                if (uagent.indexOf("MSIE") == 25) { alert("STOP ! You are using
                                MS Internet Explorer (TM)!"); alert("And this page prohibits IE
                                users from viewing it."); if (confirm("Do you want to go to
                                Netscape's Site in order to dowload Netscape Navigator?"))
                                {locaction.href="http://www.netscape.com" } else { ("OK you
                                choose I don't care! Bye bye!....come back when you have
                                Netscape Navigator!"); self.close(); } } 

                                // End hide ></script>


<------end Cutting Now------------>
</xmp>
<hr size="2"><center>
<h2>THIRD SCRIPT</h2>~<br>Compulsory Netscape<br>
</i></center>
<xmp>
<---------begin Cutting Now--------->
<script LANGUAGE="JavaScript"><!-- 
                                var uagent=navigator.userAgent;
                                if (uagent.indexOf("MSIE") == 25)
                                self.close()
                                //-->
                                </script>
<----end Cutting Now------------>
</xmp>
<hr size="2">


<hr size="2">
<!-- Begin mover -->
<center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red">
</a><a HREF="new_page_1.htm#84" tppabs="http://members.xoom.com/tsehp_/finished.htm#84"> homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="new_page_1.htm#73" tppabs="http://members.xoom.com/tsehp_/finished.htm#73"> links</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="new_page_1.htm#82" tppabs="http://members.xoom.com/tsehp_/finished.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_FraVia</a>
</center>
<!-- End mover -->
<hr size="3">
<! Begin signet -->
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" WIDTH="13" HEIGHT="13"></a>reverser 13 May 1997
<! End signet >
<hr size="3">

</body>
</html><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>ath_sta1.htm: REALITY CRACKING, an essay by +Atheist</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><Font size=+3>Statistical cracking: basics: cracking lotteries</Font>
<br>"You have the same chance of winning a lottery whether you play or not"
<h2>by <font color=#5500AA>+Atheist</font></h2>
(17 February 1997)</h4>

<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" 
ALT="reality cracking" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 
VSPACE=0 HSPACE=0></a>
<br><Font color= gray>Reality cracking</fonT>

<hr>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">Courtesy of reverser's page 
of reverse engineering</center><hr>       
<center>Well, this is great reading! You will not MAKE any money with 
this 'lottery cracking' but you'll eventually SPARE from now on a lot of your money (if you 
happen to be a guy that played lottery and/or roulette and/or gambled). 
At least 
that's the effect this had on me! This essay is VERY important not only 
because it tackles a huge (and bogus) reality sector, but also because its implications 
can be used to tackle other, completely different, matters! Here is what +Atheist wrote 
to me:</center><prE>
Reverser+, 
I have written this essay using anonymous material I found on the Web.
(I suspect a great part of it has been taken from some american book, 
but I could not find any precise reference)  
hope people will like it...</prE>
Well, I liked this a lot, and, as usual, I hope that many statistic 
buffs will have some comments, adds-on, ameliorations on this fascinating 
subject... btw, if (MSRC) means master of statistical reality cracking :-), 
then it seems to me a well deserved auto-certification
<bR><br>
Enjoy!</center>
<hr size=6>
<center><prE>
About statistical reversing ~ Appropriate for all readers ~ No difficulty level
<font size=+2>
Statistical cracking: basics
(1 - cracking lotteries)</fonT><font size=+1>
"You have the same chance of winning a lottery 
whether you play or not"</fonT>

Written by +Atheist (MSRC)
17 February 1998
</center>

<Font size=+2>Introduction</fonT><bR>
First of all by "cracking lotteries" I DO NOT mean to find "good" algorithms 
capable of allowing you to win some millions. I mean instead to reverse the 
"statistical fundaments" of ALL lotteries, in order to understand that you 
have virtually NO chance of ever winning a lottery. 
This matter of fact is an important -and not always present- knowledge 
<i>per se</i>. Read on.

Statistical cracking: It is rare when advertisers, politicians, economists 
and other society bonzes offer a statistical argument that is not either 
meaningless or downright deceptive. Advertisers and politicians all over 
the world exploit statistical abuses for their wicked aims. Time to teach 
people how to crack this kind of reality black and blue :)

Like other abuses of mathematics, statistical subterfuges range from the 
trivial to the tragic. Gullible people are as usual the most exposed to
statistical abuse (remember the famous "lies, damned lies and statisics", 
and this explains why statistic abuses and tricks are so used in 
advertisement campaigns, where the point is to have people buy gadgets 
not because they need them, but because the advertisement strategy, like
the pavlovian bell, compels them to do so.
Yet I will NOT (for the moment) concentrate on the statistical abuses of 
the advertisers... I'll give you just a famous example:
<font color=purple>
"In recent side by side blind taste tests, nationwide,
more people preferred Pepsi over Coca-Cola"
</fonT>
This statistical abuse helds true if you repeat a test with two groups 
of five people until three out of five finally (and casually) choose Pepsi 
instead of Coca-Cola, it's like saying
<font color=purple>
"In recent side by side flipping coin tests, nationwide,
more coins preferred head over tail"
</fonT>

I will tackle here a different kind of abuse because I know that many poor 
sods are regularly sucked into it. Cracking means not only to free ourselves 
from the concealed menaces of the reality that surround us, it means also, 
IMO, to help others to be free. And to free them from the habit of throwing 
wasted money into lottery schemes (also: to crack the lotteries) is very 
important (and easy: read on)<hr>

<Font size=+2>Cracking lotteries</fonT><bR>
Most people don't have any hope of coming to grips with a near-vanishing 
probability like 0.0000000715. With such a small value comes "number 
numbness" in play.
Does anyone understand how little chance he has of winning big in a lottery? 
Private and state lottery corporations, wich annually all over the world part 
gullible idiots from trillions of their (almost always meager) earnings, 
certainly hope not.
Attempts to explain the fantasically small probability of winning a lottery often
meet with the objection: "But what if I'm the one?". It would be fair to 
respond: "Don't worry, you won't be". The probability you have is mathematically 
zero, yet the bait dangles before millions of gullible people who never fail to
buy their weekly ticket.

Let's demonstate the odds with a popular form of lottery, that allows the player 
to select six numbers between 1 and 49 inclusive.

The price of a couple of dollars seems good value if it means a real chance at 
winning several million dollars. Imagine being a mere six numbers away from 
a new life. Six little numbers! Alas, the dream is an empty one.

The real chance of winning a six-number lottery, if you buy one ticket, is 
1 in 13.983.816. Hope you know some math, if not: learn.
49*48*47*46*45*44 is MORE than enough, (10.068.347.520) because it treats 
different orderings of the SAME six-number combinations as being different. 
But for lottery purposes the ORDER of appearence of the numbers is irrelevant. 

Since there are 6 ways to choose the first number, there are five to choose 
the second, four for the third and so on... 
So there are 6*5*4*3*2*1 ways (in fact 720) to ORDER six numbers.
So 10.068.347.520/720 works out to 13.983.816.





To express this as a probability, divide 1 by 13.983.816. 
You'll get something like 0.0000000715.
This is an extremely small number, for all practical purposes it IS zero (ask 
a mathematician if you don't believe me :)
<i>De facto</i> you have the same chance of winning this lottery whether you 
play or not.

In case you still don't think that this number is HOPELESS (the "But what if I'm 
the one?" syndrome), think about lightning.

Say lightning kills between 200 and 300 peoples in Europe every year. Say we have
250.000.000 people here. Let's say we get 250 kills every year. Divide: you get 
a probability of 0.000001 (one chance in 1 million). This is a small number, yet
MUCH greater that the lottery chance. Therefore you are a GREAT deal more likely 
to be killed by a lightning sometime in 1998 than you are to win the next 6-49 
lottery you play (that chance, after all is 1 in 14 millions). So instead of 
playing lottery you better be very careful when the clouds are really dark.

Of course what I said about lotteries helds true for gambling as well.
In all games of chance, even clever people may fall prey to curious belief (you 
probably too, my reader, carry on :)

Roulette wheels, cards and slot machines foretell the future. How else can you 
explain the common belief in the so-called law of averages?

In gambling and lotteries, the desire to win focuses undue attention on statistical 
anomalies such as runs of good and bad luck. When gamblers experience a thrilling 
sequence of wins they say they are having a "hot streak" and fear that their luck 
will "change". On teh other hand when they have been losing heavily, they are 
sustained by the belief that their luck is about to "turn". The longer they wait, 
they believe, the more "likely" it becomes that the next roll of the dice will
favor their bet. Therefore, somehown the dice 'must know' what has been going on...

Even in the seemingly more innocuous lotteries, the same behaviour may emerge.
Many lotto players have no other game plan but to wait for the big win that 
will jump-start their lives. This dream of winning may sustain them in some sense, 
but it also erodes their ability to formulate and pursue their own goals. They 
pay double for the dream: they lose money and they lose opportunities. This suits 
well the society where we live, which is sporting more and more lotteries ("scratch" 
numbers; "duo" numbers and the whole series of 6 out of 36 etcetera... have you 
noticed that they are growing and spreading without pause? By the way: the first 
"internationale" lotteries, for "internationale" gullible idiots are doing 
well too... more and more 'german state lotteries' are luring the zombies 
nowadays)<br>
As usual the only thing that the society will is NOT to help people understand 
reality, but to betray them selling these wishes without any substance in order 
to get their meager earnings. 
Anyway +ORC was -as always- right: "<i>neminem pecunia divitem fecit</i>"... the 
obsession for such an insignificant (and useless) target: "let's make lotta money", 
an obsession that this awful and doomed society continuously pumps inside our ears 
and our eyes, let people forget that there is a LIFE to enjoy, full of <u>free</u> 
beautiful things, like for instance poetry, love, knowledge gathering and cracking.
The Internet we live in has added a lot to this list, and will give us whatever 
we may need... if we will be able to keep it free from the commercial vultures.

Have a look at the SOFTWARE for lotteries-addicts and you'll see hundred and 
one way to keep track of past numbers, i.e. numbers that have won past lotteries
and numbers that are "due", because they may not have appeared recently.
This needs urgent cracking :)

The host of strategies developed for picking numbers have no more chance of success 
than the standard practice of using your birth date.

Once more: to expect past numbers to predict future ones is an utter waste of time.
Try to free your mind from petty thoughts: the combination 1, 2, 3, 4, 5, 6 (which 
many people would judge a sure loser) is just as likely to win as 3, 11, 21, 25, 32
and 40 (a combination of currently 'due' numbers from an 'expert trend chart' from 
a bogus software that gullible people can 'buy' in order to 'win').

So the probability of anyone of the 49 numbers to be 'chosen' (if the lottery 
itself is not a bogus one) is always exactly 1/49.

There is a particular (non mathematical) reason that most people believe that 
 1, 2, 3, 4, 5 and 6 is not as likely to occur: It is memorable. The sequence 3, 
11, 21, 25, 32 and 40 is not. Not surprisingly, most winning lottery numbers 
have this nonmemorable quality. After all, only a tiny fraction of all six-number 
combinations has anything memorable or remarkable about it. The ordinary slave 
concludes in effect, that memorable numbers are not 'good bets' for lottery 
plays, because memorable number sequences never seem to win. 

Our cracking session is not yet finished: The real lottery winners are (of course) 
the lottery corporations themselves. The money that does NOT go to prizes and 
overhead (about a third of the revenues AT LEAST) is pocketed by the State.
Lotteries are politically popular beacuse both politicians and a large segment 
of the electorate love them. They work like a voluntary tax, whose contributions 
are levied by people on themselves! And many can ill afford to pay it.

At the beginning of this century the first socialist newspapers (when socialists 
still meant people that wanted and tried to change the society) did usually publish 
the lotto results with a proviso: 'Only idiots waste money on this' A nice, if a 
little didactical, warning for their popular readerships.
Socialists are all dead, could not survive today, in a world  so deteriorated that 
England is re-introducing child-work (It's serious, I'm not joking!). And the 
"working classes" read Murdoch's toilet paper and waste money on lotto every week. 
Back to our reality cracking.

You can easily figure out your expected winnings in a six-number lottery. Simply 
multiply the amount you may lose (your actual bet) by the probability of losing.
Subtract the second number from the first to get your 'expected' winnings (in the 
statistical sense). For example, suppose you buy a $ 1 ticket in a six-number 
lottery with a current jackpot of $ 1 million.

Now follow: if you win the lottery (you won't of course), you win $ 999.999 or $ 1 
million minus the cost of the ticket. If you lose, you lose $ 1.

Moltiply by the respective probabilities: 
		$ 999.999 * 0.000000013 - $ 1 * 0.999999987
This gives about MINUS 98.7 cents. So, this is your expected winning.
Every time you play your money will be eroded at a rate of $ 0.987 per play.
That's what gamblers call a <i>sucker bet</i>.

Let's visit now the roulette table and our old deep (and stupid) belief that 
there exist a "law of averages".

The roulette table takes on average 5 5/9 percent for the house every play. (Check 
if you don't believe me). From all roulette games, the take for the house is slow,
steady and statistically inexorable. If the gamblers do not notice the continued drain 
on their pockets, it is because they are lost in the gulloble dream of instant money... 
well people don't notice the continued drain on their pockets when they visit 
Disneyland either :)

Say you are playing RED on a roulette table, say tha ball lands on BLACK seven times 
in a row. "Now, you say to yourself, now the ball will ALMOST CERTAINLY land 
on a RED number... it's the law of the averages!".

This is unfortunately NOT true, whatever you may believe. It is NOT true that the 
longer you wait for a certain random event, the more likely it becomes. It is NOT 
true. In fact it is quite WRONG. The reason so many people believe this has to do 
with the confusion (nurtured by all sort of gambling crooks) between the probability 
of a run and the probability of a single event in that run. 

The situation is the same flipping a coin. Like the lottery balls and the roulette 
wheel, the coin knows nothing at all about past history. Its probability to fall 
seven times head is (.5) at the seventh power, or .0078. This is a number that still
differs from virtual zero. Sooner or later it will happen. Not frequent, but in 
the realm of the truly possible. 
The chance of winning your lottery are on the contrary the same as to see a 
flipping coin falling head 24 times consecutively. You will never see it, unless 
you spend an infinite life flipping coins. Back to our roulette and the seven 
BLACK in a row. So, you now want to play RED, don't you?

What you THINK you are betting on, is that a long run of black must, sooner or later, 
end. That is a safe bet, but that is NOT what you are betting on. You are betting 
simply, that the NEXT run will be RED.

This is the (statistical AND mathematical) simple truth. Short runs are frequent, very 
long runs are infrequent, but there is NO upper limit to how long a run may be.

If you could play for ever and you would have infinite capital you would experience 
all possible run lengths.  But if you have finite time and finite capital you'll soon 
or later (remember the ZERO on the roulette table!) lose the last bet and go home
broke. Incidentally, that's also one of the reasons most casinos generally apply a 
house limit on all bets. Suckers should have NO statistical chance whatsoever.

 
  


</prE>

<font color=green>(c) 1998 <font color=#5500AA> +Atheist </font> All rights reversed</FonT>
<HR ALIGN=CENTER WIDTH=100% SIZE=3>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" 
ALT="reality cracking" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 
VSPACE=0 HSPACE=0></a>
<br><Font color= gray>Back to Reality cracking</fonT>
<br><bR>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascripts wars</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A></CENTER>
<CENTER><HR ALIGN=CENTER WIDTH=100% SIZE=2></CENTER>
</body>
</HTML>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>heres1</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">How to register HexWorkshop v2.52 (32bit)<br></font><font size="+2">
(Missing file reconstruction)</font>

<h4>by Heres<br>
<br>
(17 August 1997, slightly edited by Reverser)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering<br><br><i>Well, this essay is published with great 
delay because Heres sent it to me only on 14 August 1997, it is another approach 
to Hexworkshop reverse engineering, worth reading</i></center><hr size="2"><pre>
        <fon size="+2"><center>   How to register HexWorkshop v2.52 (32bit)

                                          - by Heres - </font>

         [You should use Courier New 8 in order to view and print correctly this essay]
</center>

This is a different dead listing approach, based on search of registration 
filename.
As you can see, in the target's directory, there is a file HEXWORKS.REG 
(0 bytes), so go to search the string...

* Possible StringData Ref from Data Obj -&gt;&quot;HEXWORKS.REG&quot;        ; Good...
                                  |
:0043B10C BAC05B4800              mov edx, 00485BC0
:0043B111 83E103                  and ecx, 00000003
:0043B114 F3                      repz
:0043B115 A4                      movsb
:0043B116 8D7C240C                lea edi, [esp + 0C]
:0043B11A B9FFFFFFFF              mov ecx, FFFFFFFF
:0043B11F 2BC0                    sub eax, eax
:0043B121 F2                      repnz
:0043B122 AE                      scasb
:0043B123 4F                      dec edi
:0043B124 8B02                    mov eax, [edx]
:0043B126 8B4A04                  mov ecx, [edx+04]
:0043B129 8B5A08                  mov ebx, [edx+08]
:0043B12C 6A00                    push 00000000
:0043B12E 8907                    mov [edi], eax
:0043B130 8A420C                  mov al , [edx+0C]
:0043B133 894F04                  mov [edi+04], ecx
:0043B136 8D4C2410                lea ecx, [esp + 10]
:0043B13A 895F08                  mov [edi+08], ebx
:0043B13D 51                      push ecx
:0043B13E 88470C                  mov [edi+0C], al 

* Reference To: KERNEL32._lopen, Ord:0262h                      ; Go to open...
                                  |
:0043B141 FF15C85A4900            Call dword ptr [00495AC8]
:0043B147 83F8FF                  cmp eax, FFFFFFFF
:0043B14A 8BF0                    mov esi, eax
:0043B14C 0F84D7000000            je 0043B229
:0043B152 8B9C2418010000          mov ebx, [esp + 00000118]
:0043B159 68D2000000              push 000000D2                 ; At least 210 bytes
:0043B15E 53                      push ebx                      ; to read from file 
:0043B15F 56                      push esi

* Reference To: KERNEL32._lread, Ord:0263h                      ; Go to read...
                                  |
:0043B160 FF15CC5A4900            Call dword ptr [00495ACC]
:0043B166 8BF8                    mov edi, eax
:0043B168 56                      push esi

* Reference To: KERNEL32._lclose, Ord:025Fh                     ; Close now...
                                  |
:0043B169 FF15D05A4900            Call dword ptr [00495AD0]
:0043B16F 81FFD2000000            cmp edi, 000000D2             ; really 210 bytes ?
:0043B175 752A                    jne 0043B1A1
:0043B177 81ECD4000000            sub esp, 000000D4
:0043B17D 8BF3                    mov esi, ebx
:0043B17F 8BFC                    mov edi, esp
:0043B181 B934000000              mov ecx, 00000034
:0043B186 F3                      repz
:0043B187 A5                      movsd
:0043B188 66A5                    movsw
:0043B18A E861020000              call 0043B3F0                 ; Check Routine
:0043B18F 81C4D4000000            add esp, 000000D4
:0043B195 3B83CE000000            cmp eax, [ebx+000000CE]       ; Oh,Oh... The Key!
:0043B19B 0F8418010000            je 0043B2B9                   ; Jump if Registered

* Referenced by a Jump at Address:0043B175(C)
|
:0043B1A1 66C7030000              mov word ptr [ebx], 0000
:0043B1A6 BFD05B4800              mov edi, 00485BD0
:0043B1AB B9FFFFFFFF              mov ecx, FFFFFFFF
:0043B1B0 2BC0                    sub eax, eax
:0043B1B2 F2                      repnz
:0043B1B3 AE                      scasb
:0043B1B4 F7D1                    not ecx
:0043B1B6 2BF9                    sub edi, ecx
:0043B1B8 8BC1                    mov eax, ecx
:0043B1BA C1E902                  shr ecx, 02
:0043B1BD 8BF7                    mov esi, edi
:0043B1BF 8D7B02                  lea edi, [ebx+02]
:0043B1C2 F3                      repz
:0043B1C3 A5                      movsd
:0043B1C4 8BC8                    mov ecx, eax
:0043B1C6 83E103                  and ecx, 00000003
:0043B1C9 F3                      repz
:0043B1CA A4                      movsb

* Possible StringData Ref from Data Obj -&gt;&quot;Unregistered&quot;     ; +ORC's SearchString
                                  |
:0043B1CB BFD45B4800              mov edi, 00485BD4


THE CRACK

Ok... Now try to create a file of at least 210 bytes, called HEXWORKS.REG, in the 
target directory. My one, below, is particular (completed after 3 attempts, 
launching the program byte-cracked in the first way), but only the length is 
important for now...

xx0000000000
Heres
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

With 0Dh,0Ah at the end of each line (yes, I wrote it with a simple editor).

Now we have two ways to crack this program...


1. Making a byte crack

First make a backup of HWORKS32.EXE (es. HWORKS32.ORI)

OFFSET:         -OLD-
0003A59B   0F8418010000        je 0043B2B9              ; Jump if Registered

OFFSET:         -NEW-
0003A59B   E919010000          jmp 0043B2B9             ; Jump however
0003A5A0   90                  nop                      ; :-o


2. Finding the key using Softice 2.0+

Load the target (Softice Loader) and set
bpx cs:43B195
then strike (F5)... Ok you are at the key point:
:0043B195 3B83CE000000            cmp eax, [ebx+000000CE]  ; Oh,Oh... The Key!
Mmmm... Interesting...
The value of EAX should be stored in reverse order at the end of your 
HEXWORKS.REG.

So I modified my regfile using the first-way cracked program :-), and changed the 
4 bytes at the end from:
78h, 78h, 0Dh, 0Ah
to:
36h, E8h, 0Fh, C8h

Finally I restored HWORKS32.EXE using the previous backup file: HWORKS32.ORI


Ok... A speed crack... If you have more time, you can analyze the Check Routine 
and you'll easily be able to prepare a keymaker for this program.

Note: 
Sorry for my English, I am an Italian cracker, and I learned with the 
superb +ORC tutorial...

Heres, June 3th 1997
   </pre>
 <font color="green">(c) Heres 1997. All rights reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Project 1</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84">homepage </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73">links </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82">students' essays </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">Academy database </a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts </a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_Reverser </a><br>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>javacra.htm: El Latigo's Java cracking, reversing applets</title>
</head></h1>
<body bgcolor=#C0C0C0 text=#001010 vlink=#405040>
<center>


<h1>Java cracking, reversing applets</h1><br>
by El Latigo<br>
<bR>25 November 1998
<br>
                 <p align="center">courtesy of reverser+'s page of reverse
                 engineering</p></center>
<hr><pre>
Hi there reverser+,

I'm writing you in order to (try to) contribute with all those great
essays about reverse engineering. I have cracked other programs and 
never emailed any essay; but this time, i think that this is going 
to be usefull because this time its java, and i found very little about
java reverse engineering on the web.
Ok, the targets are those beautiful www.opencube.com applets.
they are great,and you can download them...but theres one little thing,
you wont be able to use them in your website if they are not registered. 
When you upload the file to your webserver, and try to see the
page where the applet is embeded all you will get is a nasty phrase
which reads 'invalid notice tag'.
"Ahi!" -you say- "this high tech applet wont work!"
But if you send money to the guys at opencube, they will send you  a
couple of 'key' files called 'ocekey.class' and 'ocjwkey.class'
and when you replace the files you had downloaded with those they sent
you... voila! the applets work.
Of course,when you buy the applets, they tell you to specify a domain so
they can make those applets 'workable' within your domain. The thing is
simple, all you ‘crackers’ have  to do is in some way, change the url
those demo applets are registered to...
How can you do that? VERY easy, remember that <u>everything is possible</u> 
in this software world of us... if you use your head.
Ok now, i did decompile that ‘key’ class using JAD, a very
powerful ‘.class-to-.java’ decompiler which can be found at :
<a href="ftp://www.meurrens.org/pub/Java/codeEngineering/jadnt15.zip" tppabs="ftp://www.meurrens.org/pub/Java/codeEngineering/jadnt15.zip">ftp://www.meurrens.org/pub/Java/codeEngineering/jadnt15.zip</a>
Well, in fact the game is already almost over, all you have to do is 
decompile using jad (<font color=blue>jad ocekey.class</fonT>);  
the jad decompiler will make a ocekey.jad file which is the 
ocekey.class source code (cool huh?).
After that you open the file and see that little and poor class file 
that is trying to prevent you from using an applet... the source of 
the ocekey.class is the following:

import java.net.URL;

class ocjwkey
{

    public static String getKey(String note, URL u)
    {
        String regURL = "www.opencube.com";  &lt;------- bad guys :)
        int i = 1;
        while(Character.isDigit(note.charAt(note.length() - i)))
            i++;

        if(u.getProtocol().equalsIgnoreCase("file") ||
u.getHost().equalsIgnoreCase(regURL))  &lt;---vital part :)


            return note.substring(0, (note.length() - i) + 1).trim();
        else
            return "-1";
    }

    ocjwkey()
    {
    }
}

Yahooooo! Look at the regURL variable... what do we have here? Oh
yes you guessed it mr cracker! The url for the applet! Now you have two
options: you know, <b>1)</b> you can change the url for the applet to work on your
own site or <b>2)</b> you modify the source for it to work on ANY web site ...
If you choose the first option, I don't need to tell you what you should do, 
since it is jolly obvious, but if you choose the second option you have 
to delete the following lines :


1) if(u.getProtocol().equalsIgnoreCase("file") ||
   u.getHost().equalsIgnoreCase(regURL))

2) else

3) return "-1";


After this, you recompile the ocekey.class and replace the old one with
the cracked one.
Well, that's it actually! Easy easy cracking... right?
The other 'key'  class, is quite similar, i won't explain it here, tackle 
that one yourself! (an easy reversing task)

Enjoy java cracking, it's easy, it's great fun, it's interesting.

El Latigo

Ps: If you dont know how to compile a .java file, then you shouldn't be
reading this at all, come back later... :)

Ps2: You can download the target applets from  
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >http://www.opencube.com/colgo</a>

User Name: cu2248
password:  homefree

But, please, remember to delete them after having cracked them / played 
with them... this is only for study purposes of course. In fact we 
are not here in order to steal this or that specific software, we 
are here in order to MASTER software, in order to LEARN how to use 
<u>any</u> software whatsoever whenever we like, however we like and 
for any purpose we want, changing it on the fly if needs be, cracking 
it black and blue if we fancy it. 
</font></pre>

<br><center>
<hr size=5>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0>
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A>

<bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?
</A></CENTER>
<hr size=4></fonT></center></center>
</body>
</HTML>

<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>littlejo1.htm: Vb unprotection scheme</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%  HEIGHT=" 22">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">Visual Basic Unprotection</fonT><br>
        <FONT SIZE="+1">Programmers: don't protect with visual basic!</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm"><IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" tppabs="http://fravia.org/visualba.gif" ALT="visual basic" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Visual Basic</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
04 May 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Little-John
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG src="../../tgv.citeweb.net/tsehp/hcu1.gif" tppabs="http://tgv.citeweb.net/tsehp/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td>
</tr>
<TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited<br>
by reverser+</center></td>
</TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font color="#C4C0CF">fra_00xx<bR>980504<br>Little-John<br>1100<br>P8<br>PC<br></fonT></td><td><i><center>
<!-- Your truly+ comments -->Well, I think that with this essay by Little-John we 
can CLOSE the 'first part' of our Visual Basic reversing. No more essays on 
Visual Basic "simple" reversing, please, we have made our point enough. 
But there seem to be some new protection 
'breeds' ('stains'?) around: Visual Basic MIXED with assembler... interesting 
food for our future work...<br>This said, here you have an interesting little work 
by Little-John that will teach a couple of things to beginner and intermediate 
carckers and protectors alike... Enjoy!
</i></center></td>
<td></td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
This essay is dedicated to those programmers that <b>think</b> to be serious, but they 
aren't...
<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
Another brick in the wall
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
Vb4 unprotection
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
Little-John
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
<pre>
Two days ago a friend of mine (an engineer) pointed me a nice program, very useful for
engineers (especially in Italy) called 'Verifiche Periodiche IPSOA', but he had a 
problem... a nice nag appeared at the start...
</prE>
<br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
Soft-Ice 3.22<br>
Win95 File Monitor<br>
Brain<br>
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
Sorry, I don't know url or ftp for this application :-(
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
Well the version I had was dated 1997/10 and that was the Version 1.0... quite a bad 
start.
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
I recommend you to read first all the VB essays in the Visual Basic project, but with special attention to the
one by Razzia and sth.<BR>
<BR>
This is another example for programmers on how Visual Basic takes rid of your work. You, serious programmer, let
not use Vb for your creatures, because with that development tool you'll never protect your programs and your work
has gone away...<BR>
<BR>
Ok, let's start.<BR>
Verifiche periodiche has been created with Visual Basic 4 (16 bit version), in fact it is runnable also in Windows
3.1. First of all<BR>
always remember to read the documentation given with the program. In the help file it's said 
<P ALIGN="CENTER"><FONT COLOR="#000000">*** ITALIAN VERSION ***</FONT><FONT COLOR="#000080"></FONT>
<P><FONT COLOR="#000080">&quot;L'applicazione &egrave; dotata di un sistema di protezione; per utilizzare il programma
occorre infatti inserire un codice di 15 cifre che identifica univocamente il computer sul quale pu&ograve; essere
eseguito il programma stesso. La richiesta del codice d'autorizzazione avviene tutte che le volte che si avvia
l'applicazione stessa; se non si possiede il codice occorrer&agrave; selezionare Ok senza digitare nulla nella
casella di testo Codice Autorizzazione. Viene consentito l'utilizzo del prodotto per un numero limitato di volte,
superato questo limite sar&agrave; necessario inserire il codice o uscire dall'applicazione premendo il pulsante
Chiudi. <BR>
<BR>
Venuti in possesso del codice di autorizzazione mediante le procedure descritte di seguito, occorrer&agrave; digitarlo
per permettere lo sblocco dell'applicazione. Una volta compiuta tale operazione il codice non verr&agrave; pi&ugrave;
richiesto.<BR>
<BR>
Il codice pu&ograve; essere inserito all'atto dell'avvio dell'applicazione.<BR>
<BR>
Per ottenere il codice d'autorizzazione &egrave; necessario:<BR>
<BR>
- Telefonare all'ASSISTENZA CLIENTI INDICITALIA al numero 06/5196111<BR>
- Comunicare il numero di serie che viene visualizzato <BR>
- Comunicare il proprio codice cliente (ricavabile dalle fatture)<BR>
<BR>
Tale operazione &egrave; necessaria solo all'atto della prima installazione. Per gli aggiornamenti non &egrave;
necessario inserire di nuovo il codice d'autorizzazione.<BR>
Il codice deve essere custodito poich&egrave; rappresenta la &quot;Licenza d'uso&quot;.&quot;</FONT>
<P ALIGN="CENTER"><FONT COLOR="#000000">*** ENGLISH VERSION ***</FONT>
<P><FONT COLOR="#000080">The application has got a protection system; in fact to use this program you need a 15
character code, to identify uniquely your computer on which the program runs. Every time you run the application
the authorization code is required; if you haven't it, just press Ok, without inserting anything in the text-box
named Codice di Autorizzazione. You are allowed to use the program a few times, once you go beyond this limit you
must insert the code or press Close.<BR>
<BR>
When you have the authorization code, that you can obtain following the procedures described below, you have to
insert it to register the application. After that the code will never be required.<BR>
<BR>
The code can be inserted at the application start.<BR>
<BR>
To obtain the code you need to:<BR>
- Phone ASSISTENZA CLIENTI INDICITALIA, number 06/5196111<BR>
- Communicate your visualized serial number<BR>
- Communicate your client code<BR>
<BR>
This operation is necessary only at the first program installation. For the upgrades the authorization code is
not needed.<BR>
<BR>
The code is your 'User License'.&quot;</FONT><FONT COLOR="#000000"><BR>
(Sorry for my English =).<BR>
<BR>
Every time I start a cracking session I use to precrack my target (a good rule for all crackers). I open Filemon,
Regmon and VxDmon, and after that I run my target. In this case Filemon is the one we need, because this a 16 bit
application, so no Registry and no VxD. While running we see the program performing some queries on </font><font
cOlOr="#CC0000">"product.inf"</font><font CoLoR="#000000"> file on the CD and in the Windows directory on the <font
cOlOr="#CC0000">"Mappdrv.inf"</font><font CoLoR="#000000"> file.
Mmhh. Those nice programmers are using a STRANGE name to read data from. Let's have a look. A huge number is there
and it seems to be like:<BR>
[Profile]<BR>
824400=824400199710... (The other numbers are not in our interest and they change from one computer to another).<BR>
<BR>
If we try to change one number in this file the application will say Checksum error and then will stop. Now all
is clear. The application reads the value from MAPPDRV.INF and then compares'em to some others...<BR>
<BR>
Ok, so start the program and you need a 15 digit number, let's say 123456789012345. The program returns Error Code
number </FONT><FONT COLOR="#CC0000">4</FONT><FONT COLOR="#000000">. If we obmit a digit the program returns error
code number <FONT COLOR="#CC0000">6</FONT>! Put a breakpoint on hmemcpy (it works fine 99% of times) and you will find the code you inserted,
just bpr it and then g(o). You'll fall into VB40016.dll in RTCMIDCHARVAR and, while g(oing), see what happens. Yep! The memory
image is quite nice. In my memory I see:</FONT></P>
<PRE><FONT COLOR="#000000">123456789012345.
......1.......1.
......2.......2.
......3.......3.
......4.......4.
......5.......5.
......6.......6.</FONT></PRE>
<P><FONT COLOR="#000000"></br></FONT></P>

<P><FONT COLOR="#000000">...(and so on till the end of the number). So the program is reproducing our code. Why?
In order to check reason. It controls that all digits are number, in fact if you insert a non-number character
you'll see the 2 columns stop at that char and then the Error Code. If all is right, at the end of two columns, 
the program re-writes our code without the last two numbers. They're re-written below it. At the left of these two numbers 
the program reports in the same location all the digits one after the other. Put a bpr on the two stand-alone digits and see
what happens. The program stops at a 'REPNZ CMPSB' (<b>see sth essay</b>) and compares'em (45) with other two numbers
(75 in our case). Take note and write'em at the end of your code. So now the first REPNZ CMPSB check is right and
then the application performs another check. I saw the comparison between 9012355 and 4290156. What does it mean?
NICE programmers... They pick up some digit from the code and then compare'em with some others:</FONT></P>
<PRE><FONT COLOR="#000000">1234567890123<B>75
....6...42901.5
</B>
</FONT></PRE>
<P><FONT COLOR="#000000"><BR>
They are very <B>fancyful</B> programmers. So, our number now is 123466784290175. Press OK and the Error Code
number 4 will compare again. It's a natural thing. Since we have changed some number in the code, the last two
digits will change. Let's check. Yes, I'm right. It compares 75 with 77. And our number will be now <B>123466784290177</B>.
Is it cracked? Maybe. Press Ok and all goes well. It seems to work fine, but when we restart the program the Insert_Your_Code_Here
nag will appear again. 7 numbers in our code hadn't been used, (<B>1234.678</B>). The program performs two checks
on our number, the first to make the nag appear and the second to start the program. In this case the only way
to make the program work is to trace the first check made (the one for the nag). In my case the program performs
24 different types of check; some of'em are meaningless and some others very useful instead. While checking, a
very strange comparison is effected between &quot;c:\windows\mappdrv.inf&quot; and &quot;ERRORE&quot; (error :).
I think this is a way to confuse a possible cracker... At a certain point it compares NL with LI... mmhh... NL
is in our mappdrv.inf file and maybe it means Non-Licensed, and it compares with LIcensed. Ok, so let's change
NL with LI in our file and run the program. Checksum Error... this means we have to change some other values in
our mappdrv.inf file. So trace again the first comparison. In fact it compares the last two numbers of the mappdrv.inf
with newer values. Just use them in the .inf file and all goes fine. CRACKED =)</FONT><!-- PASTE HERE THE TEXT OF YOUR ESSAY -->
<!-- Hey Reverser+ I cut off your <pre> tag for a best view -->
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
Just a few days ago my engineer friend showed me some other products of INDICITALIA, the same software-house...
of VERIFICHE PERIODICHE, and they use the same VB-unprotection... :-( <br><br>
<center><b>!!! Programmers don't use Visual Basic !!!<br>
The Micro$oft mouse-trap is working well
</b></center>
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table>
 <center>
   <i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a longer 
   period than the allowed one. Should you want 
   to STEAL this software instead, you don't need to crack its protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged, farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->


<a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm"><IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" tppabs="http://fravia.org/visualba.gif"  
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 8</FonT>
<br><bR>


<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG src="../../tgv.citeweb.net/tsehp/bulletr.gif" tppabs="http://tgv.citeweb.net/tsehp/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG src="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>--====================987654321_0==_
Content-Type: text/plain; charset="us-ascii"

--====================987654321_0==_--
<HTML>
<HEAD>
<!--  formamus.htm version 09 January 1999 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>smegg_01.htm: Dopewars
</TITLE></HEAD><body BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
Reversing an algorithm to ensure gameing success and fame on the internet.
</fonT><br><FONT SIZE="+1">
Reversing the Drug pricing algorithm in Dopewars version 1.2
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="student.htm#student_loo_na" tppabs="http://members.xoom.com/tsehp_/student.htm#student_loo_na"><img SRC="images/notassi3.gif" tppabs="http://members.xoom.com/tsehp_/images/notassi3.gif" 
ALT="student" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Not Assigned</FonT>
</center></td></tr><tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
08 October 1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
smeggett
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><img SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></TD><td BGCOLOR="898030"><center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited
<br>
by reverser+
</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font color="#C4C0CF">fra_00xx<bR>981010<br>smegget<br>1000<br>NA<br>PC<br></fonT></td><td><i><center>
A quite interesting 'applied reversing' essay for beginners. In fact 
I believe we should begin a small 'dedicated' section for online gaming and (eheh :-)
for online gambling. I never analyzed the various gambling programs (that are 
mushrooming all over the net) but I would bet that reversers in need of money 
could apply our knowledge with profit at least in some cases... 
</i></center></td><td></td></tr><TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><font color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>

"An essay designed for beginners to show how an algorithm can be 
reversed in order to 'cheat' the game and pwerhaps register yourself 
on the worldwide high score list...<br>
Of course you will still need your skill to do this - the reversing only makes the
job easier." 
<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
Dopewars
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
Reversing an algorithm to ensure gameing success and fame on the internet.
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
smeggett
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
I received my copy of Dopewars via email and was (almost) hooked on it
quite quickly, trying to obtain higher and higher scores. During the course
of play I noticed that some drug prices became exceedingly high (or low)
on the odd occasion, whilst the rest of the time they fluctuated only minorly.
<p>
It was at this stage that I decided to look further into the game and see 
if it was possible to manipulate the pricing algorithm so that the game would
throw up the exceedingly high prices every second turn (so you can buy low, sell
high of course...)
<p>
So look further I did and found that after rewriting some of the code for the 
routine it was possible to achieve this goal.
<p>
<!-- PASTE HERE YOUR INTRODUCTION -->
<br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
WDasm 8.9<p>
PS Edit (or any other hex editor)<p>
and that'll about do you...
<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>
<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
http://www.beermatsoftware.com/dopewars/download.asp<p>
File: Dopewars.exe<p>
Size: 526,848 bytes

<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
None really - started as a MSDOS game in 1984 - has had a windows frontend put on.
<br><br>
<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>


The first step in this game is to try and find the algorithm which
sets the drug prices, so load the program into WDasm and do a string 
search for the text used in the message boxes to notify you of an
exorbitantly high price (or low price). Select this and you will land 
in the middle of the pricing routine. The routine is fairly long (about 
three printed pages in all), but also fairly easy to follow.
<bR><br>
The first part of the routine (beginning at 45D120) saves some values
and the initializes a few variables. Address 45D13E is where the fun begins.
You will notice the call at 45D142 (CALL 402ACC) is repeated quite a bit
throughout this routine - this is the price generator which is 'seeded' by 
the values in eax and edx. (esi stores the drug count - there are 13 in all)
<prE>
45D13E 8B4304                  mov eax, dword ptr [ebx+04]	;set seed value
45D141 40                      inc eax				;add one
45D142 E88559FAFF              call 402ACC			;set price
45D147 0303                    add eax, dword ptr [ebx]		;modify price with fixed value
45D149 894308                  mov dword ptr [ebx+08], eax	;store price
45D14C B808000000              mov eax, 00000008		;seed price generator
45D151 E87659FAFF              call 402ACC			;set price
45D156 40                      inc eax				;do sod all
45D157 48                      dec eax				;perhaps set the Zero flag
45D158 7506                    jne 45D160			;goto cheap (buy) drug routine
45D15A C6431600                mov [ebx+16], 00			;set no cheap (buy) drugs
45D15E EB04                    jmp 45D164			;goto next
* Jump at Address45D158(C)
45D160 C6431601                mov [ebx+16], 01			;set cheap drugs (buy)
* Jump at Address45D15E(U)
45D164 807B1400                cmp byte ptr [ebx+14], 00	;if 0 then no super expensive drugs
45D168 0F8488000000            je 45D1F6
45D16E B814000000              mov eax, 00000014		;seed price gen
45D173 E85459FAFF              call 402ACC
45D178 40                      inc eax				;pehaps set Zero flag
45D179 48                      dec eax				
45D17A 757A                    jne 45D1F6			;goto no super expensive drugs
45D17C 807B1600                cmp byte ptr [ebx+16], 00	;see settings above
45D180 7474                    je 45D1F6
45D182 B802000000              mov eax, 00000002
45D187 E84059FAFF              call 402ACC
45D18C 6685C0                  test ax, ax			;and ax,ax (set message - Cops or Addicts)
45D18F 752F                    jne 45D1C0			;jmp to addicts message
</prE>
The routine continues on, but this is where the decisions are made and this is
predominantly where we will have to rewrite the code. I first began modifying the
jumps at 45D17A and 45D17C (by NOPping them), but this was clumsy and did not 
force the pricing every second turn as I wished it to.
<bR><br>
So I decided that I would need to set up a variable which would flip-flop
every second turn (probably from 0 to 1 to 0, etc) which i could use to force a low
or high price for drugs. Looking at the code it seemed that it would be possible to 
use a global variable pointed to by [ebx + offset]. A quick scan of the code reveals 
that the following variables are used by the program:
<pRE>
	[ebx+04]		dword
	[ebx+08]		dword
	..
	[ebx+14]		byte
	[ebx+15]		byte
	[ebx+16]		byte
</prE>
My first hunch was to try something in the middle (ie not reuse and existing variable,
so I chose [ebx+0C] as my new variable. The next step was to decide where to put our new 
code. The idea was to modify the program by replacing existing code, but what?
<bR><br>
Looking at the code section above I decided that i could replace all the conditional jumps
and intervening code. This means the code from 45D156 to 45D181, which gives us 43 bytes
to play with. 
<bR><br>
So I wrote my routine, and then had to translate it into Opcodes to check the length and
make sure that it would fit into the required space. For those of you that have done your 
homework and traced this routine through with a debugger (I used WDasm, 'cos I foolishly
installed NT Service Pack 5 which has screwed with my version of SoftIce :(  ) you will realise
that the routine loops 13 times - once for each drug on the list, and that the base pointer
(ie ebx) is adjsuted at the end of this routine to point to the price data for the next drug.
This is good, since it means that the variable we assign a 0 or 1 to [ebx+0c] will be preserved
for each turn.
<prE>
My new code looks something like:

45D156	cmp byte ptr [ebx+0C], 00	;check variable
45D15A	je 45D162			;flip it
45D15C	mov [ebx+0C], 00		
45D160	jmp 45D166
45D162	mov [ebx+0C], 01
45D166 	cmp byte ptr [ebx+0c],00	;if variable = 0 then no exp drugs
45D16A	je 45D1FC
45D170	mov eax, 14			;seed pricing gen (existing code)
45D175	call 402ACC
45D17A	inc eax
45D17B	dec eax

The code for this looks as follows:

45D156	807B0C00
45D15A	7406
45D15C	C6430C00		
45D160	EB04
45D162	C6430C01
45D166 	807B0C00
45D16A	0F8486000000			;32 bit jmp
45D170	B814000000
45D175	E85259FAFF
45D17A	40
45D17B	48
</prE>
So now you can patch the program using PSEdit (or whatever else you fancy) and run it.
<bR><br>
You have a problem? So did I! It seems our variable [ebx+0c] is used elsewhere and our use
of it causes an overflow and the program crashes (luckily whoever wrote this code initially
put in an error handler routine so we wont cause too much damage...)
<bR><br>
OK, wrong variable - how about we use one of those byte variables already used for our own 
purposes? I chose [ebx+16] to accomplish this task - we keep the patch the same, just modify the
0C bytes to 16 in the code above. Patched? Good, now try this...lots of messages and hugely expensive
drug prices - but wait - we go to a new day, and we have no drug prices, no drugs, nothing!! Odd!
Take the train somewhere, new day and horrendously expensive drugs. So half our job is done.
<bR><br>
I spent a lot of time tracing through this routine and the program trying to find out why this 
happened (ie tracking the cause) but I could not find it (well, I didn't look that hard). Logic
suggested that our old [ebx+16] variable must have been causing this, since this was all that
we modifed. I thought about this and decided to change the condition checks from 0 and 1 to 
2 and 3. Well, what do you know, it worked!! The game opens with cheap drugs, the next day you 
have expensive drugs, and the day after cheap drugs. Whoo-Hoo!!!
<bR><br>
Now, before you go and try for those high scores you might like to NOP the jumps at 45D20E
and 45D208 and also modify 45D1F6 to read:
<prE>
45D1F6  807B1602
45F1FA  756B
</prE>
so that you will be guaranteed cheap cheap drugs on your fisrt turn. Now, go bombard to web site 
with your high scores (they have a register there...)

<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
<pre>
This is my first real attempt at truly reversing software, apart from some lazy crappy cracks, 
and i must say that it has taught me a lot when it comes to understanding the function of various
items of code. It is a truly great feeling when it suddenly dawns on you how and why everything is
happening. There is always method in the madness....
								smeggett
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</pre>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><img SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<img SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">java-script wars</A>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>
<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_"
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH!
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>wildcat.htm Cracking Wildcat 5</TITLE>
</HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100% 
HEIGHT=" 22">
<TR><td></td><td>
<!-- Choose  a TITLE probably wont be changed -->
<center>
<FONT SIZE="+2">Cracking Wildcat 5</fonT>
<br>
        <FONT SIZE="+1">When one key code works, why can't the rest of
them?</fonT>
</center>
</td>
<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="student.htm#student_loo_na" tppabs="http://members.xoom.com/tsehp_/student.htm#student_loo_na"><IMG SRC="images/notassi3.gif" tppabs="http://members.xoom.com/tsehp_/images/notassi3.gif"
ALT="student" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
<font color=gray>Not Assigned</FonT></center>
</td></tr>
<tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->30 October
1998</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->Cup of Cats</fonT>
</center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm">
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0 HSPACE=0></a>-->
</td></tr>
<TR><td>
<center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM"
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center>
</td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of reverse
engineering</center>
 </center>
</TD>
<td BGCOLOR="898030">
<center></center>
</td></TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td>
<font
color="#C4C0CF">fra_00xx<bR>981030<br>CoC<br>0100<br>NA<br>PC<br></fonT></td><td>
<i><center>
<!-- Your truly+ comments -->
A great essay. Well explained and tackling a more and more frequent aspect of our 
reversing studies: server-validation. Read it. Think about it. Work on your own. 
As you will see there's no useless keygenerator in here, there are a lot of 
EXPLANATIONS and quite 
a lot of zen reversing as well. Enjoy!</i>
</center></td><td></td></tr>
<TR><td></td>
<TD BGCOLOR="898030"><center></i><b>Quality is Job Number 2.  Making
Money is Job Number 1.</b><br>-Some big car company.</center>
</center></TD>
<td></td></TR><TR><td VALIGN= "MIDDLE" bgcolor="#C6E7C6">
<font color=blue>
<center>Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6">
<font color=blue>
<center>
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> (
)<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
I have been working on this crack for over a year.  Dont you hate it
when nothing makes any
sense, you go away for a few months, come back, and everything falls
into place in 15 minutes?
Heck, it took longer to write this essay then to crack the program. 
Makes you feel like an idiot.<br>
<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
Cracking Wildcat 5   </FONT>
<BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->Feeling for a
correct unlock code</FONT>
<BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->
Written by Cup of Cats   </FONT></center>
<br><br>
<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center>
<font size=+2><font color=blue>Introduction</fonT></fonT>
</center>
</td></tr>
</table>
<pre>
This takes <strong>A LOT</strong> of explaining.  I have been using
Mustang Software's Wildcat BBS programs for
over 9 years now and have now turned my BBS into a small ISP.  I lay
in bed at night thinking
about the money I have spent on the darn thing over the years.<br>
Instead of buying my Wildcat INS setup (wildcat 5 with the internet
addons) directly from
Mustang, I got lucky and got them locally from another setup who moved
over to Worldgroup.
Mustang has a license transfer policy that costs $25 per program. 
Imagine my complete surprise
when Mustang would not allow the seat licence that I purchased used to
be transfered under my
current license.  While I have enough seats currently, I wanted the
extra seats and felt I should
have them since I did pay for them.<br>
Well, I started last year trying to come up with a key generator for
wildcat.  (anyone else
remember me asking for help with it?)  After about 6 months trying to
work with SoftICE and
W32dasm, having no luck with the key generator, no luck with changing
jumps, no luck with anything
else, I finally said the heck with it.<br>
That was up to about a week ago.  I was fooling about with another
program in W32dasm and finally
opened the help file that comes with W32dasm.  <strong>DUH!</strong> 
I discovered how to change the registers, do
the breakpoints, and the other debugging tricks you need.  I never
could get the hang of using
SoftIce and switching back and forth from windoze.<p>
So anyway.....
</prE>
<br><br>
<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center><font size=+2><font color=blue>Tools
required</fonT></fonT></center>
</td></tr>
</table>
W32Dasm<br>
Your favorite Hex Editor <!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>
<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center><font size=+2><font color=blue>Target's
URL/FTP</fonT></fonT></center>
</td></tr>
</table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
Mustang Software has a <a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm" target=_blank http://bbs.mustang.com">http://bbs.mustang.com</a>">server</a>
just for Wildcat.
A limited verson of Wildcat 5 with Internet addons (called Wildcat INS
or WINS) is
available for download there. (It runs 25 megs or so) The seat licence
portion
should be coded the same.  The Babbages I shop in still has the 2 seat
version of
Wildcat 5 for 10 bucks and its still available from some of the on
line software
places that deal with discount software titles.  Then you can download
the upgrades
(well, the older important ones anyway) for free after you register. 
Also if you're
looking for a cheap proxy server with web and email servers, its not
bad.
<br>
<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center><font size=+2><font color=blue>Program
History</fonT></fonT></center>
</td></tr>
</table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
Mustang's been around for more then 10 years.  Their programs are a
bit expensive but
worth it.  I have dial ups, a ftp server, an (sort of OK) email
server, a (sort of
OK) web server, a nntp server plus fido, and many other addons.  Seat
licences run
15 to 30 bucks depending on the amount you buy.  Worldgroup maybe a
better bbs/isp
server but with wildcat, everything's on 1 computer (well, one plus
the linux router and the
quake server) while Worldgroup would have taken 3 computers plus the
router and quake
server.  Addons are also written by third party authors and thats
where it seems I
spend most of my money on.  I may crack, but I fully support Shareware.
<br><br>
<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Essay</fonT></fonT></center></td></tr></table>
<br>
<strong>Set up:</strong>  Wildcat 5 comes with the following to
activate it:<br>
A 6 Digit Registration Code in the form of 12-3456<br>
Your Line Count up to 256 seats<br>
and your Registration key in the form of 1234-1234-1234-1234-1234<br><br>
As I explained earlier, I have 2 working combinations. (Actually I
have a number
of them.} The problem with using another working combination is I have
a great
number of shareware addons and these are keyed to the 6 digit
registration code.<br>
For the sake of this essay, lets say the following is the keys in
question:<br><br>
My registration code: 12-3456<br>
Line Count: 4<br>
Product Key: 1234-1234-1234-1234-1234<br>
(Not really mine.  Just made up for this paper.)<br><br>
My used Registration Code: 03-2084<br>
Line Count: 16<br>
Product Key: 3a58-2395-1ded-d0e1-c100 (refered to as 3a58-etc. from
now on)<br>
(This comes from research from a USENET database and are actual
working keys.  I have no idea where it
really comes from.)<br><br>
Looking at the product keys, it appears they are written in
hexadecimal while
the registration codes and line counts are in normal decimal.  Just
something
to remember.<br>
<br>
<strong>What we want to do:</strong>  Just so we're all clear, the
point of this crack is to
have the Wildcat server accept my registration code, (12-3456) the
higher line
count, (16) and the used Product Key. (3a58-etc)  Instead of trying to
change the
program to accept any line count, I want the program to work for a
specific line
count that I feel I have a license for.  (Jumping the gun a bit, read
the essay.
It turns out we are able to work out a crack but I discovered that by
accident so
i'll cover that later on.)<br>
<br>
<strong>Looking at the program:</strong>  To set the Wildcat server up
with its codes, you run
a program called wcreg.exe.  Fire it up and you get a windows box with
3 fill-in-
the-blanks, 1 for the registration code, 1 for the line count, and one
for the
product key.  Lets just try it with the 12-3456 code, 16 line count,
and the 3a58
product key.  Hey, we might get lucky!
<br><br>
No dice.  We get a box that says: <strong><i>'The key you typed is not
correct.'</i></strong>  But we do now
have something to look for when we decompile.  Fire up W32dasm,
decompile wcreg.exe,
save it as a project file, and do a search for some part of the error
phrase.  We find
the phrase in 3 different places.  The following sections cover those
3 locations.<br>
Since I am not writing a key generator any more, I am only including
those portions
of code that we actually need to look at, understand what is being
tested, and change
if needed.
<br><br>
<strong>Debugging Part 1:</strong>  The first test is to make sure the
codes entered are of the
right type, they are the correct lengths, etc.  Since all the codes we
are using are
of the correct format, we should be passing this test.  I've included
the test code
below just for reference.  In messing with this program, I have yet to
see esi not
equal 1 in line 004017B2 as long as you don't do something silly like
using non hex
digits like 'R' and 'W' in the product key, use the wrong code
lengths, or put the
hyphens in the wrong place in the product key.
<prE>
* Referenced by a Jump at Addresses:0040179D(C), :004017A8(C)

:004017AC 47                      inc edi
:004017AD 83FF18                  cmp edi, 18       ;18h=24d have we finished with all the digits?
:004017B0 7C9D                    jl 0040174F       ;go back if we havent and do it again.

* Referenced by a Jump at Address:0040174B(U)
|
:004017B2 85F6                    test esi, esi     ;is everything ok? esi=1 if ok
:004017B4 7519                    jne 004017CF      ;go on to the next part if ok
:004017B6 6A00                    push 0
:004017B8 6A00                    push 0

* Possible StringData Ref from Data Obj ->"The key you typed is not correct."</prE>
<br>

<strong>Debugging Part 2:</strong>  The next portion uses the product
key, breaks it down by character,
does it's computation, determines the correct line count for that
specific product key,
and compares it with the line count you entered when you ran the
program.  If you put a
breakpoint on line 00401893, you can see this comparison. (We will
talk about this breakpoint
later on so keep it in mind.) When we first ran wcreg, we entered line
counts of 16.  The
Product Key we are using is also for a line count of 16.  Both esi and
eax have the values
of '10' which is hex for 16 in decimal.
<pre>
:00401886 0954243C  or dword ptr [esp+3C], edx
:0040188A FF4C2410  dec [esp+10]
:0040188E 758E      jne 0040181E
:00401890 8B4364    mov eax, dword ptr [ebx+64]
:00401893 3BF0      cmp esi, eax  ;test if the computed number equals the line count
:00401895 7419      je 004018B0   ;we entered earlier.  if equal, then move on.
:00401897 6A00      push 0        ;error messages start here.
:00401899 6A00      push 0

* Possible StringData Ref from Data Obj ->"The key you typed is not correct."
</prE>
Do we need to do anything here?  Not really.  When we ran wcreg and
entered the data, we used a line count of
16.  The Product Key we used computes to 16 also.  The cmp statement
on line 00401893 works so we move on.
      <br><br>                           
<strong>Debugging Part 3:</strong>  The third portion is where we need
to do our work.  It takes the Registration Code
and the Line Count you entered and does a computation, takes the
Product Key and does a computation, and
then compares the two.  This is where we need to modify the program. 
The code that we need to look at is
as follows:
 <pre>
:0040196A 684C25494D              push 4D49254C
:0040196F E82CFDFFFF              call 004016A0
:00401974 83C40C                  add esp, 0000000C
:00401977 3BE8                    cmp ebp, eax        ;Do the 2 computations match?
:00401979 7419                    je 00401994         ;If they match, move on.
:0040197B 6A00                    push 0              ;Else its bad code, go error codes.
:0040197D 6A00                    push 0

* Possible StringData Ref from Data Obj ->"The key you typed is not correct."
</pre>
The line 00401977 is where we need to look at.  We need to make these
match.  eax is the computation code
for the Registation code and line count while ebp is the computation
total for the Product key we entered.
To make this patch work, the easiest method I discovered was to change
the line into either:
<pre>
cmp eax, eax (#1)
or
cmp ebp, ebp (#2)
</pre>
Patch #2 does not work and causes the program to crash.  Patch #1 does
work and is how we change the program.
<br><br>
Open up your hex editor, do a search for 83C40C3BE8 and change the
3BE8 into 39ED.  Save everything, run wcreg,
enter the Registration code 12-3456, the needed line count 16, and the
used Product Key 3258-etc.  You get a
registration info saved message and the program ends.  When you look
further down the dead listing, you discover
wcreg puts the codes into the windoze registry.  A quick search for
the Registration Code turns it and the
product key up.
<br><br>
When I first tried to patch this program, I tried changing that je
statement into a jmp always.  The program
reported saving the registration data but it never worked when i tried
to start wcserver.
<br><br>
<strong>Finished?</strong>  So, we're done, right?  Let's see.  To
start Wildcat, you run a program called wcserver.exe.
We fire it up and get the error message <strong><i>'Wildcat requires a
Registration Code to run.'</i></strong>  So even though wcreg
accepted the codes and saved them to the registry, wcserver won't
accept them.  So we now have to take a look
at wcserver.  As always, fire up W32dasm and decompile wcserver.exe. 
Do a search for where in the program
Registry is opened and the codes are loaded into memory.  What follows
from that point on is code that looks
an awful lot like <strong>Debugging Part 3</strong> up above.  By
stepping through one line at a time, we are even able to
find that same compare lines as above:
<prE>
:0043DF8E 83C40C                  add esp, 0000000C
:0043DF91 3BD8                    cmp ebx, eax
:0043DF93 7503                    jne 0043DF98
</prE>
Again, the line 0043DF91 is where we have to look at.  Again we need
to make these match.  eax is the memory
location of what we need with the Registration code and the line
count, ebx is the computation code we get
with that product key.  So again we have to rewrite that line as one
of the following:
<pre>
cmp ebx, ebx (#3)
or
cmp eax, eax (#4)
</pre>
Patch #3 causes crashes.  Patch #4 does work and is what we need to
change it to.  Open up your hex editor,
do a search for 83C40C3BD8, change 3BD8 into 39C0, and we should be
set.  Run wcserver and it comes up.  Run
wcconfig, the set up program, and you discover you have your 16 nodes.
<br><br>
<strong>Finished? Part 2:</strong>  We have a minor problem.  The
versions of wcreg and wcserver are dated March 11, 1996, and
have been updated since then.  The memory locations have been changed
due to changes in the program.  (and
<strong>*MANY*</strong> bug fixes)  I decompiled the newer versions to
discover the code segments look about the same.  Do
your searches as above, make the necessary changes, and you'll be set.
 There have been no changes in
Registration codes and the computation coding looks the same, just
different memory locations.
<br><br>
<strong>Add On:</strong>  While mucking around with the program, I
tried using different product keys
and different line counts.  I got an interesting result when I used
the following product key:
<br><br>
Product Key: 0101-0101-0101-0101-0101
<br><br>
On running wcreg, the program stopped on the cmp line found in
<strong>Debugging Part 2</strong>.  It turns out that the
Product Key is acceptable for a 257d or 101h seat system.  If you use
that Product Key, 257 Line Counts, and
an acceptable Registration Code, with the above patch, things work,
and you get your 257 seats.  With more
experimenting, you discover that if you translate your needed seats
into hex code, repeat it 5 times like above,
it will work.  So if you want 70 seats, you use the following product
key:
<br><br>
Product Key: 0046-0046-0046-0046-0046
<br><br>
where 46h = 70d = 70 seats
<br><br>
What does that mean?  We actually have a patch now that will allow us
to use whatever 6 digit Registration
Code we want and whatever amount of seats we want as long as:
<br><br>
     1.) All enter codes are in the correct format.
<br>     2.) The hex numbers entered into the product key are equal to the
decimal number of the seats we also use.

<br><br>
<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center><font size=+2><font color=blue>Final
Notes</fonT></fonT></center>
</td></tr></table>
<pre>
Please encuse me if what I have written is a bit confused.  Its been a
long time since I've written any form
of paper such as this one.  I never could get used to looking at other
people's coding, debugging it, and then
trying to explain it.  Proving other people's proofs in math class
never worked either for me.

<strong>So what have we learned with this debugging?</strong>  The big
thing is to know your tools.  I feel kind of foolish
admitting that if I had read the W32Dasm help files, I would have made
this patch over a year ago.  While I
have been able to debug with SoftIce, I found the W32Dasm interface a
lot easier to deal with and was able to
understand more of what was going on in the program.

I guess I'm one of those people who need windoze no matter how many
times it crashes every day here.

Sick, isn't it?

Any comments or suggestions can be directed to me at
cupocat(at)yahoo(dot)com.
</pre>
<br><br>
<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6">
<center><font size=+2><font color=blue>Oh Duh</fonT></fonT></center>
</td></tr></table>
<center>   <i>I wont even bother explaining you
    that you should BUY this target program if you intend to use it
for a longer
    period than the allowed one. Should you want
    to STEAL this software instead, you don't need to crack its
protection
    scheme at all: you'll
    find it on most Warez sites, complete and already regged,
farewell.</i><p>
My comment:  Actually the warez version you will find is the pre
release version that was very buggy.
</center>
<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of reverse
engineering,  choose your way out:</i></center>
<br>
<center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- <a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm">
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" ALT="projecT3" ALIGN=CENTER WIDTH=114
HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT><br><bR>-->
<!-- OR JUST A LINK LIKE THIS -->
<!--<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to
Your_chosen_project</A><hr width=33%>-->
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm" http://fravia.org/ideale.htm>antismut CGI-scripts</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML><head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>bouche</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+5">BoundsChecker time limit<br>
(&quot;Persistent file protection&quot;)</font>
<br>
<h4><i>by Harwi</i>
<br>(05 July 1997, slightly edited by Reverser)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
Courtesy of Reverser's page of reverse engineering
<br><br><i>Well... even Boundschecker uses a pretty simple &quot;Cuckoo's egg&quot; 
protection scheme... actually pretty 
deceiving, thinking how good in assembly coding the Numega boys should be...<br> 
Thanks Harwi! Discovering this you show  
 us the way... and I notice a very interesting &quot;zen&quot; touch 
in your reverse engineering approach, btw :-)</i></center>
<hr size="2">
<pre>
<center><font size="+3">
How I did IT.<br>
Reverse engineering<br>the Protection scheme of BoundsChecker 5<br>
(Win95 14-day trial version)</font><br>
 By Harwi, 4 July 1997.
</center><br>

I would say that the &quot;second&quot; hottest debugger in the windows/dos world 
is probably BoundsChecker (BC) from NuMega. I would also say that it 
directly follows -in importance- after our beloved SoftIce, from that 
same holy company.
From the moment I first saw BC version 4 on the Visual C/C++ version 4 CD  
(VC4), about a year ago, I loved it. 
For the people who don't know about it: BoundsChecker is a debugger for 
application developers, i.e. people writing programs using the 'normal' 
application programming interface (API) for Win95 or NT or whatever, 
depending on what for a platform they are targeting. I would draw a line 
between these programmers and those writing drivers (like VXD's in windows) 
and stuff like that, where there is more low-level (assembler) programming 
involved. 
There are versions of BC for Win95, NT and Dos, I think, maybe more.
(Bug: A Bug is -in computer language- an error or condition that crashes 
or at least prevents a program from running as intended. Most bugs are due 
to logical mistakes in the sequence of execution of statements. A debugger 
is a program that lets the programmer monitor the code being executed and 
gives him a chance to understand what is happening and what is going wrong.)

Conventional Debuggers, like theone you get with most compilers are nice 
tools indeed, they let you step through the code, change variables put 
breakpoints here and there and a lot more. 
The annoying thing about them is that you have to have some sort of idea 
or intuition) where your error is located, so that you can breakpoint 
there and understand what&#146;s going wrong.
BC on the other hand does this work automatically, because it hooks each 
and every API call, pointer read and pointer write and so on. So you 
don't put any breakpoints anymore, you just run your program inside 
BC and BC will break whenever your program executes any error, and 
display the source code, together with relevant explanations. 
The responsable for theis brilliant tool is -as far as I know- Matt 
Pietrek, who was (or still is?) project leader for BC at NuMega (if 
you are reverse engineering anything at all you MUST have read his 
books :-) 
I must state here that I believe BoundsChecker absolutely worth its 
price, and should I ever use it for commercial purposes, I will 
purchase a copy!

Sadly enough the first demo I had, on the VC4-CD, was limited to 
debugging an application called Bugbench, that made the ugliest 
programming errors -that kind of errors that everyone who has 
ever done application development loves to find in her/his source 
code.
Too bad that I didn't know how to crack it at that time... I could 
not, because I hadn't yet learned enough about cracking.

When I came across Reverser's Page, about a month ago, I read +ORC's 
tutorial and a lot of the students' essays, and after reading, I 
tried to crack BoundsChecker and guess what: I got it. 
That was a great success for me :-) 

So, here comes the interesting part...
<br>
<font size="+4">How I did IT.</font> 

First I downloaded bc50_v(1).exe from <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#1" tppabs="http://fravia.org/tppmsgs/msgs0.htm#1">http://www.numega.com</a>.  
<font color="purple">Download quickly!</font> I don't know how long they'll keep it there after 
the publishing of this essay... (you'll be able to fetch it from other 
+crackers though :-)

Being all excited about this new &quot;time limited&quot; version, I installed it 
at once, without saving important system stuff, like the registry, and 
the various windows directory files... 
A mistake and a pity, because later I had to fetch another computer 
and re-install the same software again, in order to see which registry 
entries had been made and HAD NOT been removed by the uninstaller, a 
fact evident, since the time limit expiration did hold after 
uninstalling.

Unfortunately I made a second mistake, assuming that BoundsChecker 
saved the date information inside the registry. This is common with 
many programs, NOT with BoundsChecker! 
Therefore I didn&#146;t backup the VERY IMPORTANT (and unfortunately huge) 
file list of both the <font color="purple">windows</font> directory 
and  the <font color="purple">windows\system</font> directory. 
Too bad - comparing the registry backup with the registry after the 
install didn't give me any clue... no suspicious looking entry at 
all. 
Not very smart! I had wasted the two machines I had available for 
my installations and still wasn&#146;t able to just reinstall BC in order 
to use it after the trial period expires. That means only one thing: 
the date information must be hidden somewhere in ANOTHER file 
installed on my machine.

By simply uninstalling BC you will not reset your trial period anew. 
I found that you can play around with the system date, though, and 
in this way you'll be able to use BC as long as you want. 
But that&#146;s not what I like, and of course for such kidding you have 
to remember the original install date, in order to be able to set 
the system date within the allowed 14 days, which is also neither 
really &quot;elegant&quot; nor nice.
I had to crack this target, I felt it :-)

What did I do? 
Using SoftIce I put a breakpoint on GetSystemTime API function.  
Then I started BC and ... nothing! BC is not calling GetSystemTime, 
how is that possible? Are they using some fancy stuff to get the 
date? I was puzzled. 
I load Bugbench and press the Run button, the Trial Dialog pops up. 
Still no call to GetSystemTime, I&#146;m missing something here.
I went and got a coffee (I&#146;m sorry Reverser! there were no cocktails 
around) and thinked about it. 
Lets try DialogBoxParamA, somewhere the target must open that 
dialogbox! 
I pressed Run again.
There we are! SoftIce comes up, I type &#145;stack&#146;, but no callstack 
is displayed, I don&#146;t know what this means, maybe someone can 
explain it (?). 



I step through the system code to the next return.
That&#146;s it I am now in TLOCK32.DLL, before I didn&#146;t even know that 
TLOCK32 was used by BC because BC.EXE does not have an import 
section, so you can&#146;t see what DLL&#146;s are used. The DLL&#146;s in the 
BC directory don&#146;t say what they import either. To see the static 
imports of .exe and ...dll files, you can use the &#147;Quick View&#148; 
that comes with windows. 
If disassembled BC.EXE still does not have any explicit reference 
to TLOCK32.DLL, so it is either dynamically loaded or loaded by 
some other DLL (BTW in the disassembly one can see a lot more 
imports then the &#147;Quick view&#148; is displaying).

Where is TLOCK32.DLL&#133; search, aha! It&#146;s in windows\system, possibly 
a file that is not removed by the uninstaller.
But since I&#146;m here let&#146;s see what the dialog does. I put a breakpoint 
one line in front of the call to DialogBoxParamA (and GO); back 
in windows I close the dialog with Cancel and open it again with 
Run. In SoftIce again: some pushes before the call to DialogBoxParamA, 
there is the address of the callback for this dialog pushed, I put 
a breakpoint on the callback and remove the one inside DialogBoxParamA. 
Go! And back in SoftIce inside the dialog callback function. BC must 
now initialize the controls to display how far in the trial we are. 
I step through the code and find some GetDlgItem and SetWindowTextA 
calls and then a suspicios looking section where a memory location 
is compared to 1,2 and 4. That looks like a flag! 
The corresponding jumps go to quite large blocks of code inside the 
callback, maybe I am lucky and they do something to the state of the 
application here. I remove all breakpoints and set one right in 
front of that compare section. GO! Back in windows (after closing 
the dialog with Cancel) I advance my system date by two days. Press 
Run... SoftIce pops up&#133; the flag (loaded to EAX) holds a 2, GO! &#147;12 
Days left&#148; in the blue bar and the message inside the box saying &#147;12 
Days left&#133;&#148;. Cancel and again Run&#133; SoftIce, EAX is still 2, I change 
to 1. GO!
GOTCHA! 14 Days left! Beauty!
Cancel, and advance the date by one year, Run ...  back in SoftIce 
the flag (EAX) is 4, GO! &#147;Trial expired&#148;, no Blue anymore, Cancel! 
And Run&#133; SoftIce: The Flag is still 4, change it to 1, GO! But now, 
still &#147;Trial expired&#148; what&#146;s that? I thought I had it, Cancel and 
Run ... now the flag is 2, what&#146;s that? GO! Ahhh! Blue! and &#147;14 Days 
left&#148;. And now press OK, the Bugbench starts and I try some Errors, 
it works BC displays them. So it is only a matter of the initialization 
of the dialog controls. When the trial is over you can set the flag 
to 1 and the trial will begin anew. All you must do is close the dialog 
and reopen it again; you will get a new trial period.

Now I disassemble TLOCK32 and here I find the answer why I didn&#146;t 
catch the GetSystemTime calls, Simple! GetSystemTime is not called 
- they call GetLocalTime. Something to remember.

So what do I do with that flag? 
I change from:
	:100029EA 7417	je 10002A03    // New trial
crk	:100029EA 7517	jne 10002A03

Start BC again, load Bugbench and press Run &#133; and &#133; and &#133; and... 
NOTHING! No dialog no starting Bugbench, nothing!
Why that? Maybe a there is a checksum? I look again at the 
TLOCK32.ASM file. 
Then I change:
	:100029EC 83F802	cmp eax, 00000002     // Whithin trial 
crk	:100029EC 83F801	cmp eax, 00000001 


Start BC, load Bugbench and press Run, here we go, the dialog 
pops up and after OK Bugbench starts.
I play around with some dates and it works fine.
Here is the section where the flag is compared completely.
     :100029E2 A198FA0010    mov eax, [1000FA98] // This seams to be a sort of flag 
     :100029E7 83F801        cmp eax, 00000001   // new trial
     :100029EA 7417	     je 10002A03
crk  :100029EA 7517          jne 10002A03      	 // checksum is 1+
     :100029EC 83F802        cmp eax, 00000002   // Whithin trial 
crk  :100029EC 83F801        cmp eax, 00000001     
     :100029EF 0F848F000000  je 10002A84         //also  for checksum -1	
     :100029F5 83F804        cmp eax, 00000004   // trial is over
     :100029F8 0F8466010000  je 10002B64        
     :100029FE E981010000    jmp 10002B84  


I think this approach has its own beauty because it displays the 
protection dialog and thereby lets you remember the great victory 
of the past. But when you start your compiler, the dialog is also 
displayed and since we know now where BC stores its state, lets see 
if we cannot get ride of that dialog completely. 
The questions that come to mind are (at least to me): 
What about the flag being equal 3? What does the flag value 3 
tell BC about its state? 
Some playing with the flag (and SoftIce) soon gives the friendly 
answer: 
YES! 3 means, BC has been purchased. Some more playing with memory 
read/write breakpoints gives the location where it is easy to 
change a byte and a second to make the checksum happy. Here is 
what I changed so that there is no dialog popping up anymore 
(still inside TLOCK32.DLL):

	&#133;
	:100011F9 DFE0	fbld tbyte ptr eax
	:100011FB F6C401	test ah, 01

/// and here I crack for no dialog
	:100011FE 752e	jne 1000122e
crk	:100011FE 7500	jne 10001200 // checksum difference is &#150;2e

	:10001200 BE04000000	mov esi, 00000004
crk	:10001200 BE03000000	mov esi, 00000003 // checksum difference is &#150;2f

	:10001205 EB27	jmp 1000122E
	:10001207 BE04000000	mov esi, 00000004
crk	:10001207 BE052e0000	mov esi, 00002e05 // for checksum only , back to 0

	:1000120C E8CF090000	call 10001BE0
	:10001211 6A00	push 00000000
	:10001213 E8F8010000	call 10001410

Of course there are a lot more ways to crack this, mine is just one 
of them. I must also say that I have been extremely lucky to find 
the code (with the flag-compare) inside the dialogs callback fairly 
soon. If I hadn&#146;t, I might not have gone back to the callback. 
But, to speak with +ORC, sometimes you need some Zen.

Someone may ask, where the installation date is stored... I must 
admit that I still don&#146;t know that, but I also don&#146;t care much, 
because I&#146;m not going to break into my locked main door when my 
bathroom window is open.

Harwi, 05 July 1997

</pre>


<br>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center><br>

<center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>

</body>
</html>





<HTML>
<HEAD>
<!--   -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>int21_m2:
 ONE MORE STUPID PROTECTION
</TITLE>
</HEAD>
<body BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22">
<TR>
<td></td>
<td>
<center>
<FONT SIZE="+2">One more stupid protection </fonT>
<br>
<FONT SIZE="+1">(Explaining a very stupid quiver protection)</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->

<center>
<a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm"><IMG SRC="images/stupid.gif" tppabs="http://members.xoom.com/tsehp_/images/stupid.gif"
ALT="stupid" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
</center>
</td>
</tr>

<tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">

<!-- Date -->
9 January 1999

</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+3>

<!-- int24h -->
int24h
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">

<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm" ><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN="BOTTOM"
BORDER="1" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="#898030"><center>Courtesy of Reverser's page of
reverse engineering</center>
</center></TD><td BGCOLOR="#898030"><center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited
<br>
by reverser+
</center></td></TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font
color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></
fonT></td><td><i><center>
<!-- Your truly+ comments -->
Once more: never, never, never trust what the notes accompanying your 
software claim: you always better 
check everything yourself... if you'r a reverser, taht is :-)<br>
"<font color=purple>Beware! If the user forgets his password, it 
will be impossible for
him to access his account"</fonT>... yeah?  
should really one of the  poor 'clients' of this stupid target 
believe what the Author told him, he would be well advised to 
read the following... and don't be so naïv to believe that this 
does not happen often enough elsewhere as well... current favourite sport by  infowarfarer 
lusers on the web is to pick supposedly 'protected' and 'secure' zip 
and excel files 
from (stupid but countless) industrial sites... unfortunately (for them) 
all software is open like a sea...<br>
</center><br>On waters far<br>
Where map-man never made survey,<br>
Gliding along in easy plight<br>
The strong reverser brake the lull of night<br>
<br><center>
You do remember your Herman, I hope...
</i></center></td><td></td></tr><TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
<TD BGCOLOR="#898030"><center></i><b>There is a crack, a crack in
everything
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE"
bgcolor="#FFFFEA"><font
color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#FFFFEA"><font color=blue><center>

<!-- CHOOSE A RATING (may be changed) -->
(X)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> (
)<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>

<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->


<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
ONE MORE STUPID PROTECTION
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
Project 7
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by
int24h
</FONT></center><br><br>


<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#FFFFEA"><center><font size=+2><font
color="#898030">Tools
required</fonT>
</fonT></center></td></tr></table>

<br>
 - REGMON (or anyother registry tool)
<br>
 - Your favorite editor

<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#FFFFEA"><center><font size=+2><font
color="#898030">Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
<br>
Pointage Express v1.0 : <A
href="http://www.triagone.com/sharew/p-express.zip" >http://www.triagon
e.com/sharew/p-express.zip</a>
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#FFFFEA"><center><font size=+2><font
color="#898030">Program History</fonT>
</fonT></center></td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
<p>
Pointage Express v1.0 is a french account manager. It's one of the
four programs of TRIAGONE, a french society specialised in custom made
programs. Their proggies are written in <a
href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >WINDEV</A>.
(Beware it's in french).
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#FFFFEA"><center><font size=+2><font
color="#898030">Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED!
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<pre>
- <u>Limitation</u>
  The program can be used 30 times. On the 31th time it's locked!

- <u>Type of protection</u>
  name / serial number

  On the beginning, a nagscreen appears with a countdown of your
  remaining uses. You must click on the "Je suis d'accord" button (ie
  :I  Agree) to continue. On the background of the main window there
  is a text showing your unregistered status.

- <u>Registration</u>
  To register, clic on "?" then on the logo (a triangle).Enter your
  name and serial number.

  A bogus answer results in an error
  message.
<u><FONT color="#893009">
<B>1- How to defeat the protection</B></U>
</font>
After a first run, i searched the Registry for new entries, in
HKCU\Software and HKLM\SOFTWARE but there was nothing about Pointage
Express!

- Load <B>Regmon</B> then "Pointage express.exe" .
- Two interesting lines appeared:
  <font color="navy">
  HKCR\Log_tri.Config.Parameters\CPT    SUCCESS  "29"</font>
  <font color="navy">HKCR\Log_tri.Config.Parameters\LIC	NOTFOUND
  </font>
  CPT stands for COMPTEUR (ie COUNTER)in <U>decimal</U> value.
  LIC stands for LICENCE  (ie LICENSE)

  On every load, CPT is decremented until you reach "0". What's funny
  is that you can change the value to whatever you want, say...10000
  :) But the nagscreen screen is still there :(

  Adding the string "LIC" with no value won't register you. After a
  few "searches" it appears that the registered format is:

  <B><font color="olive">LIC="nnnnnnnnnncccccccc"</font></B>

  n=characters, 10 are needed to fill up the serial number line.
  c=characters up to 32.

  For example a valid line could be:
  LIC="1F3-4H6-7Tint24h" or LIC="0123456789int24h"

<FONT color="#893009">
<B><U>2- How to retrieve the password of an account.</U></B>
</font>
What the author says in the help file about protecting an account:

(translation)
" The fact to protect an account gives the owner of this account a
great confidentiality on his budget position."

"Beware! If the user forgets his password, it will be impossible for
him to access his account."

Well, that's not true!
In fact the name and the password (when existing) of an account
appears in CLEAR in two files, <font
color="navy">COMPTE.NDX</font> and <font
color="navy">COMPTE.FIC</font>.

- <U>COMPTE.NDX</U>

This file stores the name and the password (if existing) of any
account you created. The names are <U>numerically/alphabetically
ordered</U>, beginning at offset <EM>0x80B</EM>. Two names are
spaced by 0x2D bytes. The passwords are stored the same way,
beginning at offset <EM>0x140B</EM> and they are seprated by 0x19
bytes.

Changing a name or a password in this file will created an error on
the access of the modified account.

- <U>COMPTE.FIC</U>

Here, the names and the passwords are stored in the same order you
created them.
</pre>

<!--Tableau des offsets-->

<table border="1">
<tr>
<td></td>
<td bgcolor="#FFee00"><B>1st acc. created</B></td>
<td bgcolor="#aacc00"><B>2nd acc. created</B></td>
<td bgcolor="#88ee00"><B>3rd acc. created</B></td>
</tr>

<tr>
<td><B>Account's name</B></td>
<td bgcolor="#ffff00"><CENTER>0xA2</CENTER></td>
<td bgcolor="#aabb00"><CENTER>0x13F</CENTER></td>
<td bgcolor="#88dd00"><CENTER>0x1DC</CENTER></td>
</tr>

<tr>
<td><B>Account's pwd</B></td>
<td bgcolor="#FFFF00"><CENTER>0xDF</CENTER></td>
<td bgcolor="#aabb00"><CENTER>0x17C</CENTER></td>
<td bgcolor="#88dd00"><CENTER>0x219</CENTER></td>
</tr>


<tr>
<td><B>Account's #</B></td>
<td bgcolor="#FFFF00"><CENTER>0xF4</CENTER></td>
<td bgcolor="#aabb00"><CENTER>0x191</CENTER></td>
<td bgcolor="#88dd00"><CENTER>0x22E</CENTER></td>
</tr>
</table>
</pre>

<pre>
And so on...

If you modify the name or/and the password of an account, be sure to
use <U>CAPITAL</U> letters. And do the same changes in COMPTE.NDX .
</prE>
<br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#FFFFEA"><center><font size=+2><font
color="#898030">Final Notes</fonT>
</fonT></center></td></tr></table>
<pre>
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
Bah, we're not supposed to edit COMPTE.xxx files, but we like to know
what's on our system ...and how things work !

There are three other softwares on their site and the protection is
(you'll easily be able to find it out, but believe me, it is not worth it) ...the same!
</pre>
<br>
<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
HEIGHT="22" >
<tr><td bgcolor="#898030"><center><font size=+2><font
color="#FFFFEA">Ob
Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even bother explaining
you
   that you should BUY this target program if you intend to use it for
   a
   longer period than the allowed one. Should you want to STEAL this
   software instead, you don't need to crack its protection scheme at
   all:
   you'll find it on most Warez sites, complete and already regged,
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of reverse
engineering,
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!--
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm" ><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif"
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm" >Back to
Your_chosen_project</A>
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut
CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>
<xbasehref="http://f1.mail.yahoo.com">
<!-- end message -->



 <table cellspacing=0 cellpadding=1 width=100% border=0>
<tr>


<form method=post action="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&box=Inbox&message=5105_2957283_55178_643_13420_0&sort=date&NEX=1&order=down&inc=25&num=0&YY=9449&pos=0" >



<td bgcolor="#dcdcdc" nowrap>
<font face="Arial,Helvetica" size=-1>
<input type=submit name=TRA value="Delete"> Message	- <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&toc=1&order=down&box=Inbox&message=5105_2957283_55178_643_13420_0&YY=9449" ><b>Download</b></a>
</font>
</td>



<td colspan=3 align=right bgcolor="#dcdcdc" nowrap>
<select name=destBox1>
<option value="">- Choose Folder -













<option>start1</option>


</select>
<input type=submit name=MV1 value="Move">
</td>



</form>



</tr><tr>



<form method=post action="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&folder=Inbox&sort=date&order=down&inc=25&YY=9449" >
<input type=hidden name=message value="5105_2957283_55178_643_13420_0">
<input type=hidden name=Subject value="Project 7 - Essay">



<td nowrap valign=middle width=1% ><input type=submit name=reply value="Reply"><input type=submit name=replyAll value="Reply All">&nbsp;<input type=submit name=forward value="Forward"><font face="Arial,Helvetica" size=-2><select name=fwdoption><option value=attach >as attachment<option value=quoted SELECTED>inline text</select></font></td>



</form>



<td align=left valign=middle nowrap><font face="Arial,Helvetica" size=-1>
-

<b><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&box=Inbox&message=5105_2957283_55178_643_13420_0&sort=date&PRE=1&order=down&inc=25&num=0&YY=9449&pos=0" >Prev</a></b> |


<b><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&box=Inbox&message=5105_2957283_55178_643_13420_0&sort=date&NEX=1&order=down&inc=25&num=0&YY=9449&pos=0" >Next</a></b>

</font>
</td>
<td align=right valign=middle nowrap>
<font face="Arial,Helvetica" size=-1>
Back to <b><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&box=Inbox&sort=date&order=down&YY=9449&pos=0" >Inbox</a></b>

</font>
</td>

 </table>
</form>

<BR><BR>
<font size=-1>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm?Pyt=Tnf&TOS=1&YY=9449" >Terms of Service</a><BR>
<i>Copyright &#169; 1997-98 <a href="http://www.yahoo.com/"  target="_blank">Yahoo!</a> Inc. All rights reserved.</i>
</font>

</td>
</tr></table>
<p>
<!--YahooMail-->
</body>
</html>


<html>
<head>
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>surrsea2.htm: Reverser's how to search the web, Surreal5's second lesson</title></head>
<body>
<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">

<pre>
part 2: how to find Warez/mp3's/xxxpwords etc

This goes a little beyond just using search engines. I assume you have a
basic knowledge of FTP, and know how to use search engines. I'll use warez
as example, but the same search strategy goes for mp3's, passwords, and
anything with a time sensitive character, like cool live realaudio surf
soundtracks ;)

FTP search sucks, forget it as your main warez finder, i use it only to
locate missing files. Its noise/signal ratio is bad, even when you know
what day(s) of the week it is updated. The best way to find things with a
time sensitive character is to monitor the pages of the uploaders. For this
you will need a program that monitors webpages and notifies you
automatically when they are updated. I use Tierra Highlights2, because it
has an intuitive interface, and works as a toolbar. An alternative would be
Netattache, but i have bad experiences with it. If you already use a page
monitor, with at least a 15 minute update interval, by all means keep on
using that, but i'm using highlights as an example. 


Step 1: Setting up Highlights.

Highglights comes in a crippled demo version, it's time limited and has a
15 page maximum. Datecracker removes the time limit, but there is NO crack
for the 15 page maximum, at the time i write this . (believe me i've looked
for it). The program is cheap (around 35$) considering the good it can do
you. 

With Highlights you add a page (much like a bookmark), except it monitors
the page for you. It retrieves the page every 15 minutes (or to whatever
you set it) and highlights the changes in a different colour. In other
words within 15 minutes after uploader X, tells the world (on his page)
where he has uploaded to, you'll know about it, and are one of the first
into the ftp if you want a certain proggie. Considering warez stay on a
public ftp for about a day or two, knowing it was added only maximum 15
minutes ago, makes it worthwile checking out. Over 90% of the links i
follow this way, i get in fast, and the warez are there. Ofcourse this
ratio depends highly on the quality of the pages you monitor. So you need
to find and maintain a list of good pages.


Step 2: How to find good pages.

This is where your search technique comes in again. If you have to start
from scratch, there are two ways to find warez pages, wether they are good
takes a bit of trial and error.

1) go visit the warez top's, forget the first 10 or so, and start following
links.
2) use a search engine with a date filter and look for warez pages added in
the last few days, or look
for programs that you need :)

Go by these rules when you need to judge wether a warez page is suitable
for monitoring:
- warez pages without warez are not warez pages ;)
- warez pages that were updated longer than one or two days ago, are of
little use
- warez pages that do not contain the page owners own uploads, are of
little use. (if you start from scratch, you may keep a few leech pages
though, an update on a leech page, does mean that he got in recently...) 
- Wether the site has direct links or ftp adresses makes no difference, as
long as it's updated, and the content of what's on the ftp is shown. Ftp
links without content, are a sure giveaway that the page owner doesn't
upload himself, multiple (more than 2) direct download links for the same
proggie are a sure giveaway that he does.
- Ignore pages that are slow to load, it may be because they get too many
visitors, and your 15 minute advantage becomes useless. For the same reason
you can ignore the pro's, the pro's pages suck, everyone is on there. Go
for the kids pages, they're only good until their enthousiasm runs out, but
boy do they have enthousiasm!!! ;)


Step 3: Maintaining the quality of your list of pages.

A warez page is like a restaurant, as long as there are few people who know
about it, "the food" is good, when there are too many "customers" the
quality and service go down. When there's nobody, it closes. It takes a bit
of experience to recognise the "type" of a warez page and its owner, but
you'll soon know which pages to keep and which to throw out. A few golden
rules:

- page maintainers need feedback for their enthousiasm, click on their
sponsors, or give them a pat on the back, but stay away from that top ...
button!!!
- If you use the demo with 15 page max, always keep one or two 
free for new pages you may run into. It's continuously keeping the best,
and throwing out the ones who's page title you haven't seen for a while.
Remember your search for new pages never ends, when you have a 99.8% succes
ratio, there's always that 99.9%. Ignore it for too long, and your ratio
will fall, or the pages will have moved or are dead, and you can start all
over.
- Ignore the sort by date ranking for making a decision on which pages to
throw out, remember time is not the same on the other side of the globe ;)
Keep the ones that update around the time you are generally online.
- Remember it's better to keep a page of a busy uploader, who doesn't
update every day, than a page of a leecher who updates every hour.
- Throw out design wizzards who update their page without adding anything,
and pages with rotating banners.

For mp3's it's much the same, for passwords i imagine you have an extra use
for highlights by setting the keyword filter to the xxxsite(s) you're
looking for. The datecraked demo should work fine with the 15 pages max for
any of these tasks, but not for all three tasks at the same time, you can
get around it, by using multiple highlights.haf files and moving them to
your dir when you need them, but is the fuss really worth the 35$ i wonder... 
  
have fun...

surreal5.
</prE>

<HR ALIGN=CENTER WIDTH=100% SIZE=3>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i>
<br><bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red><a href="surrsea1.htm" tppabs="http://members.xoom.com/tsehp_/surrsea1.htm">Back to Surreal5's search tips</a>
<br><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">Back to how to search</a>
<br><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search engines</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
<bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascripts wars</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonimity academy</a> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</a>
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a> 

</center>

<hr size=3>
</body>
</html>





  









<html>
<head><title>pain2.htm</title></head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">How to make key generators</font>
<br>(Reversing some 'mathematical' routines)<br><br><h4>by ^pain^ <br>
<br>
(11 November 1997, snatched and slightly edited by reverser+)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<br>
<br><i>Well, another 'snatched' essay... strangely enough ^pain^ never sent it to me (even if he greetz me at the bottom).<br>You all know that I am 'against' key generators: it beats me why should we offer to the zombies software for free: the task of all crackers should be to TEACH people whose brain has not yet been totally atrophied by tv-drool watching or by Web-pushing how to MODIFY their software (or the software of somebody else :-), spotting silly protection scheme (especially if commercial) and uselessly overbloated applications, showing how ridicules they REALLY are, behind all the hypo and the advertising fanfare... our mission, in my opinion, is therefore NOT AT ALL to advantage idiots and slaves of the Micro$oft enemy, who would not understand what the cuckoo a byte represents even if it would jump out of the code and bite them a leg off...<br>This said, at times, (like in this 
essay by ^pain^) the creation of a key generator can teach us a lot about 'mathematical manipulation' code snippets. And this may be indeed important. Therefore I have decided to snatch and publish this essay nevertheless!</i></center><hr size="6"><pre>
<center>How to make key generators?
-===========================-</center>

Introduction
------------
I take no responsibility for the usage of this information.
This tutorial, is for educational knowledge ONLY.

Hi there, in this tutorial, I intend to teach you how to make a pretty 
simple keygen, of a program called W3Filer 32 V1.1.3.
W3Filer is a pretty good web downloader...
I guess some of you might already have bought this good program.

I`ll assume you know:
A.How to use debugger (in this case, SoftIce).
B.How to crack, generally (finding protection routines, patching them,etc...).
C.How to use Disassembler (This knowledge can help).
D.Assembly.
E.How to code in Turbo Pascal (tm).

Tools you`ll need:
A.SoftIce 3.00/01 or newer.
B.WD32Asm. (Not a must).
C.The program W3Filer V1.13, which can be found on the web.
D.Turbo Pascal (ANY version).

Well, enough blah blah, let's go cracking...
Run W3Filer 32.
A nag screen pops, and , demands registration (Hmm, this sux ;-) Now, 
We notice this program has some kind of hardcoded serial number (Mine is 
873977046), Let's keep the hardcoded serial in mind, I bet we`ll meet it again 
while we're on the debugger.

Well, now, let's put your name and a dummy reg code... 
set a BP on GetDlgItemTextA, and, press OK.
We pop inside GetDlgItemTextA, Lets find the registration routine...
I`ll save you the work, the registration routine is this:

:00404DB2 8D95A8FAFFFF            lea edx, dword ptr [ebp+FFFFFAA8]
:00404DB8 52                      push edx          ; Your user name here.
:00404DB9 E80B550000              call 0040A2C9     ; Registration routine.
:00404DBE 83C408                  add esp, 00000008 ; stack recorrection
:00404DC1 85C0                    test eax, eax     ; Boolean identifier, 0 if 
:00404DC3 7D17                    jge 00404DDC      ; registration failed, 1 if OK

Well, Let's enter the CALL 40A2C9, and see what's inside it:
(Please read my comments in the code).

* Referenced by a CALL at Addresses:00404DB9, :00407F76   
|
:0040A2C9 55                      push ebp
:0040A2CA 8BEC                    mov ebp, esp
:0040A2CC 81C4B0FEFFFF            add esp, FFFFFEB0
:0040A2D2 53                      push ebx
:0040A2D3 56                      push esi
:0040A2D4 57                      push edi
:0040A2D5 8B5508                  mov edx, dword ptr [ebp+08]
:0040A2D8 8DB500FFFFFF            lea esi, dword ptr [ebp+FFFFFF00]
:0040A2DE 33C0                    xor eax, eax
:0040A2E0 EB16                    jmp 0040A2F8

* Referenced by a Jump at Address:0040A2FB(C)
|
:0040A2E2 0FBE0A     movsx ecx, byte ptr [edx] ;Here Starts the interesting part.
:0040A2E5 83F920     cmp ecx, 00000020         ;ECX is the the current char in the user name, Hmm, 20h=' '...
:0040A2E8 740D       je 0040A2F7               ;Let's see,
:0040A2EA 8A0A       mov cl, byte ptr [edx]    ;Generally, all this loop does, is copying
                                               ;the user name from [EDX], to [ESI], WITHOUT the spaces!
                                               ;(Keep this in mind! ).            
:0040A2EC 880C06     mov byte ptr [esi+eax], cl
:0040A2EF 42         inc edx
:0040A2F0 40         inc eax
:0040A2F1 C6040600   mov byte ptr [esi+eax], 00
:0040A2F5 EB01       jmp 0040A2F8

* Referenced by a Jump at Address:0040A2E8(C)
|
:0040A2F7 42                      inc edx

* Referenced by a Jump at Addresses:0040A2E0(U), :0040A2F5(U)
|
:0040A2F8 803A00                  cmp byte ptr [edx], 00
:0040A2FB 75E5                    jne 0040A2E2 --&gt; This is the loop , we got what it does, 
                                                   ;Let's continue tracing the code...
                                                
:0040A2FD 56                      push esi         ;The user name is pushed, in order to 
                                                   ;Upcase it's chars.                                                        

* Reference To: USER32.CharUpperA, Ord:0000h
                                  |
:0040A2FE E80F330000    Call User!CharUpper ; After this, our name is in upper case.
:0040A303 56            push esi            ; Our name in upper case here.

* Reference To: cw3220mt._strlen, Ord:0000h
                                  |
:0040A304 E86F300000    Call 0040D378     ;This is the length of our name.
:0040A309 59            pop ecx        
:0040A30A 8BC8          mov ecx, eax      ;ECX=Length.
:0040A30C 83F904        cmp ecx, 00000004 ;Length&gt;=4 (MUST).
:0040A30F 7D05          jge 0040A316      ;Let's go to this address...
:0040A311 83C8FF        or eax, FFFFFFFF
:0040A314 EB67          jmp 0040A37D

* Referenced by a Jump at Address:0040A30F(C)
|
:0040A316 33D2       xor edx, edx
:0040A318 33C0       xor eax, eax
:0040A31A 3BC8       cmp ecx, eax
:0040A31C 7E17       jle 0040A335 ; (Not important, just another useless checking).

=========================================================================
========= FROM HERE AND ON, THE IMPORTANT CODE, PAY ATTENTION ===========
=========================================================================

One thing before we continue, EDX = 00000000h as we enter to the next instructions.

* Referenced by a Jump at Address:0040A333(C)
|                                
:0040A31E 0FBE1C06     movsx ebx, byte ptr [esi+eax] ; EBX <--- char in user name, offset EAX. :0040A322 C1E303 shl ebx, 03 ; Hmm, it shl's the char by 03h...(Remember that). :0040A325 0FBE3C06 movsx edi, byte ptr [esi+eax] ; Now EDI <--- Char in user name , offset EAX. :0040A329 0FAFF8 imul edi, eax ; It multiplies the char by the offset in user name! (Remember that). :0040A32C 03DF add ebx, edi ; Adds the result to EBX (That was Shelled (Ding Dong="))." :0040A32E 03D3 add edx, ebx ; EDX="EDX+EBX!!!" This is the CORE of this registration routine!!! :0040A330 40 inc eax ; Increase EAX by one (next char). :0040A331 3BC8 cmp ecx, eax :0040A333 7FE9 jg 0040A31E ; If ECX<EAX then, we leave the loop. * Referenced by a Jump at Address:0040A31C(C) | :0040A335 A120674100 mov eax, dword ptr [00416720] ; HMMMMMM, What's in here????? :0040A33A C1F803 sar eax, 03 ; WAIT! Please type in SIce '? EAX' Does this number in EAX look familiar to us? ;-) If you still don`t understand, than, It's our SERIAL NUMBER! (PLEASE, take your time, and check by yourself don`t trust me!). OK, so now we know, That it SHR's EAX by 03 (SAR is almost identical to SHR). :0040A33D 03D0 add edx, eax> Hmm, it adds the result from the loop, the serial number shr'd by 03h
:0040A33F 52            push edx     --&gt; Let's continue. (At this point, I can tell you , the reg number, is
                                                in EDX - only that the reg number is in HEX --&gt; That's how you enter it).

* Possible StringData Ref from Data Obj -&gt;&quot;%lx&quot;
                                  |
:0040A340 685EF54000              push 0040F55E
:0040A345 8D95B0FEFFFF            lea edx, dword ptr [ebp+FFFFFEB0]
:0040A34B 52                      push edx

* Reference To: USER32.wsprintfA, Ord:0000h
                                  |
:0040A34C E8E5320000     Call 0040D636  ; This one, does HEX2STR (Takes the
                                                 ;value from EDX, and turns it to an hex string).
:0040A351 83C40C         add esp, 0000000C
:0040A354 8D8DB0FEFFFF   lea ecx, dword ptr [ebp+FFFFFEB0] ;type 'd ecx' - THIS is the reg number! 
                                                           ;That's enough for us, the rest of
							       ;the code, is just for comparing ò
                                                           ;the correct reg code with ours.
:0040A35A 51                      push ecx

* Reference To: USER32.CharLowerA, Ord:0000h
                                  |
:0040A35B E8B8320000              Call 0040D618
:0040A360 8D85B0FEFFFF            lea eax, dword ptr [ebp+FFFFFEB0]
:0040A366 50                      push eax
:0040A367 FF750C                  push [ebp+0C]

* Reference To: cw3220mt._strcmp, Ord:0000h
                                  |
:0040A36A E875300000              Call 0040D3E4
:0040A36F 83C408                  add esp, 00000008
:0040A372 85C0                    test eax, eax
:0040A374 7405                    je 0040A37B
:0040A376 83C8FF                  or eax, FFFFFFFF
:0040A379 EB02                    jmp 0040A37D

* Referenced by a Jump at Address:0040A374(C)
|
:0040A37B 33C0                    xor eax, eax    ;return with ax=0

* Referenced by a Jump at Addresses:0040A314(U), :0040A379(U)
|
...	popping off
:0040A383 C3                      ret	            ;pop off and ret


              Making the actual Keygen
              ~~~~~~~~~~~~~~~~~~~~~~~~
Now, after I've explained how does the program calculate the registration
code, you can either write your own keymaker, without looking at my code, or
look at my code (in Turbo Pascal - sorry for all you C lovers ;-) Next time).

That's it, here's the Turbo Pascal source of my keygenerator:</pre><xmp>
------------------- Cut here ---------------------------------------------

Program W3FilerKeygen;
var
   Key,SerialNum,EB,ED,digit:Longint;
   I,x:Byte;
   Name,KeyHex:String;
begin
   Writeln('  W3Filer32 V1.1.3 Keymaker');
   writeln('Cracked by ^pain^ ''97 / Rebels!');
   Write('Your Name:');      { Read the name }
   readln(Name);             
   Write('Serial Number:');
   readln(SerialNum);        {Yes, we need the serial number for the calculation!}
   Key:=0;
   x:=0;
   For I:=1 to length(Name) do
   begin
      Name[I]:=upcase(Name[i]);
      If Name[I]<>' ' then begin
       eb:=ord(Name[I]) shl 3;  {EB = Name[I] Shl 03h}
       Ed:=ord(Name[I]);        {ED = Name[I]}
       ed:=ed*(x);              {ED=ED*Offset}
       inc(x);                  
       eb:=eb+ed;               {Add ED to EB}
       Key:=Key+EB;             {Add EB to KEY}
      end;
   end;
   Key:=Key+(SerialNum shr 3);  { Add SerialNum shr 03h to Key}

   { From here, this is just HEX2STRING --&gt; I`m quite sure it's
     Self explaintory, else - go and learn number bases again! ;-}
   KeyHex:='';
   repeat
      digit:=Key mod 16;
      key:=key div 16;
      If digit<10 then KeyHex:="Chr(Digit+ord('0'))+KeyHex;" If digit>10 then KeyHex:=Chr(Digit-10+ord('a'))+KeyHex;
   until key=0;
   writeln('Your Key:',KeyHex);
   writeln('                 Enjoy!');
end.
--------------------- Cut here ---------------------------------</xmp><pre>
This tutorial was written by ^pain^ / [mEXELiTE '97], Hope you enjoyed 
reading it, I`m always trying to improve my writing skills =).

Hmm, I'd like to greet the following: (No special order)

Blast Soft,Teraphy,J0b,Qapla,+ORC,Reverser+,Charley,GhostRdr,Odin,kOUGER
Niabi,Acpizer,Klagosong,Mystic Rioter,rANDOM,riDDLER (Come back man!
we NEED ya),yoshi,JosephCo,Leddy,Krazy_N,Vizion,Gunnar_,Volcanic,
Fant0m,Caruso,|PSA|,razzi,ThePharao,|KAIRN| + Everyone in #cracking &amp; in 
#cracking4newbies, And ofcourse - everyone else I forgot. ;)

------------ Signing off - ^pain^ -------------------------------
</pre>
<font color="green">(c) ^pain^ 1997. All rights reversed</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>
<html>
<head>
  
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>banda_56.htm</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<center>
<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm"><img SRC="images/snippets.gif" tppabs="http://members.xoom.com/tsehp_/images/snippets.gif" ALT="snippets" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a><br>
<font color="gray">Back to the Snippets</font><hr>
UNPACK/UNPROTECT COM FILES USING DEBUG.EXE<br>
(old powerful dos debugging - still useful today)<br>
(&quot;An acquarium for your viri&quot;)<br>
BY<br>
THE UNDERTAKER -=BANDA=-<br>
more than slightly edited by reverser+, 16 January 1998
<hr><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> Courtesy of Reverser's page of reverse 
engineering<br></center><hr><pre>
Most of today's com packers &amp; protectors can be removed using DOS 
debug. Many young crackers seem to have forgotten the mighty power 
of this very small and powerful utility: &quot;the swiss knife of all 
crackers&quot;, as Master +ORC wrote.
<font color="blue">
debug.exe  	20.522 bytes  (MS dos ver. 7, usually inside C:\WINDOWS\COMMAND)
<a href="http://acrigs.com/FRAVIA/zipped/symdeb.zip" tppabs="http://members.xoom.com/tsehp_/zipped/symdeb.zip">symdeb.exe</a>	37.021 bytes  (Ver. 4, Micro$oft)
</font>
This method is very useful, If you don't have tools around you. Also it
works with most of the popular packers &amp; unpackers. 
Actually DEBUG is a very powerful tool when it comes to the handling 
of com files. 
In those almost forgotten days, our bane micro$oft wanted to grab the 
market by producing good programs, an approach they have long forgotten, 
seen that it is now easier to grab the market bankrupting the adversaries. 

Anyway, that way DEBUG came up. 
Once they captured the market, they only cared about the money. 
Finally ending up with stupid programs like micro$oft word, access, VB+ 
and all other junk, useless programs that we are lobotomized with.

Before we start this approach, let's check how com files are organized.

 Com files are memory images that do not have any relocatable item. 
 They can only fit into one segment (SS,ES,DS = CS).

 Com files has a size of 64k. 
 Maximum amount one offset can vary between 0000 - FFFF

 Com files are slightly faster than the exe files, when it comes to 
 execution (bet you didn't know it).

 Com files do not have a header nor a checksum, like exe files.

 Com files should start at 100h, immediatly above the PSP.

 At the time of loading the com file. ES,DS,SS,CS are pointed to PSP. 
 And SP is pointed as high as possible in memory, minus 2 bytes 
 (SP = FFFE). In fact MS-DOS pushes a zero word on the stack before 
 entry.

Well, the information above will help you to handle com files. 
Ok, let us start the work. You'll see how you can UNPACK a 
file packed using an unknown packer using old silly debug!!

First, using a packer, compress your com file
I use pklite to pack a target com file of mine (CO.COM) 
Then load your packed com file using DEBUG.EXE
<font color="purple">
DEBUG CO.COM
</font>
Now type (r) to check the register contains.
<font color="purple">
-r
AX=0000  BX=0000  CX=0F6D  DX=0000  SP=FFFE  BP=0000  SI=0000  DI=0000
DS=20AB  ES=20AB  SS=20AB  CS=20AB  IP=0100   NV UP EI PL NZ NA PO NC
20AB:0100 B80524        MOV     AX,2405
-
</font>
Check the CX register. 
This contains the program size. If you convert the value inside the CX 
register to decimal you will get the actual file size, here it is
0xF6D = 3949 bytes

Once you uncompress the program you will have to &quot;adjust&quot; the value of 
CX, of course.

To uncompress the file just use the command go (g) and exit from the program. 
Then you simply land inside the debugger.
<font color="purple">
-g
</font>
After having exited the program you will see the following message:
<font color="purple">
Program terminated normally
-
</font>
Ok, Now you have got in memory the original(Uncompressed) file (of course: the 
point of any compressor is to compress a file UNTIL IT MUST RUN, duh). 
To Verify that you have an uncompressed program, you can chek the Unassembly 
listing by typing (u).
<font color="purple">
-u100
20AB:0100 E9B903        JMP     04BC
20AB:0103 0A434F        OR      AL,[BP+DI+4F]
20AB:0106 2031          AND     [BX+DI],DH
20AB:0108 2E            CS:
20AB:0109 3020          XOR     [BX+SI],AH
20AB:010B 286329        SUB     [BP+DI+29],AH
20AB:010E 2031          AND     [BX+DI],DH
20AB:0110 3938          CMP     [BX+SI],DI
20AB:0112 37            AAA
20AB:0113 205A69        AND     [BP+SI+69],BL
20AB:0116 66            DB      66
20AB:0117 66            DB      66
20AB:0118 20436F        AND     [BP+DI+6F],AL
20AB:011B 6D            DB      6D
20AB:011C 6D            DB      6D
20AB:011D 756E          JNZ     018D
20AB:011F 69            DB      69
-
</font>
Now we have to give the new size to our program. 
This is (a bit) the difficult part.
First we have to locate were the program ends. 
To do that we have check the program's terminating 
functions, and there are quite a lot of them. 
Like ...
<font color="purple">
        FUNCTION                SEARCH STRING
        --------                -------------

        1. RET          --&gt;     C3
        2. INT  20H     --&gt;     CD 20
        3. MOV  AH,4C  
           INT  21H     --&gt;     4C CD 21
        4. MOV  AX,4C00 
           INT  21H     --&gt;     4C CD 21
        5. INT  27H     --&gt;     CD 27    (For TSR's)
        6. MOV  AX,3100
           INT  21H     --&gt;     31 CD 21 (For TSR's)
</font>
Now we have to search our program for the above strings. 
You may of course write a short C program in order to do it, 
or you may do it 'per hand'. I'll show you how:
Lets start searching our program using the most common 
terminate function (AX=4C, INT 21).
<font color="purple">
-s cs:100 ffff 4c cd 21
20AB:0646
-
</font>
Aha.. found it at 0646. 
Now convert 0646 into decimal (1606) and then check if the 
value you have written down is smaller than this.

Oh...No! The previous value (0xF6D) is greater than this. 
This happens because this program's exit function is in the 
middle of the program, not at the end. 

In this case we have 2 options.
 1) Feel the code

 1. Search the program starting from 100h to the end of the code &amp; data. 
    Some times after the code starts all the data. 
    This is easy to detect: dump the program (d) starting from 100h and 
    just have a look at the code. 
    Once the program code &amp; data are over, you can identify the rest
    of the area easyly. 
    In fact, once the program is over, you will see some path settings &amp; 
    Ascii strings. Now write down the offset address were
    the program ends. 
    (To use this methods you need a good expriance of X86 assembly 
    OPCODES. By the way, getting this experience you will learn how to 
    detect patterns)

Lets say that we think that the program ends at offset 1105. 
Now he have to take off the starting 100h, because all com programs start 
from 100h. To do that we can use a Debug command of course...
<font color="purple">
-h 1105 100
1205  1005
-
</font>
Yes: answer is 0x1005. Now we have to set this value in CX register. 
We also have to give a <u>new name</u> to our 'new' uncompressed 
program...
<font color="purple">
-rcx
CX 0F6D
:1005           -- Our calculated program length.
-n test.com     -- New name for uncompressed file. (TEST.COM)
-w              -- Write test com into the disk.
</font>
Now you got an uncompressed file called TEST.COM. 

Ok, feeling the end of the code was not really difficult... 
Lets pass over to option 2.

 2. If you can't find the program end use a simple trick.  
    Multiply the compressed file size by 2. This will double the 
    compressed file size. Now put the new file size into the CX 
    register and give a name to the uncompressed file and save 
    it.


    NOTE :- Multification factor depend on the packer. 
    Some packers are able to pack files more efficiently
    than others.

Ok... Now using debug -as you can see- you can get the unpacked file. 
In fact debug is the <u>most effective</u> generic unpacker for com files. 
This is fairly known, and therefore many packed files may contain various 
INT 3 instructions(0xCC) inside their packed code. 
These int 3 have been put there ON PURPOSE, in order to &quot;gasp&quot; debug. 
These instructions will in fact cause the debugger to breakpoint. 

Do not worry: you could not care less!
Once you gasp with debug onto an INT 3 instruction just do the following 
steps...

Check the value in IP register and increment IP register by 1. Then 
countinue the program (g) that's all.
<font color="purple">
-rip      --- asking for ip
IP 016D   --- say this is the answer
:016E     --- then you just type 16E
-g        --- let's go on!
</font>
If you find more than one INT 3 in the packed code just repeat the above 
steps. If there are too many INT 3, just use your hexeditor's replace 
function and nop every single one of them.

This is just the start of course...
Keep on experimenting with com files. 
You will find lot of things inside com files. 
Also we can use this method to remove com viruses from our files
per hand (who said you should trust Norton?). 
<hr><font size="+2"><font color="blue">&quot;AN ACQUARIUM FOR YOUR VIRI&quot;</font></font>

C'mon, make yourself a very nice present! 
Buy for next to nothing an old 'almost thrown away' 80286 
computer in some shoddy second hand shop and use it to create 
your own VIRUS ACQUARIUM. You'll use it in order to experiment 
all sort of assembly viri/antiviri tricks, without any risk 
of having them biting your 'real' programs... and you'll 
moreover be able to use its screen for a real 'winice' session 
on your main computer if needs be... if you never used the 
ALTSCR ON command when you work with winice (using a second 
monitor for output) you don't know what you are loosing!

Anyway, once you have bought for the price of two pizzas 
your 80286, go fishing on the web and fish some interesting 
viri (with assembly source code) out of the net.

Now handle evrything with care and pour them into your 
acquarium, infecting all the fake files you have installed 
there.
Now try first to see if you can identify and remove them 
from your infected (fake) files using only debug WITHOUT 
and your 'feeling', without looking at their source code!
(You wont, at least not at the beginning :-)
Now study their source code, watch them 'alive', eating 
your files, kill them with YOUR OWN probes (and not with 
Norton's cram)
You'll learn an incredible amount of assembly doing this!
It's fun, great fun! (Yet keep a copy of F-prot handy :-)
<hr>

Learn assembly! Use assembly! Donate something to the world to 
destroy this gasthly micro$oft's dictature... HuH Huh...

Readers can write me...
undertakerd(at)hotmail(point)com

A final thank goes to all the +HCU's guys and to master +ORC. 
Keep up the good work Guys!!. 
Also Special thank goes to Reverser+ and +gthorne for their great 
contribution to our small reversing world.

                The Undertaker -=BANDA=-     //SRI LANKA//</pre><hr>
<center>
<a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm">
<img SRC="images/snippets.gif" tppabs="http://members.xoom.com/tsehp_/images/snippets.gif" ALT="snippets" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a>
<br><font color="gray">Back to the snippets</font><br><br><hr>
</body>
</html><HTML><HEAD><TITLE>Hunting Lesson II</TITLE></HEAD>
<BODY BGCOLOR="#008000" TEXT="#000000" LINK="#f0e68c" VLINK="#f0e68c" ALINK="#f0e68c"><P><CENTER><PRE><FONT SIZE=3 FACE="COURIER NEW">_____________________________________________________________________
®—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•Ø•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-®
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®
®HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH®
®H—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•-&gt;&gt;&gt;————&gt;•Ø•&lt;————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•     _                          _         _  •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•    /®\_______            _____/|   _____/|  •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•   /®®S®®®®®®®\          /®®®®®/   /®®®®®/   •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•  |®/|T|¯¯¯¯¯\T\        |®/|G|¯   |®/|T|¯    •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•   ¯ |E|     |H|         ¯ |I|     ¯ |H|     •&lt;————&lt;&lt;&lt;-H®
®H   ______      |A|     /E/           |V| __    |E|               H®
®H  _\_\_\_\_____|L|____/®/____________|E|/_®\ __|®|__________|\   H®
®H  >))))))))))))|®®®®®®®&lt;)))))))))))))|®|/)\®\)/|®|))))))))))))>  H®
®H  ¯/¯/¯/¯/¯¯¯¯¯|F|¯¯¯¯\®\¯¯¯¯¯¯¯¯¯¯¯¯|®|¯¯¯\®¯/|P|¯¯¯¯¯¯¯¯¯¯|/   H®
®H   ¯¯¯¯¯¯      |R|     \R\           |T|    ¯¯ |O|               H®
®H-&gt;&gt;&gt;————&gt;•     |O|  _   \I\    _     |O|  _    |O|  _  •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•    _|M|_/|    \C\  /|    _|®|_/|   _|R|_/|  •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•   /®®®®®/      \H\/®|   /®®®®®/   /®®®®®/   •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•  |®/¯¯¯¯        \®®/   |®/¯¯¯¯   |®/¯¯¯¯    •&lt;————&lt;&lt;&lt;-H®
®H-&gt;&gt;&gt;————&gt;•  ¯¯     Robin    ¯¯ ¤  ¯¯  Hood  ¯¯      ¤  •&lt;————&lt;&lt;&lt;-H®
®H—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•-&gt;&gt;&gt;————&gt;•Ø•&lt;————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-H®
®HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH®
®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®®
_____________________________________________________________________
 ®—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•—&gt;&gt;&gt;—————&gt;•Ø•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-•&lt;—————&lt;&lt;&lt;-®
¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
</FONT></PRE></CENTER></P>

<P>
<BR><HR><BR><CENTER><FONT SIZE=4 FACE="COURIER NEW">
<FONT SIZE=7><B>Hunting The Net</B><BR></FONT>
<FONT SIZE=5><IMG SRC="images/ang-lf.gif" tppabs="http://members.xoom.com/tsehp_/images/ang-lf.gif" ALIGN=BOTTOM WIDTH=53 HEIGHT=48><B> Hunting Lesson II </B><IMG SRC="images/ang-rt.gif" tppabs="http://members.xoom.com/tsehp_/images/ang-rt.gif" ALIGN=BOTTOM WIDTH=53 HEIGHT=48><BR></FONT>
<FONT SIZE=4>(Special Engine Attacks)<BR><BR>By<BR>-&gt;&gt;&gt;--Robin-Hood----&gt;<BR></FONT><BR><HR>
<IMG SRC="images/green.gif" tppabs="http://members.xoom.com/tsehp_/images/green.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> Courtesy of Reverser's Pages of Reverse Engineering <IMG SRC="images/green.gif" tppabs="http://members.xoom.com/tsehp_/images/green.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><br>
<FONT SIZE=3 COLOR="#DAA520">Portions of these Hunting Lessons have <BR>been based on the original works by reverser+ <BR> as well as private instruction from +ORC.</FONT><HR>
</FONT></CENTER></P>

<!-- BEGIN: The Specials -->
<FONT SIZE=4 FACE="COURIER NEW">
<CENTER><FONT SIZE=4>—&gt;&gt;&gt;—————&gt; <IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=6 COLOR="#800000"><B> The Specials </B></FONT><FONT SIZE=4><IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>
<HR SIZE-0 WIDTH=35%>
<P>There are many different types of specialized search engines and resources existing on the net and more being created every day.</P>
</FONT><BR><HR>
<!-- END: The Specials -->

<!-- BEGIN: The File Search -->
<FONT SIZE=4 FACE="COURIER NEW">
<CENTER><FONT SIZE=4>—&gt;&gt;&gt;—————&gt; <IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=6 COLOR="#800000"><B> File Search </B></FONT><FONT SIZE=4><IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>
<HR SIZE-0 WIDTH=35%>
<P>With a mild mastery of the major engines and boolean you'll be able to hunt down almost all of the information you want but hunting down files is another story all together. In the HREF Searches section of Hunting Lesson #1 you learned a good tool for finding files that exist as links on the web but there are vast resources of files that aren't accessed through web pages. The real trick is finding them...</P>
<BR>
<CENTER><FONT SIZE=4 COLOR="#DAA520">—&gt;&gt;&gt;—————&gt; <IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=4 COLOR="#800000"><B> FTP Search </B></FONT><FONT SIZE=4 COLOR="#DAA520"><IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>

<P>A fast and efficient way to hunt down files is through the FTP Search Engines. The standing champion of these is located in Norway but as always, there are plenty more. The list below consists of a group of engines that all run on the same software by Tor Egge. This makes automation of your file searches much easier through script cracking and email which will be covered in later Hunting Lessons.</P>

<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://ftpsearch.ntnu.no/"  TARGET="_blank">FTP Search</A> <FONT COLOR="#000000"> …………… Egge v3.6 {<FONT COLOR="#800000">Norway</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.4 {<FONT COLOR="#800000">Russia</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://ftpsearch.city.ru:8000/ftpsearch"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v?.? {<FONT COLOR="#800000">Russia</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v?.? {<FONT COLOR="#800000">France</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://archie.is.co.za/ftpsearch"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.4 {<FONT COLOR="#800000">S. Africa</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.4 {<FONT COLOR="#800000">Slovenia</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v1.0 {<FONT COLOR="#800000">Belgium</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://ftp.sunet.se:8000/ftpsearch"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.3 {<FONT COLOR="#800000">Sweden</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v?.? {<FONT COLOR="#800000">Japan</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.4 {<FONT COLOR="#800000">Japan</FONT>}</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">FTP Search</A><FONT COLOR="#000000"> …………… Egge v3.3 {<FONT COLOR="#800000">Itally</FONT>}</FONT></LI><BR>


</UL></FONT>
<BR>
<CENTER><FONT SIZE=4 COLOR="#DAA520">—&gt;&gt;&gt;—————&gt; <IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=4 COLOR="#800000"><B> Filez Search </B></FONT><FONT SIZE=4 COLOR="#DAA520"><IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>

<P>There are other search engines that index FTP servers, including some of the big comercial engines like AltaVista and there are also searchable archives of shareware, freeware and drivers.</P>


<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Filez.com</A><FONT COLOR="#000000"> …………………… An FTP Engine</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://www.filefinder.com/"  TARGET="_blank">FileFinder.com</A><FONT COLOR="#000000"> ……… An FTP Engine</FONT></LI><BR>

<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Snoopie Search</A><FONT COLOR="#000000"> ……… An FTP Engine</FONT></LI><BR>

<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://www.download.com/"  TARGET="_blank">DownLoad.com</A><FONT COLOR="#000000"> …………… Share/Freeware</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://www.shareware.com/"  TARGET="_blank">Shareware.com</A><FONT COLOR="#000000"> ………… Share/Freeware</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://www.hotfiles.com/"  TARGET="_blank">ZD Net</A><FONT COLOR="#000000"> …………………………… Share/Freeware</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Internet Pros</A><FONT COLOR="#000000"> ………… Share/Freeware</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="http://www.softseek.com/"  TARGET="_blank">Soft Seek</A><FONT COLOR="#000000"> …………………… Share/Freeware</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Windows95.com</A><FONT COLOR="#000000"> ………… Share/Driver</FONT></LI><BR>


<LI><FONT COLOR="#000000">—&gt;&gt;&gt;—————&gt; </FONT><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Oakland.edu</A><FONT COLOR="#000000"> ……………… Software Library</FONT></LI><BR>


</UL></FONT>
<BR>
<CENTER><FONT SIZE=4 COLOR="#DAA520">—&gt;&gt;&gt;—————&gt; <IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=4 COLOR="#800000"><B> The Old Guard </B></FONT><FONT SIZE=4 COLOR="#DAA520"><IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>

<P>In the constant push for newer, newer and still newer, most people have never botherd to learn about some of the old and powerful searching resources that still exist on the net. Many of these don't have a slick web interface and even those that do are still better querried through email. I've included a list of some of the existing web interfaces and resources so you can get a feel for these powerful work horses but actually putting them to work for you will be covered in later Hunting Lessons.</P>


<FONT COLOR="#800000">
<UL TYPE=CIRCLE>
<!-- BEGIN: Telnet Resources -->
<LI><B>Telnet Resources</B></LI><FONT COLOR="#000000">: It seems foolish to even discuss searching Telnet resources through a web interface but it is poissible.</FONT>

<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><A HREF="http://galaxy.einet.net/hytelnet/HYTELNET.html"  TARGET="_blank">Telnet</A><FONT COLOR="#000000"> Search All HyTelnet</FONT></LI>
</UL></FONT><BR>
<!-- END: Telnet Resources -->


<!-- BEGIN: Gopher, Jughead & Veronica -->
<LI><B>Searching GopherSpace</B></LI><FONT COLOR="#000000">: The Veronica and Jughead Servers build their indexes from the Gopher Servers (or better said GopherSpace) similar to how the Meta Engines query other resources, except the Veronica Servers actually build their own indexes.</FONT>

<!-- Begin Sub: Jughead -->
<UL TYPE=CIRCLE>
<LI><B>Jughead</B></LI>
<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Jughead</A><FONT COLOR="#000000"> Server at Logic</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Jughead</A><FONT COLOR="#000000"> Server at Liberty</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Jughead</A><FONT COLOR="#000000"> Server at U. Utah, USA</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Jughead</A><FONT COLOR="#000000"> About Using Jughead</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Jughead</A><FONT COLOR="#000000"> Index of Servers</FONT></LI>

</UL></FONT>
<!-- End Sub: Jughead -->


<!-- Begin Sub: Veronica -->
<LI><B>Veronica</B></LI>
<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><A HREF="http://galaxy.einet.net/gopher/gopher.html"  TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at einet.net</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at Tachyon</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at NYSERNet</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at PSINet</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at SUNET</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at U. Pisa, Italy</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at U. Manitoba, Canada</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at U. Texas, USA</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Server at U. Koeln, Germany</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Index of Servers (unr.edu)</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> Index of Servers (wlu.edu)</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> The Veronica FAQ</FONT></LI>

<LI><A HREF="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" tppabs="gopher://members.xoom.com:80/tsehp_/hunt_02a.htm" TARGET="_blank">Veronica</A><FONT COLOR="#000000"> How to compose queries</FONT></LI>
</UL></FONT>
<!-- End Sub: Veronica -->

</UL><BR>
<!-- END: Gopher, Jughead Veronica -->

<!-- BEGIN: Archie Resources -->
<LI><B>Archie Resources</B></LI><FONT COLOR="#000000">: The Archies are a powerful tool for searching and exist all over the world but as with most engines, they are better queried through email.</FONT>

<FONT COLOR="#DAA520">
<UL TYPE=CIRCLE>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {NASA}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Swiss}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Norway}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Norway}</FONT></LI>

<LI><A HREF="http://www.ucc.ie/cgi-bin/archie"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Ireland}</FONT></LI>

<LI><A HREF="http://www.wg.omron.co.jp/AA-eng.html"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Japan}</FONT></LI>

<LI><A HREF="http://www.tu-chemnitz.de/~ami/archie.html"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>

<LI><A HREF="http://marvin.physik.uni-oldenburg.de/Docs/net-serv/archie-gate.html"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>

<LI><A HREF="http://marvin.physik.uni-oldenburg.de/Docs/net-serv/archie-gate.html"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>


<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>

<LI><A HREF="http://www.informatik.rwth-aachen.de/archie.html"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {Germany}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {rutgers.edu}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {ASURAnet}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {TheGroup}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Server {man.net}</FONT></LI>

<LI><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/ACrigs_1/FRAVIA/new_page_1.htm"  TARGET="_blank">Archie</A><FONT COLOR="#000000"> Index of Servers</FONT></LI>


</UL></FONT><BR>
<!-- END: Archie Resources -->

</UL></FONT><BR>
<!-- END The Old Gaurd -->

</FONT><BR><HR>
<!-- END: The File Search -->


<!-- BEGIN: Specialty -->
<FONT SIZE=4 FACE="COURIER NEW">
<CENTER><FONT SIZE=4>—&gt;&gt;&gt;—————&gt; <IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=6 COLOR="#800000"><B> Our Specialty </B></FONT><FONT SIZE=4><IMG SRC="images/red.gif" tppabs="http://members.xoom.com/tsehp_/images/red.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>
<HR SIZE-0 WIDTH=35%>
<P>This is a blurb</P>

<CENTER><FONT SIZE=4 COLOR="#DAA520">—&gt;&gt;&gt;—————&gt; <IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></FONT><FONT SIZE=4 COLOR="#800000"><B> Underground </B></FONT><FONT SIZE=4 COLOR="#DAA520"><IMG SRC="images/gold.gif" tppabs="http://members.xoom.com/tsehp_/images/gold.gif" BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> &lt;—————&lt;&lt;&lt;—</FONT></CENTER>


</FONT><BR><HR>
<!-- END: Specialty -->

The Big List:<BR>
<A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm"  TARGET="_blank">Engine List</A><FONT COLOR="#000000"> Index of Web Based Searching Resources</FONT>

<BR>
<HR>
<BR>
<P><a href="robinsta.htm" tppabs="http://members.xoom.com/tsehp_/robinsta.htm"  style="color: rgb(0,0,0)">Back to Robin Hood's lessons</a><bR>
<A HREF="http://go.to/tsehp"  style="color: rgb(0,0,0)">reverser's Pages of Reverse Engineering</A>
Copyright &copy; 1998<BR>
</P>
</BODY>
</HTML>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>
staltec1.htm: Enemy investigation: email stalking techniques
</title>
</head>

<body bgcolor="C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<a name="top">
<!-- Fun with colors Begin -->
<table bgcolor="#FF0000" CELLPADDING="7" CELLSPACING="0">
<tr><th bgcolor="#FF0000">
<Font color="#804000"><H1><bR>
G<br>O<br>T<br>C<br>H<br>A<br>!<br><br>
</H1></th>
<TH BGCOLOR="#804000" width="250">
<FONT COLOR="#FF8000" FACE="ARIAL"><H2> reverser's<bR>anonymity pages<br><br></H2></fonT><FONT COLOR="#FF8000" FACE="ARIAL"><H3>Enemy 
tracking<br><br>EMAIL 
STALKING TECHNIQUES AND DYNAMIC IPs
</H3><p><br><br><br><br><FONT COLOR="#FF8000" SIZE="2" FACE="ARIAL">
Reverser's Nofrill<br>
Web design<br>
(1998)
</font>
</TH>


<TH BGCOLOR="#804000"><br>
<FONT COLOR="#FF8000" SIZE="2" FACE="ARIAL">updated<br>September 1998
</TH>
<TH BGCOLOR="#C0C0C0"><center><a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"><img SRC="images/anon1.gif" tppabs="http://members.xoom.com/tsehp_/images/anon1.gif" ALT="noanon" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a>
<br><font color="gray">Reverser's Anonymity Academy</font><br>

<h1>Enemy tracking</h1><h3>Email stalking techniques</h3></center>
<center><h3><i>(Reverser shows you what you can do - or try - and where you can learn some 
advanced stalking techniques)</i></h3>

 <br>~<br>
Enemy tracking, a very difficult art, can be divided into stalking, "logical reversing" and luring. In order to 
stalk you need a deep knowledge of Usenet spamming (and war) techniques like flaming, 
trolling and crossposting. Here you'll learn some simple tricks in order to gather information 
about your target WITHOUT contacting directly his website.
<hr width="33%">

</CENTER>
</Font>
</TH>
<TH BGCOLOR="#804000"><pre> </prE></TH>
</TR>
</TABLE>
<br>[<a href="staltec1.htm#anc1">1) scan the http server port for your target domain</a>]<br>
[<a href="staltec1.htm#anc11">1.1) a port scanning Perl script</a>]<br>
[<a href="staltec1.htm#anc12">1.2) get da relevant RFC</a>]<br>
[<a href="staltec1.htm#anc2">2) get servers list and operator names for your target domain</a>]<br>
[<a href="staltec1.htm#anc3">3) importance of a dynamic ip chain</a>]<br><br></center>
<!-- Fun with colors End -->
There are a couple of useful stalking tricks (in fact this approach is MUCH more 
anonymous than directly browsing onto your target domains :-)...
<a name="anc1"></a><hr width=44%><h3>
1) TRICK TO SCAN THE HTTP SERVER PORT FOR YOUR TARGET DOMAIN</H3><br>
This trick is useful to scan port 80 (or whatever :-) of your target (I'll use here fortunecity.com). 
Just use your email program - of course one of your "free webaddresses" aliases (like yahoo.com) 
accessed through a dynamic IP provider - onto an agora server in the following way:
</center><font color=purple><prE>
TO: 		agora@ictp.trieste.it  (or any other agora)
SUBJECT:	nutting
-----------------------
BODY:		send http://www.netcraft.com/cgi-bin/Survey/whats?\
                host=www.fortunecity.com&port=80<br><br>
</pre></fonT>
Netcraft (not you) will scan the HTTP server port of your target 
domain, and you'll get the following answer emailed to your alias:<font color=purple><pre>www.fortunecity.com is running Apache/1.2.5.</prE></fonT>
Substitute a 
domain name of your choice to the <font color=blue>www.fortunecity.com</fonT>  
using the following schema (note the <b><font color=blue>\</fonT></b> linebreak sign, because most email apps will else 
break your line arbitrarly)...:<br>
<font color=blue>send http://www.netcraft.com/cgi-bin/Survey/whats?\<br>
host=XXXXXX.XXX&port=80</font><br>...and you'r done.<br>
This will tell you the name of the server that is running your target web site, a very useful 
kind of information for your anti-smut attacks and/or for your general stalking activities... 
as you'll understand elsewhere on my pages.<br>
Of course if you prefer to use your full Internet access you can use a port scanner. 
This will scan a domain IP for all available ports and report the protocols they serve.
<a name="anc11"></a>
<hr><h3>
1.1) a little scanning Perl script</H3><br>
For those among you that don't know much about ports, here's a little Perl script:
<font color=purple><prE>
#!/usr/local/bin/perl -w
# findport - find a server running at an unknown TCP port
# &lt;title&gt;findport.pl&lt;/title&gt;
# Copyright (C) 1996 by John J. Chew

unshift(@INC, "$ENV{HOME}/lib/perl");
require 'getopts.pl';
require 'sys/socket.ph';

sub Usage {
  die "Usage: $0 [-m] [-O] [-q] host [start-port]\n".
    "-m  allow multiple matches\n".
    "-O  try `obvious' ports\n".
    "-q  be quiet\n".
    "";
  }

&Getopts('mOq') || &Usage;
$#ARGV &lt; $[ && &Usage;
$#ARGV &gt; $[ + 1 && &Usage;
$#ARGV &gt; $[ && $opt_O && &Usage;

($serverhostname, $serverportname) = @ARGV;
$serverportname = 7777 unless defined $serverportname;

@gObvious = (
  # popular port numbers for MOOs
  7777, 8888, 6666, 6969, 1234, 1701, 4444, 2112, 2499, 4000, 8000, 9595,
  1138, 1359, 1709, 1848, 1961, 1975, 1996, 2000, 2001, 2029, 2345, 3000,
  3175, 4201, 4242, 5000, 5678, 6464, 7000, 7007, 7200, 7700, 7878, 8080,
  8889, 9000, 9020, 9030, 9040, 9999, 3434,

  # other `obvious' numbers
  1111, 1112, 1113, 1996, 1997, 1998, 1999, 2222, 2223, 2224, 3001, 3333,
  3334, 3335, 3456, 4001, 4445, 4446, 4567, 5001, 5556, 5557, 6000, 6001,
  6667, 6668, 6789, 7001, 7778, 7779, 7890, 8001, 9001,
  );

sub die { die $_[0] unless $opt_q; exit 1; }

sub lint { $opt_m; }

$sockaddr_t = 'S n a4 x8';

($name, $aliases, $protocol) = getprotobyname('tcp');
socket(S, &PF_INET, &SOCK_STREAM, $protocol) || &die("socket() failed:
$!");

chop($clienthostname = `hostname`);
(($name, $aliases, $type, $length, $clientaddress)
  = gethostbyname($clienthostname))
  || &die("gethostbyname($clienthostname) failed: $!");
$clientname = pack($sockaddr_t, &AF_INET,     0, $clientaddress);
bind(S, $clientname) || &die("bind() failed: $!");

(($name, $aliases, $port) = getservbyname($serverportname, 'tcp'))
  || ($port = $serverportname);
(($name, $aliases, $type, $length, $serveraddress)
  = gethostbyname($serverhostname))
  || &die("gethostbyname($ARGV[0]) failed: $!");

$| = 1;
$port = shift @gObvious if $opt_O;
while (1) {
  $servername = pack($sockaddr_t, &AF_INET, $port, $serveraddress);
  print "$port" unless $opt_q;
  if (connect(S, $servername)) {
    print "\n\a" unless $opt_q;
    print "$port is active.\n";
    exit 0 unless $opt_m;
    }
  else {
    print " ";
    $opt_O ? (($port = shift @gObvious) || exit) : $port++;
    close(S);
    socket(S, &PF_INET, &SOCK_STREAM, $protocol) || &die("socket()
failed: $!");
    bind(S, $clientname) || &die("bind() failed: $!");
    }
  }

</pre></fonT>
<a name="anc12"></a>
<hr><h3>
1.2) Retrieve your relevant RFC!</H3><br>
If you want to know even more about ports, just retrieve RFC1060 to get a 
list of the assigned numbers. And don't ask how d'you retrieve a RFC... you 
should already know it...<br>No? Well, <u> 
per email</u>, of course here is it:<font color=purple><prE>
To: 			RFC-INFO@ISI.EDU
Subject: 		[nutting: leave blank]
----------------------------------------------
Body:			Retrieve: RFC
			Doc-Id: RFC1060</pre></fonT><H4>
The RFC1060 above is the "alfa and omega" of any good commercial_porn_sites buster, 
this report on the parameters (i.e., numbers and
   keywords) used in protocols in the Internet community belongs among your most coveted study materials! :-)
<br>Retrieve it as I told you and, in the mean time, have a look at its contents.
</H4><font color=purple><pre>
RFC 1060: Table of Contents

INTRODUCTION.................................................... 2
Data Notations.................................................. 3
Special Addresses............................................... 4
VERSION NUMBERS................................................. 6
PROTOCOL NUMBERS................................................ 7
PORT NUMBERS.................................................... 9
UNIX PORTS......................................................13
INTERNET MULTICAST ADDRESSES....................................19
IANA ETHERNET ADDRESS BLOCK.....................................20
IP TOS PARAMETERS...............................................21
IP TIME TO LIVE PARAMETER.......................................23
DOMAIN SYSTEM PARAMETERS........................................24
BOOTP PARAMETERS................................................25
NETWORK MANAGEMENT PARAMETERS...................................26
ARPANET AND MILNET LOGICAL ADDRESSES............................30
ARPANET AND MILNET LINK NUMBERS.................................31
ARPANET AND MILNET X. 25 ADDRESS MAPPINGS.......................32
IEEE 802 NUMBERS OF INTEREST....................................34
ETHERNET NUMBERS OF INTEREST....................................35
ETHERNET VENDOR ADDRESS COMPONENTS..............................38
ETHERNET MULTICAST ADDRESSES....................................41
XNS PROTOCOL TYPES..............................................43
PROTOCOL/TYPE FIELD ASSIGNMENTS.................................44
PRONET 80 TYPE NUMBERS..........................................45
ADDRESS RESOLUTION PROTOCOL PARAMETERS..........................46
REVERSE ADDRESS RESOLUTION PROTOCOL OPERATION CODES.............47
DYNAMIC REVERSE ARP.............................................47
X.25 TYPE NUMBERS...............................................48
PUBLIC DATA NETWORK NUMBERS.....................................49
TELNET OPTIONS..................................................51
MAIL ENCRYPTION TYPES...........................................52</prE></font>

<a name="anc2"></a><hr><H3>
2) TRICK TO GET SERVERS LIST AND OPERATOR NAMES FOR YOUR TARGET DOMAIN</H3><br>
Now let's say you want some more info about WHO ARE the people that have 
registered your target server, then simply 
use once more an agora and query with:

<pre>send  http://www.switch.ch/cgi-bin/info/whois?Query=fortunecity.com\
&Server=whois.internic.net
</pre>
And thou shall get the following:<font color=purple>
<pre>Results from WHOIS server whois.internic.net for query: fortunecity.com

--------------------------------------------------------------

FortuneCity.Com Ltd (ASKRIGG-DOM)		   ASKRIGG.COM
FortuneCity.Com Ltd (FORTUNECITY4-DOM)	       FORTUNECITY.NET
FortuneCity.Com Ltd (FCMAIL-DOM)	            FCMAIL.COM
Software Direct (FORTUNECITY-DOM)	       FORTUNECITY.COM

To single out one record, look it up with "!xxx", where xxx is the
handle, shown in parenthesis following the name, which comes first.</pre></fonT>

Now, as you have read, you must be patient (the foremost quality of a good 
stalker): let's go on with what they asked:
<pre>send  http://www.switch.ch/cgi-bin/info/whois?Query=!FCMAIL-DOM\
&Server=whois.internic.net
</prE>
And now we'll get a wealth of stalking information:
<font color=purple><pre>Registrant:
FortuneCity.Com Ltd (FCMAIL-DOM)
   140 Offord Road,
   Islington London., N1 1PF
   UK

   Domain Name: FCMAIL.COM

   Administrative Contact:
      Metcalfe, Dan  (DM10032)  dan@FORTUNECITY.COM
      0171 700 1617 (FAX) 0171 609 2815
   Technical Contact, Zone Contact:
      Donnahoo, Lee  (LD2352)  lee@COMMTOUCH.COM
      408-245-8682 (FAX) 408-245-3466
   Billing Contact:
      Metcalfe, Dan  (DM10032)  dan@FORTUNECITY.COM
      0171 700 1617 (FAX) 0171 609 2815

   Record last updated on 29-Apr-98.
   Record created on 24-Feb-98.
   Database last updated on 16-Sep-98 04:13:51 EDT.

   Domain servers in listed order:

   PRONTODNS.PRONTOMAIL.COM	209.185.72.9
   NS1.INFORMAIL.COM		207.135.122.6
   NS3.EXODUS.NET		206.79.240.13
</prE></font><br>Of course you should perform the same query for all other addresses 
you got (ASKRIGG.COM etcetera...)

<a name="anc3"></a><hr><H3>
3) IMPORTANCE OF A DYNAMIC IP CHAIN</H3><br>
And the really funny thing is that you have NOT directly connected neither netcraft.com 
nor internic.net from your real net-access provider. You went through 
a "tier" procedure like this:
<br><br>
YOUR_FREE_DYNAMIC IP -&gt; YOUR_FREE_EMAIL_WEB_PROVIDER -&gt; INTERNIC -&gt; TARGET_SERVER
<br>
<br>
Hope you understand what a dynamic IP is: it is the Web_access 
offered by AOL, Compuserve, whatever.<br>Of course it is <i>de facto</i>
You'll find plenty of 2 months trial for 
free. You'll find plenty of 'trial' offers on every magazines' 
CD-Rom, and of course you'll bnever confirm the contract at the end of the trial 
period: just discard and begin (a week before the trial end) <u>another</u> 
free-trial with <u>another</u> dynamic provider. (Ask for permission and then 
use your friends/colleagues/parents/grocers 
name and addresses if needed, you can carry on 50 years like that :-) 
Now, the point is that all great providers will connect you to the web 
through ONE of their many servers. This specific IP (for instance 212.211.27.146 for 
compuserve) will change EVERY TIME you access your 
provider, and it is very difficult to track down. 
Add to this the fact that the free email address hosting services (like yahoo.com, 
hotmail.com etcetera) use a plethora of different servers as well, 
and you'll udnerstand that tracking back your own stalking activities (especially 
if you have followed my advices and done them 
through an agora server) will be a nightmare even for a determined 
government agency! Not that it couldn't be done at all, mind you, 
yet it would require the collaboration of 
so many different entities (and it would violate so many privacy rules) that 
I consider it extremely unlikely that your average targeted smut-side will ever be 
able to understand what's going on under his nose :-)<br><br>
For added security yuou can of course configure <u>A CHAIN</u> of free web_email_providers 
that you have instructed to resend automatically everything they get to the next one, where 
the last one has been instructed to query ALWAYS an agora server with the content it gets.<br>
<br>Hope you understand the possibilities this open to your stalking activities in general (remember 
that agoras accept only THREE commands: SEND, DEEP and SOURCE (for an explanation see reverser's <a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to 
search</a> lessons. Here the main agoras you'll use:<br>[<a href="mailto:agora@www.eng.dmu.ac.uk">british agora</a>] ~ 
[<a href="mailto:agora@ictp.trieste.it">italian agora</a>] ~ 
[<a href="mailto:agora@dna.affrc.go.jp">nippon agora</a>]

<hr size="3">




<br><center><i>This section of my site, under perennial  construction, 
 was started on 23 september 1998</i>
<hr size="3">




<!-- Begin mover -->
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" 
ALT="red"><a HREF="pageadvi.htm" tppabs="http://members.xoom.com/tsehp_/pageadvi.htm">reverser's antispam related page</a>
 ~
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" 
ALT="red"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">reverser's antismut related pages</a> 

<hr width=33%>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<br>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript tricks</a>
<br> 
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is software reverse engineering illegal?</a>
</center>
<!-- End mover -->
<hR>
<!-- Begin signet -->
<Font color=green><a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 
HSPACE=0></a>(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998.</font> 
All rights reserved
<HR ALIGN=CENTER WIDTH=100% SIZE=3>

</body>
</html><html>
<head>
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>Howto93</title></head>
<body bgcolor= "CCCCCC" text="#001010" vlink="#405040
Alink=#00FF50">
<center><h1>HOW TO CRACK, by +ORC, A TUTORIAL</h1></center>
<hr  size=1>
<p><center>
Lesson 9 (3): How to crack Windows, Hands on<br>
     Nagscreens galore (B): The 'Dead listing' approach
</center></p>
<hr  size=1>
<p><center>[HEXWORKSHOP][PaintShopPro]</center></p>
<hr align=center width=50% size=1>
<p>
<pre>  
  (Hic sunt tabulae: Best viewed with good old Courier 10)

     In this lesson I'll teach you another cracking technique
known as "dead listing" approach, in opposition to the "live"
cracking (through Softice/Winice) that we have used (and we'll
use) most of the time.
     Since this approach requires a good Hexeditor and a good
disassembler (and a good Wordprocessor), it suits us well to
begin the 'hands on'  part cracking what we need: a good
Hexeditor.
     I'll crack here the nagscreens out of Hexworkshop, Version
2.10 (32 bit version). A good and relatively quick (for Windoze's
standards) application by Breakpoint software. Many among you
will already have this hexeditor inside their Software
collection, if not find it on the Web through an Archie search
and download it through ftpmail... searching through the archies
will give you something like this: 

Host ftp.loria.fr    (152.81.10.10)
Last updated 11:25 23 Oct 1996
Location: /pub1/pc/win95/programr
FILE -r--r--r-- 707906 bytes  02:00 13 Aug 1995 hworks32.zip

The exact NAME of this hexediting program is HWORKS32.EXE, it is
524288 bytes LONG, and its DATED 2 February 1996. This program
has many little nag annoyances:
-    shows a nagscreen reminding you how many days you have used
the program;
-    keeps a nag_string "unregistered version" on the main screen
of the program;
-    has, inside help, a "registration serial number form"...
this is the number you could get registering... and should digit
inside the HELP/ABOUT HEX WORKSHOP window form.

     Elsewhere in this tutorial we have already learned how to
defeat this type of protection: through Winice breakpoints.
Basically we would type a fake registration number (say
'121212121212') and then look for the occurrences of our string
in memory, and then search and investigate the manipulations
undertaken by the protection scheme. In this way we would finally
be able to crack the nagscreen procedure. 
     Fine, fine... this would indeed work, but I want to teach
you through this lesson ANOTHER, completely different approach
to cracking, which is and will be especially useful for
'nagscreen' and 'time-limit' cracking... i.e. the "dead listing"
approach. This approach is a much more "relaxed" sort of crack,
which  will work flawlessly most of the time. 
     This approach is particularly easy with Windows programs,
since -as I have already told you a hundred times- the modularity
of this overbloated atrocity makes it particularly easy for us
little crackers to track back the -mostly primitive- protection
methods utilized by the commercial programmers.
     I remember older times, when programming was still an art
for intelligent (not mercantile) beings, cracking the old (and
sometime beautifully crafted) Z-80, CP/M and DOS programs. In
those time 'a byte was a byte'! And good programmers found funny
tricks in order to write 'tight' code. We old crackers used the
'dead listing' approach sitting (or snoozing) in pleasant (albeit
a little battered) armchairs, inside a huge university library,
drinking very good Martini Wodka (you would be well advised to
use only Moskowskaja, coz non Russian Wodkas are repugnant). Four
of us at a time, each one just looking at his paper listings. You
cannot imagine how many little (unrelated) tricks we found inside
the code cracking in that way! A hacker, a cracker (me), a 'real'
programmer and an encryption specialist, all four sitting in the
same room, exchanging pretty clever findings and sipping (much
too many) good cocktails... it's long ago, those times (and
societies) are gone for ever! Microsoft's abomination has
unfortunately created this overbloated world of huge 'programs'
which perform more slowly (and much more awkwardly) what the old
programs did quickly and flawlessly.
     You don't believe me? Why don't you just install Linux on
your harddisk and see for yourself the difference between a good
OS and Windoze? Just try it... you'll be amazed and you'll never
go back... well, you'll actually do... only in order to crack the
hell out of Windows: We'll never damage enough Microsoft's
interests to compensate for this moronic situation: millions of
stupid users have to wait hours (and this with microprocessors
that are 1000 times quicker than the old 8086) to perform with
MS_Word -slowly- what they could have done immediately with an
old copy of Wordperfect for Dos. 
     Anyway, the huge dimension of all Windows' programs forces
us to abandon the printed "dead listing" approach... printing in
extenso the listing of a Windows program would consume a couple
of ink cartridges and could easily take ages... therefore we can
indeed still crack with the "dead listing" method, and we can
indeed still drink our Martinis (and we do, Oh Yessir), but we
must keep the overbloated listings off page, on our PC, printing
only the small part of them that are relevant to our crack.

     As I said at the beginning, for this art of cracking you'll
need basically only two programs (and you will NOT need
Softice/Winice).

1)        A disassembler like W32DASM (or another good one) in
order to find the protection scheme.
You will probably already possess it (else how did you crack
until now?)... if not find the last version on the Web -through
an Archie search- and download it -through ftpmail-, Searching
the archies will give you something like this:

Host ftp.funet.fi    (128.214.248.6)
Last updated 07:57  1 Jan 1997
Location: /pub/mirrors/ftp.cdrom.com/pub/simtelnet/win3/prog
FILE    -rwxrwxr-x  650327 bytes  23:25 28 Oct 1996  w32dasm6.zip

2)        An hexeditor (Use Hexworkshop version 2.10 itself,
since we are already cracking it :=) in order to defeat the
protection scheme as soon as you have found it. OK, enough, let's
crack.

Here is how the "dead listing" approach works:
1)   Run the program you want to crack, in this case Hexworkshop,
look at all the nag_strings and write them down (I mean snap them
down -automatically- from screen... see elsewhere in my tutorial
how to get and crack snap32);
2)   Wdasm the file (that means: 'open' it inside the
disassembler in order to get the listing).
3)   Transfer the listing to your favorite wordprocessor (we will
not need Wdasm any more, bye)
4)   Search (Find) inside your wordprocessor the nag_references,
say, in our case, the string "unregistered version"

You'll immediately land inside following piece of code:
:MAIN_NAG_ROUTINE
:00415732 CC              int 03
:00415733 CC              int 03
:00415734 CC              int 03
:00415735 CC              int 03
:00415736 CC              int 03
:00415737 CC              int 03
:00415738 CC              int 03
:00415739 CC              int 03
:0041573A CC              int 03
:0041573B CC              int 03
:0041573C CC              int 03
:0041573D CC              int 03
:0041573E CC              int 03
:0041573F CC              int 03
:00415740 55              push ebp
:00415741 8BEC            mov ebp, esp
:00415743 6AFF            push FFFFFFFF
:00415745 6873584100      push 00415873
:0041574A 64A100000000    mov eax, fs:[00000000]
:00415750 50              push eax
:00415751 64892500000000  mov fs:[00000000], esp
:00415758 81EC0C020000    sub esp, 0000020C
:0041575E 53              push ebx
:0041575F 56              push esi
:00415760 57              push edi
:00415761 898DE8FDFFFF    mov [ebp-00000218], ecx
:00415767 8B450C          mov eax, [ebp+0C]
:0041576A 50              push eax
:0041576B 6A73            push 00000073
:0041576D 8B8DE8FDFFFF    mov ecx, [ebp-00000218]
:00415773 E87EFC0100      call 004353F6
:00415778 C745FC00000000  mov [ebp-04], 00000000
:0041577F 8B8DE8FDFFFF    mov ecx, [ebp-00000218]
:00415785 83C144          add ecx, 00000044
:00415788 E84EF40100      call 00434BDB
:0041578D C645FC01        mov [ebp-04], 01
:00415791 8B85E8FDFFFF    mov eax, [ebp-00000218]
:00415797 C70028AE4500    mov dword ptr [eax], 0045AE28

*StringData Ref from Data Obj->"An unregistered version of Hex"
                             ->"Workshop has been on"
                            |
:0041579D 68085B4600      push 00465B08
:004157A2 8D85F4FDFFFF    lea eax, [ebp-0000020C]

Good, we immediately see that the above routine starts at
instruction
:00415740 55              push ebp
Therefore now we'll search our listing for following string:
call 00415740                 (that is: who calls here?).
The reason we must search for the caller is very simple: there
is no conditional jump inside the piece of code above... and
therefore it'll very unlikely hide a protection and/or a check
time or nag routine. If we do perform our search for the caller
we'll immediately land inside following routine: 

: CALL_NAG_ROUTINE
:00415DAC 55              push ebp          ;pusha lotta values
:00415DAD 8BEC            mov ebp, esp
:00415DAF 6AFF            push FFFFFFFF
:00415DB1 68045E4100      push 00415E04
:00415DB6 64A100000000    mov eax, fs:[00000000]
:00415DBC 50              push eax
:00415DBD 64892500000000  mov fs:[00000000], esp
:00415DC4 83EC54          sub esp, 00000054
:00415DC7 53              push ebx         
:00415DC8 56              push esi
:00415DC9 57              push edi
:00415DCA 894DA0          mov [ebp-60], ecx
:00415DCD 6A00            push 00000000
:00415DCF 8B4508          mov eax, [ebp+08]
:00415DD2 50              push eax
:00415DD3 8D4DA4          lea ecx, [ebp-5C]  ;for the call
:00415DD6 E865F9FFFF      call 00415740    ;*** HERE !!! ***
:00415DDB C745FC00000000  mov [ebp-04], 00000000
:00415DE2 8D4DA4          lea ecx, [ebp-5C]
:00415DE5 E804F70100      call 004354EE
:00415DEA C745FCFFFFFFFF  mov [ebp-04], FFFFFFFF
:00415DF1 E805000000      call 00415DFB
:00415DF6 E913000000      jmp 00415E0E
:00415DFB 8D4DA4          lea ecx, [ebp-5C]
:00415DFE E8FD000000      call 00415F00
:00415E03 C3              ret

Good, OK. Now -once more- who calls this function? As -here too-
we don't have any conditional jumps, we are compelled to look
further inside the green branches of our code_tree.
Let's go on: searching for
call 00415DAC       (the beginning of the above function)
we will land inside following code:

:WILL     _I_CALL_THE_CALL_NAG_ROUTINE_?
:0040254C 6808414500      push 00454108           
:00402551 8D8568FEFFFF    lea eax, [ebp-198]
:00402557 50              push eax
:00402558 E893460200      call 00426BF0
:0040255D 83C408          add esp, 8
:00402560 0FBF0508414500  movsx word ptr eax, [00454108]     
:00402567 85C0            test eax, eax
:00402569 0F8586000000    jne 004025F5  ;jump 1 over CALL_NAG
:0040256F 8B8D40FEFFFF    mov ecx, [ebp-1C0]
:00402575 E8D3350100      call 00415B4D
:0040257A 85C0            test eax, eax
:0040257C 0F841B000000    je 0040259D
:00402582 8B8D40FEFFFF    mov ecx, [ebp-1C0]
:00402588 E866360100      call 00415BF3
:0040258D 8B8D40FEFFFF    mov ecx, [ebp-1C0]
:00402593 E8DF360100      call 00415C77
:00402598 E953000000      jmp 004025F0  ;jump 2 over CALL_NAG
:0040259D 8B8D40FEFFFF    mov ecx, [ebp-1C0]
:004025A3 E83D370100      call 00415CE5 ;(month year routine)
:004025A8 898570FFFFFF    mov [ebp-90], eax
:004025AE 83BD70FFFFFF00  cmp dword ptr [ebp-90], 0
:004025B5 0F8417000000    je 004025D2    ;jump 3 over CALL_NAG
:004025BB 8B8570FFFFFF    mov eax, [ebp-90]
:004025C1 50              push eax
:004025C2 8B8D40FEFFFF    mov ecx, [ebp-1C0]
:004025C8 E8DF370100      call 00415DAC ;HERE! CALL_NAG! *
:004025CD E91E000000      jmp 004025F0
:004025D2 8D8D7CFFFFFF    lea ecx, [ebp-84];jump 3 lands here
:004025D8 E88C420200      call 00426869
:004025DD 85C0            test eax, eax
:004025DF 0F840B000000    je 004025F0
:004025E5 8D8D7CFFFFFF    lea ecx, [ebp-84]
:004025EB E8FE2E0300      call 004354EE
:004025F0 E91E000000      jmp 00402613     ;jump 2 lands here
:004025F5 8D8D7CFFFFFF    lea ecx, [ebp-84];jump 1 lands here
:004025FB E869420200      call 00426869

Now have a good look at the code above: As you can see there are
only three possible jumps which will NOT call the CALL_NAG
routine. The one at
:00402598 E953000000          jmp 004025F0 (Jump 2)         
is not conditional, and therefore very rarely used for nagscreens
protections. Besides, it links to another unconditional jump and
it's most probably a "Quick_out" way... let's eliminate it, at
least for now.
We remain with only two jumps over the NAG_SCREEN call routine:
00402569 0F8586000000         jne 004025F5 (jump 1)
and
004025B5 0F8417000000         je 004025D2      (jump 3)

     You may investigate both of them, but, hey, you could
eliminate one more jump, again, just using a little Zen code
feeling): see how the jump condition for jump_3 is a base pointer
value [ebp-90], while the one for jump_1 is a memory fixed
location [00454108]... this sort of condition is usually a green
light, for compiler reasons I'll not delve inside here. Therefore
let's have a closer look at it and let's forget jump 3, at least
for now.

:JUMP_1_UNDER_THE_LUPE
:0040254C 6808414500      push 00454108 ;values for         
:00402551 8D8568FEFFFF    lea eax, [ebp-198]
:00402557 50              push eax      ;the following
:00402558 E893460200      call 00426BF0 ;call
:0040255D 83C408          add esp, 8 ;modify stack
:00402560 0FBF0508414500  movsx word ptr eax, [00454108] ;HERE 
:00402567 85C0            test eax, eax ;conditional test
:00402569 0F8586000000    jne 004025F5  ;jump over CALL_NAG

What will then this mysterious [00454108] location be? Don't you
feel it? It's the ACTIVATOR! The location with the flag, which
sets the whole nag screen galore for Hexworkshop! Our cracking
job is already finished! 
     We don't need anything more: we don't need any fiddling with
breakpoints, nor to examine hundreds of irrelevant calls... with
Windows this kind of "dead listing" cracks works so smooth I
could shriek!
     But, hey, OK, we will continue our snooping, for the sake
of it and just in order to be completely sure... it's not
necessary, but let's do it anyway... check a little more
around... search, inside your huge listing, all the other
occurrences of the same [00454108] location... you'll get no more
than 5 hits. The most striking one from our cracking point of
view being the following occurrence:

:00402770 898574FFFFFF   mov [ebp-8C], eax ;save old eax
:00402776 0FBF0508414500 movsx word ptr eax, [00454108];FLAG*
:0040277D 85C0           test eax, eax     ;flag is zero?
:0040277F 0F8528000000   jne 004027AD    ;nope, so we won't
:00402785 8B4DEC         mov ecx, [ebp-14]             
:00402788 E883280000     call 00405010   ;call this, nor
:0040278D 898574FFFFFF   mov [ebp-8C], eax ;write

* Possible StringData Ref from Data Obj ->"Unregistered
Version"  
                     |
:00402793 6854494600    push 00464954   ;on the screen
:00402798 685C800000    push 0000805C   ;& we'll jump over
:0040279D 6800400000    push 00004000   ;these pushes
:004027A2 8B8D74FFFFFF  mov ecx, [ebp-8C]
:004027A8 E823280000    call 00404FD0   ;and this call

* Possible StringData Ref from Data Obj ->"ControlBars"
                  |
:004027AD 686C494600   push 0046496C     ;directly here

Well, yes, now it's more than enough, thanks... location
[00454108] seems indeed to be the flag we are searching.
Confirmed. Struck and sunk! Now let's quickly crack Hexworkshop:

*** CRACK FOR HEXWORKSHOP VERSION 2.10 by +ORC (January 1997) **
Use hexworkshop itself (no more debug/symdeb, coz we are working
with the overbloated Microsoft monstrosity) and search inside the
code of the copy on your harddisk for the hex sequence:
     08414500
that's the code for our flag_location, duh?

****(a short digression): BE CAREFUL SEARCHING FOR BYTES ***** 
Be careful with instructions you try to search for. You should
only search for instructions that don't change the bytes they
assemble to, depending on their location in memory. For example,
searching for the following instructions presents no problem:
PUSH      DX
POP       [DI+4]
ADD       AX, 100
but searching for the following instructions CAN cause
unpredictable results:
JE        123
CALL      MYFUNC
LOOP      100
**** (end) ********************************* **** **** ****

Searching for the byte sequence 08 41 45 00 you will obviously
find the several occurrences of it we have seen before... you
have to modify only one location though, the one followed by the
two bytes
0F85...  (jne after CALL_NAG)
at the FIFTH (and sixth) position after the search string,
because that's the location we are looking for.
Once you found it, write over the byte
85
the byte
84
and now you'll have modified the jne in a (je after CALL_NAG).
     We'll now jump if equal (as all men should be, by the
way)... Look!... no more nagscreens to annoy our proven aesthetic
perception, no more silly protections to blemish our suave future
hexediting around :=)
I almost forgot... that's obviously not enough... you must as
well modify the location at :0040277F

:0040277F 0F8528000000   jne 004027AD   ;jump over 'unregistered'
to
:0040277F 0F8428000000   je 004027AD    ;jump equal!

in order to have a well cracked copy of our target.

[PSP 32]
Can we apply this 'dead listing' approach to other programs? Can
we use the same strategies for other protection schemes?
Sure! Let's remain a little more inside the nagscreens
protections. 
     A logical step, after the invention of the nagscreen itself,
has been the "mingling" of the nagscreen calling routine. In this
kind of protection the nagscreen routines are 'amalgamated' with
other routines, which cannot be skipped as they are essential for
the working of the program. The main disadvantage of this
approach, for the mercantile protectionists, is that they have
therefore to prepare TWO different versions of their programs:
a 'nagscreened' one and a 'clean' one, since else we would
immediately be able to transform the crippled program in a fully
functional one using the same approach they would use to
'uncripple' it.
     Such mingling is therefore only used by major programs which
are well established on the market and can afford the 'doubled'
approach. This is the case of the last versions of PaintShopPro
(PSP).
     Even in this case, though, we can crack nice enough, as I
will now demonstrate you with PaintShopPro version 3.2 (a 32 bit
program for Windows 95).
     You will probably already possess it, if not find the last
version on the Web -through an Archie search- and download it
-through ftpmail-, Searching the archies will give you something
like this:

Host ftp.mds.mdh.se    (130.238.252.239)
Last updated 08:10  4 Dec 1996
Location: /pub/windows/win95/graphic_utils/paintshop
FILE  -rw-r--r--  311542 bytes  15:11 27 Jul 1996  psp32bit.zip

     We have seen in the preceding lesson (-> lesson 9.2) how to
disrupt, through the usual Winice 'live' approach, the
PaintShopPro nagscreens for Windows 3.1., cracking the older
versions of this program. Instead we will now try our 'dead
listing' approach for PSP 32 and PSP Version 4.1 (both 32 bit
programs).
     Let's fire PSP32 (I am using here the shareware version with
a PSP.EXE of 1.042.944 bytes, dated 27 December 1995). Let's have
a good look at the nagscreen (snapping it), OK, that's enough.
     Now load the target inside Wdasm32 (I am using here version
5 of Wdasm, you'll find cracked versions of it everywhere on the
Web).
     As soon as you have the complete (huge) listing of PSP.EXE
use the option "Save disassembly to text file"... you'll get a
huge text file (with 12.590.025 bytes, gosh). 
     Load it inside a (good and quick, i.e. not Microsoft's)
Wordprocessor and let's first of all have a look at the code
preceding and following our nagscreen (at this point -if you are
not completely imbecile- you should already have grasped the
foundation techniques of my "dead listing" cracking approach).
     You will see that in the code of PSP we have a lot of USER
calls. Therefore we cannot use the same easy 'find the caller'
approach used before (more about code mingling later).
     Have a look at the following piece of code (the Stringdata
for the Shareware notice has landed us there) there is a
GetDlgItem(), which is User32.EB and a EnableWindow(), which is
User32.AB.
     GetDlgItem(), as you should know, returns the handle of the
specified ID control (or zero if error). The ID number is the
parameter passed, the returned value is the hdlg (handle of the
dialog box of ID).

:0041DB69 891D38A04B00    mov [004BA038], ebx     ;ebx in here
**
:0041DB6F 6A6C             push 6C
:0041DB71 881DF4134C00    mov [004C13F4], bl      ;bl in here **
:0041DB77 56               push esi

* Reference To: GetDlgItem, Ord:00EBh in USER32.dll
                                |
:0041DB78 FF154C5A4C00    call dword ptr [004C5A4C]   ;callnag-1
:0041DB7E 50               push eax

* Reference To: EnableWindow, Ord:00ABh in USER32.dll ;callnag-2
                                |
:0041DB7F FF15DC594C00    call dword ptr [004C59DC]

*StringData Ref from Data Obj->"Paint Shop Pro Shareware Notice"
                           |
:0041DB85 6820174C00      push 004C1720
:0041DB8A 56              push esi

Now follow me closely:
1)   Since the following code pushes two locations (one with bx
and the other with bl) just before calling the  GetDlgItem and
EnableWindow routines for the "PaintShopPro Shareware Notice"
Window...
2)   ...we just need to search these locations ELSEWHERE,
"around" the above section of the code. Let's do it... Searching
the STRING "[004BA038]" we'll fetch inside our wordprocessed
listing two more occurrences: Let's look at the first one: this
piece of code compares to 1 our location just after enabling a
Window:

:REFERENCE_1_OF_OUR_[004BA038]
* Reference To: EnableWindow, Ord:00ABh in USER32.dll
                           |
:0041DA41 FF15DC594C00   call dword ptr [004C59DC]
:0041DA47 C605F4134C0002 mov byte ptr [004C13F4],2
:0041DA4E 833D38A04B0001 cmp dword ptr [004BA038],1 ;HERE!! **
:0041DA55 7510           jne 0041DA67 ;and the conditional jump!
:0041DA57 6A00           push 00000000 ;If equal (Zero flag), 
:0041DA59 6A6C           push 0000006C ;push these parameters 
:0041DA5B 6811010000     push 00000111 ;for the PostMessage
:0041DA60 56             push esi     ;function...

* Reference To: PostMessageA, Ord:01A3h in USER32.dll
                          |
:0041DA61 FF155C594C00   call dword ptr [004C595C] ;...call)
:0041DA67 B801000000     mov eax, 1        ;our jump here: flag=1
:0041DA6C E9EE030000     jmp 0041DE5F  ;end of code snippet, this

jumps to the "popping away" part of the code...
:0041DE5F 5D                  pop ebp
:0041DE60 5F                  pop edi
:0041DE61 5E                  pop esi
:0041DE62 5B                  pop ebx
:0041DE63 81C434050000        add esp, 00000534
:0041DE69 C21000              ret 0010

     AhHa! The value 111! (at :0041DA5B). You know what that
means, don't you? For the newbyes among you that don't, learn it
here (the others can skip): 
************ THE 111 WM_COMMAND RELEVANCE, by +ORC ********
The function PostMessage() has following structure:
PostMessage(HWND hWnd, UINT uMsg, WPARAM wMsgParam1, LPARAM
lMsgParam2)Where hWnd is the receiving Window, UINT is TRUE or
FALSE WPARAM is a 16 bit value and LPARAM a 32 bit one! 
Windows' applications use PostMessage() to deliver WM_Message
requests... and parameter 111 is WM_COMMAND!
Write it on your cracking notes and underline it! 1 is IDOK, 2
is IDCANCEL and 111 is WM_COMMAND.
     WM_COMMAND is extremely important for understanding the
behaviour of the application you want to crack, because the
handler for WM_COMMAND is where that application deals with user
commands, such as menu selctions, dialog push button clicks,
etcetera. In other words all what makes the 'guts' of an
application.
     An application can tell wich command a user gives through
the wParam parameter to the WM_COMMAND message.
     These values are (almost) always part of the application's
menu resources, and it is easy to get the menu ID values through
any utility for resources dumping.
************ (end) **************
     OK, so the above listed piece of code has a jump over the
PostMessage routine which (probably) disables the nag screen (6C
is the same ID, for both pieces of code we have seen)...let's try
a "weak" crack on it:

***** WEAK CRACK FOR PSP32, by +ORC, January 1997 ********

1)   Use Hexworks32
2)   Load PSP.EXE
3)   Search for the bytes sequences of the instructions
:0041DA4E 833D38A04B0001      cmp dword ptr [004BA038],1    
:0041DA55 7510                jne 0041DA67   
which are followed by the pushes:
:0041DA57 6A00                push 00000000 ;zero
:0041DA59 6A6C                push 0000006C ;ID
:0041DA5B 6811010000          push 00000111 ;WM_COMMAND

And as a quick crack (but there are more elegant ways) we can
4) substitute the byte '75' at :0041DA55 with a 74, transforming
the jne in a je, as usual, inverting the jumps. Jump if equal!

Since I have been (blandly) critized by fellow scholars for
speaking all the time of more elegant ways and yet presenting
only simple ways, here IS a more elegant crack for this code:

4)   Substitute with a new ONE the first TWO instructions:
:0041DA4E 66C70538A04B000100   mov word ptr [004BA038],1
and leave all the rest unchanged:
:0041DA57 6A00                push 00000000 ;zero
:0041DA59 6A6C                push 0000006C ;ID
:0041DA5B 6811010000          push 00000111 ;WM_COMMAND
*****************************
As you can see, we have just moved the flag '1' inside our
location, instead of comparing and jumping away as in the
original code and in the quickly cracked one. Estilo muchissimo
elegante.

Since this lesson was thought as +HCU material, here is the
result of the work on it made by (some of) my students:

JANUARY 1997: THIS PART OF LESSON 9.3 HAS BEEN MODIFIED (OR
ADDED) BY THE +HCU STUDENTS OF UNIT 4

 Let's finish our cracking of the nagscreens of the
whole PaintShopPro family with version 4.1, which is the most
recentwe know of. 
I am using here PSP.EXE 1.151.488 bytes from 1 Sep 1996, fetch
it through the archies.
We will crack this shareware program BETTER than the registered
version, since we will completely eliminate any nagscreen and
we'll not ever have the welcome screen that REMAINS inside the
registered version. We'll do this 'in a hurry', since it is not
+ORC speaking, but some of his students... you already know
enough about the 'dead listing' method to be able to follow. No
Winice in our hands, Ladies and Gentleman, We never used it on
this program. (Well... we actually did, before reading 9.3, but
it brought us nowhere, for this crack we (almost) DID NOT,
following +his instructions)
1) Get the 'dead listing' of psp.exe (it's huge)
2) Load it inside a fast wordprocessor
3) Find the string 'Purchasing' at :00406710
4) short after 'Purchasing' the only location compared and loaded
is location [004BC218]. Let's call it 'BINGO' and let's hope
it'll work.
5) this location is handled inside a small part of the code
:00406290 to :004067B5, this reduces the more than one million
bytes to 1317 bytes we'll have to examine, not bad.
6) Let's print this nagging part of the code and let's feel it
a little
7) Let's see the possible cracks we could think of (we repeat,
here is not +ORC's but his students at work, we are not perfect).
You'll see this piece of code
:FIRST_ATTEMPT (NOT SO GOOD)
:004065D0 50                  push eax
:004065D1 64892500000000      mov fs:[00000000], esp
:004065D8 81ECB4000000        sub esp, 000000B4
:004065DE 833D18C24B0000      cmp dword ptr [004BC218], 0 ;Is
BINGO zero?
:004065E5 56                  push esi
:004065E6 57                  push edi
:004065E7 0F85A0010000        jne 0040678D ;not really
this is 'pentium optimised' code, with a couple of pushes
'inside' the two logically consecutive instructions following the
double 80586 fetching... on a 80486 you would have had:
push esi; push edi; cmp dword ptr [004BC218], 0; jne 0040678D
We may just try substituting a 0F84 at :004065E7 (that is a jump
equal instead of the jne) and BOUM! We get an 'inamovible'
nagscreen, No way to click it away, it covers the main program
PaintShopPro for the eternity. This confirms that we are on the
right track (it's a green light). Uncrack the code (or reload the
original nagged program). Now look here:
:SECOND_ATTEMPT (NOT SO GOOD)
:00406495 E95AEA0900         jmp 004A4EF4
:0040649A 33F6               xor esi, esi
:0040649C C745FCFFFFFFFF     mov [ebp-04], FFFFFFFF
:004064A3 893518C24B00       mov [004BC218], esi ;load esi in
BINGO
Since :00406495 jumps away, it would be interesting to know who
the cuckoos lands at :0040649A. You'll quickly discover that
there are two jumps in this area. One 'xores' the esi before
loading it in our location, the other one does not:
:0040641C 747C       je 0040649A        ;xores esi
:0040646F EB2B       jmp 0040649C  ;does not xore esi
So you may be tempted to try '‡a passe ou ‡a casse' following
cracks:
:0040641C 747E       je 0040649C  ;no xoring even if it should
(THIS DOES NOT CHANGE ANYTHING)
:0040646F EB19       jmp 0040649A ; xoring even if it should not
(THIS CRASHES)
Bad score: a frozen nagscreen, a nothing and a crash. Three to
zero for our enemies. Let's look a little more around our 1317
bytes listing.

Well, what else?
The following code refers THREE TIMES to our location, that's a
lot, let's hope it does not suck:
:THREE_SISTER_BINGOS
:00406547 33C0            xor eax, eax  ;xor
:00406549 85C0            test eax, eax ;test ax
:0040654B 7513            jne 00406560 ;don't move in cx
:0040654D 8B0D18C24B00 1! mov ecx, [004BC218] ;move in cx
:00406553 85C9            test ecx, ecx ;test cx
:00406555 7418            je 0040656F  ;don't call Updatewin
:00406557 6A01            push 1
:00406559 8B01            mov eax, [ecx] ;move cx in ax
:0040655B FF5004          call [eax+04]  ;and call here
:0040655E EB0F            jmp 0040656F   ;don't call Updatewin
:00406560 A118C24B00  2!  mov eax, [004BC218]  ;move in ax soon
:00406565 8B4820          mov ecx, [eax+20]
:00406568 51              push ecx
:00406569 FF15C4014C00 call dword ptr [004C01C4] ;call
Updatewindow
:0040656F 6A00            push 0
:00406571 A118C24B00  3!  mov eax, [004BC218]  ;move in ax later

Well, something fishy here, don't you feel it? Who comes in here?
From where? Let's have a GOOD look at the 'preamble', i.e. the
part of the code that 'switches' to our THREE_SISTER_BINGOS block
above:
:PREAMBLE_TO_THREE_SISTER_BINGOS
:004064DD FF15BCF24B00    call dword ptr [004BF2BC] ;check this
loc
:004064E3 85C0            test eax, eax       ;test
:004064E5 744E            je 00406535              ;zero, go 6535
:004064E7 B896000000      mov eax, 96              ;load par 96
:004064EC 3945E0          cmp [ebp-20], eax     ;compare this
:004064EF 7C44            jl 00406535              ;lower, go
6535
:004064F1 3945E4          cmp [ebp-1C], eax     ;compare that
:004064F4 7C3F            jl 00406535             ;lower, go 6535
:004064F6 8B4508          mov eax, [ebp+08]     ;load this
:004064F9 85C0            test eax, eax         ;test it
:004064FB 7504            jne 00406501          ;do not xor
and...
:004064FD 33C0            xor eax, eax          ;xor and
:004064FF EB03            jmp 00406504          ;do not
:00406501 8B4020          mov eax, [eax+20]     ;...load this
:00406504 6A00            push 0                ;push
:00406506 8B4DE0          mov ecx, [ebp-20]     ;load ecx
:00406509 6A00            push 0                  ;push

Let's have a look at the 6535 routine of the switch PREAMBLE:
:00406535 E836560100       call 0041BB70
and
:41BB70 A118C34B00         mov eax, [004BC318]
:41BB75 85C0               test eax, eax
:41BB77 7407               je 0041BB80
:41BB79 50                 push eax
:41BB7A FF1530F54B00       call dword ptr [004BF530] ;globalFree
:41BB80 C70518C34B00       mov dword ptr [004BC318], 0
:41BB8A C3                 ret

Well, let's try along, what happen if we substitute a ret at
:00406535?
:00406535 C390909090     ret and nops
Nothing at all.
And what if we substitute here
:004064F6 8B4508                  mov eax, [ebp+08]
:004064F9 85C0                    test eax, eax
:004064FB 7504                    jne 00406501
:004064FD 33C0                    xor eax, eax
:004064FF EB03                    jmp 00406504
:00406501 8B4020                  mov eax, [eax+20]
:00406504 6A00                    push 00000000
... the instruction
:004064FB 7504                    jne 00406501
with the instruction 7500 (or 90 90)?
MOST BRILLIANT!
Now we XOR ANYWAY THIS AX without caring for ax+20. The nagscreen
is defeated? Not really... the nagscreen has been passed ON THE
BACKGROUND, where it still remains when you shut the 'main'
window of the program... the nag protection is somewhere there,
looking at us square in the faces... but where?
+gthorne here: since i had already seen the production version
of paint shop pro, i realized that it also had a nag screen - not
per se, but a splash screen (the very same screen without the
buttons to push and the 'number of days elapsed' warning). what
this means is that it is very possible that the screen
(regardless of what version we are running) could be intermingled
with the rest of the code, and not fully existing within a 
call. This does not proved it, just allowed the possibility.

Poking around, and being playful, i fired up snap32 and grabbed
the nagscreen window and saved it for future reference.

The next thing i did was check into the help screen area of Paint
Shop Pro. Often in shareware programs there is a HELP ABOUT, or
a HELP REGISTER section. Sometimes those places give away good
info needed (or just plain useful) in the crack routine.

Something that stood out in the help area was the paint shop pro
version statement. It seemed to be identical to the printed
version as seen on the nag screen. That means one of two things:
either the version number string was just typed in twice, or more
likely, just another call to a function: PSP_VERSION() or
somesuch.

What that means for the crackist should be pretty clearly a way
to locate the protection routine. Since the word SHAREWARE shows
up in both version calls, it can be scanned for pretty easily
with either that or the word VERSION itself.
            
Then, once i felt i had done enough scouting the territory, I ran
WDASM and grabbed myself a dead listing. Scanning for SHAREWARE,
I found a couple easy references to it... one being a data string
that I promptly blanked out and the other being in the text that
comes up on the nagscreen itself. WELL WELL... 

  This is the nagscreen result here:

* StringData Ref from Data Obj ->"This is a shareware version 
                                of "Paint Shop Pro."
                                  |
:00406B64 6810A34B00              push 004BA310
:00406B69 8D4DEC                  lea ecx, [ebp-14]

Okay, running the program again, and firing softice (old friend)
i immediately saw that the version checking routine no longer
tacked on the word SHAREWARE in either the nagscreen or in the
help box.. thus proving the version call to be just that.. a call
(as suspected).

Immediately, something else came up that I was not expecting, the
location of most of the program in memory was exactly the same
as seen with softice that it was hardcoded into the disassembly.
What i mean by that is that where softice was reporting
0137:0043FAD1 for a location in memory, identical data was
reported at location :0043FAD1 on the disassembly.

Now, talk about convenient!

Simply enough, i breakpointed in softice with a few locations i
had located in the disassembly, and voila... landed smack in the
middle of the nagscreen data.

It was do-able with soft-ice alone, but tracing into the maze of
nested calls in PSP really wasn't worth my time.

Line-by-line'ing it, it was simple to watch the nagscreen build
itself call by call, and NOP or alter JZ's & JNZ's to JMP's (74's
and 75's become EB's) so that the nagscreen lost more and more
functionality.

Then came a little work - not too much, but some things were a
little funny. Notice the BITBLT in the nagscreen creation code.
I had tried to scan for some of the standard SHOWWINDOW calls
with softice and in the disassembly, but not one was to be found
where it needed to be. Apparently PSP was using some other method
of showing the screen... and a simple graphics memory copy (known
to those who follow Micro$oft as a BitBlt) was apparently the
modus operandi.

Some of the text was already in place before the BitBlt, so here
is our reason that some of the nagscreen was not being done as
we watched with the debugger... it was being written to a
backbuffer before being copied as a whole window before being
blitted to the screen. This, for those of you new to graphics
programming, is how people make smooth animation that does not
flicker... all of the animating is done in the background and a
whole screen is blitted at one time rather than by bits and
pieces (you can tell which programs do not do this very easily
since they have images that seem to disappear or flicker wrong
in odd places on the screen)

There were not many calls in that area, and only the ones that 
referenced string data or the bitblt itself could be effectively
nop'ed out.

Here is where i basically stopped the work, since i was having
trouble locating what CALLED the nagscreen area.

The reason we are getting the ghost window in the back (notice
it's size is EXACTLY the same as the nagscreen, is that windows
is being instructed by some window create command to block off
the rectangular space for the screen even though the graphic
interior does not get written.

The backgrounding code is invaluable here since the ghost window 
does not have a way to be removed without paint shop pro closing 
(which cleans up nicely for itself on exit).

Now we need to locate the call that creates the window in the
first place and nop it or whatever... there is probably a nicer
way to do all this (if you work at it, you can probably jmp past
all the functions i nop'd - taking care not to leave unmatched
pushes or pops which ruin the flow of the program - at some point
in the nagscreen area

The funny part of all this is that our cracked version will be
better than the registered version since the registered version
has a splash screen anyway - and ours does not :)

Using all of this knowledge later can actually benefit us in a
different way... we can actually use all of the techniques (since
we already know where the nagscreen is) on the executable of the
full version as well. 
Since it has no nag functions, it is a smaller executable and
cracking it will give is a nagless, splashless (eg. screenless)
version of paint shop pro that is smaller (i.e. better and more
functional) than by just cracking the shareware version.

I find that funny somehow :)

So here is all the rest you need: 

Let's have a look at the VERSION subroutine that is called both
in the nagscreen and the HELP screen:

* StringData Ref from Data Obj ->"4" ;FIRST DIGIT OF VERSION 4.01
                                  |
:004350E4 6874AE4B00              push 004BAE74
:004350E9 8B3D90004C00            mov edi, [004C0090]
:004350EF C645FC07                mov [ebp-04], 07
:004350F3 C706F0A54A00            mov dword ptr [esi], 004AA5F0
:004350F9 FFD7                    call edi
:004350FB 83C404                  add esp, 00000004
:004350FE 8BD8                    mov ebx, eax
:00435100 C1E310                  shl ebx, 10

* StringData Ref from Data Obj ->"0"    ;SECOND DIGIT OF 4.01
                                  |
:00435103 6860A64B00              push 004BA660
:00435108 FFD7                    call edi
:0043510A 83C404                  add esp, 00000004
:0043510D 0BD8                    or ebx, eax
:0043510F C1E308                  shl ebx, 08

* StringData Ref from Data Obj ->"1"   ;THIRD DIGIT OF 4.01
                                  |
:00435112 685CA64B00              push 004BA65C
:00435117 FFD7                    call edi
:00435119 C1E010                  shl eax, 10
:0043511C 83C404                  add esp, 00000004
:0043511F 0BD8                    or ebx, eax

* Possible StringData Ref from Data Obj ->"2"
                                  |
:00435121 68C4A14B00              push 004BA1C4
:00435126 FFD7                    call edi
:00435128 83C404                  add esp, 00000004
:0043512B 0BD8                    or ebx, eax
:0043512D 899ED4000000            mov [esi-000000D4], ebx

* Possible StringData Ref from Data Obj ->"0"
                                  |
:00435133 6860A64B00              push 004BA660
:00435138 FFD7                    call edi
:0043513A 83C404                  add esp, 00000004
:0043513D 50                      push eax

* Possible StringData Ref from Data Obj ->"1"
                                  |
:0043513E 685CA64B00              push 004BA65C
:00435143 FFD7                    call edi
:00435145 83C404                  add esp, 00000004
:00435148 50                      push eax

* Possible StringData Ref from Data Obj ->"4"
                                  |
:00435149 6874AE4B00              push 004BAE74
:0043514E FFD7                    call edi
:00435150 83C404                  add esp, 00000004
:00435153 50                      push eax

* Ref from Data Obj ->"%i.%i%i"  ;PRINT 3 INTEGERS: N.NN (4.01)
                                  |
:00435154 686CAE4B00              push 004BAE6C
:00435159 8D86CC000000            lea eax, [esi-000000CC]
:0043515F 50                      push eax

* Reference To: n/a, Ord:09A7h in MFC40.DLL
                                  |
:00435160 E815FF0600              call 004A507A
:00435165 83C414                  add esp, 00000014
:00435168 8D8ECC000000            lea ecx, [esi-000000CC]

* StringData Ref from Data Obj ->" Shareware"  ;PRINT SHAREWARE
                                  |
:0043516E 6860AE4B00              push 004BAE60

The first BitBlt routine of the program puts the screen on!

it is at:

* Reference To: BitBlt, Ord:000Ah in GDI32.dll
                                  |
:00406917 FF15B4F24B00            call dword ptr [004BF2B4]
:0040691D B800000000              mov eax, 00000000
:00406922 85FF                    test edi, edi
:00406924 7403                    je 00406929
:00406926 8B4704                  mov eax, [edi+04]
:00406929 50                      push eax
:0040692A 8B45B4                  mov eax, [ebp-4C]
:0040692D 50                      push eax

and here some other annoying pieces of code: The red bar as soon
as you use the program more than 30 days...

* Reference To: n/a, Ord:0970h in MFC40.DLL
                                  |
:00406BE3 E836E60900    call 004A521E ;DRAW RED BAR
:00406BE8 6801080000    push 00000801
:00406BED 8D45A0        lea eax, [ebp-60]
:00406BF0 50            push eax
:00406BF1 8B4DEC        mov ecx, [ebp-14]
:00406BF4 8B853CFFFFFF  mov eax, [ebp-000000C4]
:00406BFA 8B51F8        mov edx, [ecx-08]
:00406BFD 52            push edx
:00406BFE 51            push ecx
:00406BFF 8D8D3CFFFFFF  lea ecx, [ebp-000000C4]
:00406C05 FF5070        call [eax+70] ;BOTTOM WINDOW TXT+RED BAR
:00406C08 53            push ebx
:00406C09 8D8D3CFFFFFF  lea ecx, [ebp-000000C4]

Once found all the above, the rest is pretty obvious... here all
the necessary crackcodes: bytes to find and change. This is a
weird, non-elegant crack, but kinda funny, so i had to write it
down until i discover a better one (+gthorne speaking) note:
i gave good search strings so lamers don't get confused with
similar patterns in the software:

8B450885C07504 to 8B450885C07500 -  screen backgrounding
3CFFFFFFFF5070 to 3CFFFFFF750090 - do not draw lower text in box
3CFFFFFFFF5064 to 3CFFFFFFEB0090 - do not report version number
83FF1E7E1E to 83FF1EEB1E         - do not draw red bar
000083FFC07403 to 000083FFC0EB03 - turn nagscreen invisible
53686172657761726500 to 20202020202020202000 - disable shareware
notice writing phisycally some spaces over it

final note: since psp closes the nagscreen when the program
exits, all is now cleaned up.

 FF15B4F24B00 to 750090750090 (bitblt) seems to not do anything
the above cracks dont do.

 Time to explain BitBlt... isn 't it? BitBlt copies
a bitmap from the device context sopecified by hdcSource to the
device context specified by hdcTarget performing a block copy.
On success the function returns not zero. 
It is called with the handle hdcTarget, int nTargetX and nTArgetY
(upper left coordinates of the point at which the bitmap will be
copied... a 'pixel point' locator may be very useful in our
trade) int nWidth and nHeight of the region, the handle hdcSource
and then, finally the upper left coordinates IN the bitmap, the
two int nSourceX and nSourcey. Is it all? NO! The final
parameter, DWORD dwRaster determines HOW the bit-by-bit contents
of the bitmap will actually be copied (black, inverted, ANDed,
ORed, XOred...etc.).

Lotta things to learn if you want to crack a lot...
THE STUDENTS OF UNIT 4 (+HCU, January 1997)
*******************************************

As a matter of fact both cracks here, mine for PSPS32 and my
student's VERY smart one for PSP41 are 'weak', though: they will
not eliminate the nagscreen (you should search for the remaining
occurrences of our locations and work from them inwards, if you
really want to crack completely this scheme, but in this case it
would be better to work more with Winice95, in my opinion. But
I hope I have made the point about "dead listing" cracking: It
works! Quick and placid! In the PSP32 case the protection will
still show you the nagscreen, which will "automatically"
disappear, though, leaving you with no annoyance (in nuce: you
cracked the return button), in the other case you have physically
eliminated all possible annoyances. The nagscreen is still there,
but it does not 'harm' you any more.
Anyway I wanted only to show you the POWER and the CHILD'S PLAY
working of this "dead listing" approach (that you may combine
with some quick winice probes if you really think you need it
anytime).
     You'll agree with me, though, that this quick "weak" crack,
made with the "dead listing" method is far less tiresome than a
'live' crack with our beloved SoftIce/WinIce.
     Now, in life, I believe, you should always search to obtain
the maximum giving the minimum. There is no point in being
altruistic or excessively honest in a society where the tiny
minority that profits most keeps getting richer and richer and
the overwhelming majority that lives with meager earnings keeps
getting poorer and poorer (and -moronized by TV-watching and
other Pavlovian propagandistic sources of misinformation- keeps
voting the same rich bastards that keep it enslaved under the
whips of publicity, as if the slaves of ancient Egypt would
happily vote for their Pharaohs). I abhor and despise the society
I am compelled to live in... but this does not mean that I
renounce to anything. I am (pretty) rich, (yet do not exploit
anybody), eat very well, have a big nice house with all the
useless objects and cars and garages and terraces and futile
gadgets you are supposed to enjoy in this moronic society (I
enjoy foremost my spacious library) and I drink my regular bottle
of (Moskowskaja) Wodka every week. My liver (and my nice family)
do not seem to complain :=)

Well, that's it for this lesson, reader. Not all lessons of my
tutorial are or will be on the Web.
     You'll obtain the missing lessons IF AND ONLY IF you mail
me back (via anon.penet.fi) with some tricks of the trade I may
not know that YOU discovered. Mostly I'll actually know them
already, but if they are really new you'll be given full credit,
and even if they are not, should I judge that you "rediscovered"
them with your work, or that you actually did good work on them,
I'll send you the remaining lessons nevertheless. Your
suggestions and critics on the whole crap I wrote are also
welcomed. Do not annoy me with requests for warez, everything is
on the Web, learn how to search, for goddess sake.

     "If you give a man a crack he'll be hungry again
     tomorrow, but if you teach him how to crack, he'll
     never be hungry again"
</pre>     
</p>
<br><center><a href="mailto:na526164@anon.penet.fi">E-mail
+ORC</a></center>

<p><center> +ORC   na526164@anon.penet.fi</center></p>

</body>
</html>



 

 


<html>
<head>
<title>rcgeudo</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>HOW TO CRACK EUDORA PRO 3.0 (30 DAY TRIAL)<br>
(Time trial protection busting)</h2><h4><i>by +RCG</i></h4>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering</center>
<hr size="2">
<pre>


		HOW TO CRACK EUDORA PRO 3.0 (30 DAY TRIAL)


	Well, in this lesson I won't explain the theory again, because our master 
+ORC did it in his 4.1 lesson. This document is a practical exercice based on that 
lesson (yes, just like I did in my school times, this is my homework).

	The problem in this kind of protection is to find where the protection is 
hidden, but we cannot do it by a registration menu, so we must put special attention 
in the events that occur before the program stops, if we are lucky a MessageBox will 
be displayed (that is a key to enter) but sometimes these keys are not so obvious.
	Another problem is given by programs in Visual Basic, which is not native code, 
and you see nothing but vb40032.dll calls, I have no idea how to crack those programs, 
so I encourage you to help us. 



	Here is my solution to this time protection scheme:

	First, use the program with the correct date, nothing special happens, now 
use it again but with two months added to the date: a warning message is displayed, 
you cannot send mail, nor receive it.

	With Eudora 3.0 we are lucky because we have this key: a MessageBox is displayed 
(and this application is programmed in C), so let's use it.

	Bpx MessageBoxA

	Remember:

	int MessageBox(
	    	HWND  hwndOwner,		// handle of owner window
    		LPCTSTR  lpszText,	// address of text in message box
    		LPCTSTR  lpszTitle,	// address of title of message box  
    		UINT  fuStyle 		// style of message box
   			   );


	When SoftIce pops up, trace until you get back to Eudora code, you will see this 
code fragment:

	

* Reference To: KERNEL32.GetModuleFileNameA, Ord:00E9h
                                  |
:00421A29 FF1504A74E00            Call dword ptr [004EA704]
:00421A2F 85C0                    test eax, eax
:00421A31 741F                    je 00421A52
:00421A33 8D8560FCFFFF            lea eax, [ebp+FFFFFC60]
:00421A39 B9B82C4E00              mov ecx, 004E2CB8
:00421A3E 50                      push eax
:00421A3F E86C2B0800              call 004A45B0		;Get checksum
:00421A44 85C0                    test eax, eax		Is correct?
:00421A46 740A                    je 00421A52		No, bad guy
:00421A48 B9B82C4E00              mov ecx, 004E2CB8
:00421A4D E81E2C0800              call 004A4670		;Decrypt_date	
:00421A52 B9B82C4E00              mov ecx, 004E2CB8
:00421A57 E834300800              call 004A4A90    ;How_many_days_left?
:00421A5C 8BF8                    mov edi, eax
:00421A5E 85FF                    test edi, edi	    ;0 days left?
:00421A60 0F85CC000000            jne 00421B32	    ;No, good guy.	
:00421A66 8D4DC8                  lea ecx, [ebp-38]
:00421A69 BEFFFFFFFF              mov esi, FFFFFFFF
:00421A6E E835B10900              Call 004BCBA8
:00421A73 68FEFF0000              push 0000FFFE
:00421A78 8D4DC8                  lea ecx, [ebp-38]
:00421A7B C745FC00000000          mov [ebp-04], 00000000
:00421A82 E81BB10900              Call 004BCBA2
:00421A87 C745FC01000000          mov [ebp-04], 00000001
:00421A8E 6A00                    push 00000000
:00421A90 8B45C8                  mov eax, [ebp-38]
:00421A93 6A00                    push 00000000
:00421A95 50                      push eax	
:00421A96 E877B60900              Call 004BD112	 <== MessageBoxA routine :00421A9B 8975FC mov [ebp-04], esi ;SIce pops here!!! :00421A9E E887000000 call 00421B2A :00421AA3 B9302D4E00 mov ecx, 004E2D30 :00421AA8 E8A3810700 call 00499C50 :00421AAD 8B45EC mov eax, [ebp-14] :00421AB0 05D4040000 add eax, 000004D4 :00421AB5 50 push eax :00421AB6 C70094000000 mov dword ptr [eax], 00000094 How_many_days_left routine : :004A4A90 53 push ebx :004A4A91 56 push esi :004A4A92 57 push edi :004A4A93 8BF1 mov esi, ecx :004A4A95 33FF xor edi, edi :004A4A97 E814FEFFFF call 004A48B0 ;Are_final_bytes_ok? :004A4A9C 33DB xor ebx, ebx :004A4A9E 85C0 test eax, eax :004A4AA0 7464 je 004A4B06 ;yes, Bad Guy :004A4AA2 57 push edi * Reference To: MSVCRT40.time, Ord:0466h | :004A4AA3 FF150CB74E00 Call dword ptr [004EB70C] :004A4AA9 83C404 add esp, 00000004 :004A4AAC 8BC8 mov ecx, eax ;Actual date :004A4AAE 817E10E8030000 cmp [esi+10], 000003E8 :004A4AB5 7207 jb 004A4ABE :004A4AB7 BFE8030000 mov edi, 000003E8 :004A4ABC EB23 jmp 004A4AE1 ;Something is wrong, beggar off :004A4ABE 8B462C mov eax, [esi+2C] ;Trial end data :004A4AC1 394630 cmp [esi+30], eax ;Must be equals :004A4AC4 751B jne 004A4AE1 :004A4AC6 3BC1 cmp eax, ecx ;Is act Date gr than Limitdate :004A4AC8 7617 jbe 004A4AE1 ;Yes, bad guy :004A4ACA 394E28 cmp [esi+28], ecx  ;Is act. Date low than Installdate :004A4ACD 7712 ja 004A4AE1 ;Yes, bad guy. :004A4ACF 2BC1 sub eax, ecx ;Limit date-Act. date :004A4AD1 BF80510100 mov edi, 00015180 ;3600*24="15180h(1day)" :004A4AD6 057F510100 add eax, 0001517F ;Add to compensate :004A4ADB 2BD2 sub edx, edx :004A4ADD F7F7 div edi :004A4ADF 8BF8 mov edi, eax ;Days left :004A4AE1 8B4618 mov eax, [esi+18] :004A4AE4 3BC1 cmp eax, ecx :004A4AE6 7612 jbe 004A4AFA :004A4AE8 2BC1 sub eax, ecx :004A4AEA 2BD2 sub edx, edx :004A4AEC B980510100 mov ecx, 00015180 :004A4AF1 057F510100 add eax, 0001517F :004A4AF6 F7F1 div ecx :004A4AF8 8BD8 mov ebx, eax :004A4AFA 8BC7 mov eax, edi :004A4AFC 3BDF cmp ebx, edi :004A4AFE 7708 ja 004A4B08 ;Days left :004A4B00 5F pop edi :004A4B01 8BC3 mov eax, ebx ;Compensate days left. :004A4B03 5E pop esi :004A4B04 5B pop ebx :004A4B05 C3 ret :004A4B06 33C0 xor eax, eax :004A4B08 5F pop edi :004A4B09 5E pop esi :004A4B0A 5B pop ebx :004A4B0B C3 ret Note that : [esi+2c] is the limit date [esi+30] is the instalation date So, the question is, where does the program takes these values from? Let's analize deeply the routines. Are_Final_Bytes_Ok routine: :004A4820 813947382559 cmp dword ptr [ecx], 59253847 :004A4826 7521 jne 004A4849 :004A4828 817904CBEACFAD cmp [ecx+04], ADCFEACB :004A482F 7518 jne 004A4849 :004A4831 8179085C0E5F8D cmp [ecx+08], 8D5F0E5C :004A4838 750F jne 004A4849 :004A483A 81790CA4E9F8B6 cmp [ecx+0C], B6F8E9A4 :004A4841 7506 jne 004A4849 :004A4843 B801000000 mov eax, 00000001 :004A4848 C3 ret :004A4849 33C0 xor eax, eax ;Yes, final bytes wrong. :004A484B C3 ret The program flow is: 1. Is the checksum ok? Yes, go to next protection pass. 2. Are the last bytes ok? Yes, go to next pass. 3. Decrypt date values. 4. Are you inside the 30 days period? Yes, good guy. Now, you can write down the address referenced by [ecx], and use SoftIce with : bmpd [ecx] W Open again Eudora, and you will be in middle of VFAT routine, so trace until again in Eudora, now put attention and try to reach the next code fragment: (tip: write in softice e ds:ecx and trace until its contents take the desired value) Get_Checksum routine : * Referenced by a CALL at Address: |:00421A3F | :004A45B0 53 push ebx :004A45B1 56 push esi :004A45B2 57 push edi :004A45B3 33F6 xor esi, esi :004A45B5 55 push ebp :004A45B6 8BF9 mov edi, ecx :004A45B8 8B442414 mov eax, [esp + 14] :004A45BC 6800800000 push 00008000 ;How to open (Reopen) :004A45C1 50 push eax ;Name stringz (Eudora.exe) * Reference To: MSVCRT40._open, Ord:0322h | :004A45C2 FF15A8B64E00 Call dword ptr [004EB6A8] :004A45C8 83C408 add esp, 00000008 :004A45CB 8BD8 mov ebx, eax :004A45CD 83FBFF cmp ebx, FFFFFFFF ;Any error? :004A45D0 0F848C000000 je 004A4662 :004A45D6 6A02 push 00000002 ;Beginning at end of file :004A45D8 6AD8 push FFFFFFD8 ;Move 0x28 bytes (back) :004A45DA 53 push ebx ;Handle * Reference To: MSVCRT40._lseek, Ord:02DEh | :004A45DB FF1568B74E00 Call dword ptr [004EB768] :004A45E1 83C40C add esp, 0000000C :004A45E4 8BE8 mov ebp, eax :004A45E6 83FDFF cmp ebp, FFFFFFFF ;Any error? :004A45E9 746D je 004A4658 :004A45EB 6A28 push 00000028 ;Read last 0x28 bytes :004A45ED 57 push edi ;Buffer :004A45EE 53 push ebx ;Handle * Reference To: MSVCRT40._read, Ord:0333h | :004A45EF FF15ACB64E00 Call dword ptr [004EB6AC] :004A45F5 83C40C add esp, 0000000C :004A45F8 83F8FF cmp eax, FFFFFFFF ;Any error? :004A45FB 745B je 004A4658 :004A45FD 8B4710 mov eax, [edi+10] ;Buffer+10 :004A4600 8BCF mov ecx, edi :004A4602 50 push eax :004A4603 E808050000 call 004A4B10 ;Manipulate data :004A4608 8BCF mov ecx, edi :004A460A 894710 mov [edi+10], eax :004A460D 8B4714 mov eax, [edi+14] :004A4610 50 push eax :004A4611 E80A050000 call 004A4B20 ;Manipulate data :004A4616 8BCF mov ecx, edi :004A4618 894714 mov [edi+14], eax :004A461B 8B4718 mov eax, [edi+18] :004A461E 50 push eax :004A461F E80C050000 call 004A4B30 ;Manipulate data :004A4624 8BCF mov ecx, edi :004A4626 894718 mov [edi+18], eax :004A4629 8B471C mov eax, [edi+1C] :004A462C 50 push eax :004A462D E83E050000 call 004A4B70 ;Manipulate data :004A4632 55 push ebp :004A4633 8BCF mov ecx, edi :004A4635 53 push ebx :004A4636 89471C mov [edi+1C], eax :004A4639 E8F2060000 call 004A4D30 ;Get_file_checksum :004A463E 394724 cmp [edi+24], eax ;Is correct? :004A4641 740C je 004A464F ;Yes, good guy. :004A4643 897710 mov [edi+10], esi :004A4646 897714 mov [edi+14], esi :004A4649 897718 mov [edi+18], esi :004A464C 89771C mov [edi+1C], esi :004A464F 8BCF mov ecx, edi :004A4651 E85A020000 call 004A48B0 :004A4656 8BF0 mov esi, eax ;flag :004A4658 53 push ebx * Reference To: MSVCRT40._close, Ord:0251h | :004A4659 FF15A0B64E00 Call dword ptr [004EB6A0] :004A465F 83C404 add esp, 00000004 :004A4662 8BC6 mov eax, esi ;flag :004A4664 5D pop ebp :004A4665 5F pop edi :004A4666 5E pop esi :004A4667 5B pop ebx :004A4668 C20400 ret 0004 Get_file_checksum routine : * Referenced by a CALL at Address: |:004A4639 | :004A4D30 B804100000 mov eax, 00001004 :004A4D35 E876950100 call 004BE2B0 :004A4D3A 53 push ebx :004A4D3B 56 push esi :004A4D3C 8BB42410100000 mov esi, [esp + 00001010] :004A4D43 57 push edi :004A4D44 55 push ebp :004A4D45 BF54ABD729 mov edi, 29D7AB54 ;Initial value :004A4D4A 56 push esi * Reference To: MSVCRT40._tell, Ord:0369h | :004A4D4B FF157CB64E00 Call dword ptr [004EB67C] :004A4D51 89442414 mov [esp + 14], eax ;File length :004A4D55 83C404 add esp, 00000004 :004A4D58 33DB xor ebx, ebx :004A4D5A 6A00 push 00000000 ;From beginning :004A4D5C 6A00 push 00000000 ;File zero position :004A4D5E 56 push esi ;Handle * Reference To: MSVCRT40._lseek, Ord:02DEh | :004A4D5F FF1568B74E00 Call dword ptr [004EB768] :004A4D65 83C40C add esp, 0000000C :004A4D68 399C241C100000 cmp [esp + 0000101C], ebx :004A4D6F 742F je 004A4DA0 :004A4D71 8BEB mov ebp, ebx :004A4D73 81E5FF0F0000 and ebp, 00000FFF :004A4D79 7514 jne 004A4D8F :004A4D7B 8D442414 lea eax, [esp + 14] :004A4D7F 6800100000 push 00001000 ;Read 0x1000 bytes :004A4D84 50 push eax ;Buffer :004A4D85 56 push esi ;Handle * Reference To: MSVCRT40._read, Ord:0333h | :004A4D86 FF15ACB64E00 Call dword ptr [004EB6AC] :004A4D8C 83C40C add esp, 0000000C :004A4D8F 0FBE442C14 movsx byte ptr eax, [esp + ebp + 14] :004A4D94 03F8 add edi, eax ;Add eax to checksum :004A4D96 43 inc ebx :004A4D97 3B9C241C100000 cmp ebx, [esp + 0000101C] ;ebx="File" lenght-0x28 :004A4D9E 72D1 jb 004A4D71 ;No, Read more :004A4DA0 8B442410 mov eax,[esp+10] ;eax="file" length :004A4DA4 6A00 push 00000000 ;From beginning :004A4DA6 50 push eax ;Displacement :004A4DA7 56 push esi ;Handle * Reference To: MSVCRT40._lseek, Ord:02DEh | :004A4DA8 FF1568B74E00 Call dword ptr [004EB768];Go end of file :004A4DAE 83C40C add esp, 0000000C :004A4DB1 8BC7 mov eax, edi ;eax="checksum" :004A4DB3 5D pop ebp :004A4DB4 5F pop edi :004A4DB5 5E pop esi :004A4DB6 5B pop ebx :004A4DB7 81C404100000 add esp, 00001004 :004A4DBD C20800 ret 0008 Decrypt routine : * Referenced by a CALL at Address: |:00421A4D | :004A4670 64A100000000 mov eax, fs:[00000000] :004A4676 55 push ebp :004A4677 8BEC mov ebp, esp :004A4679 6AFF push FFFFFFFF :004A467B 68FF474A00 push 004A47FF :004A4680 50 push eax :004A4681 64892500000000 mov fs:[00000000], esp :004A4688 81EC5C010000 sub esp, 0000015C :004A468E 53 push ebx :004A468F 56 push esi :004A4690 57 push edi :004A4691 8BF1 mov esi, ecx :004A4693 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A4699 E892B4FCFF call 0046FB30 :004A469E 68601D4E00 push 004E1D60 :004A46A3 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A46A9 C745FC00000000 mov [ebp-04], 00000000 :004A46B0 E89BB4FCFF call 0046FB50 :004A46B5 85C0 test eax, eax :004A46B7 0F8426010000 je 004A47E3 :004A46BD 6A50 push 00000050 :004A46BF 8D45A4 lea eax, [ebp-5C] ;Buffer :004A46C2 50 push eax :004A46C3 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A46C9 68541D4E00 push 004E1D54 :004A46CE E8CDB5FCFF call 0046FCA0 ;Read from register :004A46D3 8BF8 mov edi, eax ;Error flag 1 :004A46D5 8D45A4 lea eax, [ebp-5C] ;Buffer :004A46D8 50 push eax * Reference To: MSVCRT40.atol, Ord:03D4h (Ascii to long) | :004A46D9 FF1540B74E00 Call dword ptr [004EB740] :004A46DF 83C404 add esp, 00000004 :004A46E2 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A46E8 89462C mov [esi+2C], eax ;Store long :004A46EB 6A50 push 00000050 :004A46ED 8D45A4 lea eax, [ebp-5C] ;Buffer :004A46F0 50 push eax :004A46F1 68481D4E00 push 004E1D48 :004A46F6 E8A5B5FCFF call 0046FCA0 ;Read from register :004A46FB 8BD8 mov ebx, eax ;Error flag 2 :004A46FD 8D45A4 lea eax, [ebp-5C] ;Buffer :004A4700 50 push eax * Reference To: MSVCRT40.atol, Ord:03D4h (Ascii to long) | :004A4701 FF1540B74E00 Call dword ptr [004EB740] :004A4707 83C404 add esp, 00000004 :004A470A 894630 mov [esi+30], eax ;Store long :004A470D 85FF test edi, edi ;Error flag 1 :004A470F 0F8598000000 jne 004A47AD :004A4715 85DB test ebx, ebx ;Error flag 2 :004A4717 0F8590000000 jne 004A47AD :004A471D 6A00 push 00000000 ;Both flag are set * Reference To: MSVCRT40.time, Ord:0466h(Put actual date to install date | ,because is the first use) :004A471F FF150CB74E00 Call dword ptr [004EB70C] :004A4725 83C404 add esp, 00000004 :004A4728 8B4E10 mov ecx, [esi+10] :004A472B 8D1489 lea edx, [ecx + 4*ecx] :004A472E 8D1CD2 lea ebx, [edx + 8*edx] :004A4731 8D0C5B lea ecx, [ebx + 2*ebx] :004A4734 8D0C89 lea ecx, [ecx + 4*ecx] :004A4737 C1E107 shl ecx, 07 :004A473A 03C1 add eax, ecx :004A473C 8BCE mov ecx, esi :004A473E 50 push eax :004A473F 894630 mov [esi+30], eax :004A4742 89462C mov [esi+2C], eax :004A4745 E806040000 call 004A4B50 :004A474A 8B4E30 mov ecx, [esi+30] :004A474D 89462C mov [esi+2C], eax :004A4750 51 push ecx :004A4751 8BCE mov ecx, esi :004A4753 E838040000 call 004A4B90 :004A4758 8B4E2C mov ecx, [esi+2C] :004A475B 8D55A4 lea edx, [ebp-5C] :004A475E 51 push ecx :004A475F 8B3DDCB64E00 mov edi, [004EB6DC] :004A4765 68BCF34D00 push 004DF3BC :004A476A 894630 mov [esi+30], eax :004A476D 52 push edx :004A476E FFD7 call edi :004A4770 83C40C add esp, 0000000C :004A4773 8D4DA4 lea ecx, [ebp-5C] :004A4776 51 push ecx :004A4777 68541D4E00 push 004E1D54 :004A477C 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A4782 E859B5FCFF call 0046FCE0 :004A4787 8B4630 mov eax, [esi+30] :004A478A 8D4DA4 lea ecx, [ebp-5C] :004A478D 50 push eax :004A478E 68BCF34D00 push 004DF3BC :004A4793 51 push ecx :004A4794 FFD7 call edi :004A4796 83C40C add esp, 0000000C :004A4799 8D4DA4 lea ecx, [ebp-5C] :004A479C 51 push ecx :004A479D 68481D4E00 push 004E1D48 :004A47A2 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A47A8 E833B5FCFF call 0046FCE0 :004A47AD 8B462C mov eax, [esi+2C] ;Encrypted value :004A47B0 8BCE mov ecx, esi :004A47B2 50 push eax :004A47B3 E878030000 call 004A4B30 ;Decrypt it :004A47B8 8BCE mov ecx, esi :004A47BA 89462C mov [esi+2C], eax ;Actual date :004A47BD 8B4630 mov eax, [esi+30] ;Encrypted value :004A47C0 50 push eax :004A47C1 E8AA030000 call 004A4B70 ;Decrypt it :004A47C6 894630 mov [esi+30], eax ;Date limit :004A47C9 8B4610 mov eax, [esi+10] :004A47CC 8D0C80 lea ecx, [eax + 4*eax] :004A47CF 8D14C9 lea edx, [ecx + 8*ecx] :004A47D2 8D0452 lea eax, [edx + 2*edx] :004A47D5 8D0480 lea eax, [eax + 4*eax] :004A47D8 C1E007 shl eax, 07 :004A47DB F7D8 neg eax :004A47DD 03462C add eax, [esi+2C] :004A47E0 894628 mov [esi+28], eax :004A47E3 C745FCFFFFFFFF mov [ebp-04], FFFFFFFF :004A47EA E81A000000 call 004A4809 :004A47EF 8B45F4 mov eax, [ebp-0C] :004A47F2 5F pop edi :004A47F3 64A300000000 mov fs:[00000000], eax :004A47F9 5E pop esi :004A47FA 5B pop ebx :004A47FB 8BE5 mov esp, ebp :004A47FD 5D pop ebp :004A47FE C3 ret * Referenced by a CALL at Address: |:004A47EA | :004A4809 8D8D98FEFFFF lea ecx, [ebp+FFFFFE98] :004A480F E92CB3FCFF jmp 0046FB40 You can see how the instalation date is stored in : My_Pc\HKEY_CURRENT_USER\Software\Microsoft\Notepad lfIconPos : Value1 lfWindowPos : Value2 These two values are encrypted. The easier solution is when you will be notified about your expiration time, delete these entries in the registry. Also you can do a manipulation of the code, you have all you need to do that explained in that lesson, think that the routines are duplicated, one at the beginning an the other in the middle of the program when you try to send or receive mail, so you must find the other routines, but these are referenced above. Good Luck !!!! (c) +Rcg 1997 </pre>
<br>
</pre>
<br>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>








<html>
<head><title>int13asm</title></head>
<body>
<center><h1>int13asm.htm</h1></center>
<hr size="1">
<pre>
PAGE 64,132
;
;         This program intercepts Int 13H calls and prints
;         the drive, side, track, sector, # of sectors, operation,
;         and return code.
;
;--------------------------------------------------------------
DISKSTAT segment at 040h ;segment starts at abs. addr. 0400h
         org 042h
ST0      db ?        ;Disk status area used after
ST1      db ?        ;  int 13h calls
ST2      db ?
CYLINDER db ?
HEAD     db ?
RECORD   db ?
NUMBER   db ?
DISKSTAT ends
;--------------------------------------------------------------
;
cseg    segment
        org 100h
INT13   proc far
        assume cs:cseg,ds:cseg
;
        jmp install                    ;install and make routine resident
;
redef13      label      word
oldint13     dd         0              ;save area for old int13 vector
int13loc     equ        13h*4h         ;vector location for int13h
drive_a      equ         'A'
drive_b      equ         'B'
drive_c      equ         'C'
drive_d      equ         'D'
drive_x      equ         'X'
save_ip      dw         0              ;save area for calling pgm's IP
save_cs      dw         0              ;save area for calling pgm's CS
save_st0     db         ?
save_st1     db         ?
save_st2     db         ?
save_c       db         ?
save_h       db         ?
save_r       db         ?
save_n       db         ?
;
message      db 0fh        ;   code for compressed printing
             db 'Drv: '
drive        db ?
             db ' Side: '
side1        db ?
side2        db ?
             db '   Tr: '
track1       db ?
track2       db ?
             db ' Sec: '
sector1      db ?
sector2      db ?
             db '  # secs: '
sec_cnt1     db ?
sec_cnt2     db ?
             db ' Op: '
op_1         db ?
op_2         db ?
             db '   Retcd: '
status1      db ?
status2      db ?
             db '  Addr: '
cs_1         db ?
cs_2         db ?
cs_3         db ?
cs_4         db ?
             db ':'
ip_1         db ?
ip_2         db ?
ip_3         db ?
ip_4         db ?
             db '  '     ;2 spaces
             db ' ST0: '
sto0_1       db ?
sto0_2       db ?
             db ' ST1: '
sto1_1       db ?
sto1_2       db ?
             db ' ST2: '
sto2_1       db ?
sto2_2       db ?
             db '  '     ;2spaces
             db ' C: '
c_1          db ?
c_2          db ?
             db ' H: '
h_1          db ?
h_2          db ?
             db ' R: '
r_1          db ?
r_2          db ?
             db ' N: '
n_1          db ?
n_2          db ?
             db 0ah,0dh
;------------------------------
unin_msg     db 'INT13 no longer active.......$'
inst_msg     db 'INT13 is now installed.......$'
;
newint13:
        sti
        push ax
        push bp
        mov bp,sp
        mov ax,[bp+4]                  ;Retrieve return IP value
        mov cs:save_ip,ax              ;    from stack.
        mov ax,[bp+6]                  ;Retrieve return CS value
        mov cs:save_cs,ax              ;    from stack.
        pop bp                         ;Save anything which will be
        pop ax                         ;    be changed during
        pushf                          ;    processing.
        push di
        push si
        push ds
        push es
        push bx
        push cx
        push dx
        push ax
        mov ax,cs
        mov ds,ax
;---------------DRIVE------------------
        cmp dl,00h                     ;Drive A? (dl=00)
        jne chk1                       ; Note: processing is in place for
        mov drive,drive_a              ;    logging disk activity on all
        jmp drv_exit                   ;    drives, if desired.  See below
chk1:   cmp dl,01h                     ;Drive B?
        jne chk2
        mov drive,drive_b
        jmp drv_exit
chk2:   cmp dl,02h                     ;Drive C?
        jne chk3
        mov drive,drive_c
        jmp drv_exit
chk3:   cmp dl,03h
        jne chkx
        mov drive,drive_d&127;
        jmp drv_exit
chkx:   mov drive,drive_x
drv_exit:
;---------------SIDE  (DH) ------------
        mov ah,dh                      ;record side being requested-left digit
        call leftdig                   ;convert to ASCII code for printing
        mov cs:side1,ah                ;move code to message area
        mov ah,dh                      ;same for right digit
        call rightdig
        mov cs:side2,ah
;---------------TRACK NO. (CH)----------
        mov ah,ch
        call leftdig
        mov cs:track1,ah
        mov ah,ch
        call rightdig
        mov cs:track2,ah
;----------------------------------------
;
;----------------SECTOR NO. (CL)---------
        mov ah,cl
        call leftdig
        mov cs:sector1,ah&127;
        mov ah,cl
        call rightdig
        mov cs:sector2,ah
;------------------------------------------
;
;----------------NO. OF SECTORS (AL)-------
;
        pop ax      ;recall ax
        push ax     ;save it again
        mov ah,al
        call leftdig
        mov cs:sec_cnt1,ah
        pop ax
        push ax
        mov ah,al
        call rightdig
        mov cs:sec_cnt2,ah
;--------------------------------------------------
;
;--------------OPERATION TYPE (AH)-----------------
; 00:reset 01:read status 02:read sectors 03:write sec. 04:verify 05:format
;

        pop ax      ;recall ax
        push ax     ;save it again
        call leftdig
        mov cs:op_1,ah
        pop ax
        push ax
        call rightdig
        mov cs:op_2,ah
;-------------- RETURN ADDRESS CS:IP -------------------
;
        mov ax,cs:save_ip
        call leftdig
        mov cs:ip_1,ah
        mov ax,cs:save_ip
        call rightdig
        mov cs:ip_2,ah
        mov ax,cs:save_ip
        xchg ah,al
        call leftdig
        mov cs:ip_3,ah
        mov ax,cs:save_ip
        xchg ah,al
        call rightdig
        mov cs:ip_4,ah
;
        mov ax,cs:save_cs
        call leftdig
        mov cs:cs_1,ah
        mov ax,cs:save_cs
        call rightdig
        mov cs:cs_2,ah
        mov ax,cs:save_cs
        xchg ah,al
        call leftdig
        mov cs:cs_3,ah
        mov ax,cs:save_cs
        xchg ah,al
        call rightdig
        mov cs:cs_4,ah
;--------------------------------
             pop ax                    ;Restore the things which were
             pop dx                    ;    saved
             pop cx
             pop bx
             pop es
             pop ds
             pop si
             pop di
             popf
;--------------------
             pushf           ; Put flags, CS and IP onto stack for return to
             push cs         ;  routine below after standard int 13h processing
             call intcall    ; IP will point to next instruction
;
;---------------------------Report status of int 13h call----------
;
             pushf
             push bx
             push ax                   ;Save it again
             call leftdig
             mov cs:status1,ah
             pop ax
             push ax
             call rightdig
             mov cs:status2,ah
;
;retrieve the status codes from 0442-0448h
;
             push ds
             assume ds:diskstat
             mov ax,diskstat
             mov ds,ax
             mov ah,st0
             mov cs:save_st0,ah
             mov ah,st1
             mov cs:save_st1,ah
             mov ah,st2
             mov cs:save_st2,ah
             mov ah,cylinder
             mov cs:save_c,ah
             mov ah,head
             mov cs:save_h,ah
             mov ah,record
             mov cs:save_r,ah
             mov ah,number&127;
             mov cs:save_n,ah
             pop ds
             assume ds:cseg
;--------------
             mov ah,cs:save_st0
             call leftdig
             mov cs:sto0_1,ah
             mov ah,cs:save_st0
             call rightdig
             mov cs:sto0_2,ah
                mov ah,cs:save_st1
                call leftdig
                mov cs:sto1_1,ah
                mov ah,cs:save_st1
                call rightdig
                mov cs:sto1_2,ah
                   mov ah,cs:save_st2
                   call leftdig
                   mov cs:sto2_1,ah
                   mov ah,cs:save_st2
                   call rightdig
                   mov cs:sto2_2,ah
             mov ah,cs:save_c
             call leftdig
             mov cs:c_1,ah
             mov ah,cs:save_c
             call rightdig
             mov cs:c_2,ah
                 mov ah,cs:save_h
                 call leftdig
                 mov cs:h_1,ah
                 mov ah,cs:save_h
                 call rightdig
                 mov cs:h_2,ah
                     mov ah,cs:save_r
                     call leftdig
                     mov cs:r_1,ah
                     mov ah,cs:save_r
                     call rightdig
                     mov cs:r_2,ah
                         mov ah,cs:save_n
                         call leftdig
                         mov cs:n_1,ah
                         mov ah,cs:save_n
                         call rightdig
                         mov cs:n_2,ah
             pop ax
             pop bx
;------------  PRINT THE MESSAGE --------------------------
             cmp dl,00h  ;******** REMOVE THESE TWO LINES IF YOU WISH
             jne goback  ;********   ALL DISK ACTIVITY TO BE LOGGED
             push ax
             push cx
             push dx
             push si
             mov cx,87h                ; Length of message
             mov si,offset message
             xor dx,dx
prnloop:     mov ah,00h
             mov al,cs:[si]
             int 17h
             inc si
             loop prnloop
             pop si
             pop dx
             pop cx
             pop ax
goback:      popf
;-------------------------------------------------------
             ret  2          ; Go back to calling program.
                             ; Note:&quot;iret&quot; is not used because the flags
                             ;   would be popped (and we wish to pass back
                             ;   the changed set of flags).  The &quot;2&quot; ensures
                             ;   that the stack is restored by incrementing
                             ;   the stack pointer by two extra bytes.
;-----------------------
intcall      PROC near     ; get set to go to standard int 13h routine
             pushf
             push cs:[redef13 + 2]     ; &quot;cs&quot; of int 13h routine
             push cs:[redef13]         ; &quot;ip&quot; of int 13h routine
             iret                      ; Branch to normal int13h code in ROM
intcall      endp
;--------------------------
;   Routine to convert high-order digit in AH to an ASCII character
;
leftdig      PROC
             and ah,11110000b ; Mask right 4 bits
             shr ah,1         ; Move high-order digit to low-order pos.
             shr ah,1
             shr ah,1
             shr ah,1
             cmp ah,0ah       ; Check for value 0 through 9
             jnb b37          ; If value hex A through F, jump
             add ah,30h       ; Add 30h to make ASCII character
             jmp b2
       b37:  add ah,37h       ; If hex A-F, add 37h to make ASCII character
        b2:  ret
leftdig      endp
;-----------------------
;   Routine to convert low-order digit in AH to an ASCII character
;
rightdig     PROC near
             and ah,00001111b ; mask left 4 bits
             cmp ah,0ah
             jnb a37
             add ah,30h
             jmp a1
       a37:  add ah,37h
        a1:  ret
rightdig     endp
;-----------------------
install:

;     First, determine if INT13 has already been installed...
             push ds                   ;Save DS
             mov ax,0000h
             mov ds,ax                 ;Need 0 in DS
             mov di,int13loc           ;Move 4C to DI
             mov bx,[di]               ;&quot;IP&quot; of current Int 13 routine
             mov ax,[di+2]             ;&quot;CS&quot; of current Int 13 routine
             mov ds,ax                 ;Establish new DS register value
             mov ch,[bx-1]             ;Get byte just before entry point
             pop ds                    ;Restore DS value at entry
             cmp ch,024h               ;Look for a &quot;$&quot;
             je un_inst                ;If =, then Int13 is already active
;     Proceed with installation
             mov ax,0
             mov es,ax
             mov di,int13loc           ;Save old
             mov ax,es:[di]            ;   interrupt 13h
             mov bx,es:[di+2]          ;   vector
             mov si,offset oldint13    ;     &quot;
             mov [si],ax               ;     &quot;
             mov [si+2],bx             ;     &quot;
             mov ax,0
             mov es,ax
             mov bx,ds
             cli                       ;Turn off interrupts
             mov di,int13loc           ;Change int13h ....
             mov ax,offset newint13    ;   vector to...
             mov es:[di],ax            ;   point to...
             mov es:[di+2],bx          ;   this program.
             sti                       ;Turn interrupts back on&127;
             mov dx,offset inst_msg
             mov ah,09h                ;Print string function
             int 21h                   ;Print &quot;install&quot; message
;
;---Check if compressed printing is to be disabled (&quot;8&quot; in parameter string)
;       Note: parameter string begins at offset 81h into COM file header,
;             and offset 80h contains length of parameter string.
;
             mov ax,ds                 ;Make sure ES is the same
             mov es,ax                 ;   as DS
             cmp byte ptr es:[80h],00h ;Length of parm. string
             je no_chng                ;If zero, no change
             mov di,081h               ;Start of parm. string
             mov al,038h               ;38h = &quot;8&quot;
             xor ch,ch                 ;Zero high-order byte
             mov cl,es:[80h]           ;Length of parm. string
             cld                       ;Clear direction flag (forward)
             repne scasb               ;Scan ES:DI 'til match with AL,or CX=0
             jne no_chng               ;No match means &quot;8&quot; not in parm. strng
             mov message,00h           ;&quot;8&quot; found, so zero out compress char.
;----------------------------------------------------------------------------
no_chng:     mov dx,offset install     ;Address of end of resident routine
             int 27h                   ;Terminate and stay resident
;
;----------------------------------------------------------------------------
;
un_inst:     push ds                   ;Save DS again
             mov ds,ax                 ;AX has CS value of current int 13
             mov si,bx                 ;BX has entry point of current int 13
             sub bx,0d2h               ;Backup D2 bytes to find &quot;old&quot; int 13
             mov si,bx                 ;Establish &quot;source&quot; string start point
             mov ax,0h
             mov es,ax                 ;Zero out ES register for move
             mov di,int13loc           ;Establish &quot;destination&quot; (004Ch)
             mov cx,04h                ;4 bytes to move
             cld                       ;Set forward direction for move
             rep movsb                 ;Move from DS:SI to ES:DI until CX=0
;
;At this point, the int 13h vector at 0000:004C has been restored to
;       the value it had when INT13 was previously invoked.
;
             pop ds                    ;Restore entry DS value
             mov dx,offset unin_msg    ;Location of &quot;un-install&quot; message
             mov ah,09h                ;Prepare for printing
             int 21h                   ;Print the message
             int 20h                   ;Terminate
INT13        endp
;----------------------------------------------------------------------------
cseg         ends
end          INT13
</pre>
<br>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_fravia</a><br>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering illegal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>
<!-- Generated by the Home Page Wizard -- CompuServe Inc. --  Last Updated : May 04, 1996  13:15 ->

<html>
<!-- The following HTML tags are the header and title tags.  These tags allows you to specify a title for this page. -->
<head><title>sprayasm</title></head>

<!-- The following HTML tag is the body tag.  This defines the body portion of this page or document. -->
<body>

<!-- The following is an HTML headline tag.  Values for this tag range from H1 (largest) to H6 (smallest). -->
<center><h1>SPRAY.ASM</h1></center>

<!-- The following is an HTML horizontal rule tag (or line). -->
<hr  size=1>

<!-- The following HTML is just plain text. -->
<p><pre>comment }
  SPRAY.COM      program copyright Dave Angel  71046,1567.
                 free for anybody, as long as it's not included with
                 commercial software.  Nominal charge (under $6) okay.

  SPRAY.ASM      This file serves as both documentation and source code.
                 The program was written in response to a message by
                 Joe Wallace 21550,6003, who wanted a program to dump
                 memory after an accidental abort of some other program.

                 The program was entered with KEDIT, assembled with MASM
                 5.1, and debugged with SYMDEB.  There are several known
                 simplifications, to keep it small.

                 It only parses the command line to the extent that if the
                 command line is non-blank it gives the copyright message.
                 If run with a blank line, it dumps memory from its own end
                 to the 640k boundary.  If you have some other amount of
                 memory, change the line below containing '**memory' as
                 appropriate.

                 It outputs to standard out, and you have to redirect it if
                 you want it in a disk file.  So you'd run   SPRAY&gt;C:\temp
                 to get it to dump to a file on C: called temp.

                 Finally, it will go somewhat beyond the (640k) limit, as
                 much as 63.9 k beyond.  This is no problem on most
                 systems, you just may get a bit of garbage at the end.
                 But on a few systems you may get funny errors accessing
                 that memory.  If so, the 'nextsegment' logic needs to be
                 tightened up, to handle the final, partial segment.

                 Good luck.  Any suggestions or improvements welcome.
                 Dave Angel  Compuserve 71046,1456    or    Genie   D.Angel
                 July 27, 1989

}
CGROUP  group  CODE
CODE    segment
        org     100h
     assume  cs:CODE, DS:CODE
start   proc    near
        mov     sp,100h
        cmp     byte ptr ds:[80h],0
        jz      start2
        mov     dx,offset CGROUP:helpmessage
        mov     ah,9
        int     21h
        jmp     next2
helpmessage     db    'SPRAY  copyright 1989 by Dave Angel 71046,1567',13,10
                db    '   free software to dump memory to stdout',13,10,'$'

start2:
        mov     di,offset CGROUP:endcode
        mov     si,offset CGROUP:endcode+5  ; source starting address
        cld
        mov     cx,78
        xor     bx,bx           ; bx is count of printables 'in-a-row'
loop1:
        cmp     si,0fff0h
        jb      loop1a
        call    nextsegment        ; call if we're at end of segment
loop1a:
        lodsb                   ; retrieve one byte
        cmp     al,20h
        jb      loop5
        cmp     al,7fh
        ja      loop5           ; skip if unprintable character
;  found a printable character
loop2:
        stosb
        inc     bx
        loop    loop1
; we've printed enough on this line, go to next
loop3:
        mov     al,0dh
        stosb
        mov     al,0ah
        stosb
        call    flushoutput             ; write the data so far
        xor     bx,bx
        loop    loop1

;  We found a non-printable
loop5:
        cmp     bx,3
        ja      loop5a          ; skip if at least 3 printables in a row
        sub     di,bx
        add     cx,bx           ; back up over them, if 3 or less
        jmp     loop5b
loop5a:
        cmp     cx,8
        jb      loop3           ; if near the end of line, make a new one
        mov     al,20h
        stosb
        dec     cx
        stosb           ; otherwise, add two spaces and keep scanning
loop5b:
        dec     cx
loop6:
        xor     bx,bx           ; zero 'printables in-a-row'
        cmp     si,0fff0h
        jb      loop6a
        call    nextsegment        ; call if we're at end of segment
loop6a:
        lodsb
        cmp     al,20h
        jb      loop6
        cmp     al,7fh
        ja      loop6           ; ignore any more unprintables
        jmp     loop2
start   endp

flushoutput     proc    near
;  DI points one beyond last character of buffer.  So write from
;    endcode to one less than DI
        mov     cx,di
        mov     dx,offset CGROUP:endcode            ; address
        sub     cx,dx           ; count
        mov     bx,1            ; standard out
        mov     ah,40h
        push    ds
        push    cs
        pop     ds
        int     21h             ; write the line to stdout
        pop     ds
     ; ignore errors
        mov     di,offset cgroup:endcode
        mov     cx,78
        ret
flushoutput     endp


nextsegment     proc    near
;  this routine is only called when SI exceeds FFF0
;  here's where we move to another segment, and check for 640k.  We adjust
;  DS and SI, and return, if still more to do.

        push    bx              ; save bx
        mov     bx,0a000h       ; end of **memory assumed to be A000
        mov     ax,ds
        add     ax,0fffh
        sub     si,0fff0h
        mov     ds,ax
; notice, we're being sloppy here, and dumping as much as 63.9k beyond 640k
        cmp     ax,bx
        jae     next2
        pop     bx              ; restore bx
        ret                     ; return if still more memory to go
next2:
        mov     ax,4c00h
        int     21h
nextsegment     endp
endcode label   byte
CODE    ends
        end     start
</pre></p>

</body>
</html>
<html>
<head></head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>



<pRE><center><font size=+2>Dongles are NOT dead! (programmers: use them!)</font><font size=+1>
by Jack of Shadows</fonT>
21 February 1998

<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm" onMouseOver="window.status='Yessir, back to project 3'; return true"><IMG SRC="images/javascri.gif" tppabs="http://members.xoom.com/tsehp_/images/javascri.gif" 
ALT="project 3 page" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 
VSPACE=0 HSPACE=0></a><br><font color=gray>Back to project 3</font></center>



Reverser, hi!

I was stimulated to write you mail while reading the article Dongle Bashing
(quite nice, by the way). I must definitely agree with Frog's print that
most commercial producers don't use their brain in building the program
protection but I definitely disagree with idea that dongles are mostly
useless. You just have to use them the right way. So let's take a look at
how the dongles could be used correctly.

First, I must admit two things. My dongle knowledge is intimately connected
to German producer FAST and their Hardlock E.Y.E. (very nice dongle,
really). My protection writing knowledge is so far tightly connected to DOS
(real and protected mode). I hope that my ideas could be implemented in
Win32 (I will found this out in the next weeks ' update follows if you
think it will be interesting reading).

OK, let's set up some basic rules. I won't talk about time protections etc
since mostly anything that could be said about that had already been said.
Let's just say that we would like to distribute some crippleware over the
Net and be later able to activate its functions with a key. That way we
could put a 'fully' function version of our latest program on the net with
the only one 'feature' that save, print, export' functions are disabled.
Registered users would receive the key which would enable those functions.

When designing a protection system I follow the first rule of cryptography:
'System is only secure if you can distribute its source code, operation
principles and all knowledge that was build into and still nobody can crack
it'. If it is working for cryptography it must work for the program
protection also. So let's take a new look at the protection along those
premises.

Let us assume that cracker will have access to the program assembly code
(no problem those days thanks to IDA), could trace the runtime behavior (no
problem thanks to SoftICE) and would be able to trace communications
between dongle and program (no problem if we use another computer with two
parallel ports and appropriate software). If the disabled functions we were
talking about before (save, print') are present in the program, we can be
sure that cracker will find them and activate them. OK, so they must not be
present in a usable form but must be somehow encrypted. And we have a right
tool for the job - dongle!

As I have said before I don't know other dongles but Hardlock works along
quite an interesting principles. Basically it encodes any 8 bytes you send
to it and returns 8 encoded bytes. Encoding functions is bijective so we
can send resulting 8 bytes to the dongle and receive original 8 bytes.
Hardlock can therefore server as encryption function.

Even nicer property is that FAST builds into every Hardlock the customer
number of its buyer. Keys with different customer numbers behave
differently when coding/encoding. So nobody can buy a key at FAST and use
it to crack your program.

Now you probably have a pretty clear picture what I have in mind. Mark a
functions that have to be disabled in source code. Compile the program.
Encrypt marked functions with a dongle. Put program on Net. User without a
dongle has no way of guessing the code for missing functions. Add a dongle
and program becomes fully functional.

Probable ways of attack:
1. Guess what first few bytes of a function must be and guess a dongle
function.
Pretty small chances but maybe possible. Can be easily defeated by
prefixing functions to be encrypted with a few random characters.

2. Buy one copy of a program and crack it so you can use it on more than
one machine at the same time.
Much easier but can still be made a tough problem. Let's see how a
fictitious cracker can attack our program.
a) Log all communications between computer and dongle. Make EPROM with
data/encrypted data pairs. Add a processor and some logic and package it
into a dongle.
Countermeasure: don't just decode the program through the dongle but keep
the constant flow of random data interleaved with the real encryption. Make
this data pseudorandom (always use the same seed) so the cracker cannot
compare data flow from two program executions and eliminate random data.
Remember some of the returned data, send it through dongle later and
compare the results with original data. Use your immagination.
b) Wait till the program is decrypted and save in-memory copy to the disk.
Write a loader for this copy.
Countermeasure: don't decode whole program. Decode some parts when you need
them and encode others at the same time (remember, decode and encode are
really the same function!). Repeat. It is still possible to crack this
program since you have to keep track of which part of the program are
encoded but the problem is very very complicated.
c) Maybe some other form of the attack I couldn't think of'

Similar way of crippling the program can be used without a dongle. Encrypt
part of the program with cryptographic strong function. Use the key to
decrypt the program. Key is never compared to anything which is good but is
the same for all users which is bad. Alternatively: user must send you some
ID that uniquely represents your computer and which is generated by the
program. You return to the user some unlock code. He enters the code, it is
in some way combined with the computer ID and the result is decryption key.
Program is not saved to disk in decrypted form, of course, only the unlock
code is remembered (in open place since it is of no use on the other
computer which has different computer ID). Much less safe then dongle since
you must hide and protect the mechanism which combines computer ID and
unlock code but still pretty safe.

If we take this to the limits, the whole program can be encryped. Startup
code uses a fixed key to decrypt and run the program every time (resulting
program can still use all the tricks mentioned above) so this is no
protection in itself but just a weapon against disassemblers.

Be that enough for today. Publish if you think this rambling of mine is of
any interest to your faithful readers.

                                    Jack of Shadows</prE>
        <hr>
<center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<a href="http://www.dejanews.com/"  onMouseOver="window.status='(A stalking utility :-)'; return true"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0></a><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm" onMouseOver="window.status='An amazing useful link'; return true">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</A><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
</body>
</HTML><!-- saved from url=(0022)http://internet.e-mail -->
<html>
<head>
<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp">
<title>marigbox.htm Opening Vbox</title></head>

<body bgcolor="#C0C0C0" text="#001010" vlink="#405040">
<center>
<a href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm"><img src="images/timelock.gif" tppabs="http://members.xoom.com/tsehp_/images/timelock.gif" alt="timelock" align="center" border="0" width="114" height="43"></a><br>
<font color="#808080">The Timelock project</font><br>
<br>
<bR><font size=+2>PreviewParadise R.I.P. (vboxed programs... bye bye!)<br>by Xoanon</font><bR>15 June 1998
<bR><bR>
<i>Well, well, well... sieh mal Eine an: the return of a great 
cracker... and the demise of an improved timelock.dll protection. How long will we have to 
repeat it? C-O-M-M-E-R-C-I-A-L R-E-A-D-Y M-A-D-E P-R-O-T-E-C-T-I-O-N-S A-R-E U-S-E-L-E-S-S.<br>
Learn how to protect (on these very pages for instance) and then PROTECT YOURSELF your programs 
with a couple of assembly routines. They will be eventually defeated, of course, but NEVER so 
quickly and easily as a commercial protection can invariably be... man-o-man: learn to READ behind the hypes and frills, 
and then you'll never believe again what the commercial protectionists  
advertise (or anybody else for that matter: to advertise <u>means</u> to lie :-)<bR>
On one point Xoanon is dead wrong: I love him a lot, and hope that he will indulge in less 
maggots, 
more women and more reversing!<br>You will also notice that Xoanon is the mind behind the 'rolling' 
of the whole 'timelock' +HCU project... and if you had forgot it, just read <A HREF="xoanon.htm" tppabs="http://members.xoom.com/tsehp_/xoanon.htm">TimeLOCK_DLL reverse engineering (TL32V20.DLL)</a>, 
written more than ONE YEAR ago (a whole "epoque" on the Web) yet still valid!</i>
<p><br>


<hr>
<font size="5"><!-- CHOOSE A TITLE (wont probably be changed) --></font>

<p align="center"><font size="5">VBox (05/98 - 06/98)</font><br>
<font size="5"><!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->PreviewParadise R.I.P. </font><br>
<font color="#0B7FC1"><!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by xOANON [UCF/CLASS] </font><br>
<br>
<!-- INTRO STARTS HERE --></p>

<table border="1" width="760" height="22">
    <tr>
        <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Introduction</font></td>
    </tr>
</table>
</center>
<p><!-- PASTE HERE YOUR INTRODUCTION -->
Heya ol' Reverser+! Long time i'm not on your pages :) It's time
to come back i think..... Don't bug me if i don't support +HCU
as often as it would deserve, but you know.... i'm one of the
&quot;crackers-for-the-masses&quot; you don't love so much :)
Well, it's a choice... i like people use my cracks, i like to be
known, etc... But it's another story.</p>

<p>Last week i found a program called &quot;Script Driven
Internet&quot; and it appeared as protected with VBox. I read the
essay last month by <a href="marigbox.htm" tppabs="http://members.xoom.com/tsehp_/marigbox.htm">Marigold</a>
(very interesting indeed), so i took a look at it just to know
something more about this protection.</p>

<p>Marigold (amazing) technics is the virginity-restoration, i
present here a patching method instead.... much clear, much (not
so) easier and (i think) much useful coz it's goal is to produce
an universal cracked DLL which you can put in you \WINDOWS\SYSTEM
to crack *EVERY* Vboxed program.<br>
<!-- TOOLS STARTS HERE --></p>

<table border="1" width="100%" height="22">
 <tr>
  <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Tools required</font></td>
 </tr>
</table>

<p>SoftIce <br>
W32D/ASM <br>
Your favourite HexEditor<br>
Cigarettes (5)<br>
A fan (very hot here)<br>
Some good grunge music (Nirvana, Stone Temple Pilots, etc...)</p>

<p><!-- TOOLS STARTS HERE --></p>

<table border="1" width="100%" height="22">
 <tr>
  <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Target's URL/FTP </font></td>
 </tr>
</table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
<p><a href="ftp://ftp.previewsoftware.com/VboxBuilder.exe" tppabs="ftp://ftp.previewsoftware.com/VboxBuilder.exe">VBox
Builder</a> (a tool to add Vbox to your programs, very useful for
cracking purposes too.... eheheh :)</p>

<p><br>
<!-- PROGRAM HISTORY STARTS HERE --></p>

<table border="1" width="100%" height="22">
 <tr>
  <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Program History</font></td>
 </tr>
</table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
<p>TimeLock by PreviewSoft has long and glorious <a
href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm">history </a>(of its cracking). Vbox is
&quot;a new beginning&quot; of a kind. It's different from its
predecessors almost to the loss of the ancestorial resemblance.<br>
<br>
<!-- REAL ESSAY  STARTS HERE --></p>

<table border="1" width="100%" height="22">
    <tr>
        <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Essay</font></td>
    </tr>
</table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED!
     SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
<p>Here we are.... let's start. First of all, install the VBox
builder (you need to get a .prv file from their webserver, so
connect to the internet for this and fill the form needed). Then
choose a .EXE file to protect (you could choose also a .DLL or an
.OCX, but choose an .EXE coz it's better and easier for cracking
purposes) and wrap it with VBox using the builder (choose now the
Trial days protection).</p>

<p>Now the fun begins. As Marigold says, and as we easily can
see, VBox protections const of 3 dlls which are copied into your
\WINDOWS\SYSTEM directories. These DLLs are : <strong>vboxp403.dll
- vboxb403.dll - vboxt403.dll</strong>. All these dlls except the
first are packed, so we will focus our attention on <strong>vboxp403.dll</strong>.This
dll acts as a loader/unpacker for the others (among the other
things, again just look at marigold's essay for a complete
explanation), so i tought this: if i find the code which unpacks
the dll, right after the unpacking i can patch <strong>*from
inside of vboxp403.dll*</strong> the protection code which
resides in <strong>vboxt403.dll</strong> memoryspace .... and i
did :) Smart approach isn't it ? :) </p>

<p>Note: This kind of patching can be done much easily with a
memory patch (see <a href="stone1.htm" tppabs="http://members.xoom.com/tsehp_/stone1.htm">Stone</a>'s
essay), but memorypatch always need a loader, or a TSR-like
program to load just before the target. In this way, we can
obtain (as i said) a clean and universal crack which only need to
be copied in place of the original DLL.</p>

<p>So, stop talking and go on with cracking now......</p>

<p>First of all, move your system clock ahead so the target
expires.</p>

<p>Now, you VBoxed your .EXE with Trial days protection, right?
so it will be vulnerable to BPX GETLOCALTIME from our beloved
SoftICE. You will land in this code (after PRET from the API
routine) inside <strong>vboxp403.dll. </strong>We will use the
space of this code later to add our memorypatching code.</p>

<p>------------------------------------------------------------------------------------------------------------------------------</p>

<p>
:0500E720 81ECCC000000           sub esp, 000000CC<br><a name="0500E726">
:0500E726 </a>8D442410           lea eax, dword ptr [esp+10] <strong>*we will add memorypatch code here later*</strong><br>
:0500E72A 56                     push esi<br>
:0500E72B 50                     push eax<br>
<br>
* Reference To: KERNEL32.GetLocalTime, Ord:00F5h<br>
|<br>
:0500E72C FF1544C50105 Call dword ptr [0501C544]<br>
:0500E732 8D4C2404 lea ecx, dword ptr [esp+04]<br>
:0500E736 51 push ecx<br>
<br>
* Reference To: KERNEL32.GetSystemTime, Ord:0135h<br>
|<br>
:0500E737 FF1540C50105 Call dword ptr [0501C540]<br>
:0500E73D 668B4C240E mov cx, word ptr [esp+0E]<br>
:0500E742 66390D32AC0105 cmp word ptr [0501AC32], cx<br>
:0500E749 7540 jne 0500E78B<br>
:0500E74B 668B44240C mov ax, word ptr [esp+0C]<br>
:0500E750 66390530AC0105 cmp word ptr [0501AC30], ax<br>
:0500E757 7532 jne 0500E78B<br>
</p>

<p>(......... etc..... etc......... )</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>Going ahead with tracing, you will find this code in <strong>vboxt403.dll</strong>
which checks if the target is expired or not :</p>

<p>:07005EFB F6451408 cmp eax, [ebp+10]<br>
:07005EFE 7402 jz 7005F02 <strong>*NOP it*</strong></p>

<p>and</p>

<p>:7005FAA 3B45F0 cmp eax, [ebp+10]<br>
:7005FAD 751A jnz 7005FC9 <strong>* change it to JMP 7005FC9 *</strong></p>

<p>Ok, now theoretically our patch is done.... VBox screen will
not appear anymore BUT: we just did it in memory, how to apply it
on the file if <strong>vboxt403.dll </strong>is packed?</p>

<p>Here comes a little Zen, as our +teacher says.... We know that
dll must be unpacked somewhere, so let's start hunting for the
unpacking routine setting a <strong>BPM 7005EFE W</strong>
(breakpoint on memory range on write). This means SoftICE will
popup just when this memoryspace is accessed for writing (which
is, in our case, the unpacking of <strong>vboxt403.dll</strong>).</p>

<p>Ok, so set this breakpoint and rerun. You will land in our
beloved <strong>vboxp403.dll</strong> here:</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>:0500E856 8BD1 mov edx, ecx<br>
:0500E858 83E203 and edx, 00000003<br>
:0500E85B C1E902 shr ecx, 02<br>
:0500E85E F3 repz<br>
:0500E85F A5 movsd <strong>*this write the unpacked code to
DS:EDI*</strong><br>
:0500E860 FF249568E80005 jmp dword ptr [4*edx+0500E868]<br>
:0500E867 90 nop<br>
</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>As you will notice, this routine is executed many times, since
the unpacking is done at little steps. Anyway, we will focus our
attention just when <strong>EDI</strong> reach 07007000. Why?
well, simple: since we want to patch at DS:7005xxx, if EDI reach
07007000 it means the code we need is already unpacked and ready
for our &quot;rape&quot; :). </p>

<p>Now, problem #2 : we need space to do our memory patch. Easy,
look at <a href="xoa_126.htm#0500E726">here</a>.... this code is of no more
use, since the protection is killed. So we can use the
memoryspace of this datecheck code to implement our memorypatch.</p>

<p>First of all, we have to locate the call to this routine and
NOP it, since we want to use it for our purpose. Here it is:</p>

<p>:05002880 6A00 push 00000000<br>
:05002882 E899BE0000 call 0500E720 <strong>* just NOP this and
the DLL will not call the datecheck anymore *</strong><br>
:05002887 83C404 add esp, 00000004<br>
:0500288A 50 push eax<br>
</p>

<p>Now for the memorypatch. We have to jump to our routine right?
so we need to modify this code right after the <strong>vboxt403.dll</strong>
is unpacked in memory:</p>

<p>change </p>

<p>:0500E860 FF249568E80005 jmp dword ptr [4*edx+0500E868] </p>

<p>to</p>

<p>:0500E860 E9C1FEFFFF909090 jmp 500E726 <strong>*ok, now this
jump to the entrypoint of our routine*</strong></p>

<p>Here is the memorypatch routine:</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>:0500E726 81FF00700007 cmp edi, 07007000 <strong>*check if the
code we need to patch is unpacked yet*</strong><br>
:0500E72C 7519 jne 0500E747 <strong>*act normally if not*</strong><br>
:0500E72E 66C787FEEEFFFF9090 mov word ptr [edi+FFFFEEFE], 9090 <strong>*patch
at EDI-1102 = 7005EFE*</strong><br>
:0500E737 C687ADEFFFFFEB mov byte ptr [edi+FFFFEFAD], EB <strong>*patch
at EDI-1053 = 7005FA0*</strong><br>
:0500E73E 66C787A5EEFFFF9090 mov word ptr [edi+FFFFEEA5], 9090 <strong>*patch
at EDI-115B = 7005EA5*</strong><br>
<br>
* Referenced by a (U)nconditional or (C)onditional Jump at
Address:<br>
|:0500E72C(C)<br>
|<br>
:0500E747 FF249568E80005 jmp dword ptr [4*edx+0500E868] <strong>*this
is the normal jump executed after unpacking*</strong><br>
:0500E74E 90 nop<br>
:0500E74F 90 nop<br>
</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>You notice i've done another patch at 0500E73E . What's it
about? well, it patch this code</p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>:7005E9C F6451408 test byte ptr [ebp+14],08<br>
:7005EA0 BE01000000 mov esi, 00000001<br>
:7005EA5 745B jz 7005F02 <strong>*NOP it*</strong></p>

<p>-----------------------------------------------------------------------------------------------------------------------------</p>

<p>which bypass the &quot;number of executions&quot; check
(another option of VBox, try it with the builder).</p>

<p>Well.... that's all. VBox is totally dead now, thanks to
Marigold and your little xOANINO :) Go patch the <strong>vboxp403.dll</strong>
according to this essay, copy it to your \WINDOWS\SYSTEM
overwriting the original one and say &quot;CIAO CIAO&quot; to
WeiJuhn Li :)</p>

<p>Alla prossima amici... e speriamo che l'Italia vinca 'sti
mondiali.... anche se dopo la partita di ieri mi sembra
improbabile :(</p>

<p>&nbsp;</p>

<table border="1" width="100%" height="22">
    <tr>
        <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Final
        Notes</font></td>
    </tr>
</table>

<p>I hope you all liked this essay. As you see, commercial
ready-made protections are not so secure as they claim (look at <a
href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">http://www.previewsoftware.com</a>
and laugh.... they say even SoftICE creators can't crack VBox and
TimeLock, i can't believe it). There would be lot of ways to do a
very secure protection (like using a decent PE-crypter), but
maybe they think all of us +HCUkers are stupid.... bah :)</p>

<p>My greets fly out to: All UCF and CLASS members, Devil, Stone,
Miramax, Marquis, Random, SpaceOne, SaiBada, Goku, SoftPJ
(pleeeeeeeeeease improve your E-Zine) :)</p>

<p><br>
<!-- OB DUH STARTS HERE --></p>

<table border="1" width="100%" height="22">
 <tr>
  <td bgcolor="#C6E7C6"><font color="#0000FF" size="5">Ob Duh</font></td>
 </tr>
</table>

<p align="center"><i>I wont even bother explaining you that you
should BUY this target program if you intend to use it for a
longer period than the allowed one. Should you want to STEAL this
software instead, you don't need to crack its prot ection scheme
at all: you'll find it on most Warez sites, complete and already
regged, farewell.<!-- WAY OUT STARTS HERE --></i></p>

<hr>

<p align="center"><i>You are deep inside reverser's page of reverse engineering, choose your way out:</i><br>
<!-- EITHER A NICE GIF LIKE THIS --><a href="timelock.htm" tppabs="http://members.xoom.com/tsehp_/timelock.htm"><img src="images/timelock.gif" tppabs="http://members.xoom.com/tsehp_/images/timelock.gif" alt="timelock"
align="center" border="0" width="114" height="43"></a><br>
<font color="#808080">Back to the Timelock project</font><br>
<br>
<!-- OR JUST A LINK LIKE THIS -->
<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A>
<hr width=33%>
-->
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"> academy database</a>
<br>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"> reality cracking</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm"> how to search</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm"> javascript wars</a>
<br>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity academy</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</a>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_reverser</a>
<br>
<img src="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" alt="red" width="13" height="13"><a href="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</a></p>

<hr>
</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>crunchi6.htm: Little essay about the various methods and viewpoints of crunching</title>
</head>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>+HCU papers</fonT><br><br>
<font size=+6><font color=blue>Little essay about the various methods and viewpoints of crunching</font></font>
<br>
~ version September 1998 ~<bR>
by Joa Part VI
<br>


<hr>Courtesy of reverser's page of reverse engineering<bR>
<hR></center><p>
<p>

Well, Joa continues his fundamental paper on crunching, this is part VI<br>enjoy!<p>
<table border=1>
<TR><TD HEIGHT="33">10 July 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi1.htm" tppabs="http://members.xoom.com/tsehp_/crunchi1.htm" >crunchi1.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0126</TD></TR>

<TR><TD HEIGHT="33">10 June 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi2.htm" tppabs="http://members.xoom.com/tsehp_/crunchi2.htm" >crunchi2.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching II
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0129</TD></TR>

<TR><TD HEIGHT="33">17 June 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi3.htm" tppabs="http://members.xoom.com/tsehp_/crunchi3.htm">crunchi3.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching III
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_012E</TD></TR>

<TR><TD HEIGHT="33">17 June 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi4.htm" tppabs="http://members.xoom.com/tsehp_/crunchi4.htm">crunchi4.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching IV
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_012F</TD></TR>



<TR><TD HEIGHT="33">10 July 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi5.htm" tppabs="http://members.xoom.com/tsehp_/crunchi5.htm">crunchi5.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching V
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0133</TD></TR>


<TR><TD HEIGHT="33">16 September 98</TD><TD>
Joa
</TD><TD>~</TD><TD>
<a href="crunchi6.htm" tppabs="http://members.xoom.com/tsehp_/crunchi6.htm">crunchi6.htm</a>
</TD><td>Little essay about the various methods and viewpoints of crunching VI
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0133</TD></TR>



</table></center>
<hR><pre>
Little essay about the various methods and viewpoints of crunching.

Part VI: The secret of Zip and Rar (LZW explained)



By Joa Koester (JoKo2000@HotMail.Com)
This essay is free to be copied and read and spread as long as
you are decent enough to leave my name in it.
If you have corrections, comments, better examples than the ones used
in this essay etc. - drop me a line.


Last time i showed you how you could reach enormous crunch-ratios using the
LZ77-technique. I wouldn't wonder if someone would build a protection system
upon it. You'd just have to allocate some stackspace for your routine, decrunch
it into the stack and execute it. You'd would have to switch to a
decrunch-from-behind version and just by copying the decrunching routine into
the stack the final crunches would overwrite the last decrunch-loop part
thus immediately executing the decrunched routine afterwards.

But back to crunching. Soon after publishing the LZ77 alg Lempel and Ziv
fumbled a little bit around and came up with another table-oriented crunching
alg. While LZ77 used a Offset-Length pair to implement a reference to some
already passed data, LZ78 walked a completely different path. Lempel and Ziv
came up with an idea of directly addressing a table. In this table there would
be the strings they passed. The only thing you'd have to do would be to
derefernce the table entries down to the strings and you would have a crunch.

The table would start with a null-string. One Byte would be read ahead. One
acutal string would be initialized with this read-ahead byte. Then you'd check
if you already had this string in your table. If not, you would output it and
afterwards you'd add this string to your table. If you already had this string
in your table you'd read another byte and add it to your string. It is
important to notice that the last string to be output build up from a known
string in the table plus a new char.
Mark Nelson, a good source for crunching (next to Charles Bloom),
shows this alg quite clear:

for (;;)    //until the end of the file
{
  act_phrase = 0;   //the zero string
  act_len = 0;
  memset (test_string, 0x00, MAX_STRING);

  //...........................................................................
  for (;;)
  {
    test_string[act_len++] = getc(input);
    new_phrase = search_phrase_in_table(test_string); // is test_string in
                                                      // table?

    if (new_phrase == -1)   // no
    {
      break;                // then break out of inner loop
    }
    //else
    act_phrase = new_phrase // else set new actual phrase
  }
  //...........................................................................
  //Here we breaked out of the inner loop. This could happen, because of EOF or
  //because a string could not be found in the table (in case of EOF this will
  //happen, too, of course ;)
  output(act_phrase);            //output the reference of the table
  output(test_string[act_len -1] ); //afterwards output the difference char
  add_string_to_table(test_string); //and actualize table
}

Let's crunch the following term together:

0123456789a iwobiwoiwoi


Our table is empty in the beginning except for a null-string at pos 1.

pos:  0
act_phrase = 0;
act_len = 0;
test_string = [0x00, 0x00, 0x00...]


Ok, we enter the first char: i

                ...test_string[act_len++] = getc(input);...
char: 'i'
pos:  0
act_phrase = 0;
act_len = 1;
test_string = ['i', 0x00, 0x00...]
table = [ {"", 0} ]


                After the search, new_phrase is -1, so we break


  output(act_phrase);            //output the reference of the table
  output(test_string[act_len -1] ); //afterwards output the difference char
  add_string_to_table(test_string); //and actualize table

our output is: {0}i

We output the act_phrase (0) and output the 'i' afterwards. Then we update the
table with the 'i'-entry and jump back to our loop.

pos:  1
act_phrase = 0;
act_len = 0;
test_string = [0x00, 0x00, 0x00...]

enter char (w)

char: 'w'
pos:  1
act_phrase = 0;
act_len = 1;
test_string = ['w', 0x00, 0x00...]
table = [ {"", 0}, {"i", 1} ]

                After the search, new_phrase is -1, so we break

  output(act_phrase);            //output the reference of the table
  output(test_string[act_len -1] ); //afterwards output the difference char
  add_string_to_table(test_string); //and actualize table

We output the act_phrase (0) and output the 'w' afterwards. Then we update the
table with the 'w'-entry and jump back to our loop.

[...]
for the chars 'o' and 'b' it's the same. We reenter on the next 'i'

pos:  4
act_phrase = 0;
act_len = 0;
test_string = [0x00, 0x00, 0x00...]

enter char (i)

char: 'i'
pos:  4
act_phrase = 0;
act_len = 1;
test_string = ['i', 0x00, 0x00...]
table = [ {"", 0}, {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4} ]

    new_phrase = search_phrase_in_table(test_string); // is test_string in
                                                      // table?

    yes, it is, so

            act_phrase = new_phrase (1 in this case)

    and back to our inner loop.

char: 'w'
pos:  5
act_phrase = 1;
act_len = 2;
test_string = ['i', 'w', 0x00...]
table = [ {"", 0}, {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4} ]

    Do we have a 'iw' in our table? don't think so. That means next step we
    break.

  output(act_phrase);               // (1 in this case)
  output(test_string[act_len -1] ); // (w in this case)
  add_string_to_table(test_string);

and to the next char...


char: 'o'
pos:  6
act_phrase = 0;
act_len = 1;
test_string = ['o', 0x00, 0x00...]
table = [ {"", 0}, {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4}, {"iw", 5} ]

    well, we have an 'o' in our table, so the string is extended with the
    next char: 'i'.

char: 'i'
pos:  7
act_phrase = 3;
act_len = 1;
test_string = ['o', 'i', 0x00...]
table = [ {"", 0}, {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4}, {"iw", 5} ]


    Some 'oi' here? No, sir. no 'oi' here. We break and write:

  output(act_phrase);               // (3 in this case)
  output(test_string[act_len -1] ); // (i in this case)
  add_string_to_table(test_string);

the next char is the 'w':

char: 'w'
pos:  8
act_phrase = 0;
act_len = 1;
test_string = ['w', 0x00, 0x00...]
table = [ {"", 0}  , {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4}, {"iw", 5},
          {"oi", 6} ]

after adding the next char (coz 'w' is in our table) we have:

char: 'o'
pos:  9
act_phrase = 3;
act_len = 1;
test_string = ['w', 'o', 0x00...]
table = [ {"", 0}, {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4}, {"iw", 5},
          {"oi", 6} ]

    Some 'wo' here? Nope. We break and write:

  output(act_phrase);               // (2 in this case)
  output(test_string[act_len -1] ); // (o in this case)
  add_string_to_table(test_string);

The final char (plus EOF) is confronted with the following table:

table = [ {"", 0}  , {"i", 1}, {"w", 2}, {"o", 3}, {"b", 4}, {"iw", 5},
          {"oi", 6}, {"wo", 7} ]

then the i+EOF is added to the table.


The output we produced so far (spaces inserted for clarity):

{0}i {0}w {0}o {0}b {1}w {3}i {2}o {1}EOF

Hmm. This doesn't look like an algorithm which produces good results in small
files. But think about this: if there would have been another "iwo" at the end
of the file instead the 'i' we would have coded {5}o thus saving us two bytes.
And for the next 'iwo' we would have had a new table entry ready. This means
that the algorithm manages inequally long strings with just one entry
reference. If our reference is shorter than the string, we crunch. Normally we
achieve an increasing crunch-ratio after ca. 100 bytes. From that moment on our
table begins to fill with strings longer than one byte and from that moment on
we save bits with every reference we write.

I have a question, sir...

Yes, Watson?

This table-reference - how big should that table be and how do we code the
reference? And while i'm at the point: How do we search the table? This will be
the most time-consuming part, i think. And, oh yes, what if the table is full?


You are absolutely right, Watson.
Good questions!

OK!

How do we search the table FAST? Well, to be honest, i do not prefer one method
over the other. One good method would be to implement a hash-table. In C++ you
would implment a Set of Strings and hope that the implementation from your
compiler vendor is fast enough to handle some 100 Kbyte Strings. Another way
would be to allocate a biiiiig amount of memory (premise: size MOD 256 == 0),
divide it by 256 and reserve these chunks for the according ascii-values). With
this method you would have equally long maximumsized strings ready for
binary-searching and overwriting. These chunks would then be filled with the
string and a timestamp. if our chunk was full, the next time we would have to
add a string we would delete the earliest one (or maybe two or three) and could
add the new string.
I know that this method screams "RAM WASTE!!! RAM WASTE!!!", but let me tell
you that the ACB-cruncher from George Buyanovsky needs 16 MByte RAM in one
chunk to work. We will deal with 256 MByte RAM on every average PC within the
next 5 years. Not just because RAM gets cheaper every minute, but because the
average user wants to scan and digitize things (in 1998: buy three CDs or a
scanner. What do you think we will be in 5 years?).
A good tablesearch-algorithm is the stand-or-fall part of the cruncher.

As far as i'm concerned: Let the cruncher take as much memory as possible.

If you have 32 MB reserved in one piece and you want a maximum stringlen of 128
Byte per string you will have 33554432 / 256 =  131072 Bytes per chunk.
And 131072 / 128 = 1024 Strings per chunk. The more you reduce your stringlen,
the more strings you can pack into the chunk. Reducing the maximum stringlen
down to 64 brings you 4096 strings per chunk. This is quite good. 4096 strings
just for one ascii-slot.

Well, the way we code the reference is completely ours. We should take a look
back to our LZ77 essay and let our phantasy roam. From the most stupid 8+12 bit
reference (gives us crunching only at minimum 4 byte strinlen) to unary +
your_stuff - everything is possible. However it should be fast.


The coding part is pretty easy, isn't it? You could theoretically write a LZ78
cruncher in Visual Basic in a few hours and it would actually work.
And what about the decoding part? Well, no problems here, too. The decruncher
starts with the same emptied model (emptied table) as the cruncher:


  New_String = Take the first code from decoding a bit_input
  output NewString
  take the next char
  output it
  add char to New_String
  add New_String into table.
repeat until EOF



//.............................................................................
While this method is pretty good and pretty easy to implement, 1984 Terry
Welch came up with a fundamental improvement of this algorithm. Since then the
term LZW is also common. Welch had the idea that one could pre-create a table
(with the first 256 possible chars) and that the algorithm would only output
table-references.

With this trick one could create a huffman-tree for all those codes one writes
thus letting us write even fewer bits (there is a method of writing even fewer
bits than Huffman - arithmetic coding, but we'll come to this later).

So, how does this LZW work? Let's have a look:

The basic LZW-algorithm:

//Read ahead because we definitively know every single char
oldString[0] = getc(input);
oldString[1] = 0x00;

while (! eof(input))
{
  c = getc(input);                //We get the second string from our input
  strcpy(newString, oldString);   //and save the oldstring into the search
                                  //string. The first time the oldstring is
                                  //our very first char of our input. But
                                  //later it will be longer strings.

  strncat (newString, &c, 1);     //add the actual read char to the
                                  //actual string

  if (stringInTable(newString))   //when the string is already in the table
  {
    strcpy (oldString, newString) //take it as oldString and read the next char
  }
  else                            //else
  {
    code = searchTable(oldString);//get the code for the last known String
    output (code);                //and output it
    addStringToTable(newString);  //add the new String for the next time
    oldString[0] = c;             //and start again with the latest unknown
    oldString[1] = 0x00;          //char
  }
}

Looks pretty easy, ain't it? Well, it is. Let's crunch the our little 
source again (this time a little longer):


                                  0123456789abcde
                                  iwobiwoiwoiwoix


           
(We have a table, where the first 256 (0 - 255) entries are occupied with the 
corresponding values)
Let's trace the steps of the cruncher. Maybe you should print the above
typed source for checking.

  oldstring = ( 'i', 0x00 )
  
(we enter the loop) (Pos = 0)

  c = 'w'
  newString = ( 'i', 0x00 )
  newString = ( 'iw', 0x00 )
  
(no, we don't have 'iw' in our table yet)

  code = searchTable(oldString)   //oldString = 'i', 0x00
  output (code)                   //i
  addString (newString)
  oldString[0] = 'w'
  oldString[1] = 0x00
  
(back to the top of the loop) (Pos = 1)
(our table has the 256 entries plus [ {256, 'iw'} ]

  oldstring = ( 'w', 0x00 )
  c = 'o'
  newString = ( 'w', 0x00 )  
  newString = ( 'wo', 0x00 )  

(no, we don't have 'wo' in our table yet)

  code = searchTable(oldString)   //oldString = 'w', 0x00
  output (code)                   //w
  addString (newString)
  oldString[0] = 'o'
  oldString[1] = 0x00

(back to the top of the loop) (Pos = 2)
(our table has the 256 entries plus [ {256, 'iw'}, {257, 'wo'} ]

  oldstring = ( 'o', 0x00 )
  c = 'o'
  newString = ( 'b', 0x00 )  
  newString = ( 'ob', 0x00 )  

(no, we don't have 'ob' in our table yet)

  code = searchTable(oldString)   //oldString = 'o', 0x00
  output (code)                   //o
  addString (newString)
  oldString[0] = 'b'
  oldString[1] = 0x00

(back to the top of the loop) (Pos = 3)
(our table has the 256 entries plus [ {256, 'iw'}, {257, 'wo'}, {258, 'ob'} ]

  oldstring = ( 'b', 0x00 )
  c = 'i'
  newString = ( 'b', 0x00 )  
  newString = ( 'bi', 0x00 )  

(no, we don't have 'bi' in our table yet)

  code = searchTable(oldString)   //oldString = 'b', 0x00
  output (code)                   //i
  addString (newString)
  oldString[0] = 'i'
  oldString[1] = 0x00

(Now we will have something to crunch :)
(back to the top of the loop) (Pos = 4)
(our table has the 256 entries 
plus [ {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}  ]

  oldstring = ( 'i', 0x00 )
  c = 'w'
  newString = ( 'i', 0x00 )  
  newString = ( 'iw', 0x00 )  

(YES, we have 'iw' in our table )

  oldString = ( 'iw', 0x00)
(back to the top of the loop)
  oldString = ( 'iw', 0x00)
  c = 'o'  

  newString = ( 'iw', 0x00 )  
  newString = ( 'iwo', 0x00 )  


(no, we don't have 'iwo' in our table yet)

  code = searchTable(oldString)   //oldString = 'iw', 0x00
  output (code)                   //[256]
  addString (newString)
  oldString[0] = 'o'
  oldString[1] = 0x00


(back to the top of the loop) (Pos = 6)
(our table has the 256 entries 
plus [ {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'}  ]

  oldstring = ( 'o', 0x00 )
  c = 'i'
  newString = ( 'o', 0x00 )  
  newString = ( 'oi', 0x00 )  

(no, we don't have 'oi' in our table yet)

  code = searchTable(oldString)   //oldString = 'o', 0x00
  output (code)                   //o
  addString (newString)
  oldString[0] = 'i'
  oldString[1] = 0x00


(back to the top of the loop) (Pos = 7)
(our table has the 256 entries 
plus [ 
       {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'},
       {261, 'oi'}  
     ]  

  oldstring = ( 'i', 0x00 )
  c = 'w'
  newString = ( 'i', 0x00 )  
  newString = ( 'iw', 0x00 )  

(YES, we have a 'iw' in our table)
  oldString = ( 'iw', 0x00)
(back to the top of the loop)
  oldString = ( 'iw', 0x00)
  c = 'o'  

  newString = ( 'iw', 0x00 )  
  newString = ( 'iwo', 0x00 )  

(YES, we have a 'iwo' in our table)
  oldString = ( 'iwo', 0x00)
(back to the top of the loop)
  oldString = ( 'iwo', 0x00)
  c = 'i'  

  newString = ( 'iwo', 0x00 )  
  newString = ( 'iwoi', 0x00 )  


(no, we don't have 'iwoi' in our table yet)

  code = searchTable(oldString)   //oldString = 'iwo', 0x00
  output (code)                   //260
  addString (newString)
  oldString[0] = 'i'
  oldString[1] = 0x00


(back to the top of the loop) (Pos = a)
(our table has the 256 entries 
plus [ 
       {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'},
       {261, 'oi'}, {262, 'iwoi'}    
     ]  

  oldstring = ( 'i', 0x00 )
  c = 'w'
  newString = ( 'i', 0x00 )  
  newString = ( 'iw', 0x00 )  

(YES, we have a 'iw' in our table)
  oldString = ( 'iw', 0x00)
(back to the top of the loop)
  oldString = ( 'iw', 0x00)
  c = 'o'  

  newString = ( 'iw', 0x00 )  
  newString = ( 'iwo', 0x00 )  

(YES, we have a 'iwo' in our table)
  oldString = ( 'iwo', 0x00)
(back to the top of the loop)
  oldString = ( 'iwo', 0x00)
  c = 'i'  

  newString = ( 'iwo', 0x00 )  
  newString = ( 'iwoi', 0x00 )  

(YES, we have a 'iwoi' in our table)
  oldString = ( 'iwoi', 0x00)
(back to the top of the loop)
  oldString = ( 'iwoix', 0x00)
  c = 'x'  

  newString = ( 'iwoi', 0x00 )  
  newString = ( 'iwoix', 0x00 )  


(no, we don't have 'iwoix' in our table yet)

  code = searchTable(oldString)   //oldString = 'iwo', 0x00
  output (code)                   //262
  addString (newString)
  oldString[0] = 'x'
  oldString[1] = 0x00

So, our output would look something like this:

 iwob[256]o[260][262]


Hey, we have two codes directly. Does this make trouble when decrunching?

Well, let's see how we would decrunch our little baby:


//Well, we know that the first character is uncrunchable, so let's output it
//directly
oldString[0] = decode(input())
oldString[1] = 0x00;

putString(oldString);      

newCode = input()                         //We get a new inputCode
while (newCode != EOF)
{
  newString = searchInTable(newCode);     //We have to have it in our table
  putString(newString);                   //then we output it
  strncat (oldString, &newString[0], 1);  //the oldstring is concatenated by 
                                          //the first char of the freshly read
                                          //string
  addString (oldString);                  //this string is then added to the
                                          //table
  strcpy (oldString, newString);          //then the freshly read string is
                                          //from now on our new base 
  newCode = input()                       //We get a new inputCode
}


OK, let's trace this alg when we decrunch our crunch:

 iwob[256]o[260][262]

Our table has the table entries 0 - 255 filled with the corresponding values.

oldString[0] = 'i';
oldString[1] = 0x00;
putString(oldString);       //i is output

newCode = 'w';

(enter loop)
  newString = 'w'
  Output 'w'                //w is output
  
  oldString = 'iw'          //build up new String
  //                        //and add it to the table

  oldString = 'w'    
  newCode = 'o'

our table has the 256 entries 
plus [ 
       {256, 'iw'}
     ]  
(enter loop)
  newString = 'o'
  Output 'o'                //o is output
  
  oldString = 'wo'          //build up new String
  //                        //and add it to the table

  oldString = 'o'    
  newCode = 'b'

our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}
     ]  
(enter loop)
  newString = 'b'
  Output 'b'                //b is output
  
  oldString = 'ob'          //build up new String
  //                        //and add it to the table

  oldString = 'b'    
  newCode = [256]

our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}
     ]  
(enter loop)
  newString = 'iw'
  Output 'iw'               //iw is output
  
  oldString = 'bi'          //build up new String (just the first char from the
                            //new String)
  //                        //and add it to the table

  oldString = 'iw'    
  newCode = 'o'


our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}
     ]  
(enter loop)
  newString = 'o'
  Output 'o'                //o is output
  
  oldString = 'iwo'         //build up new String
  //                        //and add it to the table

  oldString = 'o'    
  newCode = [260]
  

our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'}
     ]  
(enter loop)
  newString = 'iwo'
  Output 'iwo'              //o is output
  
  oldString = 'oi'          //build up new String (just the first char)
  //                        //and add it to the table

  oldString = 'iwo'    
  newCode = [262]
  

our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'}
      {261, 'oi'}
     ]  
(enter loop)
  newString = CRASH !!! CRASH
  
Damn. I knew it. The cruncher added a code and used it immediately and the
decruncher can't use it as it doesn't know how to create it. Or does it???

Hmmmm....

Ok, ok, i lied. I knew it all the time that this constellation was deadly for 
our decruncher. This behaviour appears, whenever the cruncher meets a 
constellation like (iwo b iwo iwo iwo) where the last character of a crunch is 
the beginning of the next sequence. This leads to creating table-entries which 
the decruncher can not foresee. But lucky us - this is the only case when this 
happens. A little if-clause will just catch the null-pointer and just fetch the 
oldString and copy it to newString. Then we add the first char of newString to 
the end of newString. Then we continue as always. The if-clause could look like 
this:

  if (newString == null)
  { 
    char c[2]
    //we still know oldString
    strcpy (newString, oldString)
    char c[0] = newString[0];
    char c[1] = 0x00;
    strcat (newString, c);    
  }

With this clause let's restart from the last part:

our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, {259, 'bi'}, {260, 'iwo'}
     ]  
(enter loop)
  newString = 'iwo'
  Output 'iwo'              //o is output
  
  oldString = 'oi'          //build up new String (just the first char)
  //                        //and add it to the table

  oldString = 'iwo'    newCode = [262]


our table has the 256 entries 
plus [ 
      {256, 'iw'}, {257, 'wo'}, {258, 'ob'}, 
      {259, 'bi'}, {260, 'iwo'} {261, 'oi'} 
     ]  
(enter loop) 
  newString = null
  if (newString = null)
  {
    newString = 'iwo'
    newString = 'iwoi'      //First character added again
  }
  Output 'iwoi'             //iwoi is output
  
  oldString = 'iwoi'        //build up new String (just the first char)
  //                        //and add it to the table
...
and then we have our entry 262.

Phew.

You see when you try this on your own, that there is a lot of room for 
improvement. 
But this is the basic algorithm and as now know the secrets of LZW you know 
what RAR and ZIP are doing. I have some sources i can mail you, if you want.


All right, next time i'll explain something related to Huffman - 

                The Arithmetic Crunching Method (tataaa... :-)
                (how can i crunch 0.74 bits ???)


Greetings from a programmer,

Joa

</prE>
<center>
<hr size=3><a href="mailto:JoKo2000@hotmail.com">
<IMG SRC="images/tellme.gif" tppabs="http://members.xoom.com/tsehp_/images/tellme.gif" width="140" height="21"></a>
<br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
 <br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A> 
 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER></center>
<HR SIZE=2>

</body>
</html>

<html>
<head>
<title>nop1</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">PhotoVista v1.0 crack Step-by-Step<br></font><br>
<font size="+2">A &quot;smearing&quot; protection reverse engineered</font><br>
<h4>by Nop<br>
<br>
(27 August 1997)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<br><br><i>Well, step by step essays are always 
very useful for newbyes and old hands alike... here is one by a new 
+HCU contributor that I'm happy to host on my site: Nop<br><br>Another interesting 
thing in this target, is that it is one of those annoying &quot;smearing&quot; 
protection schemes... i.e. the program prints on all the samples made 
with an unregistered copy an annoying &quot;banner&quot;. Smearing protection 
schemes are, of course, even more crackbar than the &quot;simple&quot; protection 
schemes, since they have necessarily even more routines that &quot;unveil&quot; 
the protection.</i></center><hr size="7">
<pre> 
<font size="+3"> 
 PhotoVista v1.0 crack Step-by-Step by Nop</font>
 <hr size="4">
  (look for the Pc_VISTA.ZIP for the .COM)
  Note that this is a brutal-20minutes-crack-Pepsi-included
  
  All the address are indicatives.
  
  I use a &quot;&gt;&quot; to indicate SoftIce commands

  When i say ...trace... this is for the P key (skipping calls,...) not
  the T key (trace all) !

  When you have a good crack, think to take the Hex of the modification
  (use CODE ON to see the hex)

  You can find PhotoVista at http://www.livepicture.com


                      ------------------------


1) Install the prog
   Choose full install 
   (to see which composents need to be cracked)

2) Launch the .EXE (not the main) to see if the others prog need to
   be cracked

3) Launch the PVISTA.EXE (coz other are ok)

4) The prog begin with a screen, where we can enter a serial
   choose the command &quot;Run as Trial&quot;

5) The prog is loading ...

6) Trying a sample (&quot;Created with PhotoVista&quot; appear on the sample i
   made)
   quit the prog

7) Take a 7up (or a sprite).
   I decided that today is'nt a good day for serial so i only search
   a crack
   I press Ctrl-D to call my friend Soft-Ice...always here


          -= PART I: ATTACKING THE SERIAL =-

9) launch the prog
   The screen &quot;Enter Serial Number&quot; appears

   i fill all the query with recognizable text
   i click on &quot;Run&quot;
   and obtain &quot;Sorry, this serial... ...invalid&quot;
   ok, i see.

   Ctrl-D
      &gt; HWND
         ...
         01F8(1)      197F    32  PVISTA    #32770 (Dialog)  ...
          08CC(2)     197F    32  PVISTA    Static
          04FC(2)     197F    32  PVISTA    Edit
          0DC0(2)     197F    32  PVISTA    Static
          0970(2)     197F    32  PVISTA    Edit 
          023C(2)     197F    32  PVISTA    Static
          0218(2)     197F    32  PVISTA    Edit 
          0230(2)     197F    32  PVISTA    Static
          0B0C(2)     197F    32  PVISTA    Edit 
          0968(2)     197F    32  PVISTA    Button
          ...
   i locate the 4 Edit that are in the Form (in the screen)
   i put a breakpoint on the 4FC (the first edit)
      
      &gt; BMSG 4FC 0D
   (it's a breakpoint on a windows message (BMSG) on handle 4FC,
    breakpoint waiting the prog get the text, 0D is the code of
    WM_GETTEXT)

   i click on &quot;Run&quot;
   Soft-Ice come back with the Breakpoint i can read the typical
   &quot;USER!BOZOLIVEHERE&quot; 
      &gt; X (to return to prog)
    
   Soft-Ice come back again with the Breakpoint
      &gt; X
     
   &quot;Sorry, this serial... ...invalid&quot; appear. Ok.
   The prog decided that the serial is bad with only TWO edit
                                                    
    i click again on &quot;Run&quot;
    Soft-Ice Again
      &gt; X
    Soft-Ice Again
    This time i press P
       ...trace...
       a RETF
       
       (USER!BEAR498+14D)
       ...trace...
       a RETF
       
       (USER!GLOBATGETATOMNAME) (usual)
       ...trace...
       a RET
      
       (another USER!GLOBATGETATOMNAME)
       ...trace...
       a RETF

       (USER!GETWINDOWTEXT)
       ...trace...
       a RETF
       
       JMP 0137:BFF72964
       ...trace...
       JMP [EBP-24]  (usual also)

       so, we enter really in the prog
       i trace 
         ret
         ...
         jmp 00479878
         ...
         ret
         ...
         CALL 00458ED0
         TEST EAX,EAX       this is the first test we meet
         JNZ 00416228
         
9) just put a breakpoint on the TEST EAX, EAX (my shortcut is F2)
   (BPX 0001:00015185 BPX=BreakPoint on eXecution)

        EAX=5 so we do a jump to 00416228
        we have:

137:00416228 XOR EAX,EAX
             TEST EAX,EAX
             JZ 00416245
        
   put another breakpoint on the TEST EAX, EAX
   ...trace...
   because of the XOR EAX we jump on 00416245

137:00416245 PUSH 30
             ...
             CALL
             &quot;Sorry, this serial... ...invalid&quot; appear. Ok.             
             ...
             CALL
             ...
             ...
             ret


   So, now we know where the prog make it choice, so, we deactivate the
    breakpoint on Edits with
    BD 0  (use BL to see the list of the breakpoint used, and 
           deactivate &quot;BMSG 04FC WM_GETTEXT&quot; if this isn't the first (0))

    
10) Look at the window, how ! a nice girl !
    Be concentrated !    Be concentrated !
 
    Now it's important to think to what we have.
     We can simply replace the last JZ 00416245 with 0x90, but, in this
     case, don't use the code between this jump and the previous
     (JNZ 00416228)
   
    So we need more infos, coz, if the CALL 00458ED0 is a serial-tester
     we must send a good response, and not jump at 00416228)

 
11) Click on &quot;Run&quot;
     At the first Breakpoint, put a breakpoint on the CALL 00458ED0
     ...
     Launch the prog again
     Stop on the Call
     Now press T to enter in the CALL
      Some CMP...
      trace...
      oh a CMP [EBX+ECX], DL
      so what contain [EBX+ECX] ?
        &gt; d ebx+ecx
      what we see, the seventh character of the Activation key !
      and what contain DL ? 0x2D the hex of the &quot;-&quot; character !
      So this CMP compare this character with a &quot;-&quot;
      (if i was looking for a good serial, i had to look in the CALL
       found in this routine)
     trace ... 
     we have to quit this CALL
     (it's quick coz my activation key don't contain the &quot;-&quot;)
    
12) So this is really the Serial-tester in this CALL
    We now have to modify the prog
         CALL 00458ED0
         TEST EAX,EAX    <- we are here now JNZ 00416228 We can use some 0x90 instead of this 2 lines, but... if EAX is used after, this is not a good idea, so we put: CALL 00458ED0 XOR EAX,EAX NOP NOP NOP (i prefer personnaly use "NOP" than NOP INC EAX, DEC EAX...) NOP NOP 13)> X     
     The prog stop on the other TEST EAX,EAX
137:00416228 XOR EAX,EAX
             TEST EAX,EAX
             JZ 00416245

     this time we put
             XOR EAX, EAX
             INC EAX
             NOP
             NOP
             NOP            (this is the same number of instructions)


14) We launch the prog with the 2 cracks (put with Soft-Ice, not already
    with an hex-editor)
    Click on &quot;Run&quot;
    Prog launch
    NetBrowser launch and &quot;Thanks you for registering appear&quot;

15) Verify the crack, launch the same sample than before (see (6))
    The text &quot;Created with PhotoVista&quot; doesn't appear any more.

16) All is working...
    ...But...
    This crack was asked by Jenn on irc (#PC97 !) and she want to
    destroy the ask of the serial
    So...


          -= PART II: EXPLODE THE NAG-SCREEN =-

17) Launch SoftIce Loader
    click on File/Open Module
    select PVISTA.EXE
    click on Module/load
     &gt; BD *
    (disable all breakpoints)

18) ...trace...
    the nag-screen appear just after you skip a call (key P)
    click on &quot;Cancel&quot;
    soft-Ice appear again
    put a BPX on this CALL (CALL 0047368A for me)
    launch the prog
    ...enter this call... (key T)
    ...trace...
    There is a CALL [EBX+58] who launch the nag-screen
    Breakpoint it
    Disable all the previous breakpoint
    launch the prog
    ...enter this call...
    4 CALL...
    TEST...
    8 CALL...
    CMP EAX, EDI
    9 CALL...
    TEST EAX, EAX
    JNZ...  (we jump)

   we arrive here:
    XOR EAX, EAX
    TEST EAX, EAX
    JNZ 00414F63 (NO JUMP)
    CALL...
    nag-screen appear
    ...
   
   so, i decided to make it quick, and disable all the previous BPX
    and put one on the TEST EAX, EAX
   launch the prog
    modify the EAX EAX=00000000 -&gt; EAX=00000001
   what appears ?
    nag-screen doesn't appear any more !

   return to Soft-Ice and modify the code
    XOR EAX, EAX
    TEST EAX, EAX    -&gt;  INC EAX
                         NOP
    JNZ 00414F63     -&gt;  JMP 00414F63

19) (I hope you have wrote the hex crack...)
    We have:
       search 85C00F859D000000
 replace with 33C0909090909090

       search 33C085C07417C746
 replace with ----40909090----       (- used when bytes don't change)
 
       search 85C00F85F4000000
 replace with 4090E9F500----90
 
    now use your hex editor (i have made mine), like hex Workshop
    apply the crack

20) LAUNCH the prog again !
    you must verify that there isn't a Checksum on the file by trying
    again the sample.
     
    ...it work
    ...it's done
     
    (i have used my own prog to make a .COM)

    when your .COM it done, verify again, in case of some joke ;)
    write the .NFO
    make a .ZIP    
    send it...

    THE END (?)

                      ------------------------

SOME INFOS:
============

I u want to know, for example, why there is a
   XOR EAX, EAX
   TEST EAX, EAX
   ...
 see in the prog. (there is a jump before)

REAL SECRET !!!!
 in fact, real cracker don't make so many try, they simply use
a serial-generator made by others crackers. (no no it's a joke, don't
strike me...Argghhh)

See you soon on iRC                
                                                      Nop
													  </pre>
  <font color="green">(c) Nop 1997. All rights reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#79" tppabs="http://fravia.org/tppmsgs/msgs0.htm#79">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#53" tppabs="http://fravia.org/tppmsgs/msgs0.htm#53">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#78" tppabs="http://fravia.org/tppmsgs/msgs0.htm#78">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>

  
<html>
<head>
<title>eudorauk</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to defeat a three-folded protection<br>
(semi-advanced cracking)</h2><h4><i>by TheChineese</i></h4>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering
<br>~<br><i>
Well, this essay is indeed interesting... just read it straight on, 
and you'll get 
a lot of info at first glance, you'll understand even more 
when you delve inside it.<br><br>Note the hyperlinked listing...<br> I wish 
all people sending contributions would work html like this! (Take note, 
+HCUkers! :-)
</i></center>
<hr size="2">

<pre>
<pre><center>	
<b><font SIZE="+2">HOW TO CRACK EUDORA PRO 3.01 (AND 3.0) TRIAL VERSION</font></b>
<b><font SIZE="+2">By TheChineese (jun 97)</font></b>
</center></pre>
<hr>
<pre>
<a NAME="preliminaire">WHY ?</a>
------------

(English is not my mother tongue , so please  be indulgent ...)

I was working on Eudora Pro 3.0 and plan to send it to +ORC... but 
+RCG made it before me :-( 
So i downloaded the Eudora Pro 3.0.1 French version and worked on it.
(International version available at <a href="http://www.eudora.com/" >http://www.eudora.com</a>).
First of all it seem that in this case removing the keys in the register 
doesnt works. So i searched all the proctection routines in Eudora
and made a patch.

------------
A-TOOLS
------------
- Eudora Pro 3.0.1 French version (Eudora.exe 1 116 712 bytes)
- Softice 3.1 (3.0)
- Windasm 8.0
- Psedit or Hwork
 
------------------------------------------
B- PROTECTION SCHEME
-------------------------------------------
We have to understand and to find all the protection schemes.
When we execute Eudora there is the first proctection scheme

1	Checksum routine 
2	&quot;Last bits&quot; routine
3	Date encryption routine	
4 	&quot;How many day left&quot; routine 

(as described by +RCG in his lesson)

But after that we have several places in eudora where we found the proctection

In fact, after using Eudora a little bit, we realize
that there is a call to the protecion each time we try to:

	-  Read the mail
	-  Send the mal
	-  Remove a mailbox
	-  Read the mail with Personalities (Dominant) 
Sometimes there is even a double call to the protection 

This is the summary of the second protection scheme:

	- &quot;How many day left&quot; routine
	Wich calls:
		
		- Last bits ok ?
		- Checksum ?

	- and the routine compares the actual date to the &quot;limit date&quot; and 
        to the &quot;install&quot; date

	
----------
C-HOW TO ?
----------
For the first Protection 
--------------------------------------------------------
We have to :
0) fire softice
1) set the system date after limit date
2) bpx messageboxa
3) use F10 or F12 (for backtracing)
4) in order to find the piece of code at :00441C49

For the other proctection
-----------------------------
0) use  windasm 
1) Read the snippet of code of the first protection, find
   the value 29D7AB54 (which is the initial value of the checksum)
2) Search all the code using the same value 29D7AB54 
3) bpx at the piece of code using the Value 29D7AB54
4) use Eudora (read, send, remove mailbox etc ) and pop into Softice


CONCLUSION
-------
This is the summary of all the location of the protection code


I	<a HREF="eudorauk.htm#verif lancement">:00441C49 </a>First call to the protection when firing Eudora

II	<a HREF="eudorauk.htm#IIveriflireenvoyercourier">:004A5BC0 </a>When we try to Read or Send Mail 

III	<a HREF="eudorauk.htm#IIIverifperso">:004A95F0 </a>When trying to read mail (Personnalities Dominant ...)

IV	<a HREF="eudorauk.htm#doubleverif">:004AA1A0 </a>Double protection ( called sometimes ...)

V	<a HREF="eudorauk.htm#boitelettre">:00432D70 </a>Removing mailbox

VI 	<a HREF="eudorauk.htm#patch">For The Patch
</a>
<a NAME="verif lancement">------------------------------------------------------------------------------</a>
First Proctection
When firing Eudora
**************************
-----------------------------------------------------------------
:00441C49 FF153C275000            Call dword ptr [0050273C]
:00441C4F 85C0                    test eax, eax
:00441C51 741F                    je 00441C72
:00441C53 8D8560FCFFFF            lea eax, [ebp+FFFFFC60]
:00441C59 B9B89F4F00              mov ecx, 004F9FB8
:00441C5E 50                      push eax
:00441C5F E8CC970500              call 0049B430		&lt;---- <a HREF="eudorauk.htm#1ercall">first call	checksum
</a>:00441C64 85C0                    test eax, eax			
:00441C66 740A                    je 00441C72			bad guy if eax=0 (to nop) 90 90
:00441C68 B9B89F4F00              mov ecx, 004F9FB8
:00441C6D E87E980500              call 0049B4F0		&lt;---- <a HREF="eudorauk.htm#2emecall">2nd call	date decryption
</a>* Referenced by a Jump at Addresses:00441C51(C), :00441C66(C)
|
:00441C72 B9B89F4F00              mov ecx, 004F9FB8
:00441C77 E8949C0500              call 0049B910		&lt;---- <a HREF="eudorauk.htm#3emecallcombierdejours">3rd call how many days left?
</a>:00441C7C 8BF8                    mov edi, eax		&lt;-- edi= numbers of day
:00441C7E 85FF                    test edi, edi		if  edi=0 bad guy
:00441C80 0F85CC000000            jne 00441D52		&lt;--- <a HREF="eudorauk.htm#verif jours &gt; 7">TEST DAY &gt;7 </a> change : jmp 441d52
:00441C86 8D4DC8                  lea ecx, [ebp-38]
:00441C89 BEFFFFFFFF              mov esi, FFFFFFFF
* Reference To: MFC40.MFC40:NoName0924, Ord:01E6h
                                  |
:00441C8E E805F10800              Call 004D0D98
:00441C93 68FEFF0000              push 0000FFFE
:00441C98 8D4DC8                  lea ecx, [ebp-38]
:00441C9B C745FC00000000          mov [ebp-04], 00000000
* Reference To: MFC40.MFC40:NoName0881, Ord:0E48h
                                  |
:00441CA2 E8E1F10800              Call 004D0E88
:00441CA7 C745FC01000000          mov [ebp-04], 00000001
:00441CAE 6A00                    push 00000000
:00441CB0 8B45C8                  mov eax, [ebp-38]
:00441CB3 6A00                    push 00000000
:00441CB5 50                      push eax
* Reference To: MFC40.MFC40:NoName0400, Ord:0425h
                                  |
:00441CB6 E86FFB0800              Call 004D182A
:00441CBB 8975FC                  mov [ebp-04], esi
:00441CBE E887000000              call 00441D4A
<a NAME="1goodguy">* Referenced by a   Jump at Addresses:</a> :00441C2E(C), :00441D55(C), :00441DB0(U)
|
:00441CC3 B930A04F00              mov ecx, 004FA030       &lt;  here good guy **************
:00441CC8 E8E37D0200              call 00469AB0           &lt;--no limitation message
:00441CCD 8B45EC                  mov eax, [ebp-14]
:00441CD0 05D4040000              add eax, 000004D4
:00441CD5 50                      push eax
:00441CD6 C70094000000            mov dword ptr [eax], 00000094
* Reference To: KERNEL32.GetVersionExA, Ord:0138h
<a NAME="verif jours &gt; 7">-----------------------------------------------------------</a>
CHECKING IF EDI &gt;7  FOR MESSAGE                              

------------------------------------------------------------
* Referenced by a   Jump at Address:00441C80(C)
|
:00441D52 83FF07                  cmp edi, 00000007
:00441D55 0F8368FFFFFF            jnb 00441CC3		&lt;-- TEST DAY &gt;7 <a HREF="eudorauk.htm#1goodguy">good guy ( change : jmp 441CC3)</a>
:00441D5B 8D4DCC                  lea ecx, [ebp-34]	
:00441D5E BEFFFFFFFF              mov esi, FFFFFFFF
* Reference To: MFC40.MFC40:NoName0924, Ord:01E6h
                                  |
:00441D63 E830F00800              Call 004D0D98
:00441D68 68FDFF0000              push 0000FFFD
:00441D6D 8D4DCC                  lea ecx, [ebp-34]
:00441D70 C745FC02000000          mov [ebp-04], 00000002
* Reference To: MFC40.MFC40:NoName0881, Ord:0E48h
                                  |
:00441D77 E80CF10800              Call 004D0E88
:00441D7C 57                      push edi
:00441D7D 8D8D60FDFFFF            lea ecx, [ebp+FFFFFD60]
:00441D83 C745FC03000000          mov [ebp-04], 00000003
:00441D8A 8B45CC                  mov eax, [ebp-34]
:00441D8D 50                      push eax
:00441D8E 51                      push ecx
* Reference To: MSVCRT40.sprintf, Ord:0448h
                                  |
:00441D8F FF1560375000            Call dword ptr [00503760]
:00441D95 83C40C                  add esp, 0000000C
:00441D98 8D8D60FDFFFF            lea ecx, [ebp+FFFFFD60]
:00441D9E 6A00                    push 00000000
:00441DA0 6A00                    push 00000000
:00441DA2 51                      push ecx
* Reference To: MFC40.MFC40:NoName0400, Ord:0425h
                                  |
:00441DA3 E882FA0800              Call 004D182A
:00441DA8 8975FC                  mov [ebp-04], esi
:00441DAB E80D000000              call 00441DBD
:00441DB0 E90EFFFFFF              jmp 00441CC3
:00441DB5 8D4DCC                  lea ecx, [ebp-34]
* Reference To: MFC40.MFC40:NoName0799, Ord:02C2h
                                  |
:00441DB8 E9CFEF0800              Jmp 004D0D8C
<a NAME="1ercall">----------------------------------------------------------------------</a>
1st call Checksum
-----------------------------------------------------------------------
* Referenced by a CALL at Address:00441C5F   
|
:0049B430 53                      push ebx
:0049B431 56                      push esi
:0049B432 57                      push edi
:0049B433 33F6                    xor esi, esi
:0049B435 55                      push ebp
:0049B436 8BF9                    mov edi, ecx
:0049B438 8B442414                mov eax, [esp + 14]
:0049B43C 6800800000              push 00008000
:0049B441 50                      push eax
* Reference To: MSVCRT40._open, Ord:0322h
                                  |
:0049B442 FF150C375000            Call dword ptr [0050370C]
:0049B448 83C408                  add esp, 00000008
:0049B44B 8BD8                    mov ebx, eax
:0049B44D 83FBFF                  cmp ebx, FFFFFFFF
:0049B450 0F848C000000            je 0049B4E2
:0049B456 6A02                    push 00000002
:0049B458 6AD8                    push FFFFFFD8
:0049B45A 53                      push ebx
* Reference To: MSVCRT40._lseek, Ord:02DEh
                                  |
:0049B45B FF15DC375000            Call dword ptr [005037DC]
:0049B461 83C40C                  add esp, 0000000C
:0049B464 8BE8                    mov ebp, eax
:0049B466 83FDFF                  cmp ebp, FFFFFFFF
:0049B469 746D                    je 0049B4D8
:0049B46B 6A28                    push 00000028
:0049B46D 57                      push edi
:0049B46E 53                      push ebx
* Reference To: MSVCRT40._read, Ord:0333h
                                  |
:0049B46F FF1510375000            Call dword ptr [00503710]
:0049B475 83C40C                  add esp, 0000000C
:0049B478 83F8FF                  cmp eax, FFFFFFFF
:0049B47B 745B                    je 0049B4D8
:0049B47D 8B4710                  mov eax, [edi+10]
:0049B480 8BCF                    mov ecx, edi
:0049B482 50                      push eax
:0049B483 E808050000              call 0049B990
:0049B488 8BCF                    mov ecx, edi
:0049B48A 894710                  mov [edi+10], eax
:0049B48D 8B4714                  mov eax, [edi+14]
:0049B490 50                      push eax
:0049B491 E80A050000              call 0049B9A0
:0049B496 8BCF                    mov ecx, edi
:0049B498 894714                  mov [edi+14], eax
:0049B49B 8B4718                  mov eax, [edi+18]
:0049B49E 50                      push eax
:0049B49F E80C050000              call 0049B9B0		&lt;-- manip data
:0049B4A4 8BCF                    mov ecx, edi
:0049B4A6 894718                  mov [edi+18], eax
:0049B4A9 8B471C                  mov eax, [edi+1C]
:0049B4AC 50                      push eax
:0049B4AD E83E050000              call 0049B9F0		&lt;-- manip data
:0049B4B2 55                      push ebp
:0049B4B3 8BCF                    mov ecx, edi
:0049B4B5 53                      push ebx
:0049B4B6 89471C                  mov [edi+1C], eax
:0049B4B9 E8F2060000              call 0049BBB0 	&lt;-- <a HREF="eudorauk.htm#checksumfile">checksum file</a>
:0049B4BE 394724                  cmp [edi+24], eax	if equal
:0049B4C1 740C                    je 0049B4CF		jmp --&gt;here
:0049B4C3 897710                  mov [edi+10], esi
:0049B4C6 897714                  mov [edi+14], esi
:0049B4C9 897718                  mov [edi+18], esi
:0049B4CC 89771C                  mov [edi+1C], esi
* Referenced by a   Jump at Address:0049B4C1(C)
|
:0049B4CF 8BCF                    mov ecx, edi		&lt;-- here
:0049B4D1 E85A020000              call 0049B730		&lt;-- <a HREF="eudorauk.htm#3bitok">lasts bit ok
</a>:0049B4D6 8BF0                    mov esi, eax
* Referenced by a   Jump at Addresses:0049B469(C), :0049B47B(C)
|
:0049B4D8 53                      push ebx
* Reference To: MSVCRT40._close, Ord:0251h
                                  |
:0049B4D9 FF1504375000            Call dword ptr [00503704]
:0049B4DF 83C404                  add esp, 00000004
* Referenced by a   Jump at Address:0049B450(C)
|
:0049B4E2 8BC6                    mov eax, esi
:0049B4E4 5D                      pop ebp
:0049B4E5 5F                      pop edi
:0049B4E6 5E                      pop esi
:0049B4E7 5B                      pop ebx
:0049B4E8 C20400                  ret 0004


<a NAME="2emecall">------------------------------------------------------------------------</a>
2nd call: date decryption  (and KEYS in REGITER )
------------------------------------------------------------------------
* Referenced by a CALL at Address:
|:00441C6D   
|
:0049B4F0 64A100000000            mov eax, fs:[00000000]
:0049B4F6 55                      push ebp
:0049B4F7 8BEC                    mov ebp, esp
:0049B4F9 6AFF                    push FFFFFFFF
:0049B4FB 687FB64900              push 0049B67F
:0049B500 50                      push eax
:0049B501 64892500000000          mov fs:[00000000], esp
:0049B508 81EC5C010000            sub esp, 0000015C
:0049B50E 53                      push ebx
:0049B50F 56                      push esi
:0049B510 57                      push edi
:0049B511 8BF1                    mov esi, ecx
:0049B513 8D8D98FEFFFF            lea ecx, [ebp+FFFFFE98]
:0049B519 E8A294FEFF              call 004849C0
* Possible StringData Ref from Data Obj -&gt;&quot;HKEY_CURRENT_USER\Software\Microsoft\Notepad&quot; &lt;-- Référence à Regiter for  limit date and instal date
                                  |
:0049B51E 68A07C4F00              push 004F7CA0
:0049B523 8D8D98FEFFFF            lea ecx, [ebp+FFFFFE98]
:0049B529 C745FC00000000          mov [ebp-04], 00000000
:0049B530 E8AB94FEFF              call 004849E0
:0049B535 85C0                    test eax, eax
:0049B537 0F8426010000            je 0049B663
:0049B53D 6A50                    push 00000050
:0049B53F 8D45A4                  lea eax, [ebp-5C]
:0049B542 50                      push eax
:0049B543 8D8D98FEFFFF            lea ecx, [ebp+FFFFFE98]
* Possible StringData Ref from Data Obj -&gt;&quot;lfWindowPos&quot;		&lt;-- 1st KEY
                                  |
:0049B549 68947C4F00              push 004F7C94
:0049B54E E8DD95FEFF              call 00484B30
:0049B553 8BF8                    mov edi, eax
:0049B555 8D45A4                  lea eax, [ebp-5C]
:0049B558 50          