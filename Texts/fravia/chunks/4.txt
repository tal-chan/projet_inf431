gineering legal?</a>

</center></center>
<hr>
<!-- Begin signet -->
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=CENTER 
BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font color=green>(c) 
<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a> 1995, 1996, 1997, 1998, 1999. All rights 
reserved</fonT>
<!--
<pre>reverser's main cocktails' page: bric-a-brac and cracking lores</pre>
-->
<!-- End signet -->
</body>
</html>


<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>epic2</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">FrontPage 98 English beta 1 for Windows 95 &amp; NT 4.0<br></font><font size="+2">
(They are getting tougher)</font>

<h4>by Epic Lord<br>
<br>
(14 August 1997, slightly edited by Reverser)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering<br><br><i>Well, Epic Lord has worked 'in a hurry', but his 
crack is nevertheless quite effective and interesting... so Micro$oft is now writing 
&quot;scarecrow&quot; phrases like <b>&quot;This copy of Microsoft FrontPage has been modified in a way which 
is in violation of the license aggreement&quot;</b>... poor sods! And some antiwinice tricks as well...
 mmm, we'll have to keep half-awake to drefeat M$ protections in the future :-)


 </i></center><hr size="3">
<pre>
Well, I hope this essay will become my contribution to Project 9, 
namely reverse engineering all the Micro$oft products' protection 
schemes! I apologize for my English.

The target is &quot;FrontPage 98 - English Beta 1 for Windows 95 &amp; NT 4.0 - US
English Version&quot;. A long name. It can be found at Microsoft, located at 
<a href="FRAVIA_index.htm#252" tppabs="http://members.xoom.com/tsehp_/index.htm#252">http://www.microsoft.com/msdownload/fp98/05000.htm</a>, if you're lucky, 
anyway, even if they retire/modify it after the publication of this essay, 
too many people will already have downloaded it (and too many magazines 
will have already published it) to halt this snowball rolling :-)

BTW, it is approximately 20 MB. Pretty big to download with a 14400
connection, but I wanted to be the first one on the subject :=)

The product is really overbloated; it spans more than 80 folders and 950
files. In the BIN folder alone there are more than 30 files.

Let's begin.

I started the FrontPage Explorer (fpexplor.exe), target starts. Changed my
system time to a couple of years ahead, started again, target did not start. 
Started FrontPage editor (fpeditor.exe), target started. 
Tried again, it did not. 
Well, the various programs under examination are writing something 
somewhere (huh? a clever conclusion :=)

I disassembled first of all the target file (fpeditor.exe) and found 
nothing. The same happened while I was working on M$ Publisher. 
The protection must dwell somewhere outside the main code, it must be 
easily editable and must be undercover. 
YES! look at the .dll files.

Well there are 22 .dll files in the BIN folder. A couple more are in the
SYSTEM directory. 
Lets get tougher :=) 
I searched the files to find the word &quot;expired&quot; and couldn't get 
anything at all (DUH). 
Multibyte characters !!! Therefore I searched the sequence 
&quot;65 00 78 00 70 00 69 00 72 00 65 00&quot; 
which is &quot;expired&quot; interpolated with 0h seperators. 
I could forget cracking this target... I couldn't find the target itself yet! 
The search string is in &quot;fp30cutl.dll&quot;... bingo!

Ok ok. I cheated. I could not feel the multibyte problem at the beginning 
so I did start Softice and checked what actually was going on. 
This approach let me suspect the file &quot;fp30cutl.dll&quot;. 
Do what I say, not what I did. 
BTW try softice. 
You will not find anything. The &quot;Expiry&quot; dialog box will pop and in spite of 
all the debugging capability you have, none of the breakpoints will
activate. 
Reverser+ is right. They are getting tougher.

Using a debugger will not be enough. 
This target calls the .dll, and the .dll calls in turn another one. 
&quot;FpEditor.Exe&quot; <- "fp30cutl.dll" <- "mfc42.dll" and so on. For this crack, I used both the "live" Softice and the "dead listing" approach. I pressed F12 and kept pressing till the nag screen appeared, and eventually I found the following code "snippet.class" tppabs="http://fravia.org/snippet.class" in "fp30cutl.dll": :67B497CD E89A760000 Call 67B50E6C ;MFC42:NoName0103, Ord:09D2h :67B497D2 5F pop edi :67B497D3 5E pop esi :67B497D4 C3 ret not very informative ha? I backtraced to the caller in the editor (not through Softice, through the dead code) and found the activator... here it is: Exported fn(): ExpFn0115() Ord:0074h :67B2CC60 55 push ebp :67B2CC61 8BEC mov ebp, esp :67B2CC63 81EC50010000 sub esp, 00000150 :67B2CC69 53 push ebx :67B2CC6A 33DB xor ebx, ebx :67B2CC6C 381D6B54B567 cmp byte ptr [67B5546B], bl :67B2CC72 56 push esi :67B2CC73 57 push edi :67B2CC74 750B jne 67B2CC81 :67B2CC76 891D6054B567 mov dword ptr [67B55460], ebx :67B2CC7C E941020000 jmp 67B2CEC2 Well, <font color="red">I added &quot;fp30cutl.dll&quot; to the exports list of Softice</font> and 
restarted my system. 
I put a breakpoint on fp30cutl.!ORD_0074 and let the babe run.
Nothing happened. No bp popup. Gee! hat was wrong? 
Well... I put a memory RW breakpoint at [67B5546B] and now! Look! it pops! 
I played a little with the code, and wow! a system error dialog appeared,
saying <font color="blue"><b>&quot;This copy of Microsoft FrontPage has been modified in a way which 
is in violation of the license aggreement&quot;</b></font>.

Nice! We are getting somewhere!

I studied the code and found no CRC, nor any similar checking. 
It was because of comparing fixed memory locations. 
However, it's getting late 05:30 in the morning, the cracking session 
was heavy... sorry for the short climax, but that's all, the rest you'll 
understand yourselves...

I will not dwelve into the details of date checking and other comparisons
(put 1990 in EAX, add 7 find 1997 etc) let's crack it stright on.

The suspect culprit is the jump below:
:67B2CC74 750B                    jne 67B2CC81

Patching the values of BX in order to get some correct flags after the 
comparison makes you Micro$oft_guilty. 
Study the code piece above. 
Therefore, quite simply...

	LETS IGNORE THE JUMP, REPLACE IT WITH 40 48

Ok. Thats all folks. I'm fast ha? :=). BTW, with this patch, all other
components will run smoothly.

Best wishes, Epic Lord, epic@lords.com.

Thank you Reverser+

note: I do not claim any right for this essay :=)</pre>
 <font color="green">(c) Epic Lord 1997. No rights whatsoever reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="project9.htm" tppabs="http://members.xoom.com/tsehp_/project9.htm">project 9 </a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="new_page_1.htm#84" tppabs="http://members.xoom.com/tsehp_/finished.htm#84">homepage </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="new_page_1.htm#73" tppabs="http://members.xoom.com/tsehp_/finished.htm#73">links </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#82" tppabs="http://members.xoom.com/tsehp_/finished.htm#82">students' essays </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">Academy database </a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts </a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_Reverser </a><br>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>
<html>
<head>
<title>Essay #41: How to produce KeyGENs</title>
</head>

<body bgcolor=#EBEBEB>

<!-- BEGIN Document-View-Counter -->
<img src="new_page_1.htm" tppabs="http://cgi3.fxweb.com/v2-trackrun.cgi?userid=P77701&quiet=true" nosave height=1 width=1>
<!-- END Document-View Counter -->

<center><font face=verdana,arial,helvetica size=7>
<b><font color=#000080>How to produce KeyGENs</font></b></font><br>
<font face=verdana,arial,helvetica size=5>
<b>A general appropoach to the goal</b><br>
</font>
</center>

<br><br>

<hr size=1 width=100%>
<font face=verdana,arial,helvetica size=2>

<center>
<table border=0 cellspacing=0 cellpadding=4 bgcolor=#FFFFDD width=95%>
 <tr>
    <td bgcolor=#FFFF00 width=20% valign=_top>
      <font face=verdana,arial,helvetica size=2>
       <b>Target:</b>
      </font>
    </td>
    <td width=80%>
      <font face=verdana,arial,helvetica size=2 valign=_top>
      Zip Manager 5.3
      </font>
    </td>
 </tr>

 <tr>
    <td bgcolor=#FFFF00 width=20% valign=_top>
      <font face=verdana,arial,helvetica size=2>
       <b>Author:</b>
      </font>
    </td>
    <td width=80%>
      <font face=verdana,arial,helvetica size=2 valign=_top>
      <a href="http://www.sebd.com/">Software Excellence By Design</a>
      </font>
    </td>
 </tr>

 <tr>
    <td bgcolor=#FFFF00 width=20% valign=_top>
      <font face=verdana,arial,helvetica size=2>
       <b>Protection:</b>
      </font>
    </td>
    <td width=80%>
      <font face=verdana,arial,helvetica size=2 valign=_top>
      Name/Serial
      </font>
    </td>
 </tr>


 <tr>
    <td bgcolor=#FFFF00 width=20% valign=_top>
      <font face=verdana,arial,helvetica size=2>
       <b>Tools used</b>
      </font>
    </td>
    <td width=80%>
      <font face=verdana,arial,helvetica size=2 valign=_top>
      - <a href="http://lccwin32.cjb.net/">lcc</a><br>
      - SoftICE 3.2<br>
      </font>
    </td>
 </tr>

 <tr>
    <td bgcolor=#FFFF00 width=20% valign=_top>
      <font face=verdana,arial,helvetica size=2>
       <b>Level</b>
      </font>
    </td>
    <td width=80%>
      <tt>
      (X) Beginner<br>
      (X) Intermediate<br>
      ( ) Advanced<br>
      ( ) Expert
      </tt>
    </td>
 </tr>
</table>
</center>

<hr size=1 width=100%>
<font size=4><b>Disclaimer</b></font><br><br>
<font color=#FF0000>
Do I really have to remind you all that by BUYING and NOT stealing the software
you use will ensure that these software houses will continue to produce even
*better* software for us to use and more importantly, to continue offering even
more challenges to breaking their often weak protection systems.
BTW, It's illegal to use cracked Software!<br>
<br>
If you're looking for cracks or serial numbers from these pages then your wasting
your time, try to search elsewhere on the Web under Warez, Cracks, etc.
</font></font>
<hr size=1 width=100%>

<br><br>

<font face=verdana,arial,helvetica size=2>
As a matter of fact there is growing interest in essays dealing HOW TO KEYGEN a target ...
writing such essays requires a lot of time and extra work. Now holidays have started and
I decided to write this essay, which shows in detail HOW TO PRODUCE KEYGENS.<br>
<br>
The appropoach I've chosen here should work on quite a lot of target's and is so kinda
GENERIC APPROPOACH to the goal of coding a KeyGEN for a target ...<br>
<br>
To understand this essay and the KeyGEN coding process you need at least a basic knowledge of
ASM. For that matter an excellent document has been written by CoRN2:
<a href="http://crknotez.cjb.net/">Assembly for Crackers</a>.<br>
<br><br><br>
<a name=#Step_1><font size=4><u>Step 1: How to start?</u><br></font></a>
Of course, first of all you need to execute your target and find the Registration Screen.
After that little work, you can start with the real process. So enter your Registration
Details and enter SoftICE. Now set a BPX HMEMCPY, leave SoftICE and press the 'OK'
button in the Registration Dialog. Now SoftICE should pop up. BD <i>(disable)</i> your BPX
and start the tracing ... here is where all the fun starts :)<br>
<br><br>
<a name=#Step_2><font size=4><u>Step 2: The fun starts</u><br></font></a>
For me the real fun is tracing through the target's code and find the instructions that
are used for generating serials <i>(or parts of them)</i> or whatsoever of your Registration
Details. This can be done (often) easier using a disassembler <i>(hope you have a fast
CPU)</i> ... if you know what you are looking for :)<br>
<br>
Back to the tutorial: Things generated must be checked ... either NOW or on start of the
target. Very often the things are checked NOW; that eases your work (often) a lot. But
what's next? Well your Registration Details have to be manipulated in some way so a
number or whatsoever is generated out from them ... all this is done using ASM instructions.<br>
<br>
A KeyGEN routine or whatsoever is CALLed (often) right before the real check if the enterd data
is either correct or not; so the CALLs before the real check are quite interesting ... you don't
need however to trace them all ... just find out by observing registers, ... what CALL you need
to trace and what NOT. It's easy :)<br>
<br><br>
<a name=#Step_3><font size=4><u>Step 3: Starting to work on the algo</u><br></font></a>
After having successfully found the algorithmus what does the manipulation used to generate
the correct Registration Data, you have to work out how this works <i>(of course)</i>. Here is
where you need your basic ASM knowledge. Watch out for instructions like ADD, AND, ...<br>
<br>
I highly suggest making notes on a piece of paper how this routine works and after that, use
your favourite coding language to code a routine that does EXACTLY the same ... mostly it's
just a simple algo ... but there are examples where the algo is really complex and a KeyGEN
takes a lot of time. Working out a KeyGEN in such cases might however help you to improve
your knowledge on KeyGEN coding :)<br>
<br><br>
<a name=#Step_4><font size=4><u>Step 4: What do I have to take care of?</u><br></font></a>
Well this is just an addendum to the last step, however I suggest you to really find out
if special chars are allowed in the Registration Data and what the minimal length of your
name needs to be. Also be sure to check if spaces are allowed.<br>
<br><br>
<a name=#Step_5><font size=4><u>Step 5: Using the described technique</u><br></font></a>
Now it's time for some real work with the technique I (tried) to explain in the above
steps. If you haven't understand them all, there is now another chance you do so :)<br>
<br>
As a target I've chosen an in my opinioun EASY target. I could've chosen a DIFFICULT target, but
that's not really needed here, because if you want to KeyGEN DIFFICULT things you FIRST need the
basic technique to work perfectly. That's the key to success! Enough theory now; let's use the
technique.<br>
<br><br>
I do assume you have the basic knowledge of cracking and a little experience so that you can
actually find the compare between the real serial and the wrong one. If you don't have
that experience you should read some more tutorials and then come back to this one. This is
definately not a tutorial for a complete beginner to cracking, although lots of beginners might
(hopefully) understand :)<br>
<br><br><br>
After having enterd your Registration Details and after tracing a little bit throught the code
you'll come accross the code, which calculates your serial <i>(CALL, JNZ is always very
suspicious)</i>:</font><br>

<font color=#008000><tt><pre>
   :0045D7BD  C745F800000000      MOV       DWORD PTR [EBP-08],00000000
   :0045D7C4  C745F400000000      MOV       DWORD PTR [EBP-0C],00000000
   :0045D7CB  C745F000000000      MOV       DWORD PTR [EBP-10],00000000
   :0045D7D2  C745EC00000000      MOV       DWORD PTR [EBP-14],00000000
   :0045D7D9  C745E800000000      MOV       DWORD PTR [EBP-18],00000000
   :0045D7E0  C745E438270000      MOV       DWORD PTR [EBP-1C],00002738
   :0045D7E7  8B4508              MOV       EAX,[EBP+08]
   :0045D7EA  8945FC              MOV       [EBP-04],EAX
   :0045D7ED  66C745D80000        MOV       WORD PTR [EBP-28],0000
   :0045D7F3  E904000000          JMP       0045D7FC
   :0045D7F8  66FF45D8            INC       WORD PTR [EBP-28]
   :0045D7FC  0FBF45D8            MOVSX     EAX,WORD PTR [EBP-28]
   :0045D800  83F82B              CMP       EAX,2B
   :0045D803  0F8D5B000000        JGE       0045D864
   :0045D809  0FBF45D8            MOVSX     EAX,WORD PTR [EBP-28]
   :0045D80D  8B4DFC              MOV       ECX,[EBP-04]
   :0045D810  0FBE0408            MOVSX     EAX,BYTE PTR [ECX+EAX]
   :0045D814  8945E0              MOV       [EBP-20],EAX
   :0045D817  8B45E0              MOV       EAX,[EBP-20]
   :0045D81A  69C049870100        IMUL      EAX,EAX,00018749
   :0045D820  0145F8              ADD       [EBP-08],EAX
   :0045D823  8B45E0              MOV       EAX,[EBP-20]
   :0045D826  69C061870100        IMUL      EAX,EAX,00018761
   :0045D82C  0145F4              ADD       [EBP-0C],EAX
   :0045D82F  8B45E0              MOV       EAX,[EBP-20]
   :0045D832  69C095860100        IMUL      EAX,EAX,00018695
   :0045D838  0145F0              ADD       [EBP-10],EAX
   :0045D83B  8B45E0              MOV       EAX,[EBP-20]
   :0045D83E  69C037870100        IMUL      EAX,EAX,00018737
   :0045D844  0145EC              ADD       [EBP-14],EAX
   :0045D847  8B45E0              MOV       EAX,[EBP-20]
   :0045D84A  69C057870100        IMUL      EAX,EAX,00018757
   :0045D850  0145E8              ADD       [EBP-18],EAX
   :0045D853  8B45E0              MOV       EAX,[EBP-20]
   :0045D856  69C0D9860100        IMUL      EAX,EAX,000186D9
   :0045D85C  0145E4              ADD       [EBP-1C],EAX
   :0045D85F  E994FFFFFF          JMP       0045D7F8
   :0045D864  8B45F0              MOV       EAX,[EBP-10]
   :0045D867  0345F4              ADD       EAX,[EBP-0C]
   :0045D86A  0345F8              ADD       EAX,[EBP-08]
   :0045D86D  0345E4              ADD       EAX,[EBP-1C]
   :0045D870  0345E8              ADD       EAX,[EBP-18]
   :0045D873  0345EC              ADD       EAX,[EBP-14]
   :0045D876  B93DBB0D00          MOV       ECX,000DBB3D
   :0045D87B  99                  CDQ
   :0045D87C  F7F9                IDIV      ECX
   :0045D87E  8D4201              LEA       EAX,[EDX+01]
   :0045D881  8945DC              MOV       [EBP-24],EAX
   :0045D884  8B450C              MOV       EAX,[EBP+0C]
   :0045D887  3945DC              CMP       [EBP-24],EAX
   :0045D88A  0F850F000000        JNZ       0045D89F
   :0045D890  B801000000          MOV       EAX,00000001
   :0045D895  E90C000000          JMP       0045D8A6
</pre></tt></font>
<font face=verdana,arial,helvetica size=2>
Now you have to understand the calculation instructions ... that's mostly quite easy once you
found them all. Try to work out how the serial is generated yourself and then read on ...<br>
<br>
<br>
So you know how it's generated, right? Well for a maximum of 2B h times <i>(0045D800)</i>, a
char of your name is read out and</font><br>

<tt><pre>
&nbsp;&nbsp;&nbsp;- multiplicated by 18749 h and added to [EBP-08] <i>(0045D81A and 0045D823)</i>
&nbsp;&nbsp;&nbsp;- multiplicated by 18761 h and added to [EBP-0C] <i>(0045D826 and 0045D82C)</i>
&nbsp;&nbsp;&nbsp;- multiplicated by 18695 h and added to [EBP-10] <i>(0045D832 and 0045D838)</i>
&nbsp;&nbsp;&nbsp;- multiplicated by 18737 h and added to [EBP-14] <i>(0045D83E and 0045D844)</i>
&nbsp;&nbsp;&nbsp;- multiplicated by 18757 h and added to [EBP-18] <i>(0045D84A and 0045D850)</i>
&nbsp;&nbsp;&nbsp;- multiplicated by 186D9 h and added to [EBP-1C] <i>(0045D856 and 0045D85C)</i>
</pre></tt>
<font face=verdana,arial,helvetica size=2>
If your name is not 2B h chars long, then the rest of the chars will be just ignored.
<br>
<br>
After that multiplication thing, [EBP-08], [EBP-0C], [EBP-10], [EBP-14], [EBP-18] and
[EBP-1C] were added together <i>(0045D867 up to 0045D873)</i> and then divided by
<i>(0045D876 and 0045D87C)</i> DBB3D h. Finally the remainder of that
division is increased by 1 <i>(0045D87E)</i> - and that's the real serial then. It's that
easy :)<br>
<br>
<br>
I don't see an interest in the whole KeyGEN source, so I've just added that calculation part to
this tutorial:</font><br>

<font color=#008080><tt><pre>
   short int Calculate(HWND hDialog)
   {
    unsigned char name[50]      = {0};
    unsigned char serial[100]   = {0};
    unsigned long EAX           = 0;
    unsigned long TMP           = 0;
    unsigned long EBP_10        = 0;
    unsigned long EBP_0C        = 0;
    unsigned long EBP_08        = 0;
    unsigned long EBP_1C        = 0x2738;
    unsigned long EBP_18        = 0;
    unsigned long EBP_14        = 0;
    unsigned long i             = 0;
    static HWND hControl;
   
    hControl = GetDlgItem(hDialog, EDIT_NAME);
    GetWindowText(hControl, &amp;name, 43);
   
    for (i = 1; i &lt;= 0x2B; i++)
    {
      if (i &lt;= strlen(name))
      {
       EAX = name[i-1];
       EBP_08 += (EAX * 0x18749);
       EBP_0C += (EAX * 0x18761);
       EBP_10 += (EAX * 0x18695);
       EBP_14 += (EAX * 0x18737);
       EBP_18 += (EAX * 0x18757);
       EBP_1C += (EAX * 0x186D9);
      }
    }
   
    EAX  = EBP_10 + EBP_0C + EBP_08 + EBP_1C + EBP_18 + EBP_14;
    TMP  = EAX / 0xDBB3D;
    EAX  = EAX - (TMP * 0xDBB3D);
    EAX += 1; 
   
    wsprintf(serial, &quot;%lu&quot;, EAX);
   
    hControl = GetDlgItem(hDialog, EDIT_CODE);
    SetWindowText(hControl, serial);
   
    return 0;
   }
</pre></tt></font>
<font face=verdana,arial,helvetica size=2>
Feel free to e-mail me feedback, questions or whatever <i>(NO crack requests!!)</i>. You can
also talk to me on IRC (EFNet) at
<font color=#000080>#ImmortalDescendants</font>,
<font color=#000080>#PhrozenCrew</font> or
<font color=#000080>#cracking4newbies</font>.
</font>

<br><br><br><br>

<font face=verdana,arial,helvetica size=2 color=#0000FF>
Another lesson has just finished. Hopefully you have learned something useful from it!
Feel free contacting me anytime ... till next time, I highly recommend you to visit
<i>(or better download completely)</i>
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm">+Fravia's excellent site</a>, which has
unfortunately been frozen!
</font>

<br><br>

<hr size=1 width=100%>
<font face=verdana,arial,helvetica size=2>
<font color=#990099>Greetings <i>(no specific order)</i>:</font><br><br><font color=#000080 size=1>
+Aesculapius, +Fravia, +MaLaTTiA, +ORC, +wAj, ^TheDevil, /Miz, ACiD BuRN, adenozin, alpine, AntiMaterie, AppBusta, Artex, Black Check, BJanes, ByteBurn, cALiGo, CoRN2, Carpathia, CrackZ, Crashtest, Cruehead, Da GRiM ReaPeR, DEATH, DEZM, DnNuke, douby, duelist, Eternal Bliss, FireWorx, G-RoM, HarvestR, Icecream, Iczelion, Jeff, josephCo, Kaparo, knotty, Kwai_Lo, LagPRO, LaZaRuS, Lord Soth, Lucifer48, MisterE, MiZ, McCodEMaN, Mr. NOP, Mr. WhiTe <i>(WKT)</i>, NeuRaL NoiSE, nIabI, NiKai, Nitrus, Noos, Northpole, pain, Pedro, PeeGee, PeeWee, ^PlAyEr^, Predator NLS, Prof. X, Quantico, r4lph, R!SC, Rhytm, rudeboy, Santa Clawz, Scribe, SiONiDE, Steinowitz, TaG^, TaMaMBoLo, The +Sandman, The AntiXryst, The OWL, Thesmurf, Tin, tKC, viny, VisionZ, Vladimir, Volatility, yAtEs, yosh, ytc, WarezPup, WhizKiD, widYa@cL 2011.
</font></font>
<hr size=1 width=100%>
<center><font face=verdana,arial,helvetica color=#008000 size=2>
<b>Copyright &copy; 1999 by TORN@DO [ID/PC]. All Rights Reversed.</b>
</font></center>
</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>snooty2.htm:  Unprotecting unprotectors ; or how AccessData failed itself by relying on StopCopy</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><i>
Courtesy of reverser's pages of reverse engineering
</i><bR>~<bR>15 July 1998</center>
 <HR size=1><pre><center>Unprotecting unprotectors
or 
how AccessData failed itself by relying on StopCopy
by Snooty, July 1998</center>

Tools Needed
Filemon
Regmon
Winasm89
Hex Editor (I like Hexpert)

This is a lesson on fear and learning not to feel it (when it comes 
to hacking, that is.  You've got a Doberman behind you, run for your 
life!)  This is a story of how an average cracker took on the big 
boys and won.  It is also the story of how a company that created 
some good DOS-based protection schemes relied on some expensive 
third-party protection software and died trying.

Accessdata is a company out of Orem, Utah which specializes in 
password cracking for many popular applications - Word, Excel, 
WordPerfect, Paradox, Lotus, etc.  They have been around since 1985 
or so, and their stuff works well.  You can reach them at 
www.accessdata.com to pick up their most recent Win32 'demo'.  This 
is a fantastic piece of work (hereafter referred to as 'the target') 
that has crackers for over 18 different applications with over 45 
versions supported in all.  It is the latest and greatest in 
deprotection.  Licenses are available for different 'modules' that 
allow the user to crack  specific applications.  Note that this demo 
is the second demo that Accessdata has distributed.  The first one 
was written completely for DOS, and was much harder to crack.  It is 
a great testpiece for crackers to sharpen their skills.

The primary protection on this proggie is a third-party wrapper 
written by StopCopy, a commercial vendor.  It uses a 'key disk' to 
store license data and other random, secret files to lock the 
original application.  As we will see, there are some other 
subroutines that test for code tampering, date changing, and license 
altering.  You can find out a lot about the program at 
<a href="http://www.bbics.com/q&a.htm"  target=_blank>http://www.bbics.com/q&a.htm</a>.  Here are some intimidating quotes from 
the page:
<font color=purple>
StopCopy is an easy to use, extremely powerful software protection 
package which can effectively protect anyone's valuable software 
investments. It remains virtually transparent to the honest end-user, 
and is loaded with options.  PC versions of StopCopy can reliably 
defeat all SOFTWARE copiers executing on an IBM/Compatible computer.  
Macintosh versions of StopCopy can reliably defeat all SOFTWARE 
copiers executing on a Macintosh computer.  It is the program of 
choice for developers wishing to defeat all software copiers for a 
very low price.

Q.    What stops a hacker from simply removing the protection code?
A.    All StopCopy Products employ extensive encryption and    
      checksumming routines. (Mommy!) Also, the developer can choose 
      to use multiple layering (???) , which will afford him even more 
      protection.
</fonT>
Ok, lets crack this nooge (pronounced knew-j as in 'jerk')

You start this proggie up and you get a splash screen, saying 
"Verifying License Data".  It obviously can't, then a second box 
comes up demanding that you insert your license diskette.  But, I 
don’t have one!  So I must hit Cancel and go into demo mode. A third 
box pops up saying that I can try it ,etc.,etc. but it will only 
recover passwords of 10 characters. OK.

Now a thought for a long time.  Was this nooge complete?  That is, 
was this proggie distributed in its entirety by a greedy software 
vendor (with dollar signs for eyes), or were there subroutines on 
this license diskette that were vital to the proper operation of the 
program.  Was StopCopy providing vital services, vital code I would 
need to have, or was the key disk some kind of bullshit  'check for 
good guy and his license files' crapola?

Run Filemon and Regmon.  We see some files being accessed but they 
look like the latter - some extremely complicated license files in 
some 5000-bit encryption key that no one will ever break.  BUT,  no 
access of vital .dlls or .exes of something like that.  This nooge 
was complete - how else could it recover the passwords except by 
scanning all of them?  I felt it at a deep level that I had it by the 
balls.

Fire up Winasm8.9

Search through the strings embedded in the prog - we see such 
interesting bits as "Law Enforcement Version","Your time has 
Come","Operating in Demo Mode" (boo,hiss), and "This Program has been 
Corrupted".  OK,  Let start with the last one, and use a regimented 
approach to cracking the schemes one by one.   Again, some thought.  
Obviously we will need to fix the checksumming routine first, or all 
of our efforts will be in vain.  Start by finding the string "This 
Program has been Corrupted"

This is the relevant code:

:00401D97 A154C05800		mov eax, dword ptr [0058C054]
:00401D9C E8F7570600		call 00467598
:00401DA1 E87AFEFFFF        	call 00401C20
:00401DA6 E895FDFFFF        	call 00401B40
:00401DAB 803D20B9500000 	cmp byte ptr [0050B920], 00
:00401DB2 7527 			jne 00401DDB  &lt; ---- check is here!
:00401DB4 6A30 			push 00000030

* Possible StringData Ref from Data Obj -&gt;"Corrupted Executable"
                               
:00401DB6 B9E1044F00 		mov ecx, 004F04E1

* Possible StringData Ref from Data Obj -&gt;"This program has been 
corrupted."
                                  |
:00401DBB BA9F044F0		mov edx, 004F049F
:00401DC0 A108215900		mov eax, dword ptr [00592108]
:00401DC5 E8E6B50900 		call 0049D3B0
:00401DCA 33C0 			xor eax, eax


Change the 75 to 74 at 00401DB2.  Incredibly, that one byte kills off 
the so-called 'extensive' checksumming routines.

Phase 2 - Lets kill off the time check by the numbers.  Search for 
the string "Your Time was Come".  Youll find it along with a long 
harangue about expiration, order the target, etc.etc,etc.  Heres the 
snippet:

Referenced by a Jump at Address:004056DC(C)

:00405A94 E82A650900 		call 0049BFC3
:00405A99 DD9D60FFFFFF		fstp qword ptr [ebp+FFFFFF60]
:00405A9F 8D8560FFFFFF 		lea eax, dword ptr [ebp+FFFFFF60]
:00405AA5 E836360000 		call 004090E0
:00405AAA 3B056CB55200 		cmp eax, dword ptr [0052B56C]
:00405AB0 7435 			jle 00405AE7 &lt;  ---- check is here!
:00405AB2 6A41  		push 00000041

* Possible StringData Ref from Data Obj -&gt;"Your Time Has Come"
                                
:00405AB4 B9B34D4F00  		 mov ecx, 004F4DB3

* Possible StringData Ref from Data Obj -&gt;"This program has expired.  You "
-&gt;"may click 'Cancel' to attempt "
-&gt;"to run it with a license diskette "
-&gt;"if you have received one.  Otherwise, "
-&gt;"click 'OK' to exit the program. "
-&gt;" Contact AccessData for details."

Change the 7E to EB and thats the end of the 'extensive' time expiry 
protection!

Phase 3 - Lets kill off the demo nag screen by the numbers.  Search 
the String refs for 'You are About to enter Demo Mode".

* Referenced by a Jump at Addresses:00405B1A(C), :00405BF0(U), :00405C40(U), 
:00405D11(C), :00405D44(U) :00405D73(U)
:00405DA2 E82E160200 	call 004273D5 &lt;   ---- and a suspicious little bastard here!
:00405DA7 84C0  		test al, al
:00405DA9 7422  		je 00405DCD
:00405DAB 8B0D08215900   	mov ecx, dword ptr [00592108]
:00405DB1 80797C00  		cmp byte ptr [ecx+7C], 00
:00405DB5 7516  		jne 00405DCD &lt;  ---- Demo Nag Screen here!
:00405DB7 6A00   		push 00000000

* Possible StringData Ref from Data Obj -&gt;"You are about to enter Demo Mode."

:00405DB9 B9B2524F00 		mov ecx, 004F52B2

* Possible StringData Ref from Data Obj -&gt;"The Password Recovery Toolkit "
-&gt;"demo can recover passwords created "
-&gt;"in applications such as WordPerfect"

:00405DBE BA9E4F4F00   		mov edx, 004F4F9E
:00405DC3 A108215900  		mov eax, dword ptr [00592108]
:00405DC8 E8E3750900   		call 0049D3B0


By this time I was breathing pretty easy - StopCopy is a fucking 
Joke! Also I thought I had finally split this nooge with one final  
edit   - after all, it jumps the demo mode. So I Change the 74 to EB 
- and nothing happens.  A dark pall was cast onto the scene - I felt 
a nameless presence, and I knew its name was "Multiple Checks"  This 
snippet of code was referenced by six different other calls, and I 
knew that tracing them down would be a hassle, a snarly maze of irets 
and calls twisting in and back on themselves.  Long thinky.

I was at the starting point, and I knew the finish too - it was after 
the window opened up and everything was loaded, waiting for the user 
to do something.  I figured that all the security choices would have 
already been made by this point, so the solution lay in finding a 
reference point in the middle to guide by.  Perhaps by working from a 
known middle location I could connect the dots and find the path.  
Search through the string refs, always the string refs, until I find 
one that I like - "Law Enforcement Version".  This I like - this must 
be on the right path.  Lets look at it:

* Possible StringData Ref from Data Obj -&gt;"C:\"

:00407B39 BA8F534F00              mov edx, 004F538F
:00407B3E 8D45FC                  lea eax, dword ptr [ebp-04]
:00407B41 E81A670600              call 0046E260
:00407B46 FF45D8                  inc [ebp-28]
:00407B49 8B10                    mov edx, dword ptr [eax]
:00407B4B 8B4DB8                  mov ecx, dword ptr [ebp-48]
:00407B4E 8B819C020000            mov eax, dword ptr [ecx+0000029C]
:00407B54 E8C7860D00              call 004E0220
:00407B59 FF4DD8                  dec [ebp-28]
:00407B5C 8D45FC                  lea eax, dword ptr [ebp-04]
:00407B5F BA02000000              mov edx, 00000002
:00407B64 E857690600              call 0046E4C0
:00407B69 E802DBFFFF              call 00405670
:00407B6E A154C05800              mov eax, dword ptr [0058C054]
:00407B73 E8E0020700              call 00477E58
:00407B78 8B1554C05800            mov edx, dword ptr [0058C054]
:00407B7E 8955F8                  mov dword ptr [ebp-08], edx
:00407B81 837DF800                cmp dword ptr [ebp-08], 00000000
:00407B85 7419                    je 00407BA0
:00407B87 66C745CC2000            mov [ebp-34], 0020
:00407B8D BA03000000              mov edx, 00000003
:00407B92 8B45F8                  mov eax, dword ptr [ebp-08]
:00407B95 8B08                    mov ecx, dword ptr [eax]
:00407B97 FF51FC                  call [ecx-04]
:00407B9A 66C745CC1400            mov [ebp-34], 0014

* Referenced by a Jump at Address: 00407B85(U)
|
:00407BA0 803DF88A580000          cmp byte ptr [00588AF8], 00
:00407BA7 0F8482000000            je 00407C2F
:00407BAD 66C745CC2C00            mov [ebp-34], 002C
:00407BB3 8D45F4                  lea eax, dword ptr [ebp-0C]
:00407BB6 E8E5A9FFFF              call 004025A0
:00407BBB 8BD0                    mov edx, eax
:00407BBD FF45D8                  inc [ebp-28]
:00407BC0 8B45B8                  mov eax, dword ptr [ebp-48]
:00407BC3 E89CF50500              call 00467164
:00407BC8 8D55F4                  lea edx, dword ptr [ebp-0C]
:00407BCB 52                      push edx
:00407BCC 8D45EC                  lea eax, dword ptr [ebp-14]
:00407BCF E8CCA9FFFF              call 004025A0
:00407BD4 50                      push eax
:00407BD5 FF45D8                  inc [ebp-28]

* Possible StringData Ref from Data Obj -&gt;" - Law Enforcement Version"
                                  |
:00407BD8 BA93534F00              mov edx, 004F5393
:00407BDD 8D45F0                  lea eax, dword ptr [ebp-10]
:00407BE0 E87B660600              call 0046E260
:00407BE5 FF45D8                  inc [ebp-28]
:00407BE8 8D55F0                  lea edx, dword ptr [ebp-10]
:00407BEB 59                      pop ecx
:00407BEC 58                      pop eax
:00407BED E825690600              call 0046E517
:00407BF2 8D55EC                  lea edx, dword ptr [ebp-14]
:00407BF5 8B12                    mov edx, dword ptr [edx]
:00407BF7 8B45B8                  mov eax, dword ptr [ebp-48]
:00407BFA E895F50500              call 00467194
:00407BFF FF4DD8                  dec [ebp-28]
:00407C02 8D45EC                  lea eax, dword ptr [ebp-14]
:00407C05 BA02000000              mov edx, 00000002
:00407C0A E8B1680600              call 0046E4C0
:00407C0F FF4DD8                  dec [ebp-28]
:00407C12 8D45F0                  lea eax, dword ptr [ebp-10]
:00407C15 BA02000000              mov edx, 00000002
:00407C1A E8A1680600              call 0046E4C0
:00407C1F FF4DD8                  dec [ebp-28]
:00407C22 8D45F4                  lea eax, dword ptr [ebp-0C]
:00407C25 BA02000000              mov edx, 00000002
:00407C2A E891680600              call 0046E4C0


Scanning upwards from the string ref, we see an unconditional call 
from 00407B85, And the best part of all is it’s the only one.  So 
change the 74 to EB at 00407B85.  Now at 00407BA7, we have another 
conditonal - lets change that one too (from 84 to 85) to streamline 
this baby right into the Law Enforcement Version string.  I try it 
again and it still is not fully functional, although it does say Law 
Enforcement Version now.  But it still only cracks ten character 
passwords.  I take a gamble - I know 10 is 0xA and this is a 32-bit 
app (the dlls scream it at you), so a stupid protectionist will 
compare the password to 0000000A.  I search the file and there are 
about twenty of them, but one lets off a stinky aroma:

:00430D44 50                      push eax
:00430D45 E87759FFFF              call 004266C1
:00430D4A 59                      pop ecx
:00430D4B 84C0                    test al, al
:00430D4D 0F8552010000            jne 00430EA5
:00430D53 837D840A                cmp dword ptr [ebp-7C], 0000000A &lt;--- Stinky!
:00430D57 0F8448010000            je 00430EA5
:00430D5D FF7580                  push [ebp-80]
:00430D60 8B5508                  mov edx, dword ptr [ebp+08]
:00430D63 FFB23C020000            push dword ptr [edx+0000023C]
:00430D69 E85256FEFF              call 004163C0
:00430D6E 83C408                  add esp, 00000008
:00430D71 0FBEC8                  movsx ecx, al
:00430D74 83F94E                  cmp ecx, 0000004E
:00430D77 7536                    jne 00430DAF
:00430D79 66C745984400            mov [ebp-68], 0044

* Possible StringData Ref from Data Obj -&gt;"&lt;No Password&gt;"
                                  |
:00430D7F BAE5245200              mov edx, 005224E5
:00430D84 8D45E8                  lea eax, dword ptr [ebp-18]
:00430D87 E8D4D40300              call 0046E260
:00430D8C FF45A4                  inc [ebp-5C]


Here we have a compare sandwiched between to calls to the bugger off 
routine, right it the middle of the password verification algorithm.  
I start (and finish) with this one - change the top jump from 85 to 
84.


Now it works!


Several final points:
1.  I was intimidated by this program because it had professional 
protection.  There was no need to be.  On the contrary, the original 
schemes written by Accessdata is DOS took me about one week each to 
crack the proggies one by one.  

2.  There are of course several types of protection in this scheme - 
checksumming, time expiry, the stopcopy stuff, and the ten-character 
password check.  None of these were hard to beat, but they required a 
regimented approach to beat the entire system.  By concentrating on a 
single step, the journey was finally completed, but none of the steps 
were hard.

Finally, I had to change my style three times.  I started out 
following string references to kill of the checksumming and time 
expiry.  Then I worked from the middle, transposing from the string 
references to call tracing.  Finally, I used a little Zen to find the 
0000000A connection.  As Lee said, be like the water.

Snooty
</font></pre>
<center>
<hr size=5>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0> 
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A>

<bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </A></CENTER>
<hr size=4></fonT></center></center>

</body>
</HTML>

</body>
</html>


<html>
<head><title>pain1.htm</title></head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">How to USE nag screens</font>
<br>(Nagscreens and CRC checking show us the way)<br><br><h4>by ^pain^ <br>
<br>
(11 November 1997, snatched and slightly edited by reverser+)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<br>
<br><i>Well, a 'snatched' essay... strangely enough ^pain^ never sent it to me... yet I find it interesting! Therefore I have decided to publish it nevertheless!</i></center><hr size="6"><pre>
8/24/97           
<center>How to USE nag screens?
=======================</center>

Introduction
------------
What I`m about to teach in this tutorial, is simply how to USE nag screens,
yeah yeah, it sounds ridiculous, and, I`m not sure that i`m not inventing
the Wheel here, but, I've never seen any tutorial about this issue...

I`ll assume you have some knowledge in:

1.SoftIce (Winice will be more percisive...).
2.cracking (ie, about 2-3 months of cracking..).
3.Nag Screens (How to kill'em - but, that's of course not what will be discussed
  here).

Tools you`ll need for this tutorial:
1.SoftIce 3.00/01.
2.Hex Work Shop (ANY VERSION) / or any other good Hex Editor.

Programs that will be discussed in here:

1.DeskWipe v1.2                 : URL - Http://Home.sol.no/Frankm
2.Idyle Phone Book Pro 97 V2.21 : URL - Http://www.idyle.com/


                 Some words for start
                ----------------------
What we're going to be doing here, is to use the nag screens in order to
get to the registration routines, in programs that newbies usually find
hard to handle - The programs that have NO visible registration info...
Which means, programs without register boxes... etc..

Our basic method here, will be to set a break point on a messagebox , or
some other forms of nag screens that will be discussed here later,
then , after breaking in the nag screen routine, look back in the code,
and see what condition brought us to the nag screen, then, break point in that
condition (ie, je,jz,jnz etc....), and disable it... ;-)
Sounds like we`re just about to start our cracking here...... :)


The first program I'd like to discuss is one of the simplest...

                DeskWipe 1.2 Cracking (Using nag screen).
              --=========================================--
OK, we're all set with SoftIce running?
great, lets start the program to see the actual protection scheme...

After launching DeskWipe 1.2 , quickly pops a nag screen, errrgh! sux!
Lets Exit the program , and set a bp on messageboxa, then, run it again...
oh, no ;`[ , we're lost, messageboxa wasn`t such a lucky guess,
Hmm..... Now, we can use our knowledge in nag screen (which is not too hard
to achieve btw...;), while we're in the nag screen, press CTRL+D, And,
type hwnd deskwipe...
You`ll see only one button , BMSG on it, (For me , it gave 0688...).
Now, press CTRL+D, and follow my instructions FULLY! (I'd really wish to
talk to you guys about these stuff, but, that's not for this tutorial,
and, it won`t serve my targets...).

1.After pressing CTRL+D , you`ll pop again in SICE, press F12 9 times.
2.press F10 several times, until you get to this instruction:
...
  MOV EAX,[EBP-04]
  MOV EAX,[EAX+00000128]
  TEST EAX,EAX
  JZ  420940       / This one, you`ll have to NOP in order to pass the nag screen,
                   / because, this is the condition, if the Button was pressed
                   /or wasn`t... (That was just a side comment).
  ...
  NOP the JZ...
3.now, we can Continue pressing F12 7 more times...
  until we're popped in this instruction:
...
  CALL 00425728
  POP  ECX
  POP  ECX
...
  Let's now press CTRL+UP several times, (to see the above code, that 
  brought us to this nag screen)
  Until you get to this:
  MOV EAX,[429664]  / The initial value for the registration routine
  CALL 425FFC       / The registration routine itself!!! ;)
  INC EAX           / The Boolean identifier, that's used to determine if
  JZ  426EA6        / The registration was successful...
...
  I`ll leave you guys the job to Register this program (NOTE that in order
  to crack this one with Patching, you`ll HAVE to change EAX's value INSIDE
  the registration routine, But, it won`t be the BEST crack, for making the
  BEST crack, you`ll have to make a license file... - I`ll leave this job to
  you, I`m not trying here to teach how to do key files, I already assume
  that you can handle the registration routine by yourself... ;)


  Well , that's it for this program , Now , Let's move to some harder
  Job... ;)
              
  Lets Crack Idyle Phone Book Pro 97 Now!!

                   Phone Book Pro 97 V2.21 Cracking!!!
                 --===================================--

I'd like to take this opportunity to GREET the author, Damien Rame, for a 
GREAT interface: I've never seen a better phone book! If you use this program,
please send him money! he deserves that! 
This one, is about to be harder to do than the previous one.
I`m about to do patching here , just to give you an example of a CRC checking
that's kicking ya from the program if it detects patching (this is usually
done by doing CheckSum to the EXE and  comparing it with a Value that's
kept somewhere...)
We're all set with our little SoftIce? :)
great!
Lets launch the program...
press the About/Register button...
Hmm, interesting... the author seems to be pretty smart, look what he did,
he DIDN`T give ya ANY buttom to press in order to tell the program to check
the registration info that was entered!!!
How do we solve this problem?
Well, it's obvious that the program checks the registration info in REAL TIME
(ie, when you enter it in the dialog box).

OK, Let's try something here:
I entered Name    :^pain^ '97
          Reg Code: 9999999
Wait, Let's Press CTRL+D, and, set a bp in HMEMCPY,then , press CTRL+D again,
and, add another char to the reg code...
YES! we popped right next to the registration routine...
Let's press F12 now until we get to the program code, and, trace the code
until we get to this instruction (The registration routine itself):
...
  MOV EDX,EBX
  MOV EAX,EBX
  CALL 49616C
  TEST AL,AL
  JZ  004968B4
...
Now, it's obvious what you should do: trace in the registration routine,
Set a bp on some code in the registration routine, and, restart the program.
(Don`t worry, I know what I`m doing...)
After we pop back in Sice...
Exit the routine, and ,do the patch OUTSIDE the routine!!! (VERY IMPORTANT!)
(ie, TEST AL,AL ===&gt; OR AL,01)

Now, we're all set for the point I want to discuss... :)
Launch the program! 
Oh my! Now Look what happens! This program does CRC checking! (Did I ever
say the author is a smart guy? ;-) Although, he did a stupid thing...
Left us a MSG TYPE ERROR BOX!!! (That says there was a CRC error, and that 
the program will now be terminated!) Let's use this to our advantage! :)

Launch the program AGAIN!
when you get to the Error Button.
1.Type in Sice HWND.
2.BMSG on the ONLY button that PHONEBOOK uses.
3.Press CTRL+D
4.Press F12 5 times.
5.Press F10 until you get to this instruction:
...
  Mov EAX,[EAX+00000150]
  TEST EAX,EAX
  JZ 00430CE2    /  Nop the JZ...
                   (Only a temporary change for passing the msg box).
...
6.Press F12 8 more times.
7.Press CTRL+UP some times, until you see this:
  CALL 445570  / CRC Checking routine... :)
  CMP  EBX,-2  / Boolean Identifier.
  JNZ  459409

  Now, All you have to do, is to change the CMP EBX,-2 ==&gt; MOV EBX,01
                                            JNZ 459409 ==&gt; JMP 459409
  And , we're all set! ;)
  simple eh? :)
  After nopping it, patch the EXE and you will have a FULL crack! :)
 
  NOTE that that's not how I did the crack, I did a better patch, but I really
  don`t remember now what the cuckoo did I patch, and, it's not really important 
  for our discussion anyway ;) So, you`ll have to forgive me... 


Well, I think that's it, I've cleared my point, and , I think it's time to 
Sign off... 
Hope you found this info interesting.....(I wouldn`t like to have spent my 
time for nothing... ;-)

Ohhh...... almost forgotten, I'd like to greet the following dudes:
Acp,Niabi,JosephCo,_rANDOM,|KAIRN|,Razzi,Yoshi,GrimL0ck,kOUGER,Odin,
[J0B],Qapla,Leddy,TeRaPhY!,
All the great guys in  #cracking &amp; #Cracking4newbies 
And all the rest of you M$ fighters I've forgotten!

Signing off - ^pain^ [mEXELiTE] in the year of 1997 - 

</pre>
<font color="green">(c) ^pain^ 1997. All rights reversed</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>

<!-- saved from url=(0022)http://internet.e-mail -->
<html>
<head>
<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp">
<title>Zen and the Art of Dongle Cracking</title></head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">Zen and the Art of Dongle Cracking</font>
<br>(A somehow 'general' essay about dongles)<br>

<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><img SRC="images/project3.gif" tppabs="http://members.xoom.com/tsehp_/images/project3.gif" ALT="project3" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a>
<br>
<!--<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/tough.gif" ALT="tough" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>-->


<h2><b>by zeezee</b></h2>
<h4>(24 December 1997, slightly edited by reverser+)</h4>

<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<hr>
<i>Well, our dongle cracking project was being a little neglected... which is not nice, 
yet somehow <u>understandable</u>...
huge economic interests are in play here, and many 'lower' crackers prefer to find an
'economic' arrangement with the dongle producers instead of publishing their (simple) cracks... (which is
something that real +crackers should never do!)<br>And we have unfortunately had other delays as well: Marta never sent
his contributions (we all know how lazy these spanish friends are :-) and
we are all still awaiting Quine's promised HASP tutorial (should be there soon,
be prepared!)<br>Luckyly we have
zeezee working hard on this as well! This is what zeezee wrote me:</i></center><pre><font color="purple">
hi reverser+

This time comes a little more 'general' essay about dongle cracking.
After winning with 4 dongles and loosing with one I can draw some general
conclusions which may help all will-be dongle crackers</font></pre><i><center>
Now read and enjoy... +HCU's dongle cracking 
is gaining 'momentum' (was about time... this 
crap 'faked hardware' solution was gaining too much place (and easy money) on the 
protection scene... funny! As if a good logic analyzer would not be enough to crack any stupid 
dongle black and blue!<br><br>I'll tell you what I like about this essay: zeezee DOES NOT 
gives us here <u>any specific target</u>! In fact to know which target a cracker is 
working on is mostly utterly unimportant... the important thing 
for us is to learn HOW to reverse this kind of code, not to learn how to crack a 
specific program... Hey! You better learn it right now in 1997 (you have still a week 
before 1998), should you never 
have understood 
it until now: there are BILLIONS software programs out there... well, most are crap, 
yet say 
there are <u>hundred thousands</u> good software programs you could eventually 
enjoy 
out there... what's the point of giving any luser a 'specific' crack? (besides... 
most of the time it's much more fun cracking such software than using it :-)<br>
You dig it? A 'specific' target 
crack (with few exceptions) has therefore -mostly- NO interest whatsoever for us... 
what we want is to understand 
how another fellow +cracker tackled HIS target in order to tackle OUR (completely 
different) ones with this knowledge somewhere in our 'collective memory'... therefore
zeezee's approach is VERY GOOD. You won't learn here how to deprotect a specific 
dongle target, you will -eventually- learn how to crack your own dongle protected crap next 
year! (Let's hope you'll write an essay on your approach :-)<br>
Have a happy new 1998!</i></center>
<hr size="6"><pre>
                     Zen and the Art of Dongle Cracking
                     ------------------------------
                               by zeezee


Disclaimer:
I don't publish here any dongle-protected program names since it's not my goal
to make battles with lawyers, you see only relevant code snippets. This
tutorial is not about one specified software or dongle. The example given is
from a real program not widely available. The program itself isn't important.

So, let's start with blah-blah, sorry, with basics.

Dongles are small boxes connected to the LPT port (or sometimes to COM port) of
your computer. They should be (in fact they are in 99%) invisible to printer
connected to this port. There are variants of dongles mounted inside computer
but for us, the exact appearance of the dongle isn't important.

Inside of the dongle is an EEPROM or ASIC or maybe a dead fly. For us this is
only a black box which receives / sends data from our application via piece of
software (dongle API) which is sold with the dongle to app developers.
The app writers call the API and check values returned to make good/bad guy
jumps.

Most popular dongles are:
- Sentinel (big family) from Rainbow Technologies (USA)
- Hasp (not bad) from Aladin (Israel)
- Fest (if I recall made in Germany)
- Actikey (France)
and tens of others... See your favourite Dr Dobb's page.

Tools needed are usual: IDA, SoftICE, HIEW. And of course our application.
No logic analyzer, oscilloscope, maybe LED monitor if you really want it.

So, dear cracker, first step in our tutorial is:

*1* Identify the dongle you are dealing with.

It's not so hard in most cases. Either look at the dongle if you have
access to it, or look at all files that install with your soft, then you may
search all .DLL's, .VXD's etc. for copyright text other than application authors.
You find it quickly in almost all cases.

*2* Gather all possible information from www pages of dongle vendor.
This is VERY IMPORTANT STEP!

You will wonder how much doc you get. Full API, often with source, demo soft,
examples how to use API with your future biggest program etc. Get it all and
study carefully.
Remember: ALL computer hard/soft vendors are present in the Net. Just find them.
Don't panic when you read all info about dongle security. They ARE secure. OK.
You can't crack them unless they're done by complete idiots. OK.
But you want to crack the application, NOT the dongle.
When you read about RSA encryption, one-way functions and see in the
API some interesting Question/Answer hashing functions, remember that it's only
API. No one uses it. Only simple functions like Check/Serial Number/Read and
sometimes Write are used.

*3* You may also get an evaluation dongle from dongle dealer. For free.
If not for free ask for 14-day lease. It works! They want to sell these boxes.
Call these 0-800 or 0130 numbers. They want to help you unless you say something
stupid when asked for software you want to protect.
The people at Rainbow and Aladin dealers are _extremely_ helpful.

*4* Now you know the dongle/app you want to crack and have (or not) some additional
info. Time to think (+Orc calls it Zen).

Imagine a software company making big good proggy. The proggy is almost finished,
then comes the boss and says: &quot;Ok, we're ready, now is the time to protect our
fantastic product. We have a demo kit from dongle X. So, dear programmers, use
it&quot;.
And poor programmers are studying dongle docs, API etc and putting some API
calls into their code.

Sometimes it ends like this:

        call DONGLE
        or ax, ax
        jz goodguy
badguy:

Yes, you may not believe it, yet it's true. (See previous essays)

Sometimes they go little further but in most cases, I repeat: in MOST cases
the idea is stupid.

But the chain is so strong as its weakest link. And in all 4 different progs
protected with different dongles the weakest link was the interface:

     Application - Dongle API (mostly contained in a DLL)

The dongle manufacturers are smart guys, they know how to encrypt data, make
self-modifying code, anti-debug tricks etc. I recommend: Leave their code as is.
The application side is much easier to crack.

The first thing in real crack is to find THE call (rarely more than one) to
the dongle API, Use IDA or WDASM and remember the name of the DLL containing
dongle API and after several minutes (last time 2 hours and 40MB .IDB file!)
you have it.

There should be a part of API statically linked to the executable we are
cracking which calls the DLL, funny people at Aladin make self-mod code here,
so our further goal is to go a bit up.

Our poor programmers are lazy. Everyone is lazy when it comes to make some
dumb work like calling the dongle. So they write their own functions like:

QuickCheckIfDonglePresent()
GetDongleSerialNumber()
ReadDongleByte( addr ) - or word, or dword, or even full table
WriteDongleByte( addr, value )

Maybe they are exported by name? Maybe the name is ReadDongle or similar?

Look carefully at references IDA gives you. You certainly find it.
You should find procs called only once - they should be interfaces between
application/API. Who writes two wrappers to one function?

The dongle API is very well structured in most cases, the function number is
explicitly given, 0 - check, 1 - get number, 2 - read, 3 - write, etc...
Identify where are params/results.
And this is the thing which helps us crack. We may have also the API docs!
The API producers want to make API maximally user-friendly. They make it also
more cracker-friendly... We may find quickly what the app expects from the
dongle by studying API calls and 'cmp ax' following it.

*5* Then comes the active part (you may need dongle for short period of time)
Patch the code inserting a CC byte in the 'App-API Interface' place(s).

Run SoftICE with BPINT 3.

Replace INT 3 with the original byte, then set BPX to this address, trace...
Look what happens when there is no dongle. You may have luck and quickly find
a checkpoint with bad/good guy switch. Try to go the other way and see what
happens (maybe your app starts running).

Try to patch the code to emulate QuickCheckIfDonglePresent function.
Simply return a value which satisfies calling proc.

This may be sufficient in most stupid cases.

Then try to emulate GetSerial# routine. Remember that dongle serial# may be
stored and used to display # in About box. See references IDA gives you.
Not all dongles have GetSerial# proc. Sometimes serial# is read like normal
data from dongle.

This may be sufficient in most not-so-stupid cases.

And then comes to dongle reading. Several bytes are read, I assume that you find
the place where they are stored and all references to this place.
Several checks may happen and certainly will happen in programs with different
options enabled/disabled by the dongle.

maybe so (real example from one of leading SCADA programs)
  cmp eax, some_value1
  je is_model_1
  cmp eax, some_value2
  je is_model_2
  etc.


or maybe so (real example from Israeli program with Israeli dongle)

  test eax, mask_1
  jz lab1
  call enable_option_1
lab1:
  etc.

or maybe so (electrical engineering tools made in France with french dongle)

  12 words read from dongle are stored from [ebx]

  mov ecx, 12
lab1:
  cmp word ptr [ebx], 1
  jne lab2
  call enable_option(cx)
lab2:
  inc ebx
  loop lab1

Believe me. It's real.

If you have a working dongle, read all values from it, and you know what to
emulate (set BPX after API read function does his job and make notes).

And here the real example. The app is useless to you, it isn't freely available,
so let's study the disassembly I prepared for you.

*1* Our dongle is french Actikey and the DLL is CCNMMNT.DLL
*2* We do the disassembly of our target (40 MB) and look into .idata section.
    It takes a little longer than one cocktail...
    The result is astonishing, but I wait until ALL references were displayed.
*3* Crtl-S and go to .idata section. I found extern imported from CCNMMNT.DLL
    Go to reference of it.

00594510 ; Imports from CCNMMNT.dll
00594510
00594510                 extrn CCNMM:dword       ; DATA XREF: j_CCNMM&#24;r

Only one reference! The name j_CCNMM is assigned by IDA!
then:

00408770 ;               S u b r o u t i n e
00408770
00408770 j_CCNMM         proc near               ; CODE XREF: key_io+6F&#24;p
00408770                 jmp     ds:CCNMM        ; jump to Dongle DLL
00408770 j_CCNMM         endp

The name key_io and other below are assigned by me, they are not exported ;-)

Let's go one step up. See: Only one reference. A green light! We are on our 
good way.
then:

0040BA10 key_io          proc near               ; CODE XREF: main_key_check+8
0040BA10                                         ; main_key_check+18C&#24;p
0040BA10                                         ; key_check2+45&#25;p

After checking, I found that key_check2 is called only from the main_key_check,
so we still only have one reference here. We are still inside dongle API code.

Let's go up.

0040B840 ;               S u b r o u t i n e
0040B840
0040B840 main_key_check  proc near               ; CODE XREF: key_fun_00+4D&#24;p
0040B840                                         ; keyfn_18_sernum+68&#24;p
0040B840                                         ; keyfn_02_write+5B&#24;p
0040B840                                         ; keyfn_03_read+56&#24;p
0040B840                                         ; key_fun_1b+50&#24;p
0040B840                                         ; key_fun_1c+54&#24;p
0040B840                                         ; key_fun_1d+5C&#24;p

Of course you may ask, how do I know that this is API and not our 
application? Quick answer: Funcs 1b, 1c and 1d aren't called!
Do you imagine writing wrappers that are never called? They were written by
the dongle makers and linked to the app.
In fact keyfn_02_write isn't called also. This is good news, the key should 
always respond with the same data.

The names of the callers are self-explanatory. Where I got them from? 
Studying the procs, that's all, see for example:

0040A250 keyfn_18_sernum proc near               ; CODE XREF: (several)
0040A250
0040A250 arg_0           = dword ptr  8
0040A250
0040A250                 push    esi
0040A251                 call    key_fun_00
0040A256                 cmp     ax, 1
0040A25A                 jnz     short skc110
0040A25C                 mov     ax, 1           ; 1 - error?
0040A260                 pop     esi
0040A261                 retn

0040A262 skc110:
0040A262                 mov     word ptr ds:key_fun, 18h  ; function 18!!!
0040A26B                 xor     eax, eax
0040A26D                 mov     esi, [esp+4+arg_0]
0040A271                 mov     word ptr ds:key_result_1, magic1
0040A27A                 mov     word ptr ds:key_par3, ax
0040A280                 push    offset key_par4
0040A285                 mov     word ptr ds:key_par4, ax
0040A28B                 push    offset key_par3
0040A290                 mov     word ptr ds:key_par1, magic2
0040A299                 mov     word ptr ds:key_par2, magic3
0040A2A2                 push    offset key_par2
0040A2A7                 mov     [esi], eax
0040A2A9                 push    offset key_par1
0040A2AE                 push    offset key_result_1
0040A2B3                 push    offset key_fun
0040A2B8                 call    main_key_check        ; here our call
0040A2BD                 mov     word ptr ds:main_result, ax
0040A2C3                 add     esp, 18h
                    ....store results...

The magic values are identifying the dongle and the product, so I removed 
them... they are unimportant for our cracking.

And this is the top of dongle API. Now it's time to identify what the
API is expected to return. Several 'cmp ax, something' and I was able to emulate
API functions 00 (quick check) and 18 (get serial).
I applied a short patch using HIEW to emulate these functions.

After that my proggy started with all options disabled.
Analyzing other 'cmp ax, something' was almost trivial.

So I wrote a short emulator of key_fn_02_read and now the proggy opens all
options to me.

Conclusions.

* Dongle cracking is not much more complicated as serial# cracking. You need
  more theoretical background from dongle producers, good disassembler which
  finds all Xrefs and SoftICE of course. The shareware protections are often
  much more sophisticated than simple dongle calls in expensive commercial apps.
  Of course, there are programs protected better, but they are exceptions.

* Don't start cracking from BPIO on LPT ports. Try to find The Weakest Link!

* Remember, Programmers are lazy when it comes tu put foreign code into their own.
  Not all API calls are used. Check simplest functions first and see what happens.

* Let your cracked program run for several minutes. Almost always there is
  a dongle check performed each 1 minute or so. Your crack should survive this.
  Try all actions the program should perform. Select every item from menu.
  Or, if you prefer, study whole disassembly for dongle calls...

* Beware when cracking with real dongles connected. There is theoretically the
  possibility to destroy a dongle. Use dongles only to read their contents
  and remove them when SoftICE-ing your cracks. They aren't necessary at this
  time :-) However I never found any auto-destruction procedure when studying
  various dongles API.
  Neverthless, you have been warned!

Good Luck!

zeezee</pre>
<font color="green">(c) <font color="#5500AA">zeezee</font> All rights reversed</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"> Back to Project 3</a> 
<hr width="33%">
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"> academy database</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_fravia</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html><HTML>
<HEAD>
<!--  formamus.htm version 09 January 1999 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>erl_jav0.htm:               
Beagle's guide to Java: digging in.
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
Beagle's guide to Java: digging in.
</fonT><br><FONT SIZE="+1">
A hike through the garden of Java
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="java.htm" tppabs="http://members.xoom.com/tsehp_/java.htm"><IMG SRC="images/java.gif" tppabs="http://members.xoom.com/tsehp_/images/java.gif" 
ALT="java" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Java Lab</FonT>
</center></td></tr><tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
10 July 1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+2>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
my dogg Erl
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></TD><td BGCOLOR="898030"><center>
<!-- Your truly+ will edit only if really necessary -->

</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>
<!-- Your truly+ comments -->
Lately, many of our more industrious and investigative interpreters have taken it upon themeselves to supply reverser's site with documents which purport to explain and/or illuminate the origin of a project which we believed to be a wholly unique reversing endeavour: namely, the production of the pages which you now casually finger.
Yet, to our horror, we discover that (alas) this section apparently has had some predecessors, a sobering fact to which the brief but informative squibs arranged above attest.
In light of this new discovery, the editors gently wish to make it known that they claim no 'squatter's rights' regarding this pre-ordained intellectual territory, but are interested only in the free dissemination of this kind of knowledge. 
Welcome to the new java section of mys ite, dear reders, scouting into java will be assured by my dogg Earl, maybe the only person I know of that can describe in writings an altavista search.
</i></center></td><td></td></tr><TR><td></td>
<!-- Leonard Conehead's old song, because we are poets, not only crackers http://nebula.simplenet.com/cohen/covergreatest1.jpg-->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everybone 
That's how the tongue gets in</b></center>
<!-- Leonard Conehead's old song, because we are poets, not only crackers -->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><font color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
Volition- asks, "I am learning java, just for the heck of it. Does anyone know any good Java sites for beginners?"<br>
Well, I do.  Don't you?  Here is a....
<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
Beagle's guide to Java: digging in.
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
A hike through the garden of Java.
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
my dogg Erl
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table><pre>
You wonder what you are getting into?  Well, don't wonder... let's go get into it.
I'm your scout.  We're going in there, snoop around, dig stuff up. What's a garden for?
 
Got your Dog's Tooth badges?  You don't?  We'll make them give us badges.  And lessons, 
and freebees, and stuff to run off with, and words of wisdom, and pats on the head.

We may even stop to listen to grouse and quail.  
<!-- PASTE HERE YOUR INTRODUCTION -->
</prE><br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
They are?  Well then, we'll dig up tools!  We'll go snoop out a Java Development Kit, which has a compiler, and an editor, and a viewer, and learn how to use it.  But for now, just your nez and a pair of paws...  well, as many as you've got!  
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
Yeah, oh yeah. You want to know where this playground's at!  Meet me at the corner of Java and Elliotte Rusty Harold.  Right here, we crawl under the  <A HREF="http://metalab.unc.edu/javafaq/">fence</A>... "There's some dirt, there's some dirt under every fence.  That's how the beagles get in."
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
Java has been here forever... well, I'm only four years old!  If you really want to know, here's the scoop.  <A HREF="http://www.wired.com/wired/archive/3.12/java.saga.html">Wired 3:12 The Java Saga</A> <br>
Elliotte Rusty Harold has a quicker answer at his Java Overview question:  <A HREF="http://metalab.unc.edu/javafaq/javafaq.html#xtocid190291">Where did Java come from?</A>
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<pre>
I'm going to get a little more serious, but not too much - we're out on a lark, after all.  
School's out!  Always!  but we love it for the smells!  

I'm going to get serious enough to suggest that once we get there, not all of us dogs will 
want to program Java, but would first just like to snoop out what it's all about.

But if you want to dig right in, here's my main man, Elliotte Rusty Harold.  He'll teach 
you how to program in Java.  Now watchit!  When you get to his booklist, and it says 
Unreleased Books about Java, and you see his book, and he's recommending "Buy It!"  that's 
a joke, ok?  Just like the first four of his favorite books.  Don't let on you're onto him, 
ok?  He likes to tell this joke over and over.  You could buy those books, and it would 
make you both happy, but for now, we're in it for the handouts.  You  dig in right here:  
<A HREF="http://metalab.unc.edu/javafaq/javatutorial.html">Brewing Java: A Tutorial</A>  Oh, another thing, his tutorial is stuck in 1998, so humour him.  

His <A HREF="http://metalab.unc.edu/javafaq/">Cafe au Lait</A> we were into before is right up to date,  and he's got a <A HREF="http://metalab.unc.edu/javafaq/course/">college course</A> 
he'll let you audit.  Here's the book required for his course: <A HREF="http://metalab.unc.edu/javafaq/course/week1/05.html">Required Textbook</A>   (hehehe, 
i know what it is!)  Oh, yes, his <A HREF="http://metalab.unc.edu/javafaq/books.html">'favorite books' list</A>.

Now, for the rest of us hounds, here's a nice rosy picture from the house of Java, You'll 
need Java enabled in your browser to catch the Dog's Tooth badge.  Here we go, under the 
platform: <A HREF="http://www.sun.com/java/platform.jhtml">Java Technologies: Java platform</A>

Did you see one?  No, it looks like a dog's tooth, with a ruby stuck into it.  You know, 
way rad.  Well, gee, I'm sorry.  Maybe they ran out.  I'll keep an eye out for one for you.  
I know they go well at <A HREF="http://java.sun.com/javaone/">trade shows</A>...

I see we've lost the eager dogs at the Elliotte Rusty Harold tutorial. Hows abouts we take 
a tutorial.  A gentle one. <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">Introduction to Java, by Marshall Brain.</A>  "The focus of this 
tutorial is not on the language itself but what you can do with the language."

Did you click on the examples and get them to work?  Less than thrilled, hey?  You didn't 
like tinker toys when you were small?  Oh, you DID like tinker toys...  Well, then you'll 
like my next excursion.

Now, some of you just like to dink around.  Well, what better place to dink around than
<A HREF="http://www.hotwired.com/webmonkey/java/?tw=java">Webmonkey java collection</A>  It's more fun that a barrel full of monkeys, and doesn't hurt
your teeth like that monkey wrench he's tossing around.  Monkey's never learn to fetch,
they just throw things, don't they?  And besides, we never had to use highchairs.  I say 
that gives us dogs a leg up on the AIQ test!  
      
Ok, now, let's get serious about this.  Here's your momma speaking.  Did you ever learn 
anything from your momma when she sat you down and talked to you.  Here she's going to 
try again.  I KNOW there's a Dog's Tooth badge in here: <A HREF="http://java.sun.com/docs/books/tutorial/">The Java(tm) Tutorial</A> ... Snuff,
snuff, snuff... follow the footprints!

Now, here's one I haven't tried.  (That may be the best recommendation...  it ain't broke,
yet!)  But I'd better show you, or you'll be upset with me for holding back the good stuff 
for inhouse dogs:  <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">Shlurrrp......Java</A>

Well, I think I lost everyone.   I even have more!  But for now, I'm going to relax with 
Sandy Anderson, who's got it all licked, until the next "Revolution."  <A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">Java at Middlesex</A>.
This is sort of a Java Nirvana, where you go after you've won, or after you are back together 
again at one with yourself.
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
<pre>
I hope you came away with these things:  a Dog's Tooth badge, the Java Development Kit, a 
lot of places scented to return to, and an idea where you might look next (hint, hint, next 
page of the Beagle's guide to Java: the <A HREF="erl_jav1.htm" tppabs="http://members.xoom.com/tsehp_/erl_jav1.htm">Links</A>)

See you around, Java hounds!  Wear your "<A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">Duke</A>" badges proudly.
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</pre>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML><!-- saved from url=(0022)http://internet.e-mail -->
<html>
<head>
<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp">
<title>zeropdf</title></head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">PDF: Quick starting notes
<br>
and pdf again
<br></font>
<font size="+2">(A short comment, snatched by reverser+ and a 'deeper' essay :-)
<br>
</h4>

<h4>by Zer0+<br> 
<a href="solution.htm" tppabs="http://members.xoom.com/tsehp_/solution.htm"><img SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="+cracker" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"></a>
<br>
<br>
The Quick starting notes have been snatched on 1 November 1997 and have been 
left here because they may be useful as well, yet you'll find       
below the 'real' <a href="zeropdf.htm#anchorzerofin">+Zer0+'s final essay</a> (12 November 1997)</font>

<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering<br><br><i>Well, I have snatched this without 
Zer0+'s authorization, because I believe that it can be helpful for 
many more people than he thought :-)
<br>
This was of course only a 'place holder' 
until Zer0+ sand his real essay ('pdf again')</i></center>
<hr size="6">
<pre>
I have started to work on the pdf crack +ORC asked us. I downloaded
http://www.adobe.com/supportservice/devrelations/PDFS/TN/PDFSPEC.PDF
file which is a detailed description of the pdf format, so not much
cracking on that. (Some of us might start to write the txt -&gt; pdf 
converter based on the specs.)
After reading the security specs I got the next preliminary
conclusions:

Whether the menubar, toolbar of the reader is present when you open
a document is not connected to the security, its controlled by  
boolean variables HideMenuBar, HideToolBar in the Viewer Preferences 
section of the file. You can change the true settings to false and
they appear when you open the file. Be careful though not to change
the lenght of the file when you change the text (you have enough space
there fortunately), because the file length is linked to the security 
heavily.

The restrictions what can be done with a file is contained in the P 
variable of the Filter section. Its an unsigned word value certain
bits representing the writing, copying printing permissions of the
user. You can not change this value to eliminate the restrictions
because all text and picture data of the file (but not the file
itself) is encoded by the RSA algorithm using a key provided by
a hash function from a random file ID, the userkey, the permission
value etc. This means that if we change permission value the text
and data cannot be decoded correctly. (The reader complains of
corrupted file, tries to fix it etc.) Therefore, we must let the
program to decode the text with the original permission value
and patch the program to set itself up with a &quot;let him do everything&quot;
value later on.

I got all this info only by reading the specs and setting values in
the pdf files. Now I try to find the part of the program where he sets
itself up according to the permission value. BTW the acrobat reader 
(being only a reader) does not allow modifying a document 
independently of the permission value which means this restriction
is logically hard coded in it.

I wrote this to inform you in which direction I am going with this 
project and to facilitate quick exchange of information to spare
some work for all of us.

bye
Zer0+ 
<hr size="6">      
</pre>
<a name="anchorzerofin"></a>
<font size="+2">pdf again</font><hr size="6">
<i>Well, +zer0+ has worked quite a lot on the 
pdf-project, and I find VERY interesting the comparison with 
the recent essay by SiuL+Hacky on LINUX Acrobat  reversing, that 
you can find <a href="linux2.htm" tppabs="http://members.xoom.com/tsehp_/linux2.htm">here</a>. I too believe that the 
idea of writing a small 
utility to get the user and owner password of a pdf document, is a very good one.
As so often happens in life, excessive (and as we all know totally unjustified) belief in 
the strength of software protections can be turned by any reverse engineer in a 
catastrophe for the very people that wanted 
to protect themselves.</i></center><hr size="6"> 
<font size="+2">pdf again</font><br>by +Zer0
<pre>Here I send, as promised, a polished version of the Acrobat reader
patch which enables to select and copy parts of a document
independently of Adobe security settings.
I do not want to repeat here how the whole encryption is working
in  a PDF document (you can find that in the PDF specs from
Adobe or understand it reading the many essays inside +HCU's 
<a href="pdffing.htm" tppabs="http://members.xoom.com/tsehp_/pdffing.htm">pdf-project</a>), so I just point out the most important things.

- If a PDF document is encrypted by using the Standard security
handler the P key containes the permissions which are granted
when the document is opened with the user password. Its a word
value, FFFC meaning you are allowed to do everything, FFC0 means
you can=B4t touch the document.

- You can't just rewrite this value in the document because it
is used for generating the key which is used to encrypt the
document (check the specs for details.)

- However, here is a note from the PDF specs:
<font color="purple">
&quot;Despite the specification of document permissions in a PDF file,
PDF cannot enforce the restrictions specified. It is up to the
implementors of PDF viewers to respect the intent of the document
creator by limiting access to an encrypted PDF file according to
the permissions and passwords contained in the file.&quot;
</font>
This means that a reader can ignore the permission settings.
Unfortunately, this nice feature is missing from Acrobat Reader
so we have to work a bit.

Target: Adobe Acrobat Reader 3.00   2 263 552 bytes

Our main aim is to find the place of the program where the
permission value can be modified to let us do everything without
affecting the decryption of the document.

What I did was: set a break point on kernel _lread to monitor
the file access, if the P value was read into memory breakpoint
set break point on its memory position and see where the program
touches it. This way I got to code at 47D50D where the program
starts to parse it, at 4CDF3D it converts the string to word
value and later puts it at the 26C position of a structure
at 442844 MOV [ECX+0000026C], EAX. This was an effective, but
long and boring way to find this position. Now looking back
I could have found it by searching the dead listing for the
value FFFC (remember this is the let everything to do value
which is used when there is no protection) the program sure
moves it into [ECX+0000026C] a few times. Well, this means
I am still quite a way from being a ZEN cracker :( and once
again proves the words of the great Dave Mustaine &quot;Hindsight
is always 20-20&quot; :)

Now that we have this position we can see what the program
is doing with it. It takes the value at 442CB8 for generating
the decryption key and at 4430E5 it copies it to position
20C and used for setting the permissions. I wanted to fiddle
with the permission settings as far as possible from the
decryption part so I followed it till 480A62 where it moved
to [esi+78] position. Actually the value has been transformed
a bit high order byte to 7F and low order byte incremented
by 1 so the desired value at this position is 7FFD instead
of FFFC. It seems the program is not moving it any further
so we have to patch here to move 7FFD into [esi+78].

This enables selecting text and pictures from any document
and printing it. If you check the security settings menu
point you will see the original settings because the
program reads the 26C position which we have not changed
to present the settings. If you want to change that you
can fiddle with one of the few instructions which reads
[reg+0000026C], but I actually forgot which one. I myself
prefer not to change it, this way I can check what kind of
permissions the author originally set for us :)

One last thing: the author of the pdf document can set
whether the menubar toolbar and windowUI is displayed
when a document is opened. This is controlled by the
HideToolBar, HideMenuBar and HideWindowUI flags in the
ViewerPreferences dictionary. We of course want to have
these goodies always on (which is the default value) so
can destroy the reference to these flags so the program
cannot recognise them. Therefore search these strings in
the reader exe file and change one letter in them. <font color="blue">Now the
program cannot parse these settings in the PDF file 'correctly' 
anymore so we always have the goodies on</font>.

PS: I think now I'll move on to a deeper analysis of the 
pdf standard encryption handler and I will write a small 
utility to get the user and owner password of a document 
(if I can). 
I am just curious what could be the owner password of the 
Ghiribizzo files :)

Zer0+</pre>   
<font color="green">(c) Zer0+ 1997. All rights reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering, choose your way out:</i></center>
<br>
<center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="pdffing.htm" tppabs="http://members.xoom.com/tsehp_/pdffing.htm">Back to the PDF-Project </a> 
<hr width="33%">
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"> Academy database</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_Reverser</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering illegal?</a>
</center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html><HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>pilgrim2.htm FlexLmPC: Further FlexCrypt analysis</TITLE>
</HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<a href="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm"><IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" 
ALT="protec" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to protec</FonT>
<br><bR>
<center><i>The second part of Pilgrim's Flexcrypt studies, 
see  <a href="pilgrim.htm" tppabs="http://members.xoom.com/tsehp_/pilgrim.htm" >pilgrim.htm</a>: Pilgrim's <i>How to crack a PC-based FlexLm license manager</I>, 
read and enjoy!</i>
<hr>Courtesy of reverser's pages of reverse engineering
</center><hr>
<prE>
Further FlexCrypt analysis
==========================


pilgrim 7th January 1999

Introduction
============

Globetrotters FlexLm has been discussed by Siul+Hacky and myself
previously.
One of the first stages in analysing FlexLm is to crack the encryption
used to package it:
FlexCrypt.
FlexCrypt is produced by Globetrotter Software Inc 
and seems to share may commonalities with FlexLm.
This document analyses the FlexCrypt en/de-cryption program to a stage 
that allows decryption of any FlexCrypted package.
This in turn leads into some interesting areas worthy of further
investigation.

Tools required
==============

IDA ( 3.75 used in example )
W32DASM ( V8.9 used in the example )
Install-shield decompiler ( isdcc V1.1 used in example )
HexEditor ( Hiew V5.66 used in example )

Targets URL
===========

<a href="http://www.globetrotter.com/"  target=_blank>http://www.globetrotter.com</a>
<a href="ftp://ftp.globes.com/" tppabs="ftp://ftp.globes.com/" target=_blank>ftp://ftp.globes.com</a>

Recommended files
=================

For a full explanation you'll need to download two files: flexlm5.12
and flexlm6.1

<a href="ftp://ftp.globes.com/flexlm/v5.12/windows/flexmin.exe" tppabs="ftp://ftp.globes.com/flexlm/v5.12/windows/flexmin.exe" target=_blank>ftp://ftp.globes.com/flexlm/v5.12/windows/flexmin.exe</a> ( 4,088,198
Bytes )
<a href="ftp://ftp.globes.com/flexlm/v6.1/windows/flexlm.exe" tppabs="ftp://ftp.globes.com/flexlm/v6.1/windows/flexlm.exe" target=_blank>ftp://ftp.globes.com/flexlm/v6.1/windows/flexlm.exe</a> ( 7,873,894 Bytes )

The site also contains many other flexcrypted files to practise on.

FlexCrypt basics
================

FlexCrypt uses a rolling XOR based scheme to encrypt a file.
It uses the same key on 8 bytes, recalculates the key, then continues
through the file.
The key is in some way based on the passkey you must find for correct
decryption.
The passkey is of the format xxxx-xxxx-xxxx-xxxx-nn
where the x are hexadecimal numbers and nn ranges from 00 to 99 decimal.
The hex numbers are in some way related to your PC ( hard disc number
/ network card number ).
The nn specifies which of 100 keys was used to encrypt the file. 
Only one nn value decrypts the file correctly.
There is a table which stores 100 passkey related values in the
decryption executable.
There are many versions of FlexCrypt available, but there is basically
a 16bit and 32bit.
Both use the same encryption method.
32 bit introduces a file header with some sort of file/passkey check
data included.
All FlexCrypt files may easily be decrypted correctly using the 32 bit
decryption program.
The decryption program is packaged with the install files and is
usually called something 
like cryptwin.exe
Command line options for decrypt.exe:
-p xxxx-xxxx-xxxx-xxxx-nn : the passkey
-t Z *.fc : decrypt all .fc extension files to files with .Z extension
-d n : debug mode, n can take values 1,2,3 each displaying differing
formats of debug info

Stage 1 :  how to decrypt the files
===================================

Run the install.exe from the downloaded FlexLm 5.12.
This will extract all the files needed for the install.
Run setup.exe
You'll be asked for the FlexLm decryption key in the format
xxxx-xxxx-xxxx-xxxx-xx
Cancel the install.
We see a setup.ins file : installshield is here
Use isdcc to decompile the install script.
Have a look for the text we saw earlier, xxxx-xxxx-xxxx-xxxx-xx, and
we see:

AskText(&quot;Please enter in your decryption key.  It should be of the
form xxxx-xxxx-xxxx-xxxx-xx .  If you do not have this key, you can
obtain it by calling Globetrotter Software at (408) 370-2800  If you
do not have a key at this time, please press cancel to end t&quot;,
&quot;xxxx-xxxx-xxxx-xxxx-xx&quot;, string15);
Sprintf(lString1, &quot;%scryptwin.exe&quot;, SRCDIR);
Sprintf(lString2, &quot;Decrypting files, this may take some time&quot;);
function11(lString2, 1);
Sprintf(lString0, &quot;-w %s  -p %s -t Z *.fc&quot;, SRCDIR, string15);

This decodes to:

cryptwin.exe -p xxxx-xxxx-xxxx-xxxx-xx -t Z *.fc

where xxxx-xxxx-xxxx-xxxx-xx would be the numbers you type.
-p option is password
-t is convert *.FC into *.Z type

So rename cryptw~1.exe to it's full title, cryptwin.exe, and try 
cryptwin.exe -p 0000-0000-0000-0000-00 -t Z *.fc 
We end up with zero length Z files. Not too good.

Cryptwin is 16-bit, so let's use IDA to dissassemble it.
At this moment I'm interested in command line options so let's have a
look.
Searching for -p gives us a function at loc_8B6_6C which looks like a
command line parser.
It seems to also accept -x -o -i -e and -d options
What's -d? debug? There's references to DEBUG in the exe, let's try it.
A bit of experimenting shows there are 3 debug levels, with varying
outputs,
1 writes a log file, 2 displays on the screen, 3 uses pop-up windows.

Stage 2 : Get a valid passkey
=============================

32 bit's easier to debug than 16 bit so let's abandon FlexLm 5.12 for
now and try FlexLm 6.1

Clear the Windows\Temp directory and run the FlexLm 6.1 install.
When prompted for the key press cancel and copy all the files into
another work directory.

Let's try cryptwin.exe -d 3 -p 0000-0000-0000-0000-00 -t Z *.fc again.
Again we end up with a zero length Z file.
Dissasemble cryptwin.exe using W32DASM.
Load the program with the command line options -p
0000-0000-0000-0000-00 -t Z *.fc
Put a break-point on the reference to &quot;%.4d-%.4d-%.4d-%.4d&quot;
Run to the break point then single step.

* Possible StringData Ref from Data Obj -&gt;&quot;%.4d-%.4d-%.4d-%.4d&quot;
:00405E2F 6870B04200              push 0042B070
:00405E34 BE60F34200              mov esi, 0042F360
:00405E39 56                      push esi
:00405E3A E8A1840100              call 0041E2E0
:00405E3F 83C418                  add esp, 00000018

In this case there's a call to 0041E2E0 which returns esi pointing to
the processed string,
which looks something like:

[esi+00000000] - 7375
[esi+00000004] - -553
[esi+00000008] - 2-55
[esi+0000000C] - 21-5
[esi+00000010] - 871.

This string appears to be related to machine specific items such as
hard disk number
and network card number. This string is the first four numbers of a
potentially valid
passkey. The last two digits are the key number used in the test. In
this case 00.

OK, we have a key to try, it's 7375-5532-5521-5871-00
So let's try cryptwin.exe -d 3 -p 7375-5532-5521-5871-00 -t Z *.fc 
Again, an error message and a zero file.

We need to repeat the above process using keys 00 to 99 as the last
two digits in the password.
This would be a very slow process using DASM.
So modify the cryptwin program to generate a file with a name of each
passkey.

Stage 2a: auto generate the passkeys
====================================

Copy your original cryptwin.exe to something else, I used dcrypt.exe.
Using your favourite hexeditor, modify dcrypt.exe as follows:

1) Just after esi points to the passkey string, jump to some unused
code space:

Replace
:00405E3F 83C418                  add esp, 00000018
:00405E42 57                      push edi
:00405E43 E80C000000              call 00405E54
With
:00405E3F 83C418                  add esp, 00000018
:00405E42 E9E1B9FFFF              jmp 00401828

2) At this unused space, 00401828, replace the existing code with:

:00401828 6A00                    push 00000000
:0040182A 6880000000              push 00000080
:0040182F 6A01                    push 00000001
:00401831 6A00                    push 00000000
:00401833 6A03                    push 00000003
:00401835 68000000C0              push C0000000
:0040183A 8BC6                    mov eax, esi
:0040183C 50                      push eax
* Reference To: KERNEL32.CreateFileA, Ord:0030h
:0040183D E8CC760200              Call 00428F0E    &lt;- create the file
:00401842 50                      push eax
* Reference To: KERNEL32.CloseHandle, Ord:0017h
:00401843 FF15BC324300            Call dword ptr [004332BC] &lt;- close
the file handle
* Reference To: KERNEL32.ExitProcess, Ord:006Ah
:00401849 FF158C324300            Call dword ptr [0043328C] &lt;- end the
program

Now run the dcrypt.exe with the command line options -p
0000-0000-0000-0000-00 -t Z *.fc
You should get a file of name 7375-5532-5521-5871

Now write 2 batch files to run through 00 to 99 and store the results:

test2.bat:
call test.bat 00
call test.bat 01 .... to .....
call test.bat 98
call test.bat 99

test.bat:
dcrypt -p 0000-0000-0000-0000-%1 -t cab data1.fc
rename ????-????-????-???? ????-????-????-????-%1

This gives 100 files with potential passkeys to try.
Note that these passkeys will differ on different machines.

So now we want to try each one and see when we get a valid result.
Dir all the files into a text file and run a macro to get something like
cryptwin -p 7375-5532-5521-5871-00 -t cab data1.fc
pause 
... etc for each key

I checked the size of the decrypted file after each try.
It's non-zero when it's been decrypted correctly.
( further work: you may be able to use the debug error level to tell
you when it's worked )

You'll eventually end up with the correct key for your machine.
Once you've got it you can then use it to decrypt all the fc files.

Stage 3: Repackage so you don't need the key again.
===================================================

It would be wise to repackage the FlexLm 6.1 so you don't need the key
again.
Delete the cryptwin.exe and the *.Z files then try installing again.
You can now enter any passkey and FlexLm6.1 will install.

Stage 4: Try decrypting another package.
========================================

Let's try the passkey we got above with the 16 bit FlexLm5.12
No good. 
That's because the 16bit cryptwin.exe has a different set of keys
stored in it's executable.
OK, so let's try decrypting the 16bit FC files using the 32bit cryptwin.
This may work as we know the key for the 32bit decrypter.
Well, we get some Z files, no error messages, but the files are corrupt.
Open up a Z file with your favourite hex editor and have a look.
Mmmm, lots of repeating 8 byte patterns. 
Looks like we've decrypted the file but with the wrong start value.

Stage 4a: A diversion ... partial analysis of file decryption
=============================================================

Time to look at how crypwin.exe decrypts the fc file.
Open up the disassembled cryptwin.exe from FlexLm6.1, and look at
00402d1d:
( Some dissassembly has been removed )

1) Read the file and see if it contains the &quot;FLEXcrypt Copyright&quot;
signature
   If it does then this is a new 32bit generated file, else it's a
16bit file

:00402D1D 55                      push ebp
....
:00402D58 51                      push ecx
:00402D59 E8D2A60100              call 0041D430 &lt;- fread &quot;FlexCryp&quot;
from the file
...
* Possible StringData Ref from Data Obj -&gt;&quot;FLEXcrypt Copyright (C)
1990-1997, &quot;
                                        -&gt;&quot;Globetrotter Software, Inc.&quot;
:00402D66 6870AE4200              push 0042AE70
:00402D6B 51                      push ecx
:00402D6C E8CFC40100              call 0041F240 &lt;- Compare the 2 strings
:00402D71 83C40C                  add esp, 0000000C
:00402D74 85C0                    test eax, eax
:00402D76 7579                    jne 00402DF1 &lt;- Jump if it's 16bit
straight to decrypt file

2) This is a 32bit file with a valid header
   The analysis of this next section needs some more work, it may hold
more clues.
   The code reads some sort of checksum from the file header
   The first 8 bytes of data are decrypted
   The data is then compared with something and a pass/fail is
determined.

:00402D78 FF7508                  push [ebp+08]
:00402D7B 53                      push ebx
:00402D7C 6A68                    push 00000068 &lt;- 104 bytes of header
data
:00402D7E 8D8D24FFFFFF            lea ecx, dword ptr [ebp+FFFFFF24]
:00402D84 51                      push ecx
:00402D85 E8A6A60100              call 0041D430 &lt;- read the header data
:00402D8A 83C410                  add esp, 00000010
:00402D8D 8D55BC                  lea edx, dword ptr [ebp-44]
:00402D90 FF7508                  push [ebp+08]
:00402D93 53                      push ebx
:00402D94 6A08                    push 00000008
:00402D96 52                      push edx
:00402D97 E894A60100              call 0041D430 &lt;- read the first 8
bytes of data
:00402D9C 83C410                  add esp, 00000010
:00402D9F 8D4DE4                  lea ecx, dword ptr [ebp-1C]
:00402DA2 8D55BC                  lea edx, dword ptr [ebp-44]
:00402DA5 8D45DC                  lea eax, dword ptr [ebp-24]
:00402DA8 51                      push ecx
:00402DA9 52                      push edx
:00402DAA 50                      push eax
:00402DAB E818550000              call 004082C8 &lt;- get an 8 byte key?
:00402DB0 83C40C                  add esp, 0000000C
:00402DB3 B9FF000000              mov ecx, 000000FF
:00402DB8 8B4514                  mov eax, dword ptr [ebp+14]
:00402DBB 2BC8                    sub ecx, eax
:00402DBD 51                      push ecx
:00402DBE 50                      push eax
:00402DBF 50                      push eax
:00402DC0 8D4DC8                  lea ecx, dword ptr [ebp-38]
* Possible StringData Ref from Data Obj -&gt;&quot;%02x%03d%03d&quot;
:00402DC3 6860AE4200              push 0042AE60
:00402DC8 51                      push ecx
:00402DC9 E812B50100              call 0041E2E0 &lt;- sprintf first 8 bytes
:00402DCE 83C414                  add esp, 00000014
:00402DD1 8D4DC8                  lea ecx, dword ptr [ebp-38]
:00402DD4 8D55E4                  lea edx, dword ptr [ebp-1C]
:00402DD7 6A08                    push 00000008
:00402DD9 51                      push ecx
:00402DDA 52                      push edx
:00402DDB E820C40100              call 0041F200 &lt;- string compare 8
bytes
:00402DE0 83C40C                  add esp, 0000000C
:00402DE3 85C0                    test eax, eax
:00402DE5 7411                    je 00402DF8 &lt;- passkey OK, continue
to decrypt the file
:00402DE7 B801100000              mov eax, 00001001
:00402DEC E9B5000000              jmp 00402EA6 &lt;- fail, abort with
error code

3) Decrypt the file, 8 bytes at a time

:00402DF1 C745F801000000          mov [ebp-08], 00000001
...............
:00402E73 8D45E4                  lea eax, dword ptr [ebp-1C]
:00402E76 8D4DF0                  lea ecx, dword ptr [ebp-10]
:00402E79 50                      push eax
:00402E7A 8D55DC                  lea edx, dword ptr [ebp-24]
:00402E7D 51                      push ecx
:00402E7E 52                      push edx
:00402E7F E844540000              call 004082C8  &lt;- get an 8 byte key?
:00402E84 83C40C                  add esp, 0000000C
:00402E87 33C0                    xor eax, eax
* Referenced by a (U)nconditional or (C)onditional Jump at Address:
|:00402E95(C)
-&gt; 8 bytes loop
:00402E89 8A4C05D4                mov cl, byte ptr [ebp+eax-2C] &lt;- XOR
8 bytes
:00402E8D 304C05E4                xor byte ptr [ebp+eax-1C], cl &lt;-
with key
:00402E91 40                      inc eax
:00402E92 83F808                  cmp eax, 00000008
:00402E95 7CF2                    jl 00402E89 &lt;- loop 8 times

Stage 5: XOR the incorrectly decrypted file
===========================================

As mentioned above, it's as if we've used the wrong start point to
decrypt the FC file.
And from the analysis above we can see it's an XOR decryption.
So how about finding some likely looking zeros in the file.
XOR of zero with a key is zero.
If we XOR the file with the value stored at a zero we may get a
working file.
Open up the html.Z that comes with FlexLm5.12 with your hex editor.
I spy lots of repeats at 40hex, in my case, d361f5a2006ebb12.
Let's try XORing the whole file with d361f5a2006ebb12.

I wrote a little C program to do this, ( main parts only shown ):

void main()
{
FILE *ReadFile, *WriteFile;
unsigned char xor_table[8]={0xd3,0x61,0xf5,0xa2,0x00,0x6e,0xbb,0x12};
ReadFile=fopen(&quot;test.x&quot;,&quot;rb&quot;);     /* Open up the project file to read
*/
WriteFile=fopen(&quot;test.z&quot;,&quot;wb+&quot;);   /* Open up the new project file to
write */
init=0;
i=0;
while (feof(ReadFile) == 0) /* Repeat until the end of the read file
is reached */
{  
  c=fgetc(ReadFile);
  if (init==1)
    c^=xor_table[i];
  i++;
  i&amp;=7;
  init =1;
  fputc(c,WriteFile);
}
fclose(ReadFile);
fclose(WriteFile);
}

Run this on the files and they look like they should work, but they're
still corrupt.

Stage 6: correct the first 8 bytes of the file
==============================================

The problem is the first 8 bytes of the data are not correct.
Further work: I think the first 8 bytes have something to do with the
initial decrypt value.
This doesn't pose a problem as FlexCrypt is typically used to encrypt
files with known headers.
For an installshield Z file the first 8 bytes are
13,5D,65,8C,3A,01,02,00
For an installshield CAB file the first 8 bytes are
49,53,63,28,04,00,00,01
So I modified my XOR code to skip the first 8 bytes and replace them
with the correct header:

void main()
{
FILE *ReadFile, *WriteFile;
unsigned char xor_table[8]={0xd3,0x61,0xf5,0xa2,0x00,0x6e,0xbb,0x12};
unsigned char z_header[8] ={0x13,0x5D,0x65,0x8C,0x3A,0x01,0x02,0x00};
ReadFile=fopen(&quot;test.x&quot;,&quot;rb&quot;);     /* Open up the project file to read
*/
WriteFile=fopen(&quot;test.z&quot;,&quot;wb+&quot;);   /* Open up the new project file to
write */
/* Skip the first 8 bytes and write the Z file header */
for (i=0;i&lt;8;i++)
{
  c=fgetc(ReadFile);
  fputc(z_header[i],WriteFile);
}
init=0;
i=0;
while (feof(ReadFile) == 0) /* Repeat until the end of the read file
is reached */
{  
  c=fgetc(ReadFile);
  if (init==1)
    c^=xor_table[i];
  i++;
  i&amp;=7;
  init =1;
  fputc(c,WriteFile);
}
fclose(ReadFile);
fclose(WriteFile);
}

Run this and your encrypted files are now decrypted.
As before, remove the cryptwin.exe and the FC files and your
installation will now accept 
any passkey.

FlexCrypt further work
======================

Now we can decrypt ANY FlexCrypted file.
This includes the FlexCrypt developers kit.
So download this, decrypt it and we get a useful html manual and some
source code.
Have a look a mycode.c and cryptkit.h
It appears that the kit uses FlexLm license data to encrypt the keys
stored in the code.
There's an array fc_keytab[256] stored in the cryptwin.exe 
which contains the 8 bytes keys to use XORed with vendorkey5.
As we know from FlexLm cracking, vendorkey5 is the hard one to find.
And we also know it's calculated on the fly from the other vendor codes.
So maybe cryptwin.exe has the necessary license data stored in it's EXE?

Using your favourite hex editor open up cryptwin.exe from FleLm 6.1
Have a look at offset 002a5c0, I think this is the fc_keytab table.
Looking at the rest of the code it seems to have lots of FlexLm code
embedded in it.
And we've cracked this before.

So maybe, by analysis of the cryptwin.exe and the FC file it may be
possible to determine
which key will work, without all the effort above.

Conclusion
==========

The above document shows how we can decrypt ANY FlexCrypted file.
Further work may show the essence of FlexCrypt and it's relationship
with FlexLm.

Thanks to the people out there who continue to reveal the light.

pilgrim
</prE>
<hr><center><a href="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm"><IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" 
ALT="protec" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to protec</FonT>
<br><bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>


<br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>&nbsp;
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>


<br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 


BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
legal?</A>


</CENTER>


<hr>


<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->


</BODY>


</HTML><html>
<head>
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>surrsea1.htm: Reverser's how to search the web, Surreal5's jumpstation</title></head>
<body>
<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">

<a name="anchortop">

<!-- HTML code by Reverser, Yeah, go ahead, steal my code, sucker -->
<!-- Begin Introdo -->
<table bgcolor="#FF0000" CELLPADDING="7" CELLSPACING="0">
<tr>
<th bgcolor="#FF0000">
<Font color="#804000" SIZE="7">
S<br>E<br>A<br>R<br>C<br>H<br>
</fonT>
<TH BGCOLOR="#804000">
<FONT COLOR="#FF8000" SIZE="7" FACE="ARIAL">
Surreal5's<bR>Search tips<br><FONT COLOR="#FF8000" SIZE="4" FACE="ARIAL"><br><br>
<br><br><br><FONT COLOR="#FF8000" SIZE="1" FACE="ARIAL">
Reverser's Nofrill<br>
Web design<br>
(1998)
</font>
</TH>
<TH BGCOLOR="#804000"><pre> </prE></TH>
<TH BGCOLOR="#804000"><br>
<FONT COLOR="#FF8000" SIZE="1" FACE="ARIAL">Updated<bR>
02 December 1998
</TH>
<TH BGCOLOR="#C0C0C0">
<center><font size=+1>How to search the web</fonT><bR>
<bR>
<a href="surrsea1.htm#anchorintr">Surreal5's Introduction and First lesson</a><br>February 1998<hr>
<bR>
<a href="surrsea2.htm" tppabs="http://members.xoom.com/tsehp_/surrsea2.htm" >Surreal5's Second lesson</a><br>February 1998<hr>
<bR>
<a href="surrsea3.htm" tppabs="http://members.xoom.com/tsehp_/surrsea3.htm" >Surreal5's examples from my own last search lesson</a><br>February 1998<hr>
<bR>
<a href="4surreal5.htm" tppabs="http://members.xoom.com/tsehp_/4surreal5.htm" >Surreal5's snippets of information</a><br>March 1998<hr>
<bR>
<a href="surre_05.htm" tppabs="http://members.xoom.com/tsehp_/surre_05.htm">The continued irc experience.<bR>Pro's and con's from a searching standpoint</a><br>December 1998<hr>



</TH>
<TH BGCOLOR="#804000"><pre> </prE></TH>
</TR>
</TABLE>
<a name="anchorintr"></a>
<hr size=3><font color=gray><font size=+3>Surreal5 's Search tips</fonT></fonT>
<br>

<prE>

Surreal5 's Search tips,  courtesy of Reverser's pages of reverse engineering.

I've tried to organise this (provisorial) essay so, that both beginners and
advanced users can get something out of each lesson, and can almost
directly use it. Even if you are already an expert on how to find the
example types i used, you may get something out of it, a different
perspective, something you hadn't thought of. I like Robin Hoods tutorial,
he has a broader experience than i do, but i feel my lessons give faster
results, with less effort spent on learning boolean ,and other tool
specifics. Consider this a crash course if you will. Consider it a
preliminary to Robin Hoods tutorial. Consider it an alternative view from a
lazy guy who wants results fast ;)

surreal5
 
Introduction.

I'm no hacker, i'm no cracker,  i don't need to be, i know how to locate
and manage the combined sum of knowledge and resources people (including
hackers and crackers) have put on the web, deciding wether it's worth
trying to understand or having to learn how they did it, or just use
whatever they have put online for my leeching. ;) The point is i can find,
or learn, anything i want, whenever i feel i should need it. I've been
online for about 16 months at this point,so i may not be one of the best
searchers around, but i do feel i'm good enough to teach others. ;)

I'm one of the few people who does not know the URL's of his own webpages.
I do not need to remember, i know the keywords i entered. If i need a page
on Reverser's site, i know he updates to Exite, and use the view by url
function. It's only two clicks instead of the three or four on reverser's
site you need to go trough. Sites that are navigation hell, and contain a
lot of info that i need often, i add/update the url to a search engine, and
navigate from the engine. 

If you want to get the information you need from the web,  you should have
your personal toolbar folder full of search tools. Your bookmark file
should be as empty and as managed as possible. There's a point when you
find the page you need faster with a search engine, than going through your
huge and  messy bookmarks file. Make a temp folder for pages you need to
visit later that day or something, and empty that folder every so often.  

There's a lot of discussion about which search engine is the best. I'm not
going into that, you need a lot of search engines, and some are better for
some types of searches than others. I use Infoseek as standard, you should
by all means  keep on using yours. Use the others if you don't find what
you need, and you will soon find out which is the best engine to put under
that home button, for the type of search you use most. 

A lot of search engines have very specific users. You'll find a lot more
kiddie crack archive pages on say alta vista, than on other search engines,
but you may also find some doom clan page instead, from the kid who got
scared, replaced his page,. but didn't update his keywords or his url to
the engine. You'll find more mama's and papa's on exite. And you'll find
more business and science pages on infoseek. Forget yahoo completely, it's
the internet equivalent of a tv remote control zapper, not a program guide.

Deciding wether you will use any search engine should include: how well you
can use it already, how good it is as a search engine (what
functions/filters does it have?), but also what is the amount of
relevant content added to the engine... 

Make your standard search engine your startup page, or at least #1 on your
personal toolbar folder, and add at least two others to your personal
toolbar folder, the others should have functions that your 
standard engine doesn't have, or different percentages of content. Always
add deja news and ftp search there as well, or put them in a top dir in
your bookmark file, for easy access.   

ready ? 

-------------------------------------------------------

Lesson 1: finding a crack/serial.

Finding a crack or serial is probably one of the most common searches ;).
Many people can find cracks, yet many people have trouble finding that one
crack they're looking for. Note that an experienced searcher has no use for
saving cracks or serials, or maintaining lists with serials. Getting the
serial/crack again from the web when you need to re-install, should
eventually be a lot faster and easier than wading through your
harddrive/cd-R's/zips crack name files, or even faster than going through
your huge dbase with outdated serials. (and maybe having to sort it). (save
'em for now though ;) )


step 1: targeting.

Defining the type of program should influence your search strategy for the
crack or serial. It may all seem like a lot to do now, but it will come
naturally in time, involving miliseconds instead of minutes.

a) is it a popular program ?
b) how old is the program ?
c) does it have any previous versions ?

- if it's a popular program that doesn't have many versions,  -> step 2
- if the program  has many previous versions, your search could be more 
effective/faster with a search engine that includes a date filter. -> step 3 
if the program is very popular AND has many previous versions -> step 4
- if the program is not popular or very specific, very new or elusive ->
step 5 


Step 2: the two keywords approach.

with infoseek:
a) search field: <program name>
b) glance at nr of hits, too few ? then you're back to step 1.
c) search field: serial  [ or crack or serial OR crack]
(tag search these results only)
d) analyze hits

with your preferred search engine:
a) search field: <program name> AND serial 

Analyzing hits takes experience, speed is the most important in this step,
so ignore all headers/descriptions that are too obvious, ("WAREZ WAREZ
WAREZ!!!") anything that says "FREE" and anything that includes "XXX".
They're 90% smut site hit gatherers. Go for the hits that show other
program names and serials, or "ABCDEFG...etc" in the descriptions first. 

Remember speed is the most important in this step, if there are many hits,
your crack/serial is on many many pages, so don't wait for slow pages to
load, they could be dead, don't bother with heavy pages or frames. just hit
the next one that catches your interest. 


Step 3: the date filter approach.

Your program has too many versions and you run into old expired serials,
and cracks that no longer work on the new version. If your program is
really popular, skip and go straight to step 4.

It's time to use an engine with a date filter, i'll use altavista advanced
query as an example.

a) search field: <program name> AND serial 
b) from field: <set the date>

If your program has many previous versions, set the date to any time when
you think the crack you need was released and minimum 2 or 3 days ago,
since that's usually how long it takes for the url to be indexed. It will
eliminate most dead links, though i prefer not to use it as a standard for
this reason, because you usually end up with more smutsite (who update more
often) noise, in a date filtered search, than with dead hits in a standard
two keywords search. Also Altavista sorts oldest hits first. and you end up
spending too 
much time on doing new searches with new dates, it's often easier and
faster just to click your way through noise...

C) analyze hits (see step 2).

With the exception that speed becomes slighlty less of a priority.


Step 4:  The search as a phrase option.

Your search still generates too much noise, your proggie is too popular...
It's time to go back to your own search engine.

a) search field: "<program name> Vx.x" AND serial. 
experiment with placing/ not placing a space between the program name and
version #. , and leaving the "V" out.
b) analyze hits.

or with infoseek:
a) search field: "<program name> Vx.x"
b) search field: serial (tag search only in these results)
d) analyze results.
 

Step 5: re-targeting

your crack is elusive, because the program is...

a) too new -> step 6
b) too specific, not popular enough -> step 7
c) too old ! ->. step 7, -> C


Step 6: the usenet approach.

go to deja news and enter in the search field: (leave the rest default).

crack ^ <program name>

or

<program name> ^ crack

repeat with serial as nessecary

This will result in a lot of hits from posts by people requesting a crack.
Check the RE: headers first, hit the view thread button, you may find the
name of the crack. if you do... enter that name in your search engine ...
duh :)

If you don't, or do get the name, but don't find the crack,  start up your
news reader, subscribe to all crack groups and make a general filter
autoselecting all possible keywords. It may take you a few days or weeks,
but if a crack exists it will eventually show up. Don't post a request ,a
searcher never begs,  he watches 
others, and intercepts. ;) keep monitoring the groups, and combine with
seaching the web with step 3 - the date filter approach.

Or go to lesson 2, and use the warez/mp3's/passwords strategy on your new
crack search. 


Step 7: the puzzle approach.

Your program is very specific. this is the most difficult type of
crack/serial to find, and it could be worthwile learning how to crack for ;). 

With this type of search, signal and speed are no longer priorities, 
and every dead link, or noise link, may hold a valuable clue. There isn't
really one place you should look first anymore. Your clue to succes could
be anywhere. Still, my favourite is... 

A) dejanews filtered search.

-Add in the groups field: *crack*, *2600* etc etc 
-specify nothing else.
-hit create filter.

enter in the search field:
<program name>

Again it's likely only requests will show up. view the threads, sift
through the replies. note the request headers and do a searches or make a
filters on them, and repeat.
 
B) Brute force search: 

Do a search on meta crawler (be prepared for lots of noise) or try all
popular search engines, try some noise, try the dead links that had the
keywords right, try to figure out the id of the page owner. try a parent
dir, examine the description in your search engine, and do a search on page
titles, handles, keywords etc... 
 
C) search for program fan pages.

Search for:
"the unofficial <program name> homepage" , fanpages, etc etc
one of them may actually have the crack or serial you need, especially for
old programs this is often the case.

go back and repeat in different order, some clues found with one strategy,
may shed new light on the search, 

.....have fun ;)

surreal5.</prE>

<HR ALIGN=CENTER WIDTH=100% SIZE=3>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i>
<br><bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red><a href="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">Back to how to search</a>
<br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search engines</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
<bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascripts wars</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonimity academy</a> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</a>
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a> 

</center>

<hr size=3>
</body>
</html>


<HTML>
<HEAD>
<TITLE>javpass1.htm  Reverser explaining easy Javascript password systems</TITLE>
<!-- HTML code by Reverser, Yeah, go ahead, steal my code and style, sucker -->
<!-- Javascript code by Reverser, Yeah, go ahead, read -->
<SCRIPT  LANGUAGE="JavaScript">
<!--- 
function grasppasswd() {
var paroledordre = prompt("No way to go further without password:", "")
var wherever=paroledordre + ".htm";
this.location.href = wherever;
}
//  --->
</SCRIPT>
</HEAD>
<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<center><font size=+5>DEAD END</fonT><bR>(24 January 1998)<br><bR>
This gate to the advanced Javascript page is actually no gate at all... there 
is no way you can find out a password from the code on this page, short of 
bruteforcing all possible combinations... a very easy way to demonstrate 
to you that there is NO WAY whatsoever to fool an incredibly easy to write 
and implement javascript snippet. You need the exact name of the page you 
want to access, and you do not know it. This brings us once more to the importance 
of NAMES on the web... clearly if the page you are looking for would have been 
called adv_java.htm, you could have guessed it or bruteforced it, but if you NAME 
your secret pages something like GH_55_QP.html (note the htm<u>l</u>), you will not 
get all too much visitors where they should not be.

Basically, as you'll be able to see clicking 
<SCRIPT LANGUAGE="JavaScript">
<!--
if (navigator.userAgent.indexOf("Mozilla/3.0") != -1) version = 3;
else if (navigator.userAgent.indexOf("MSIE") != -1) version = 1;
else if (navigator.userAgent.indexOf("Mozilla/2.0") != -1) version = 2;
else if (navigator.userAgent.indexOf("Mozilla/4.0") != -1) version = 4;
else version = 0;

function source(object)     { 
         return '<A HREF="view-source-'+eval(object+'window.location')+'" tppabs="http://fravia.org/view-source:'+eval(object+'window.location')+'">this link</A>';
}

if (version != 1) document.write(source('top.'));
//--></SCRIPT> (another small javascript trick), I have written inside the HEAD of this 
page a <font color=blue>function 
grasppasswd()</fonT> that translates the password I could have given you into the URL 
you'll call...
<hr>
<center>
Just click on the gif to get the password entry form...
<bR><bR>

<A HREF="javascript:grasppasswd()" onMouseOver="window.status='Click this gif and enter the password';return true" onMouseOut="window.status='';return true"><IMG SRC="images/javascri.gif" tppabs="http://members.xoom.com/tsehp_/images/javascri.gif" WIDTH= "114" 
HEIGHT="43" NATURALSIZEFLAG="0" ALIGN="CENTER" ALT="javascri.gif" ></A>
<br>
<bR>
Of course if you type <font color=blue>fravia</fonT> you'll land inside reverser.htm, 
and if you type <font color=blue>links</fonT>  
you'll land inside mty links page (what about a navigational aid with such system? is it quicker to click on 
a long frame list or to type a four/five letter URL like links? Try it out!).<br>
<hr width=55%>
<i>Ok, so the sense of all this is that to protect parts of your site you may just 
use a simple NAME barrier, and that tools and techniques are needed to defeat this... 
at the moment the only valid methodes I know of (short of bruteforcing) are 
the "crumb gathering" technique, social engineering and psychological introspection... 
together with a little historical research (which is easy on sites that 
have slow mirrors :-)<br>
Now I am already talking too much... may be this dead end IS NOT so dead after all... 
and, what's more important, may be some of my more advanced readers and wizards have 
something interesting to add, which I will publish... of 
course "on the other side"...</i>
<hR size=6>

<a href="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm" onMouseOver="window.status='Click this gif and go back to the entrances';return true" onMouseOut="window.status='';return true"><IMG SRC="images/javascri.gif" tppabs="http://members.xoom.com/tsehp_/images/javascri.gif" ALT="javascri.gif" WIDTH= "114" 
HEIGHT="43" NATURALSIZEFLAG="0" ALIGN="CENTER"></a><br>

<font color=gray>Back to the Javascript entrances</fonT><br><bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search engines</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
<bR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascripts wars</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonimity academy</a> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI-scripts</a>
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red></a><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a> 

</center>

<hr size=3>
</center>
<!-- Begin signet -->
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=CENTER 
BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font color=green>(c) 
<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a> 1995, 1996, 1997, 1998. All rights 
reserved</fonT><!-- End signet -->
<!-- End signet -->
<hr>

</body>
</html>

<HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>dvdfuhr.htm: Dr. Fuhrball's "DIVX and DVD reversing"</TITLE>

<body bgcolor="C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<center>
<hr><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="+HCU Papers" 
ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Papers</fonT>
<hr>
"DIVX and DVD reversing"<br>by Dr. Fuhrball's<br>23 September 1998<br>(slightly edited by reverser+)
<hr>
Well, this is a very interesting essay. Dr. Fuhrball joins a sound reversing approach 
(and protection busting) with a broader analysis that borders to reality 
cracking. I have included it into the +HCU papers, because I believe that 
'domestic appliances' cracking will be more and more a fundamental part of 
any applied reverse engineering study... 
 </fonT>"
<hr></center>

[<a href="dvdfuhr.htm#zora">Zoran Softdvd</a>]
[<a href="dvdfuhr.htm#zeni">The Zenith DIVX player</a>] 
[<a href="dvdfuhr.htm#remot">Get remoteselector 131 emailed to you</a>]
<pre>

   DVD, DIVX and MACROVISION

   Zoran Softdvd, Creative Pc-Dvd Encore, Zenith 2100 DIVX player...

   By Dr. Fuhrball

   (Some of this is not done yet, i just do not have the time i used to!)
   (No Reverser+... its not because i am watching too much TV, these days i
   watch less than two hours a week!)

   This weeks cocktail:   Cadenheads Longmorn Glenlivet. Delivered at
   full cask strength of 120 proof. Whoaboy is this stuff good. And along
   with it a monte-cristo from Havana (&#161;Que linda es Cuba!). (What you say? 
   Havana cigars are illegal in USA? Really?)

   How the motion picture industry wants to screw your butt,
   over and over and over and over.....


   DVD, the Digital Versatile disk. Used to be Digital Video disk, but
   they found a bunch more uses for it. Up to 4 layers on a dual sided
   disk the same size as a cd, with up to about 18GB.

   But could they leave this alone, no way. First they had to find a way
   to protect their valuable films. Along came "regional" control. Now this
   really pisses me off, because when i buy a video disk, i want to be
   able to play it. When I go to Japan and buy a "region 2 disk", then bring
   it back to the Usa, it will not play, because a region 2 disk generates
   an authentication error on a "region 1" player. Will I tolerate this,
   of course not. Lots of ways to go about it.
<a name="zora"></a>
   The first way is Zoran Softdvd.
   This is a software only product that with appropriate hardware
   in this case a pII/400 and an ATI AGP video card, this software product
   plays DVD's at full frame rate with stereo sound. Kind of slick
   actually.
   Kind of buggy really. This version is 1.61. One small exe file and
   a bunch of huge dll's. Take a look at the following segment.


   CCE_SPU.DLL

   Area 1

   :1000448B 8B7C2464          	mov edi, dword ptr [esp+64]
   :1000448F 57        		push edi
   :10004490 E82B0E0000        	call 100052C0
   :10004495 83C404    		add esp, 00000004
   :10004498 33C9      		xor ecx, ecx
   :1000449A 85C0      		test eax, eax
   :1000449C 745C      		je 100044FA
   :1000449E 83F803    		cmp eax, 00000003
   :100044A1 7525      		jne 100044C8
   :100044A3 B801000000        	mov eax, 00000001
   :100044A8 89BE1C020000      	mov dword ptr [esi+0000021C], edi
   :100044AE 5F        		pop edi
   :100044AF 898E14020000      	mov dword ptr [esi+00000214], ecx
   :100044B5 898E10020000      	mov dword ptr [esi+00000210], ecx
   :100044BB 898E18020000      	mov dword ptr [esi+00000218], ecx
   :100044C1 5E        		pop esi
   :100044C2 83C450    		add esp, 00000050
   :100044C5 C20C00    		ret 000C

   * Referenced by a Jump at Address:100044A1(C)
   |
   :100044C8 50        		push eax
   :100044C9 57        		push edi
   :100044CA 8D442410          	lea eax, dword ptr [esp+10]

   * Possible StringData Ref from Data Obj ->"Could not authenticate disk %d "
      		    		           ->"(0x%08x)."
   :100044CE 68A4D00010        	push 1000D0A4
   :100044D3 50        		push eax

   * Reference To: MSVCRT.sprintf, Ord:02ADh
              
   :100044D4 E88D280000         Call 10006D66
   :100044D9 8D442418           lea eax, dword ptr [esp+18]
   :100044DD 83C410    		add esp, 00000010
   :100044E0 6A30      		push 00000030

   area 2

   :10004581 33C0      		xor eax, eax
   :10004583 8B7C2464          	mov edi, dword ptr [esp+64]

   * Referenced by a Jump at Address:1000457F(U)
   :10004587 85C0      		test eax, eax
   :10004589 7432      		je 100045BD
   :1000458B 50        		push eax
   :1000458C 57        		push edi
   :1000458D 8D442410          	lea eax, dword ptr [esp+10]

   * Possible StringData Ref from Data Obj ->"Could not authenticate title %d "
					   ->"(0x%08x)."
              
   :10004591 686CD00010        	push 1000D06C
   :10004596 50        		push eax

   * Reference To: MSVCRT.sprintf, Ord:02ADh
              
   :10004597 E8CA270000        	Call 10006D66
   :1000459C 8D442418          	lea eax, dword ptr [esp+18]
   :100045A0 83C410    		add esp, 00000010
   :100045A3 6A30      		push 00000030


   I think you all know what to do with the two jumps at
   44A1 and 4589

   But there is still one little detail. Even though we have now
   got rid of all authentication control, The ntsc video output on the
   ATI video card has macrovision applied to it, courtesy of the
   impacTV2 ntsc output chip. Now this is buried in the code somewhere,
   that i have yet to be able to find.


   Is macrovision a problem. Do not think so.
   I was going to include a schematic for a macrovision decoder, but
   with numerous outfits on the net selling them for $60 USD, its not
   worth building one.

   check out videotek.net


   However soon, there will be players with a newer version of the macrovision
   circuit thats much harder to defeat. But here is the best part, not
   only is the new encoding circuit patented, but macrovision also patented
   the decoding circuit, so that anyone producing macrovision decoder boxes
   could (and most likely will be) sued. Nasty people aren't they. After
   obtaining a copy of the patent, its obvious that the newest idea is to not 
   only to mess with the sync signals, but to slowly and rhythmitically modify
   slightly the frequency and phase of the color burst signal. Does not affect
   standard viewing (Bullshit it don't) but drives VCR's nuts.

   Lots of tapes and DVD's and PPV events on DSS have macrovision enabled.
   People start voting on this with your pocket book. Are you going to
   spend 5K on an HDTV monitor, only to have the picture screwed with by
   macrovision?

   Here is the same think for the pc-dvd encore unit.
   This uses a dedicated mpeg video decoder board with the Ccube chipset
   on it.
<a name="remot"></a>
   I could dissasemble and patch this mess, but someone else has already
   done a really good job of creating a universal gizmotron to do it.

   Check this out and support this guy

   www.xs4all.nl/~evdberg/</prE>
<hR><font color=purple>
In january 1998 I (Erwin van den Berg) made a small utility that 
could change the region code of the Creative DVD Encore Dxr2. 
This program was called the Creative DVD Region Selector (REGION.EXE). 
Later, when the program also could change the color carrier of 
the tv output and disable MacroVision, the name was changed in 
Creative DVD Selector (SELECTOR.EXE).
</fonT><hR width=33% height=5>If you want this program right now (version 1.31), just email 
<a href="mailto:getweb@usa.healthnet.org">getweb@usa.healthnet.org</A>
and write the following inside the BODY of your email (no subject needed):<bR>
<font color=red>get http://www.xs4all.nl/%7Eevdberg/remoteselector131.zip</font><br>
(where %7E corresponds to the "tilde" ~ of the above URL)
<hr>
   <prE>Whats really slick about this method, is that it touches NONE of the
   original code. It just intercepts things...

   There are most certainly other ways.

   Modify the drive itself to always spit back the non-copyrighted, multi
   region label. On some drives this could be slightly tough.

   For most panasonic and pioneer players there are already numerous
   outfits out there selling what amounts to new firmware that disables
   all regional controls and macrovision. Prices are currently a little 
   high but will definitely come down as volume increases.

   Modify the operating system DVD device driver.
   Now this one is a bit of work. With windows98 its built into the
   operating system. One patch will fix most drives.

   This is what i will be spending much time on in the future.
<a name="zeni"></a>
<hr>
   Now on to more fun.
   The Zenith DIVX player.

   Now I really hope that DIVX actually fails BIGTIME real soon. 
   Absolutely everything about DIVX is bad.

   quoting from various sources...

   Under Divx, consumers would pay about $5 for a DVD-quality movie - a
   far lower price than today's standard DVDs, which often retail for up to
   $26. But unlike today's DVDs, the Divx movie could be played for only
   two days, and only on a Divx-equipped player. After that, the movie
   would be scrambled. 

   For additional viewings, consumers would pay additional fees which could
   vary from film to film. Divx-equipped players, connected to phone lines,
   would unscramble the film and pass information along to a central office
   that would bill the consumer. 

   Sounds like a good idea, think again. Whats the average life of a CD
   player. In my house its ready for the trash can in 4 years. That means
   that if you spend the full price for the movie, you can ONLY watch that
   movie in THAT player. When the player breaks, your investment goes
   away. If i take a movie over to a friends house which i now legally own,
   it will NOT play in his player.

   What else would you expect from a bunch of lawyers working for
   Circuit City corporate.

   Others have listed the disadvantages much more accurately.

   Some of this should go in under the reality cracking section.


   1.    The Divx players will cost 100-200$ more than ordinary DVD players and
         thus putting them even more out of reach for those preferring to
         rent and not to buy.
   2.    You will also have the extra expense of installing permanent telephone
         lines to all your Divx players. No other electonic devices used in the
         homes needs a permanent telephone connection. 
   3.    The rental fee will be higher than that of ordinary DVDs. 
   4.    Many people will throw away the Divx disc after the first wieving as
         the plastic disc is then worthless. This in not exactly environmentally
         safe.
   5.    Divx will mean that several hundred thousand DVD players are outdated
         just a few months after the DVD launch.
   6.    Launching a competing format will confuse the consumers and confused
         consumers will not buy anything. The entire launch of DVD will be
         delayed worldwide. The delay may be so long that it comes too close
         too the launch of the next DVD generation with HDTV resolution.
   7.    Many average consumers will not understand that the Divx disc they
         buy can't be played in any DVD player and they will also have problems
         understanding the rental system. Less honest people will take advantage
         of the confusion and sell Divx discs as used DVDs.
   8.    Paying full price to get an unlimited rental period will not be
         possible with all titles. Try to calculate what 1 year of Lion King
         would cost and try to imagine explaining to the kids that they can't
         see the title even if it's on your bookshelf.
   9.    You can't sell your Divx movies even if you have paid Divx full price
         to "own" the titles.
   10.   If you take a Divx disc you "own" over to a friend not only does he
         need to have a Divx player, he will also have to pay a 48 hour rental
         fee to play the disc. 
   11.   It will not be possible to show a part of a scene on a Divx disc to
         demo the new digital video format without having to pay a full 48 hour
         period for it. 
   12.   Imagine if the babysitter would take a short peek (Looking for cool
         menus and extras) at 50 of the movies in your collection that you do
         not yet "own". 
   13.   "Hey, this is the wrong film!" How many times have you put the wrong
         VHS or CD into a player? That error will now cost you a 48 hour
         rental. 
   14.   If another company buys the rights to a movie or if Disney again put
         one title on moratorium expect that a Divx disc you have paid full
         price for can suddenly become unwatchable. 
   15.   Divx claims that their system will survey the consumer no more than
         that of an ordinary video rental store will do. This is not true. With
         Divx they will have to keep track every title you (or anyone else) put
         into your video player from the day you open the Divx account and that
         no matter the origin of the disc. They will even know what time of day
         you are viewing the title.
   16.   The Divx discs will be numerated so if you take your disc over to a
         friend who also happends to have a Divx player the Divx central will
         know it. Divx have already said they will use this information. Maybe
         you don't care about being surveyed, but imagine getting a call from a
         pizza company every time a Divx is put into a player it don't "belong"
         to.(In case you don't understand this: When a Divx disc in put into
         another player chances are that several friends are gathered to watch
         a movie. A pizza company may be willing to pay Divx for this
         information). 
   17.   Only the manufacturers selling the lowest quality players supports Divx. 
   18.   You will not be able of using the cool extras that many titles will
         have on a computer with a DVD-ROM player.
   19.   With Divx you will only be able of renting from one company. If the
         format gets accepted among the consumers they will have a monopoly
         and can set the prices without any competition. 
   20.   If Divx is accepted they will take over the market from specialised
         video stores who will have to close. The profit margin they can get
         from selling Divx discs are simply not enough for them. How many rare
         movie titles do you expect to find at the local grocery store if they
         start to sell Divx there? Contrary to the claims Divx will mean that
         the consumers will have less titles to choose from as it will kill
         nearly all specialzed video stores. Apart from less choice many jobs
         would also be lost.
   21.   If Divx is accepted they could also offer rentals at higher price at
         the same time as the movies passes at the movie theatres. Divx could
         kill your local cinema. 
   22.   No information system is without errors. What if you find that you
         are charged for viewing a disc you know you have not seen the last
         month. How can you prove it to them? If you refuse to pay they may
         simply disable your Divx account.
   23.   What will you do when they start charging you a monthly fee for having
         a Divx account? Will you pay whatever they ask or will you throw
         away the film collection they claimed you "owned"? 
   24.   No credit card or no phone? Forget it! 
   25.   If your check account is not ballanced then Divx may stop your Divx
         account and you will suddenly find yourself unable of viewing the
         entire movie collection you have already paid full price for. 
   26.   What will happend if your phone line is down for several days, if
         angry DVD owners are blocking the tollfree numbers or simply if you
         go on vacation for a week or more and you are not willing to leave
         the player connected?
   27.   The system could also be used to monitor all DVD and CD titles you
         play on the Divx player.
   28.   If you move to another country your entire movie collection would
         become worthless.
   29.   People will simply not accept paying each time they view a title they
         have in their house. They would simply copy it to VHS using a
         macrovision buster. It would even be fully legal for the consumers to
         do this. How do you expect the studios to cover their loss?
   30.   What will you do with the collection of Divx discs you "own" if/when
         the whole Divx project is stopped? Do you expect that you can still
         watch a Divx disc you "own" 15 year from now just as you can with
         VHS, Laserdisc and ordinary DVD?
   31.   If Divx succeeds expect similar systems to be used for DVD-ROM and
         DVD-Audio. By releasing software only on a Divx system they hope
         to push the consumers into supporting this more expensive rental system. 
   32.   In a few years DVD-RAM could be used to record TV programmes and
         replace the VCR completely. If the player also has Divx don't
         expect the studios not to take advantage of having control of your
         player.
   33.   No matter how impressive the encryption is there will always be a
         loophole. To modify a Divx player so it "forgets" it has played a disc
         should not be too big a challenge for many crackers. Expect such players
         to become mainstream in the USA and the rest of the world if Divx
         by any chance takes off in the USA. Remember that the Circuit City
         chairman Richard Sharp warned that early adopters were taking a risk.
         This is indeed true with Divx. If Divx is not killed right after the
         launch expect a new system called something like Divx-2 soon to be
         launched rendering the old Divx players outdated.  


   Now lets pay attention to #33. Lets take a DIVX disk and stick it in a
   regular computer DVD player. Lets open the disk with explorer. Oh,
   lookie it looks just like a regular dvd disk. Lets open softdvd and try to play
   the disk. "Not a MPEG data stream". So its encrypted. I do not believe
   that cracking this is gonna be that tough. It cannot be tough, there is just
   barely enough time to run the mpeg decoder anyway. If anything its a
   masking or rotating bit shifting thing.

   Now lets crack open that Zenith DIVX player i have gotten my hands on.
   Make no mistake about it, the only thing Zenith owns about the entire thing
   is the logo on the front. Its actually made by Goldstar. Zenith engineers
   would be incapable of designing anything like this anyway, thats if
   there were any engineers left after the recent chapter 11 filing....

   Oh, look a 32,768 khz watch crystal. Naw, can't be that easy.
   First never ever hook this thing to the phone line. Without being on
   the phone line, it can never update the time. Now either short the
   two wires of the crystal together, or tie one wire to ground. The
   clock stops. Turn the unit back on, beep, beep ,beep. Turn the unit
   back off, install a switch. Turn the unit back on, comes up fine.
   Now turn on the switch stoping the clock. If you leave the unit in this
   condition, you can play DIVX disks, damm near forever. Now one would
   normally think that there is got to be a hidden gotcha here, like the
   player timing out after not being able to reach the authorization
   center for a week, But this now 3+ weeks running, and no problem yet.
   (Of course this is a BETA player, and they will probably fix it, then
   again maybe not.) On the other hand it may be that they use the clock
   to determine cheaper times to call in, and since the clock never advances
   then the player does not call in. Given #10 above, it would seem that
   they are not worried about the ocassional possibility of one person
   watching a movie, then immediately taking it over to another persons
   house so that he can watch it...

   Actually the phone company will probably love divx, think of all that
   additional revenue from all those boxes calling in all the time.

   Its now 5 weeks later, and the divx player continues to play disks that
   have not been paid for. Sears a large retailer in the USA has dropped
   selling divx, saying that they do not want consumer backash to divx to
   affect other parts of their store.

</pre><center><hr><i>You'r deep inside reverser's pages of reverse engineering, choose your way out</i>
<hr size=2 width=33%>
<a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="+HCU Papers" 
ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Papers</fonT><p>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" 
VSPACE="0"
HSPACE="0" ALIGN="BOTTOM" width="13" height="13"><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A>
<IMG 
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"><A 
HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" 
HEIGHT="13"
BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"><A 
HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" 
HSPACE="0" width="13" height="13"><A
HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0"
VSPACE="0" HSPACE="0" width="13" height="13"><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A><IMG 
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"><A 
HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter
measures </A><BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" 
HSPACE="0" width="13" height="13"><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" 
ALIGN="BOTTOM"
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A><IMG SRC=
"images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"><A 
HREF=
"searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER=
"0" VSPACE="0" HSPACE="0" width="13" height="13"><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A><IMG 
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"><A 
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" 
HSPACE="0" width="13" height="13"><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal? </A></CENTER></P>

</BODY>
</HTML>





<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><META Name="Voluntary Content Rating" content="it's reverser's: great!">


<title>scarecro.htm Scarecrow license agreements and how to defeat them</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 ALINK=#405040 VLINK=#8850AA><CENTER>
<a name="scarec"></a>
<H2>'Scarecrow' license agreements and how to defeat them</H2>
<H3>'Legal scarecrow' agreements <u>are NOT</u> legally binding<br>
And even if they were, I'll show you here how to circumvent them...</H3>
by reverser+, 20 October 1998, <i>in fieri</i><bR>
[<a href="scarecro.htm#wta">What they are</a>] ~ 
[<a href="scarecro.htm#efe">Eye for eye</a>] ~ 
[<a href="scarecro.htm#rth">Reversing them</a>] 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=500 HEIGHT=5 BORDER=0
VSPACE=0 HSPACE=0>
<br><br></center>
<center><a name="wta"></a><H2><font color=gray>What they are</font></H2></center>
<bR>
Most licence agreement (that thing that you click "I agree" on and never read, 
where you agree to give up your first born child and let your sister be 
sold as a slave :-) include a clause that prohibits reverse engineering. A couple of 
examples... 
<font color=purple><prE>
IF YOU AGREE TO THE DISCLAIMER AND LICENSE YOU MAY:

(i) use this software on as many computers as you wish at no charge for 
up to but no more than 30 days. After 30 days of use you must either 
discontinue the use of this software or purchase a registered version 
for each computer that you are going to use this software on.

YOU MAY NOT:

(i) sublicense, rent, sell,  or lease any portion of this software;

(ii) reverse engineer, decompile, disassemble, modify, translate, 
make any attempt to discover the source code of this software, or 
create derivative works from this software; or

(ii) continue use of this software after your 30 day trial.

DISCLAIMER OF DAMAGES:

We have made every effort possible to ensure that this software is free 
of any bugs or errors, however in no way is this software to be considered 
error or bug free.  By using this software you assume all responsibility 
for any damages or lost data that may result from any errors or bugs in
this software.  Regardless of whether any remedy set forth herein fails 
of its essential purpose, in no event will our Software house be liable 
to you for any special, consequential, indirect or similar damages, 
including any lost profits or lost data arising out of the use or inability 
to use this software...</prE></fonT><br>
Note that you should not "reverse engineer, decompile, disassemble, modify, translate, 
make any attempt to discover the source code", as if the source code of a 
software product were a 'private secret' that third parties are not even
allowed to examine... <br><br><hr>
Here another example:<font color=purple><prE>
You may not:

* permit other individuals to use the Software except  under  the
  terms listed above;
* permit concurrent use of the Software;
* modify, translate, reverse engineer, decompile, disassemble  or
  create derivative works based on the Software;
* copy the Software other than as specified above;
* rent, lease or otherwise transfer rights to the Software; or
* remove any proprietary  notices or labels on the Software.

TITLE

Title, ownership rights, and intellectual property rights in  the
Software  shall  remain  in  Our Software house  and/or  its  
suppliers. 
The Software is protected by the copyright laws and treaties. 
Title and related rights in the content accessed through the Software
is the property of the applicable content owner and may  be  pro-
tected  by  applicable  law.  This License gives you no rights to
such content.

TERMINATION

The license will terminate automatically if you  fail  to  comply
with  the limitations described herein.  On termination, you must
destroy all copies of the Software and Documentation.</prE></fonT>
<br>
Here there seems to be an interesting possibility. I reverse the 
software. License has been violated and terminate. I then destroy 
all copies of the software, and have then respected the licence. And so 
on <i>ab absurdo</i>. Like the never-ending sentence  
"All crackers are liers, lied the cracker". <hr width=44%>
<center><a name="efe"></a><H2><font color=gray>Eye for eye</font></H2>
(Let's produce our own preliminary agreements and let's alien 
software sign them)</center>
<br><br>

OK, it is clear that such 'scarecrow' agreements are as 
funny and 
preposterous as you wish, yet of course NOT legally binding. Let's 
demonstrate it <i>ab absurdo</i>: If they were legally binding, then ANY 
agreement of this sort would be, and then anyone, you or me,  
could prepare on his own a small program (I promise that I'll really 
write it myself as soon 
as I find the time) that acts as a small 'wrapper' for all this kind 
of software (I really wish that a good lawjer will correct this 
in 
order to make our own 'legal scarecrows' even more dangerous-looking than 
those used by some softwarehouses...):<font color=purple><prE>
Your software is entering my private computer. By trespassing 
this memory point you  agree to allow complete  possession of 
your  software to the  legitime  owner of this  computer, and 
specifically you  completely and irrevocabily  agree to allow 
any attempt to modify, translate, reverse engineer, decompile,
disassemble or create derivative works based on this Software 
that the legitime owner of this memory (i.e. me :-) fancies.
You also declare as void and inexistent any other conditions-
agreements  regarding your  software that  may preposterously 
be triggered by your software inside the RAM hosting you.
Finally  you  accept  also  COMPLETE  RESPONSABILITY  for any 
malfunctioning your software will have caused to the owner of 
the  hardware  you  are  herewith  allow to visit ONLY if you 
accept this.

If you don't wish  to  accept these  conditions, please leave 
immediatly this private memory and fully remove your software 
from this private hardware.
By trespassing this  memory point you  have completely agreed 
to the above. 
              [add date with hours, minutes and seconds here] 
 [add 'Signature' with the version name of the software here]</pre></font><bR>.
Ab absurdo, as I said... yet, see, either both "agreements" are valid or neither 
is... you cannot have the cake and eat it.<br>I would say that we could keep it this way: anyone 
may reverse the hell out of everything, provided he does not steal or sell 
alien code.<bR>
The only binding texts are the NATIONAL LAWS governing software 
reversing and we have already  seen that (at least in the <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >European  
Union</a>):<font color=green><prE>
 5(3): The person having a right to use a copy of a computer program          
       shall be entitled, without the authorization of the rightholder, 
       to observe, study or test the functioning of the program in 
       order to determine the ideas and principles which underlie any 
       element of the program if he does so while performing any of 
       the acts of loading, displaying, running, transmitting or 
       storing the program which he is entitled to do.</prE></fonT>.
<hr width=44%>
<center><a name="rth"></a><H2><font color=gray>Reversing them</font></H2>
(Let's click our 'I disagree' button)</center>
<br><br>
Now, this said, I cannot understand why a cracker (one of the most intriguing 
heroes in modern society) should not use his superior knowledge
in order to avoid ANY silly trick or bogus legal mumbo-jambo, in life 
and in software life as well.
<br><br>
So let's see: let's take as target "Window Washer", by Webroot software.
<br><br>
There you can read the following preposterous text:<font color=purple><prE>
YOU MAY NOT:
(i)   sublicense, rent, sell,  or lease any portion Window Washer;
(ii)  reverse engineer, decompile, disassemble, modify, translate, 
      make any attempt to discover the source code of Window Washer, 
      or create derivative works from Window Washer; or
(iii) continue use of Window Washer after your 30 day trial.</prE></fonT>
<bR>
Well, I don't like it: of course I wish to reverse engineer, decompile, 
disassemble modify and make any attempt to discover the source code of 
any application running on my ram... why shouldn't I? 
<bR><br>
This puts me in a difficult situation: I cannot agree with this clause, 
yet the demande made is as much as my conscience, verging on the border of
 that that fine line which divides honesty from dishonesty, would tolerate...
<bR><bR>
So let's reverse THIS AGREEMENT first of all:
<br><br>
1) Fire the Customizer (you'll find it -uncracked) in my <a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a> section, 
crack it first.
<br><br>
2) Fire Window Washer (actually it's 'setup' module).
<br><br>
3) identify the main agreement window with the customizer, you'll see that's 
Class: TForm4; Title: License Agreement & Disclaimer; Handle (here) 0x0644; 
Dimensions: 373x557 at 61,216; 
<br><br>
4) now point the customizer to the small button 'Agree', you'll see that's 
class Tbutton; ParentClass: TForm4; Dimensions: 25x75 at 395,378.
<br><br>
5) Now choose the label 'Text' Inside the customizer. And type under 'Nex Text': 
'I Disagree' (or whatever you fancy :-)
<br><br>
6) Since I didn't agree, I'm not bound to the list of no-no-no. Yet don't worry: 
I won't translate nor modify this crap.
<bR>
<hr>
So easy it is. And yet this i quite interesting, not only for software license agreements, bu 
also for many more legal paraphernalia that are now appearing on the web everywhere. 
Let's see more 'in deep' the code used by a normal application for this kind of stuff...
<hr>
... to be continued, your suggestions, additions, critics and modifications are welcome... 20 October 1998...
<hR>



<center>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0>
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A>

<bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?
</A></CENTER>
<hr size=4></fonT></center></center>
<!-- Begin signet -->
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=CENTER
BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font
color=green>(c)
<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a> 1995, 1996, 1997, 1998.
All rights reserved
<!-- End signet -->
</body>
</HTML><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>
fravgif
</title>
</head>
<!-- HTML code by Reverser, Yeah, go ahead, steal my code, sucker -->
<body bgcolor="CCCCCC" text="#001010" vlink="#405040 Alink=#00FF50">
<a name="anchortop">
<center><font size="+4">reverser's <font color="red">famous little gifs</font></font><hr>
<i>Well, I presume that if you followed all the links until here you are REALLY 
interested in my site... therefore you deserve a complete list of all my gifs: 
here they are! (all gifs are 114*43 pixels)<br><br>
</i>
</center>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1">
<tr>
<td VALIGN="center"><img SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm">advanced.htm</a></td>
<td VALIGN="center">Shows 'deep concentration' necessary for zen cracking</td>
<td VALIGN="center">&quot;If you drive alone you drive with Hitler&quot;, USA 1940</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/snippets.gif" tppabs="http://members.xoom.com/tsehp_/images/snippets.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="snippets.htm" tppabs="http://members.xoom.com/tsehp_/snippets.htm">snippets.htm</a></td>
<td VALIGN="center">Shows relative unimportance and 'roughness' of snippets</td>
<td VALIGN="center">Canon's printing press, 1990</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="students.htm" tppabs="http://members.xoom.com/tsehp_/students.htm">students.htm</a></td>
<td VALIGN="center">Real +Crackers have it, one of the first gifs</td>
<td VALIGN="center">My own, 1996</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/offitool.gif" tppabs="http://members.xoom.com/tsehp_/images/offitool.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools.htm</a></td>
<td VALIGN="center">Official HCU tool... shows protections as wild animals</td>
<td VALIGN="center">From &quot;Tarzan and the slavegirl&quot;, South America 1960</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/stupid.gif" tppabs="http://members.xoom.com/tsehp_/images/stupid.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm">project7.htm</a></td>
<td VALIGN="center">&quot;Most stupid protection&quot; award, ridiculizes protectionists</td>
<td VALIGN="center">My own, 1997</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/tough.gif" tppabs="http://members.xoom.com/tsehp_/images/tough.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm">protecti.htm</a></td>
<td VALIGN="center">&quot;Our protections&quot;, I don't like it much and I will change it</td>
<td VALIGN="center">My own, 1997</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/spectool.gif" tppabs="http://members.xoom.com/tsehp_/images/spectool.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools.htm</a></td>
<td VALIGN="center">generic for all tool pages, self-ironic :-)</td>
<td VALIGN="center">One of Gil Evgren's most famous pinups, 1945</td>
</tr>


<tr>
<td VALIGN="center"><img SRC="images/antism.gif" tppabs="http://members.xoom.com/tsehp_/images/antism.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">ideale.htm</a></td>
<td VALIGN="center">Crackers against smut, shows women disgust for smut sites</td>
<td VALIGN="center">Peter Driben, Inside Detective 1940</td>
</tr>


<tr>
<td VALIGN="center"><img SRC="images/hcu98.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu98.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="solution.htm" tppabs="http://members.xoom.com/tsehp_/solution.htm">solution.htm</a></td>
<td VALIGN="center">+HCU strainer 1998, underlines the importance of 'feeling' code</td>
<td VALIGN="center">My own, 1997</td>
</tr>

<tr>
<td VALIGN="center"><img SRC="images/anon1.gif" tppabs="http://members.xoom.com/tsehp_/images/anon1.gif" ALIGN="LEFT" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="114" HEIGHT="43"></td>
<td VALIGN="center"><a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">noanon.htm</a></td>
<td VALIGN="center">Reverser's Anonymity Academy, the one I like most</td>
<td VALIGN="center">Unknown, Detective stories 1943</td>
</tr>






</table>
<br>
<i>I know: there are more... I'll add them when I'll feel like it.
</i>

<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT="13" WIDTH="13" ALT="red_ball"><a HREF="private.htm" tppabs="http://members.xoom.com/tsehp_/private.htm">Back to private.htm</a>
</center>
<!-- End mover -->
<hr>
<!-- Begin signet --><i> reverser, December 1997<br>
<!-- End signet --></i>
<hr>
</body>
</html>
   <HTML>
<HEAD>
<TITLE>frogssep.htm: Frog's Print's contribution to reverser's crossing</TITLE>

<body bgcolor="C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<prE>

                 Hi Reverser+,

                 How are you?
                 Fine I assume, according to what I just read in your September "radical
                 plans".
                 A new +HCU is a smart idea. I haven't heard -yet- about +others'
                 opinions, but I am quite sure that they will all realized how 
		 necessary it is to bring up some new interesting thoughts and 
                 questions about that and will follow you. 
                 I will and I am ready for it ;-)
                 Enclosed is my HTML 'public opinion'.
                 Let me know if you need some help!</prE>
<hr>

 My very first contribution to the +HCU (a stupid essay about W32dasm7) 
                               was on March 19, 1997.
<bR>
                                At this time there were only 5 essays published .
<bR>
                                Now, 1 year and 1/2 later, I am totally unable to say how many essays have

                                been published and I don't even think I read half of them :-(

                                It grew big, it grew fast...too fast in my opinion.
<br>


                                Despite the fact that I may not agree with some of Reverser+'s philosophical

                                thoughts about our +selfish approach and our beloved -programmers bankruptcy,

                                I have to say one thing:

<bR>
                                HE IS BLOODY RIGHT ;-)

<bR>
                                I think the +HCU has reached a point where there's no real way to make it more

                                interesting or even to improve it. We'll all soon get fed up while browsing 

                                through these megabytes of essays hopefully trying to find something new, unusual.

                                How could it last this way?
<br>
                                Let's forget about that Beta version of the +HCU (at which +we contributed

                                passionately), time has come to release a brand new bugless Final version.

<bR>

                                Reverser+ already made some suggestions (few small labs) but at this point I think

                                it would be too early (and not really smart IMHO) to criticize them right now

                                (nevermind, good and new ideas are always rejected first ;-).

<br>

                                Don't forget as well, that only our -good- contributions could help this new vintage

                                +HCU to be even more interesting than ever. 

<bR>
                                Frog's Print 8/9/98
<br>
                                PS: Plz, don't throw away all those essays: may be a repository somewhere else would be nice!

 
</body>
</html>  <html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>pro_syn</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to protect better<br>
(SECOND PHASE of this new section)</h2><h4>by +Sync, 21 July 1997</h4>
<img SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="HCU" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0">
	<br>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering

<hr size="2">
<pre><font color="purple"><h2>
How to protect better.
</font></h2></center>
	                   Register - The MegaMan Protection
                                   By +Sync

			download <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >register.exe</a> here (11200 bytes)

        Well, I was wondering why I have not seen a unique protection scheme
in quite a while, so I decided to come up with one of my own.  I tried to
think of a straight ahead name/password scheme except to make the algorithm
really tricky.  However, since anyone with passing knowledge of assembly can
reverse this reasonably quickly, I decided to try to put a 'twist' on it.
What I came up with is, I believe, a challenging crack.  This is what I would
call a 'fairly strong' protection.  I did not Hackstop the program or put any
anti-debugger code in it, although I suspect that if I were actually trying to
protect this software I probably would have.  What I developed is, as far as I
am aware, the only 'MegaMan' type registration scheme around.  I call it
'MegaMan' because the old Nintendo games used to use a similar method for
entering codes.  My challenge to you is, crack it - but following a few
restrictions.  While a patch is always valid, and I would like to see how
some of you go about patching it, a valid code (or generator) will be the only
100% valid answer.  I know that since this program does not use the standard
API functions (GetWindowTextA etc.) to retrieve the password it will require
some research (possibly) into how windows retrieves the data.  I hope this
slows some of you down.  Realizing that this is a somewhat difficult crack, I
offer you 2 hints.
1.  The number of 'checks' is not always the same.  It CAN vary in length
        slightly depending on the name entered.
2.  THIS IS A HUGE CLUE - I will give you a valid name/number pair, so that
        you can see how the program reacts when a valid number is entered.
        The program acts no different, and no message box appears, so you
        cannot use a break on a window handle.
        Name: +Sync
        Code:
                0 - H       \
                0 - C        |- HCU on line 0, pretty interesting.
                0 - U       /
                1 - S
                2 - M
                3 - Q
                4 - I
                4 - S
                4 - Q
                5 - H
                6 - L
                7 - S
                8 - E
                9 - S

        I tried to not make this too tough to reverse engineer.  For example,
one idea I toyed around with was to have the user enter a separate registration
number into each block, rather than just check it.  I decided that while this
was challenging enough to prevent most crackers from attempting it, it was not
a viable protection because your customers would get frustrated too quickly. I
invite others to also develop UNIQUE protections and share them with us.

Final Note:  As soon as a  correct answer has been posted to the +HCU
discussion, full source to the registration routine will be presented by me.
Please make any comments you want (i.e about my lousy windows coding). I'm sure
that there is at least one EASY way to crack this, however there are many ways
to get lost quickly.  Remember, a patch is acceptable, but the real answer is
a working code.
+Sync
 </pre>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="new_page_1.htm#79" tppabs="http://members.xoom.com/tsehp_/finished.htm#79">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="new_page_1.htm#53" tppabs="http://members.xoom.com/tsehp_/finished.htm#53">links </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#78" tppabs="http://members.xoom.com/tsehp_/finished.htm#78"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a><br>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering illegal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html><html>

<head>


	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>gnew1.htm</title>

</head>

<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">

<center><font size="+3">PIQ + Pentium, + some general<br>protection
thoughts for the HCU</font>

<br>(freezing and crashing everything in sight when someone patches our
programs)

<h4>by g(ar)<br>

(21 November 1997)</h4>

<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm"><img SRC="images/tough.gif" tppabs="http://members.xoom.com/tsehp_/images/tough.gif" ALT="our protections" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a>

<br><font color="gray">Our protections</font>


<hr>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 

of reverse engineering<br>       

<br><i>Sorry g(ar), no single letter pseudos are allowed for
cross-referencing reasons :-)<br>It was about time... &quot;our own
protections&quot; do not seem to attract much work, yet the PIQ
considerations (started by Camel Eater long ago) are slowly growing.
We'll see... I must admit that I'm getting curious... could anybody send
to the +HCU some <u>WORKING</u> recent PIQ-protection schemes? 

</i></center><hr size="6">

<pre><font size="+2"><center>

PIQ + Pentium, + some general

protection thoughts for the HCU</font>

by g(ar)</center>



The PIQ has been used for a long time to detect whether a prog is being
traced. It is a simple idea, but actually determining the _size_ of the
PIQ can be another matter altogether. The two PIQs on the Pentium are
both 64 bytes long (though only one is in use at any one time) so you
don't need to work it out. The 486's is 32 and the 386's 16 (though
some versions have 12).

First though, +Heres was right in suspecting that the Pentium always
updates the PIQ. At first, I couldn't believe that this was actually the
way it's done, but according to a book I've got it is in fact true. The
Pentium checks the linear address of the memory address to be modified
to see if it's in the PIQ. I'm not 100% sure, but it appears that even
instructions in the pipeline are also saved. (When you get to execute
the 'rep stosb' there should be two 'inc bx's in the pipeline).

I'm not entirely sure whether this feature is a good idea in terms of
CPU performance. I'd have to see some evidence before deciding.
Personally, I wouldn't have thought that doing a check on every memory
write just to stop self-modifying code was worth it.

However, all is not lost! You _can_ use the PIQ for this trick, but only
in protected mode. Consider the linear address of the instruction to
modify and then consider the linear address of that same instruction in
the PIQ. They're the same, right? Well, they are and they aren't. If you
remap memory so you've got virtual memory you could have a different
linear address that is in fact mapped to the same physical memory
address. Hence if you're running normally you'll get what was in the
PIQ, but if there's a debugger running then the PIQ will be different
and you'll get what's in memory. Simple really :)

-------------------------------------------------------------------------------

This different way of doing things on the Pentium is actually pretty
beneficial. As most readers will have noticed, the main problem with
this type of code is that it's really easy to spot, but on the Pentium
you get code like:

    set address $12345678 to 10      ; these would in fact map to the
    set address $87654321 to 0       ; same address

(NB: I assume that $12345678 is the linear address to modify - if it
isn't then you'll have to do the modification before the address to be
modified gets into the pipeline. If you don't the memory address will be
altered, but not the bit in the pipeline. Of course, you can have the
instruction be something like 'mov eax,10' already but more useful is
to change the instructions to what the real ones are, or something else
entirely if a trace is on as this will fool disassemblers)

If you're sneaky (which you should be) you can exploit the Pentium's
large PIQ to full extent - you could have two instructions like this
approx 60 bytes apart. Only if you're not being traced will the value
be equal to 10. You can exploit this virtual memory mapping even more
by using different addresses to read the location later on. Clearly,
the location could be used as an instruction or a variable, or even
both at the same time. Obviously, when setting up the mapping you'll
have to be sneaky :) To make things more difficult you could hide
instructions within instructions and put the byte sequence F0 0F C7
C8 in somewhere as it puts Pentium's into an endless loop due to a bug.

A neat trick is to have the protection routine write itself using a
stealth technique to provide different length routines and have the
protection routine then write vital bits of the code if the protection
is passed. The writing routine itself could use the PIQ trick and so
could the protection. Your protection routine should be the longest
most convoluted spaghettified piece of garbage you can come up with
and contain lots of jumps, checks and as much bizarre code as you can
fit in, possibly with lots of stuff that's there simply 'to make the
numbers up.' You should, of course, have repeated protection checks,
at different points in the program, that jump into the protection
code at different points. You can even have multiple protections.
Also, don't just blindly take the address and stick it in your code,
build it elsewhere using several instructions, preferably at
different code points.

If the Trap Flag is set, a trap occurs after each instruction. If this
is being used by the debugger then you can use the Pentium's internal
counters to verify this. Use RDTSC to get the clock count and then read
it later on. You will already know a rough number of how long your
code takes so you can check this to see if you're being traced. I've no
idea how SoftIce or other debuggers work. This is probably one way.
In all cases of having the protection being broken in any way I
recommend crashing the machine (or doing something equally obtuse such
as re-writing bits of the code). Obviously, there are a wide variety
of ways of doing this and I leave the choice to the reader. There's
no reason in my mind why you should make things easy. As an aside,
if you set the Resume Flag, this disables Int 1 which is used for
debugging under protected mode, or you could patch in your own
version instead.

A final trick is to do a file check, e.g. file length or bits of the
file to see if its been changed, or the actual code in memory. If it
has you could freeze the program somewhere or erase all the code from
memory except a single infinite loop or delete the proggy from the disk
alongwith its associated files (be careful not to delete anything you
shouldn't though) or...you get the idea I guess. A final point to note
is that I think you should always use multiple protections and should
make life difficult by doing clearing the proggy from memory and stuff
like that. It's better than nothing I suppose.

I must stress that I'm an absolute newbie to PC cracking/hacking and
have very little experience in the field itself. Hopefully the info
here is correct and I've not written anything totally lame but if I
have then please correct me and don't flame too hard. If you're going
to be doing any PIQ stuff then I suggest you read up on exactly how it
works, as it is quite complicated, but there should be some ideas in
here for you to work on.

As a final point, I think that only prgs should be available for
download first, with sources following later, and there should be no
help given. I mean, how many times have you bought a prg that comes
with source or has hints on how to crack it?

l8r,
g(ar)
</pre>



<font color="green">(c) g(ar). All rights reversed</font>

<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">

<center><i>You are deep inside reverser's page of reverse engineering,  

choose your way out:</i></center>

<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm">Our Protections</a> 

           <hr width="33%">





<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a> 

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy
database</a><br>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>



<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
legal?</a></center>

<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>

</body>

</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>caligo4.htm: How to make passwords hidden by "stars" visible</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><H2>Using BRW: How to make passwords hidden by "stars" visible</H2>
by <font color=red>Lord Caligo</fonT><br>
02 December 1998
</center>

<center>
<hr>Courtesy of reverser's pages of reverse engineering<bR>
slightly edited by reverser+<hr width=33%><br><i>I have two observations about this text.<bR>
The first one regards the delay in publishing it: I have more than 20 email addresses, because I discard those that have 
been spammed (one of my email addresses 'felt' into the database of those 
commercial bastards at xoom, for instance, and has been since 
continuously spammed), I use some email addresses with automatic 
filtering capabilities 
and automatic responders for some automatic tasks, I have special 
addresses for people in 'real life' that have nothing whatsoever to 
do with my site, I have three different chains of email  
addresses for pseudo-anonimity purposes, and I have a couple of 'dormient' 
addresses as well...<br>The problem with email addresses changes: you 
tend to check the 'remote' ones less and less often. Thta's the reason this 
nice essay by LordCaligo remained unpublished until now... Sorry, old pal :-)<br><br>
As second observation I may add that, even if BRW version 4,5 is 
undoubtely the best resource editor ever made, since BRW has been 
'discontinued' (see my various essays about it) I'm afraid we'll 
have all to carry on our studies with a Micro$oft product... (at least until 
the arrival of a better -and new- resource editor) the most recent 
version of Micro$oft's resource editor, dubbed 'Developer studio', seems 
to do the resource job done (albeit not as well as BRW).   
</i></center>
<hr> 
<prE>
                   _   _   ___   _ _ _  _____   ___
                   | |_| | / _ \ | | | ||_   _| / _ \
                   |  _  || (_) || | | |  | |  | (_) |
                   |_| |_| \___/ \_____/  |_|   \___/

                make passwords hidden by "stars" visible
                      a 'tutorial' by lord caligo
                          02 december 1998

OVERVIEW:  I.    INTRODUCTION
           II.   NEEDS
           III.  WHAT IS RESOURCE WORKSHOP ?
           IV.   THE THING TO DO
           VII.  PATCHING THE DIALUP NETWORK
           VIII. LAST WORDS

 --------------------------------------------------------------------------

I. INTRODUCTION

It's been a while since i've been writing these howto's, my only public
essays available. The time I am writing this there are four, if you're 
interested in earlier ones just ask me or Reverser+.
But let us begin: Since a few months a tool became more and more popular:
Snadboy's Revelation (http://www.snadboy.com/) - a great tool to view
passwords hidden by asterisks (just everything uses them, except a few
good ones like PGP). Unfortunately I don't know enough of Win32 Programming 
yet and the author did not tell us how the program works, but I did not
find a thing it does NOT work with.
The only "disadvantage" of Revelation is that you always have to run
it when you need to 'remember' a password - and it needs 1,3MB of my
(important) hard disk space. ;-)
Now I want to show a simple way to get rid of these asterisks in (nearly) 
every Windows program using the Borland Resource Workshop (I don't 
know a 'stable' Internet address for it, but try to locate it
using FTPsearch or Archie. The two versions I have are v1.02 (included in
an old Turbo Pascal/Win Package :) and the last release, v4.5 (filename is
BRW45.ZIP). Some of thhose available on the net do not work correctly, you
cannot directly edit bitmaps/cursors/icons... If you know why or you have 
a fixed version please email me.

 -------------------------------------------------------------------------

II. NEEDS

That's what you need:

 - Borland Resource Workshop (any version, but only newer ones are abled
   to handle Win32 applications :-)
 - a program you want to patch (I successfully did it with Pegasus Mail
   and CuteFTP, should work with other programs, too); Win3.x and Win95
   programs work

 -------------------------------------------------------------------------

III. WHAT IS RESOURCE WORKSHOP?

Before starting you may want to know what this tool does. If you already
know it or if you do not want to know just skip this chapter :)

Borland made this useful program and included it in several coding
language packages. But after a few years Borland suddenly stopped the
support.
As the name says, this tool allows us to view, edit and recompile
the resources of a program (sometimes it does not work, just try out).
That means you can view and edit

 Bitmaps
 Icons
 String References
 Dialog Boxes

Sometimes you can use the BRW to remove nagscreens/unnecessary dialog
boxes by just DELETING them with BRW.
Now, I could tell you more about this tool, but that's not the sense
of this tutorial.

 -------------------------------------------------------------------------

IV. THE THING TO DO

First you'll have to find the dialog box that show the password (the
asterisks).
Sometimes that dialog box/reference is not located in the main program
itself, if not check a few dll's around. You can find out which DLLs
a program executes by using the Dependacy Viewer (DEPENDS.ZIP) by Matt
Pietrek.
Sometimes there are more than one dialog box displaying the password.
Here are a few examples:

CuteFTP 2.5/Win95 :
   
   DIALOG 106
   DIALOG 131
   DIALOG 1537
   DIALOG 1543
   DIALOG 1547
   DIALOG 1549
   
Pegasus Mail v3.01b/Win95 :

   DIALOG TCPS 
   (a few more...)

When you finally have located the DIALOG BOX, hit enter (or doubleclick
on the Item) and you'll see a text like this one (example taken from 
WinPMail):

 TCPS DIALOG 59, 29, 253, 203
 STYLE WS_CHILD 
 FONT 8, "MS Sans Serif"
 {
  CONTROL " Your &e-mail address is:", 7001, "STATIC", SS_LEFT | WS_CHILD | WS_VISIBLE | WS_GROUP, 8, 11, 81, 8
  CONTROL "", 106, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 7, 20, 186, 12
  CONTROL " Settings for receiving mail ", 7002, "BUTTON", BS_GROUPBOX | WS_CHILD | WS_VISIBLE | WS_GROUP, 7, 37, 186, 54
  CONTROL "POP3 &host", -1, "STATIC", SS_RIGHT | WS_CHILD | WS_VISIBLE | WS_GROUP, 13, 51, 41, 8
  CONTROL "", 101, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 57, 49, 129, 12
  CONTROL "&User name", -1, "STATIC", SS_RIGHT | WS_CHILD | WS_VISIBLE | WS_GROUP, 13, 64, 40, 8
  CONTROL "", 102, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 57, 62, 75, 12
  CONTROL "&Password", -1, "STATIC", SS_RIGHT | ES_PASSWORD | WS_CHILD | WS_VISIBLE | WS_GROUP, 18, 76, 35, 8
  CONTROL "", 103, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 57, 75, 75, 12
 [....]
 }

All you have to do now is to remove the dialog box attribute ES_PASSWORD,
just edit it as if it was a text! :)
After this your dialog box properties should look like this:

 [....]
  CONTROL "", 102, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 57, 62, 75, 12
  CONTROL "&Password", -1, "STATIC", SS_RIGHT | WS_CHILD | WS_VISIBLE | WS_GROUP, 18, 76, 35, 8
  CONTROL "", 103, "EDIT", ES_LEFT | ES_AUTOHSCROLL | WS_CHILD | WS_VISIBLE | WS_BORDER | WS_TABSTOP, 57, 75, 75, 12
 [....]

You got the point? Just save the whole file (BRW automatically does a
backup, but I think it's always better to keep a manual backup for
yourself) and run the program.
If you did everything right, the dialog box should show you the
clear password without any asterisks.

 -------------------------------------------------------------------------
 
VII. PATCHING THE DIALUP NETWORK

I did this a few months ago just for myself... No other persons have
access to my PC so I don't care whether the program shows the password
or not.
All you need to know is that the dialog box that appears when using
the DialUp Network (you know it...) - I located it after a few minutes in
RASAPI32.DLL .

Erhm, another thing. The dialog box in my version of RASAPI32.DLL
(4.00.1150 German) is DIALOG 1000 ... but if you just want to edit
out the ES_PASSWORD attribute, BRW does not want to recompile the DLL
(Error Message: "Expecting control window style"). So what to do?
I just tried to remove the other unidentified style identifier (in other
words "attribute"): SS_ETCHEDHORZ (appearing in 3 lines).
I did not expect it to work, but it did...

 -------------------------------------------------------------------------

VIII. LAST WORDS

After reading all this you may want to know: Why did I need to know all
this?
The answer is: You don't need to know it. But I'm using the way described
above to remove all lines using asterisks so I do not need to remember
all my passwords - eg. I just can check my CuteFTP settings to find out
the passwords I'm using on my accounts.

I don't know why you need this, but perhaps it's interesting to know
what you can do with BRW... already tried to remove/add a few other
attributes? :-)

 ------------------------------------------------------------------------


(c) by lord caligo - [caligo(at)lords(point)com]</prE><center>

<hr width=33%>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="howtouse.htm" tppabs="http://members.xoom.com/tsehp_/howtouse.htm">How to use our tools</A><br><br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0> 
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A><bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </A></CENTER>
<hr size=4></fonT>
</body>
</HTML><html>                                                                                                        
<head>                                                                                                        

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><META Name="Voluntary Content Rating" content="great!">                                                       
                                                                                                              
                                                                                                              
<title>danadd1.htm: Dangerous food additives (reversing labels)</title>                                       
</head>                                                                                                       
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>                                                             
<center><a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" ALT="realicra" ALIGN=BOTTOM WIDTH=114                  
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>Reality cracking</fonT>                          
                                                                                                              
<hR>courtesy of reverser's page of reverse engineering<br>15 June 1998<font size=+4>                            
<hr>Dangerous food additives (reversing labels)<br>by Maxine+<br></font><br>(version 0.1 ~ <i>in fieri</i>)<hr>                    
</center>  
<bR><bR>                                         
                                                                                                            
Well well well... what d'you eat actually?                                                                                                                                                                 
I'll tell you. In this society, whose only aim is profit, you are probably eating                                                                                                                                      
foods that may kill you. No, I'm not speaking of the 
most evident problems, like the 'mad cow' disease (more profit for the nice master 
if he does not 
kill or denounce his ill animals)<bR>And, no, I'm not speaking of the hormones 
either, commonly used both 
in the States (legally) and in the European Union (illegally) to mast cows, pigs, 
whatever can be thus made to grow (and produce profits) more quickly.<br>
And, er no, I'm not speaking of the pesticides residuates in many food products either (since 
the nice peasants want to make a little profit too, don't they... and, man, there are 
so many cheap pesticides on the markt!).<br>And -see- I'm not 
sepaking about the dangerous lurking future either, with nice big  
pigs with more ribs and legs than nature cared and six legged genetic engineered 
chickens that eat cloned fat blue worms before being roasted for your kids (I'm afraid that 
we'll have to genetically reverse engineer our food :-)... (btw... allergenicity of foods produced by genetic modification 
has been already scientifically proved, see  Critical reviews in food science and nutriton
Vol. 36, Supplement, 1996)<br>No, gentle readers, I'm speaking today 
of LEGALLY AUTHORIZED killer agents. I'm speaking of dangers that you can SEE and AVOID, if you 
just reverse (and study) a little the world around you.  
</P><p>
Food labelling has always been object of fierce struggles between regulators (that at times wish 
to limit, at least 
a little, the 'licence to kill' of the big food processing corporations) and 
the food producers and resellers, that want -obviously- just to make profit, if necessary 
over the dead bodies of their own customers.</p><p>
Reading the European Union's directives on food labelling, it is pretty easy to 
see how much any proposed increase in 'transparence' on food labels annoys 
the 'market forces' and the 'experts 
of the concerned sectors': these pigs don't WANT you to know what's inside their products... 
since -to make just an example- if you really knew what's inside -say- the 
'Jucca' cheese (produced by Kraft) you wouldn't dream to touch such a garbage with a 
badger pole, 'geschweige denn' to buy it.</p><p>
In fact the 'market forces' are annoyed by the food labels themselves: I remember that when 
the 'end date' on food products became compulsory in Europe they tried to 
avoid this and had success in delaying the introduction of the compulsory 'end date' 
labelling for years.<br>Nota bene that this same compulsory labelled "End date" 
which is calculated BY THE PRODUCERS for obvious commercial reasons at the very limit of deperibility 
is 
eufemistically called 'best before' in many (stupid) States... as if the producers had 
any interest in leaving you graciously some more days 'allowance' 
instead of putting as 'end date' the (already 
thin stretched) maximal time duration before their product begins to make worms or worse.                                                                                                                                                
</p><p>                                                                                                                                                                                                    
Here a list of food additives allowed by the European Union (which has                                                                                                                                     
      among the BEST standards on the planet, you can imagine what for additives                                                                                                                           
     you'll find in -say- Kuala Lumpur or Ulan Bator :-(                                                                                                                                                   
 </p><p>                                                                                                                                                                                                   
Some of these additivies are QUITE DANGEROUS for ANYBODY.                                                                                                                                                  
                                Others are QUITE dangerous for kids. (In which case I would say you better                                                                                                 
stop eating them as well)                                                                                                                                                                                  
Others are QUITE dangerous for anaphylactic (allergic) people.                                                                                                                                             
Others are moderately dangerous, once more, for everybody, for kids and for                                                                                                                                
allergic people.                                                                                                                                                                                           
Others cause adverse reactions: urticaria, angioedema, asthma.                                                                                                                                             
</p><p>                                                                                                                                                                                                    
Well, here's the list... next time pay a little more attention at those little                                                                                                                             
"E 114" warnings on the labels...                                                                                                                                                                          
</p><p>                                                                                                                                                                                                    
                                                                                                                                                                                                           
The laws in the European Union:                                                                                                                                                                            
<ul>                                                                                                                                                                                                       
<li>Colours:   European Parliament and Council Directive of 30 June 1994 on colours for use in foodstuffs (94/36/EC)                                                                                       
<li>Sweeteners: European Parliament and Council Directive of 30 June 1994 on sweeteners for use in foodstuffs (94/35/EC)                                                                                   
<li>Food additives other than colours and sweeteners:  European Parliament and Council Directive of 20 February 1995 on food additives other than colours and sweeteners (95/2/EC)                         
</ul>                                                                                                                                                                                                      
</p><p>  
<h3>Dangerous Additives</h3></a>    
<br>
<i><p>There have not been many  studies in the area of 
additives and allergy (and it is easy to guess why, in our awful 
society where only the interests and whims of the big corporations 
are supinely and routinely served and the interests of consumers
are almost NEVER defended, since consumer should -as their name implies- 
"consume" and else shut up :-(<br>Therefore
 much of the evidence for specific links between substance and reaction is anecdotal. Those
additives that have most often attracted the attention of the few investigators in this field 
can be grouped into about
seven substances or families of substances: dyes, parabens and benzoates, BHA and BHT,
nitrates, aspartame, MSG (monosodium glutamate) and finally, sulfites. This DOES NOT mean, of 
course, that the remaining additives are safe. I repeat: There have been only few 
 studies in the area of 
additives and allergy
</i>                                                                                                                                                                                                                                                                 
<ul>                                                                                     
                                                                                         
<li>- <b>Sunset Yellow (E110)</b> - a synthetic colourant, which can                     
provoke allergic reactions and hyperactivity; and increased incidence of                 
tumours in animals; banned in Norway.                                                    
                                                                                         
<li>- <b>Amaranth (E123)</b> - a synthetic colourant, which can provoke                   
asthma, eczema and hyperactivity; it caused birth defects and foetal                     
deaths in some animal tests, possibly also cancer; banned in the USA,                    
Russia and at least 5 other countries.                                                   
                                                                                         
<li>- <b>Sodium Nitrite (E250)</b> and Potassium Nitrate (E252) -                        
preservatives and colour fixatives, which may provoke hyperactivity and                  
other adverse reactions; potentially carcinogenic; their use is severely                 
restricted in many countries. Nitrates and nitrites
are preservatives that also add colour and flavour, and are common 
in preserved meats such as salami.                                                        
                                                                                         
<li>- <b>Butylated hydroxanisole BHA (E320) & Butylated hydroxytoluene 
BHT (E321)</b> - synthetic antioxidants, which may                 
trigger hyperactivity and other intolerances; serious concerns over                      
carcinogenicity; BHA is banned in Japan; in 1958 & 1963 official                         
committees of experts recommended that BHT be ban ned in the UK, however                 
due to industry pressure it was not banned; McDonald's eliminated BHT from               
their US products by 1986.  Butylated hydroxanisole (BHA) and butylated hydroxytoluene 
(BHT) are antioxidants that
appear in many grain and cereal products.<br>BHA and BHT are known culprits in 
cases of urticaria.                                                        
                                                                                         
<li>- <b>Carrageenan (E407)</b> - stabiliser and thickening agent; linked                
to toxic hazards, including ulcers and cancer; the most serious concerns                 
relate to degraded carrageenan, which is not a permitted additive.                       
However, native carrageenan, which is us ed, may become degraded in the                  
gut.                                                                                     
                                                                                         
<li>- <b>Monosodium Glutamate (E621)</b> - "flavour enhancer" - Is an aminoacid 
commonly used as a flavouring. While it appears naturally in some foods like 
Camembert cheese, it's used mainly as an additive, particularly in Chinese 
and Japanese food. A single bowl of Wonton soup can contain 2.5 grams of MSG. 
It's also one of the "secret herbs and spices" in Kentucky Fried Chicken.
<br>Can                    
cause intolerant reactions and effect chemistry of the brain. <br>
MSG is responsible for an allergic reaction known as Chinese restaurant syndrome
(CRS), characterized by headache, nausea, chest tightness, sweating and a burning sensation
along the back of the neck. Some researchers writes that these 
symptoms affect "only" "MSG-sensitive" individuals who eat free
MSG (usually added in the restaurant as a condiment) on an empty stomach. you may want to 
apply some easy reversing to such assertions :-)<br>MSG has also been
blamed in a case of angioedema.                           
                                                                                         
<li>- <b>Potassium Bromate (E924)</b> - used as flour improver, banned in                 
1989 as a dangerous carcinogen; previously widely used in bread products,                
including McDonald's buns.<p>                                                            
    
<li> -<b>Aspartame (E951)</b> - (NutraSweet) is another additive that enhances flavour. 
Temporarily banned in the
mid-1970s because of fears that it caused mental retardation and endocrine dysfunction,
aspartame is now back as a common additive in foods and carbonated drinks. <bR>
Aspartame is a known culprit in cases of urticaria.

                                                                                     
</ul>                                                                                    
                                                                                         
                                                                                         
<hr>  
<center>    (...to be continued)                                                                                                                                                                                                                                   
<hr>                                                                                                                                                               
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" ALT="realicra" ALIGN=BOTTOM WIDTH=114                                                                                     
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>Reality Cracking</fonT>                                                                                    
                                                                                                                                                                   
                                                                                                                                                                   
<hr size=5>                                                                                                                                                        
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"                                                                                                                                             
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                                            
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"                                                                                                              
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>                                                                                              
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A>                                                                                                                                     
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>                                                                       
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A>                                                                                                                                
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM                                                                                                                      
WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>                                                                                          
                                                                                                                                                                   
<IMG                                                                                                                                                               
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                          
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>                                                                                                                           
                                                                                                                                                                   
<IMG                                                                                                                                                               
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                          
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A><bR>                                                                                                                       
<IMG                                                                                                                                                               
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                          
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>                                                                                                                                    
                                                                                                                                                                   
<IMG                                                                                                                                                               
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0                                                                                               
VSPACE=0 HSPACE=0><A                                                                                                                                               
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>                                                                                                                                        
                                                                                                                                                                   
<IMG                                                                                                                                                               
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0                                                                                               
VSPACE=0 HSPACE=0><A                                                                                                                                               
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots & agents reversing </A>                                                                                                                   
                                                                                                                                                                   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13                                                                                                   
BORDER=0 VSPACE=0 HSPACE=0><A                                                                                                                                      
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>                                                                                                                                 
                                                                                                                                                                   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13                                                                                                   
BORDER=0 VSPACE=0 HSPACE=0><A                                                                                                                                      
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>                                                                                                                           
                                                                                                                                                                   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"                                                                                                                                             
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                                            
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>                                                                                                                              
                                                                                                                                                                   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"                                                                                                                                             
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                                            
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>                                                                                                                               
                                                                                                                                                                   
                                                                                                                                                                   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"                                                                                                                                             
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A                                                                                            
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </A></CENTER>                                                                                                     
<hr size=4></fonT></center></center>                                                                                                                               
                                                                                                                                                                   
</body>                                                                                                                                                            
</HTML>                                                                                                                                                            <!-- saved from url=(0022)http://internet.e-mail -->
<HTML>
<HEAD>
<!--  formamus.htm version 09 January 1999 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->
<TITLE>ugmaci.htm: 
UGFLEX
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
UGFLEX
</fonT><br><FONT SIZE="+1">
modified flexlm by UNIGRAPHICS
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="student.htm#student_loo_na" tppabs="http://members.xoom.com/tsehp_/student.htm#student_loo_na"><IMG SRC="images/notassi3.gif" tppabs="http://members.xoom.com/tsehp_/images/notassi3.gif" 
ALT="student" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Not Assigned</FonT>
</center></td></tr><tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
15.11.1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
macilaci
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 
reverse engineering</center> 
</center></TD><td BGCOLOR="898030"><center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited
<br>
by tsehp</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><font color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(X)<B>Beginner</B> (X)<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
YES. Flexlm for newbies. Presented by UNIGRAPHICS.
<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
UGFLEX
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
modified flexlm by UNIGRAPHICS
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
macilaci
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table><pre>
When you are interested in CAD software you may noticed, that UNIGRAPHICS company released 
a free software named SolidEdgeOrigin. This well programmed software uses the latest parasolid engine. 
However the UGs added some nonfunctionality to this program. You will create a model - all ok.
You can save  it to disk /yeah..you think../, but when you create a drawing from the model.... 
You will be unable to save the drawing- UG starts asking for money. And this makes the soft unusable. 
Why create the model when you are unable to make drawings from that? The answer is the marketing strategy. 
AutoCad users should learn a new approach... Do you guess it now? 
Anyway, you will come to a point when you decide whether to buy the license for SolidedgeOrigin3D or not.  
<!-- PASTE HERE YOUR INTRODUCTION -->
</prE><br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
Softice or any other win32 debugger, 
Wdasm or IDA 3.75 

brain and essays on flexlm /*S+H,pillgrim,etc.*/ 
<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><fonsize=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
http://www.ugsolutions.com, 
http://www.solid-edge.com /*ask for your free CD*/ 
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
flexlm.../*globetrotter*/
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<pre>
Part One 

Our target uses the Globetrotter's flexlm protection. When you have the 
license key for SolidEdgeOrigin create 
a license file using SolidEdge registration wizard. The license file looks 
like this: 


FEATURE solidedgeorigin uglmd 7.0 permanent uncounted XXXXXXXXXXXX \ 
HOSTID=ANY 

The XXXXXXXXXXX is your CD key /*hexadecimal numbers*/. 

Let's load the ugflex.dll to Wdasm and look at the exports: FLEX__enter is 
the most near to the lc_init in noticed essays. Put a breakpoint on the entry 
to this fuction. /* Tip for newbies - use the addr command after application start*/ 
Get your feature names. On the FLEX__enter dd eax and voila... 
Create a fake license file: /* Selicense.dat*/ 

FEATURE solidedgeorigin uglmd 7.0 permanent uncounted 123456789123 \ 
HOSTID=ANY 

FEATURE solidedgeorigin3d uglmd 7.0 permanent uncounted 123456789123 \ 
HOSTID=ANY 

FEATURE solidedgeboxset uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 

FEATURE solidedgeclassic uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 

FEATURE solidedgeassembly uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 

FEATURE solidedgesheetmetal uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 

FEATURE solidedgexpresroute uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 

FEATURE solidedgefeaturereco uglmd 7.0 permanent uncounted 123456789123 \ 
       HOSTID=ANY 


Part Two 

After this run again the target. I used the part.exe file. You will get a 
message -8,130 - error. And another one that you don't have any valid license. 
Run it again this time with bpx on FLEX__enter. 
Press F12 until you get to part.exe module. 

10001568                 mov     edx, [esp+24h+var_20] 
1000156C                 push    edx 
1000156D                 call    j_JUTIL_1101 
10001572                 test    eax, eax ; our landing point 
10001574                 jl      short loc_100015BE ;jump 
. 
. 
. 
100015BE                 lea     ecx, [esp+28h+var_24] 
100015C2                 push    ecx 
100015C3                 call    j_JUTIL_700 
100015C8                 add     esp, 4 
100015CB                 test    eax, eax 
100015CD                 jnz     short loc_100015DD ;jump 
100015CF                 test    esi, esi 
100015D1                 jz      short loc_100015DD ;jump 
100015D3                 mov     eax, 1 ;load dll's and run it 
100015D8                 pop     esi 
100015D9                 add     esp, 20h 
100015DC                 retn 
100015DD                 xor     eax, eax ;bad user - no license 
100015DF                 pop     esi 


Run it with your valid license number obtained from UGs. You will see the difference... 
Run the Part.exe with your fake license number. But what, when you bpx on the 100015CB in the part.exe 
some strange thing happen. Yes I speak about this page fault. Let's clear the bpx and run it. 
All is OK. You will get the -8,130 message. Do you feel the CRC check? Yes I guessed it too. Do the bpx 100015CB 
again but this time with bpm 100015CB. 

10001501                 mov     edx, eax 
10001503                 xor     ebx, ebx 
10001505                 mov     bl, [ecx]                  ; you land here before the page fault 
10001507                 and     edx, 0FFh 
1000150D                 xor     edx, ebx 
1000150F                 shr     eax, 8 
10001512                 mov     edx, dword_10006054[edx*4] 
10001519                 xor     eax, edx 
1000151B                 inc     ecx 
1000151C                 dec     esi 
1000151D                 jnz     short loc_10001501 
1000151F                 pop     ebx 
10001520                 not     eax 
10001522                 pop     esi 
10001523                 retn 

Get one level up with F12. You see: 

10001715                 mov     edx, dword_10006C78 
1000171B                 mov     eax, dword_10006C74 
10001720                 push    edx 
10001721                 push    eax 
10001722                 call    sub_100014F0 ;our call 
10001727                 mov     ecx, dword_10006C7C         ;load the correct CRC 
1000172D                 add     esp, 8 
10001730                 cmp     eax, ecx ;compare 
10001732                 jz      loc_10001819 ;jump if OK 
. 
. 
1000174E                 push    offset aCrcBuffer_8xCo       ;bad boy 
10001753                 push    eax 
10001754                 call    ds:sprintf 
1000175A                 add     esp, 14h 
1000175D                 lea     ecx, [esp+540h+var_20C] 
10001764                 push    ecx 
10001765                 call    ds:OutputDebugStringA 

Another exples:  Bpx in Jutil.dll module. The CRC check is done right 
before the our part.exe CRC check: 

100016C6                 push    3BF0h 
100016CB                 push    eax 
100016CC                 call    sub_100014F0 
100016D1                 add     esp, 8 
100016D4                 cmp     eax, 464E4B2Eh        ;looks like CRC 
100016D9                 jnz     loc_1000176B ;jump if bad 
100016DF                 lea     ecx, [esi+1350h] 
100016E5                 push    130h 
100016EA                 push    ecx 
100016EB                 call    sub_100014F0 
100016F0                 add     esp, 8 
100016F3                 cmp     eax, 1A78AC1Ch         ;this too 
100016F8                 jnz     short loc_1000176B 
100016FA                 add     esi, 3A1F0h 
10001700                 push    0D8h 
10001705                 push    esi 
10001706                 call    sub_100014F0 
1000170B                 add     esp, 8 
1000170E                 cmp     eax, 4D03231Ah         ;oops 
10001713                 jnz     short loc_1000176B 

To keep our debugging session comfortable modify the jumps. 

Let's continue with our BPX 100015CB. 

1000156C                 push    edx 
1000156D                 call    j_JUTIL_1101 
10001572                 test    eax, eax ; our old landing point 
10001574                 jl      short loc_100015BE ;jump if bad 
. 
. 
. 
100015BE                 lea     ecx, [esp+28h+var_24] 
100015C2                 push    ecx 
100015C3                 call    j_JUTIL_700 
100015C8                 add     esp, 4 
100015CB                 test    eax, eax 
100015CD                 jnz     short loc_100015DD ;jump if bad 
100015CF                 test    esi, esi 
100015D1                 jz      short loc_100015DD ;jump if bad 

Examine the JUTIL_700 call - you will see that this is just playing with 
numbers. The real deal is the JUTIL_1101. 
Bpx there and step in... 

5A00F870                 sub     esp, 20h 
5A00F873                 lea     eax, [esp+20h+var_20] 
5A00F877                 mov     [esp+20h+var_1C], offset loc_5A00C690 
;create jump table 
5A00F87F                 push    eax 
5A00F880                 mov     [esp+24h+var_18], offset loc_5A00CDB0 ;create jump table 
5A00F888                 mov     [esp+24h+var_14], offset loc_5A00D4D0 ;create jump table 
5A00F890                 mov     [esp+24h+var_10], offset loc_5A00DBF0 ;create jump table 
5A00F898                 mov     [esp+24h+var_C], offset loc_5A00E310 ;create jump table 
5A00F8A0                 mov     [esp+24h+var_8], offset loc_5A00EA30 ;create jump table 
5A00F8A8                 mov     [esp+24h+var_4], offset loc_5A00F150 ;create jump table 
5A00F8B0                 call    ds:time                              ;get random value 
5A00F8B6                 mov     eax, [esp+24h+var_20] 
5A00F8BA                 mov     ecx, 7 
5A00F8BF                 cdq 
5A00F8C0                 idiv    ecx 
5A00F8C2                 mov     eax, [esp+24h+arg_0]                 ;reduced to 7 cases 
5A00F8C6                 push    eax 
5A00F8C7                 call    [esp+edx*4+28h+var_1C]               ;jump 
5A00F8CB                 add     esp, 28h 
5A00F8CE                 retn    4 

As you see the the code at different locations is the same. What does this 
mean ? Answer: To gather newbies getting informations about this target. 
You can set the edx value to zero. 

Step in the 5A00C690. 
5A00C8FA loc_5A00C8FA:                  ; CODE XREF: .text:5A00CA8B_j 
5A00C8FA               mov     ecx, [esp+3Ch] 
5A00C8FE                add     ecx, edi 
5A00C900                cmp     [ecx+10h], ebx 
5A00C903                 jz      loc_FFFFF000_5A00CA78 ;jump if nofeature 
. 
. 
5A00CA78                 mov     edi, [esp+10h] 
5A00CA7C                 mov     ecx, [esp+40h] 
5A00CA80                 inc     ebp 
5A00CA81                 add     edi, 14h 
5A00CA84                 dec     ecx 
5A00CA85                 mov     [esp+10h], edi 
5A00CA89                 cmp     ebp, ecx ;all licenses checked? 
5A00CA8B                 jle     loc_5A00C8FA ;jump if not 

And inside this cycle  /*if the name of  feature was found*/: 


5A00C987                 push    eax 
5A00C988                 push    ecx 
5A00C989                 call    sub_5A010480 ;check license 
5A00C98E                 add     esp, 2Ch 
5A00C991                 test    eax, eax ;it's OK? 
5A00C993                 jz      short loc_5A00C9DE ;jump if not 
5A00C995                 mov     edx, [esp+40h] 
5A00C999                 lea     esi, [ebp+1] 
5A00C99C                 dec     edx 
5A00C99D                 cmp     esi, edx 
5A00C99F                 jg      loc_5A00CA78 

You can set the jump to nops at 5A00C993 but the license is still not 
available. So step into the 5A010480 call. 


5A010508                 mov     ecx, dword_5A03CBB4 
5A01050E                 push    eax 
5A01050F                 call    sub_5A026660 ; compare license 
5A010514                 mov     ebx, eax 
5A010516                 lea     ecx, [esp+9Ch+var_5C] 
5A01051A                mov     byte ptr [esp+9Ch+var_4], 4 
5A010522                 call    ??1GUserText@@QAE@XZ 

Look at the eax poiter - our feature names, step into 5A026660. 

5A026691                 mov     ecx, [esp+2Ch+arg_4] 
5A026695                 push    ecx 
5A026696                 push    edx 
5A026697                 call    j_FLEX__set_product_version 
5A02669C                 lea     eax, [esp+34h+var_20] 
5A0266A0                 push    1 
5A0266A2                 push    eax 
5A0266A3                 call    j_FLEX__enter ;we started here 
5A0266A8                 add     esp, 10h 
5A0266AB                 mov     ecx, ebx 
5A0266AD                 mov     esi, eax 
5A0266AF                 call    sub_5A026D50 
5A0266B4                 mov     ecx, [esp+2Ch+arg_8] 
5A0266B8                 test    esi, esi 
5A0266BA                 mov     [ecx], eax 
5A0266BC                 jnz     short loc_5A0266DA 
5A0266BE                 lea     edx, [esp+2Ch+var_20]                ; license ok, continue 

Don't modify the jump - it doesn't make any sense, just step into a 
FLEX_enter. 

04E514EE                 push    esi 
04E514EF                 mov     esi, [esp+4+arg_0] 
04E514F3                 push    esi 
04E514F4                 push    offset aEnteringModule ; entering module 
04E514F9                 call    FLEX__note 
04E514FE                 mov     eax, dword_4E81DA8 
04E51503                 push    4000h 
04E51508                 push    offset unk_4E7C130 
04E5150D                 push    0 
04E5150F                 push    1 
04E51511                 push    offset a15_0 
04E51516                 push    esi 
04E51517                 push    eax 
04E51518                 mov     dword_4E80410, 1 
04E51522                 call    sub_4E53481 ;yep , this call - step in 
04E51527                 mov     esi, eax 
04E51529                 add     esp, 24h 
04E5152C                 test    esi, esi 
04E5152E                 jge     short loc_4E51552 
04E51530                 cmp     [esp+4+arg_4], 1 
04E51535                 jnz     short loc_4E51540 
04E51537                 push    esi 
04E51538                 call    sub_4E519E0 ; ugflexlmerror 

04E53481... 
. 
. 
. 
04E534F5                 mov     dword_4E80948, offset 04E53669 
04E534FF                 or      byte ptr [esi+17Ch], 40h 
04E53506                 push    esi 
04E53507                 call    dword_4E80948 ;step in 

An indirect call - this might be... 

04E53669... 
. 
. 
. 
04E53827                 push    edi 
04E53828                 push    esi 
04E53829                 call    sub_4E53E77 
04E5382E                 add     esp, 0Ch 
04E53831                 test    eax, eax        ; eax should not be 
zero 
04E53833                 jz      loc_4E53726 ; jump if bad boy 
04E53839                 cmp     dword ptr [ebp+18h], 3 
04E5383D                 jz      loc_FFFFF000_4E53924 
04E53843                 push    edi ;license OK -continue 

When you patch the jump at 04e53831 you will get the right license for our 
fake license file. And how to get this? 
I've just compared the jumps with the valid SolidEdgeOrigin key /*remember, it's for free*/. 
Here is the jump at location -compare table: 
SolidEdgeOrigin Our feature with fake key 
     04E536A1       04E536A1 
     04E536D7       04E536D7 
     04E5371E       04E5371E 
     04E53749       04E53749 
     04E5377F       04E5377F 
     04E537A2       04E537A2 
     04E537F3       04E537F3 
                    04E53833 
     etc.                       etc. 

You see - nothing special. 


Part three - let's patch it 


Patch the location in ugflex at 04E53833 to some nops. And of course keep 
the fake license file in the directory. The part.exe you can overwrite with original version. 
To prevent lamers from detecting which file was changed /*the about box - 
setup info- */ change some bytes in partDcx.dll at 075B77FA to nops. 
You will get the complete copy of  SolidEdge 7.0 -YES all modules!!! 
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
<pre>
This is a nice example to show the commercial stupidity  - how to license a feature or how to make more money with less effort. 
Poor programmers...  Dear programmers if you are reading this, you should improve your product and sell it at nice price. 
Then more people will buy it  /*The effect of scale- ask marketers - they should know it and if not, there's a problem*/.   
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</pre>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside fravia's page of reverse engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia+</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML><HTML>
 <HEAD>
  
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>ind_tra1.htm: Pluckit 3.0 ~ Hip Hip Hurray for Smartcheck </TITLE>
 </HEAD>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="5" BORDER="0">
<TR>
  <TD VALIGN="MIDDLE" BGCOLOR="898030">
   <FONT SIZE="2" COLOR="FFFFFF">
    <CENTER><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"></a></center>
   </FONT>
  </TD>
  <TD BGCOLOR="C0C0C0">
<!-- CHOOSE A PROJECT GIF (may be changed) -->

<a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm"><IMG
SRC="images/visualba.gif" tppabs="http://members.xoom.com/tsehp_/images/visualba.gif" 
ALT="Visual Basic" ALIGN=RIGHT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
   <FONT SIZE="+2">
<center>
<!-- CHOOSE A TITLE (may be changed) -->
Pluckit 3.0 ~ Hip Hip Hurray for Smartcheck
   </FONT><br>by 

<font size=+3>

<!-- CHOOSE A HANDLE (wont be changed) -->



+Indian_Trail



    </fonT>, 

 <FONT COLOR="890000">

<!-- CHOOSE A DATE (wont be changed, unless necessary) -->

04 May 1998


</FONT><br>

  </center>

  </TD>

 </TR>

<TR>

  <TD BGCOLOR="898030">   <FONT SIZE="2" COLOR="898030">f</TD>

  <TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 

reverse engineering</center> 

  </center>

  </TD>

 </TR>

<TR>

  <TD VALIGN="MIDDLE" BGCOLOR="898030">

   <FONT SIZE="2" COLOR="FFFFFF">

    <CENTER>reverser's comments</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0"><i><center>
An interesting essay for beginners, which underlines an old truth:<bR> 
<font color=green>IF</fonT> visual basic <font color=green>THEN</fonT> cracked at once<bR>
Protectors working in visual basic should be aware of the existence of Smartcheck (I can't 
imagine anyone working vith ANY programming language that doesn't know of this GREAT 
incredible reversing tool..., as I have written myself repeatedly :-)
<TR>

  <TD BGCOLOR="898030">   <FONT SIZE="2" COLOR="898030">f</TD>

  <TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in
everything<br>

That's how the light gets in</b></center>

  </center>

  </TD>

 </TR>



<TR>

  <TD VALIGN="MIDDLE" BGCOLOR="2C142B">

   <FONT SIZE="2">

    <CENTER><FONT COLOR="FFFFFF">Rating</FONT></CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

   <FONT FACE="Courier New">

<!-- CHOOSE A RATING (may be changed) -->

    (x)<B>Beginner</B> ( )<B>Intermediate</B> ( )<B>Advanced</B> (
)<B>Expert</B>

   </FONT><BR><I>

<!-- CHOOSE A COMMENT (may be changed)  -->



We have all seen fine examples on how to use smartcheck. This essay will
be about how to get a valid serial number from smartcheck rather than
finding a byte to patch. I don't think it's possible to write a clever
protection in visual basic so thereof this protection is not interesting
at all...



</I>

  </TD>

 </TR>





   </FONT>

  </TD>

 </TR>

 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="890000">

   <FONT SIZE="2" COLOR="FFFFFF">

    <CENTER>Title</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">

   <FONT SIZE="+2">

<!-- CHOOSE A TITLE (may be changed) -->



Pluckit 3.0 Hip Hip Hurray for Smartcheck



   </FONT><BR>

   <FONT COLOR="0B7FC1">

    Written by +Indian_Trail

<!-- REPEAT YOUR CHOSEN HANDLE HERE -->



   </FONT>

  </TD>

 </TR>



 

 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="FF7F21">

   <FONT SIZE="2">

    <CENTER>Introduction</CENTER>

   </FONT>

  </TD>

  <TD BGCOLOR="C0C0C0">



<!-- PASTE HERE YOUR INTRODUCTION -->

<p>A friend of mine asked me to crack this program. It a newsscanner
that downloads pictures from newsgroups, probably written for porno
lusers. Anyway I didn't know that Pluckit was written with Visual Basic. 
So this was my first attempt at a visual basic program.</p> 
<p>
I never liked Visual Basic or delphy, I don't see the point in using a
language that produce bad code. The obvious way shuld be to try to write as
small and efficent programs as possible and to do that -as you all know-
you have to write tha meain routines in pure assembler. Anyway I don't
mind people using Visual Basic as an introduction language to
computer programming. Most of us learned basic as a start on the first
home computers like Zx80 or Sinclair Spectrum and C64. But, programs
that are written in toy languages like this should be free for all people.</p>
<p>
Applications that are slow and filled with bugs should not be
commercial, they should be freeware (this is valid for word an Excel as well, btw). 
Unfortunatley the author of this lame
crap has another idea about this. On startup there is an ugly nagscreen
with some text inside it and an "ok_ button" and a "cancel_button".
After the nagscreen is a register screen where you can input a
serialnumber, if you don't have a serial# you'll only be able to
download 15 files. We will focus on the serial#.</p>
</TD>
 </TR>

 <TR>
  <TD VALIGN="MIDDLE" BGCOLOR="B04A53">
   <FONT SIZE="2">
    <CENTER>Tools Required</CENTER>
   </FONT>
  </TD>
  <TD BGCOLOR="C0C0C0">

   <B>

<!-- PASTE HERE YOUR REQUIRED TOOLS -->

Smartchecker 5.0 <br>Win32Dasm

<br>~<br>

<!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET -->

<A href="http://www.pluckit.com/" >www.pluckit.com</a>

</B></TD>

 </TR>

 <TR>

  <TD VALIGN="MIDDLE" BGCOLOR="FFFFEA">

   <FONT SIZE="+3" COLOR="C0C0C0">

    <CENTER>T<BR>H<BR>E<BR> <BR>E<BR>S<BR>S<BR>A<BR>Y</CENTER>

   </FONT>

  </TD>

  <TD VALIGN="TOP" BGCOLOR="C0C0C0">

    <h3>Step I: loading the target through smartcheck.</h3>
<hr>
<p>
As I mentioned this is my first attempt to crack a VB program. In my
first approach I changed some jumps in memory, but there were too many
jumps to change so I decided to go for the serialnumber. I'm not gonna
cover how to set up smartcheck cause Reverser+ has already done that. Well
lets fire smartcheck...<br><br>

On startup you'll get two 'invalid arguments' errors, like I said, this crap 
is filled with bugs. Proceed to the registration screen and type in any#.
In smartcheck choose view "specific events.. " so you can easily
navigate and find what we are looking for.</p>
<p>
After the "invalid..." dialogbox appears, terminate Pluckit3 and go to
smartcheck and look around. At sequence# 16745 you'll see your false
serial number. Now what follows is:</p>
<pre>
16752	Trim (variant: string"false#")	4d4260
16763	Val (string"false": 	
	| 
	|
16931	msgbox
-----
</pre><p>
Now it's time to choose view "All events".  I reached this point after 3
seconds, and What you'll see now is the first barricade of the
protection scheme. The last things that are done before the messagebox
as you'll see (if you chosen view all events) is :
<pre>
16926	__VbaVarOr()		
16927	__VbaBoolVarNull()	Return dword FFFFF
16928	_vbaVarDup(VARIANT: string "invalid", Variant boolean false)
----
</pre>
This looks very strange, no manipulations at all so far execpt from the
basic ones ie calculate length of string and so on. I don't know what
__vbaVarOr or __vbaBoolVarNull does exactly but judging from their names
they must check something from beeing either true or false. That was
what I thought when I first glanced at it. But what could it be?
It could be three things:
<pre>
1 A letter 
2 A char ie "%" or whatever
3 both of them
</pre></p><p>
So start all over again and this time enter your name as registration#.
Remeber to choose view "specific events and errors" if you want to skip
alot of unimportant "code".
<br><br>
There are some significant changes, first obvious one is we passed the
__vbaBoolVarNull and second the sequence numbers has shrinked !!?  The
messagebox is now at sequence# 14764. But what's more interesting is the
lines above 14764. From 14731 ---> 14758 are a bunch of
Integer(#)-->Long(#) where # is starting from 0 and ending at 9. View
all events and you'll see that under each Integer(#) there is a a
different number that is tested against a variable called double:0. The
values that are tested against double:0 are:
<br><br>
55276<br>
39824<br>
68684<br>
75268<br>
12367<br>
59826<br>
48927<br>
65826<br>
34096<br>
15824<br>
<br></p><p>
This means that double:0 should have a value equal to one of these
numbers and the registration code must contain a letter(s) for us to
pass __vbaBoolVarNull(). We also know that double:0 is zero when we only
entered letters. So the registration code must have some numbers and one
or more letters
</p>
<h3>step II </h3>
<p>
Start again (I know this begins to be boring but we are almost
finished). This time we must use systematical inputs. Lets begin with
123A and see what happens what value is given to double:0. Hmmn we
didn't pass the __vbaBoolVarNull() function with 123A. Well my
experience in registration codes tells me that the letter may be a
separator of two numbers. Lets try 123A123.</p>
<p>
Great (balls of fire) we passed the evil __vbaBoolVarNull(), lets find
out if double:0 has a value. Just click on one of the __vbaVarTestEq at
sequence# 14909 for example wich is the first one. As you'll see
double:0 has the value of 15129 and is therefore called double:15129
instead of double:0. How did it get that value?
<br><br>
14347	__vbaVarMull(variant:double:123, variant:double:123) returns dword
6FF714
<br><br>
Well 123*123=15129 and thats where double:15129 got it's value from. So
the form of the regisration code is #####X#####=Y where # is a number
and X is a letter and Y any of the valid numbers that our double:15129
is tested against. Lets pic one of the valid numbers and use them in our
code like this:
<br><br>
55276A1000 = 55276*1000 = 55276000
<br><br>
Since such a visual programmer is assumed to be a moron, he will 
probably only check
the five first numbers but hey, should he check all numbers we still
have the equation... so it would be really easy to solve it. 
But lets first try the
above to see how dumb such a "programmer" can be... 
Could you believe that? It worked at once! What a moron programmer! 
<br><br>
Numega deserves all credits for its Smartcheck, this is truly an amazing
tool. Thats it for now.
<br><br></p>
<i>Indian_Trail<br><font color="red"> (Saddle all the horses far on the
Indian Trail, 'til it's time to change the key and jump to a different
scale...a boogie woogie on the
run)</i></font>                             
</prE>
  </TD>
 </TR>

 <TR>
  <TD VALIGN="MIDDLE" BGCOLOR="00B645">
   <FONT SIZE="2">
    <CENTER>Ob duh</CENTER>
   </FONT>
  </TD>
  <TD BGCOLOR="C0C0C0">
   <i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a
longer
   period than the allowed one. Should you want 
   to STEAL this software instead, you don't need to crack its
protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged,
farewell.</i>
  </TD>
 </TR>

 <TR>
  <TD VALIGN="MIDDLE" BGCOLOR="2AB6B6">
   <FONT SIZE="2">
    <CENTER>Final Notes</CENTER>
   </FONT>
  </TD>
  <TD BGCOLOR="C0C0C0">
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
I don't know why one should choose visual basic to make an application
like this one. But this Author is probably just a greedy looser, who only want 
to make some fast money instead of taking pride in a good, lean and fast 
program.
</TD>
 </TR>
<TR>
  <TD VALIGN="MIDDLE" BGCOLOR="898030">
   <FONT SIZE="2" COLOR="FFFFFF">
    <CENTER>way out</CENTER>
   </FONT>
  </TD>
  <TD BGCOLOR="C0C0C0">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<a href="project8.htm" tppabs="http://members.xoom.com/tsehp_/project8.htm"><IMG SRC="images/visualba.gif" tppabs="http://members.xoom.com/tsehp_/images/visualba.gif" 
ALT="visual basic" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>

<br>



<font color=gray>Back to Visual Basic</FonT>

-->
<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to
Your_chosen_project</A> 
-->
           <hr width=33%>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM

BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>

<br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
legal?</A>
</CENTER>
  </TD>
 </TR>
</TABLE>
</BODY>
</HTML>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>conself1.htm: Consumer self-defense: an anti-advertisement tutorial -1 (REALITY CRACKING) </title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>

<center>
<font size=+3>Consumer self-defense: an anti-advertisement tutorial</font>
<bR>By +Insiderbetraying
<hr><a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" ALT="reality cracking" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Reality Cracking</font>
<bR>
<br><i>Courtesy of reverser's pages of reverse engineering, 10 July 1998<hr width=33%>
Yes! Jawohl! Right so! ...and I hope to receive MANY MORE essays on these lines. For the first time in 
the history of humanity... well, actually I'm not kidding: have 
a search around and see what else you can find :-) the power and 'cleverness' of the Web offer us CONSUMER, guinea pigs of the marketing mavericks, give us   
stupid pavlovian slaves, whose brains are being relentlessly maimed to 
mud by tons of ads every 
minute of our poor lives, allow us the possibility to understand (first) exchange knowledge (second) 
and retaliate (third). Great! Read and head! And work! Let's go up from consumers to 
human beings, let's learn how to counter all the pavlovian techniques of 
the slave masters!
</i><hR><font size=+4><font color=blue>Consumer self-defense</fonT></fonT>
<br><font size=+2>(an anti-advertisement tutorial)</font>
<bR>Part n.1: Some amoebas slip from under the slide and take a 
quick look at the lab<bR>by +Insiderbetraying ~ July 1998
<hR width=66%><b>Nota Bene: there are in 
<font color=olive>olive</font> some more 'technical' parts 
that you may 'safely' jump over. This <i>in fieri</i> document is 
the first part of a series that I'll publish ONLY on the web (in fact at reverser's) since IMO
"paper"  
publishing doesn't make today (July 1998) any more sense (I mean, if you'r seeking synergy, not 
money :o)</b>
<hR width=44%></center>
<b>Introduction</b><bR>
As you probably know, there is a whole scientific branch called 'consumer behavior'. What 
you might not know, unless you are on the take, is that there are MANY other less known disciplines aimed 
at allowing a better (in fact an absolute) control of the consumer (i.e. you).<bR>
The declared purpose of these studies is to fool you into buying gadgets and products 
you don't need (or are downright harmful to you) playing on your most elementary 
feelings. Pavlov and Goebbels would never have dreamed a so scary (and almost perfect) 
world of hidden and concealed compulsions. In order to defend yourself you must first 
of all understand the techniques used by your enemy. I'll here just <u>list</u> some of them, as 
you will see, this is scary enough per se.
<p>
A word of warning: once you will have understood the basic aims of some of the techniques used 
in order to tame consumers, 
you'll see your own life from a completely different point of 
view. While you may already have experienced something similar reading master +ORC's 
famous '<a href="slaves.htm" tppabs="http://members.xoom.com/tsehp_/slaves.htm">supermarket enslavement</a>' essay (the masterpiece that started all sort of 
"reality reversing" studies), I know how upsetting this can be, especially once you'll 
have found yourself in a very peculiar position vis-à-vis almost all your friends and 
social relations: in fact they will mostly NOT understand the problem at all. See: some 
of them will have bought and wear colored nice T-shirts carrying advertisements or huge 
industrial logos on them; some other will have just returned from the mall with a lot of 
nice colored bags filled with "offers" they just couldn't resist buying; 
others, while apparently "listening" to you, will have 
turned the TV set on and happily munch 
some "crusty choco-bars" or some "chips" (or whatever they <u>had 
to</u> buy) under its continuous ads' bombarding... in fact the situation 
may dangerously recall you 
those science-fiction 
films of the fifties where everybody but the hero is completely controlled by some little 
green aliens... no, actually you'll feel even worse: you'r not an hero, you'r just sorta like an 
ameba that has escaped from underneath the microscope's slide and took a look at the 
scientific lab. It is NOT always a very nice feeling :-(
<p>
So I'll here -as introduction- just list some techniques, and show some examples... you'll 
be able to check how terribly true they are all by yourself, as you'll see, 
it's pretty easy to individuate them... once you know where to look.
<p>
<b>Consumer Behavior</b><bR>
The purpose of  "Consumer Behavior", as a discipline (which is a fairly young branch, 
with textbooks beginning to show up in the '60s), is to provide "a foundation for marketing 
management" through the advanced use of psychological, medical, ethical, cultural and 
historical knowledge on human behavior. In fact in order to allow what they also 
hypocritically call 'the development of a managerial strategy', these disciplines use 
(and  misuse) theories and concepts from all the behavioral sciences - psychology, 
social psychology, sociology, anthropology, demography, and economics. In fact the 
marketing and advertisement 'scientists' -as you will see- act just like those nazi and 
Japanese doctors of the '40s, that conducted criminal experiments on human prisoners.
<p>
The direct result of all these efforts is an almost pavlovian 'branding' of illiterate 
consumer minds, just to cite a typical, investigated example, when shown logos of 
children's brands, adult's brands and consumer products, over 51% of children aged 
3 to 6 recognized the "Old Joe" camel cigarette logo. I repeat: children between 3 
and 6 (!) and  a CIGARETTES image! Second came Nike's logo. (source: Fischer  "Brand 
logo recognition by children aged 3 to 5 years," JAMA, December 11, 1991, 3145-3148).
<p>
In the following text I'll use my own terminology: the term 'slave masters' is used 
to denote the unhealthy alliance between 'consumer behaviorists',  'marketing buffs', 
'commercial sellers/producers' and politician and media anchormen that defend such 
a society and profit from it (let's not forget just to make an example, that the Reagan 
administration purposely reduced funding to many of the agencies responsible for enacting 
the consumer laws). Clearly the term is vague and imprecise, yet it does the job. The term 
'puppets' or 'puppet-models' is used to denote the use of 'celebrities' in advertising 
and media for mass-control and mass-influencing purposes.
<p>
<b>Memory patterns</b><br>
One of the main problems for the slave masters is that consumers have a limited 
capacity to process information - information overload can impede consumer 'learning' 
(from their point of view, learning means here being conditioned with the need to 
buy a determinate product). Since emotions strongly influence how information is 
processed they are widely used in advertising. In fact Memory processes are 
influenced by affect and arousal.<br>
A simplified memory model has three components: sensory memory, short-term memory, 
and long-term memory.<br>
'Sensory memory' is a pre-attention stage where a stimulus is briefly 
analyzed to determine if it will receive additional processing (short-term 
in duration, usually less than a second), then follows the 'Short-term memory' 
stage - where information is temporarily stored while processing. If this information 
is not rehearsed (silently repeated to encode into long term memory) it is lost 
within 30 seconds. Short-term memory is characterized by limited capacity - 
Miller's law states people can handle 7 (+ or - 2) bits of information at a time. 
Information is transferred from short-term to long-term memory when it has been 
rehearsed with a transfer process known as encoding. Recall will be more difficult 
if there is clutter or too many stimuli. Example: the plethora of commercials on a 
Superbowl program make it difficult for the viewer to recall any one specific 
commercial. Long-term memory stores the meanings of words, symbols along with the 
associations among various semantic concepts. Here it is important to notice 
that 1) visual images or pictures tend to be more memorable than their verbal 
counterparts, especially when there is low-involvement on the part of the 
consumer; and 2) words that have high-imagery content are superior to words 
that do not. Example: high imagery words: table or car, low imagery words- 
future or peace. The slave masters of course concentrate on the storage process 
into and on the retrieval process from Long-term memory, so consumers will 
retrieve the conditioning presented with the advertisements when faced with 
a choice. Retrieval can be enhanced by repetition of a symbol from the 
advertisement to the package and by attaching a memorable jingle or 
music to the advertisement. This is 'brand imprinting'.
<p>
<b>Brand imprinting</b><br>
Brand imprinting consists of a brand 'node' implanted in memory which links a 
variety of associations (brand name, brand's characteristics, advertisements 
about the brand, the product category, and emotional reactions to the brand 
and its advertisements).
<p>
Some shrewd techniques are here used to numb the consumer, the most common 
one takes advantage of a psychological characteristic of our specie called 
the <b>Zeigarnik effect</b> (if a task is interrupted, material relevant to the task 
tends to be remembered ).<br>
This is the concept behind all interrupted :15 second commercials. The 
first :15 presents 'information', is interrupted with a :30 that is different, 
and then a :15 returns to complete the presentation of the material begun with 
the first :15. This snaps the Zeigarnik effect: the slave will remember.
<p>
<b>Behavioral learning and conditioning</b><br>
'Behavioral learning' is the nice name that the slave masters have found for 
'consumer conditioning'. It is divided in three main sectors: Classical 
consumer conditioning, Operant consumer conditioning and Vicarious consumer 
conditioning.<br>
Classical conditioning - behavior is influenced by a stimulus that 
occurs prior to the behavior and elicits it in a manner that appears 
to be a reflex. Advertisers try to identify messages, sights or sounds 
that will elicit positive reactions from consumers to associate their 
product with a positive stimuli - thus eliciting a positive reaction 
to the product (half-naked babe on the car roof). The classical conditioning 
framework was discovered by Ivan Pavlov in his work with dogs and those same 
principles are ACTIVELY used by the slave masters. You better understand them, 
at least in their most elementary form.
<hr><font color=olive>In classical conditioning, a previously 
neutral stimulus (the conditioned stimulus or CS) is repeatedly paired with 
the eliciting stimulus (the unconditioned stimulus or UCS). To be effective 
the CS needs to occur prior to the UCS so it predicts the UCS. After a 
number of pairings, the ability to elicit a response is transferred from 
the UCS to the CS. The response is called the conditioned response or CR.
</font><hR>  
A couple of examples: stores and mall all over the world know that the tempo 
of music played in the store resulted in various shopping speeds by consumers. The 
slower (and rithmic) the music, the slower (and almost trance-inducted) the 
shopping speed, the more (up to 40% !!) groceries 
purchased. La va sans dire that the customers would NOT have purchased 
this surplus if they could have maintained self-control. It is also 
obvious that music is only ONE of the 'hypnotizing' factors in play (see 
+ORC's essay). 
Note that customers are <u>completely unaware</u> of any differences in music cadence, 
since the effects of music operate at below consciousness levels. Music is also 
used purposely elsewhere: take restaurants: although customers take more time to complete 
their dinners when slow music is played, liquor sales increase. Every time 
the consumers take longer to eat, the time spent waiting for food increase 
the sales of liquor & aperitifs & second bottles of wine or mineral water made 
while waiting for the food... a trade off between number of times a table can be 
used and higher recipes per consumer... so to say a "slow food benefit" vis-à-vis fast 
food joints.
<p>
Another example, all stimuli associated with spending money (credit card 
insignias) actually elicite a spending response in shoppers. Yet another example: 
Using the symbol of the national flag (a conditioned stimulus) with a product 
or service (a previously neutral stimulus). The product or service gains 
increased status via higher order conditioning. Note that the conditioned 
stimulus should be consistently paired with the unconditioned stimulus. For 
example, if the slave masters use a 'celebrity bait' with a product in an 
advertisement, the celebrity should be shown in point-of-purchase displays as well.<br>
Operant conditioning - behavior is influenced by the consequences of the 
behavior. Sales promotion and 'personal selling' involve providing consumers 
with reinforcers and/or punishments to influence later behavior. Operant 
conditioning is often used inn order to shape consumer responses - like 
training animals. Totally new operant behaviors can be created by selectively 
reinforcing behaviors that successively approximate the desired instrumental 
response. This happens for example giving consumers a free sample of a 
product. The reinforcement is the product's performance. The added reinforcement 
is the enclosed coupon for purchase. In the promotional mix, operant 
conditioning is particularly applied to personal selling and sales 
promotion. Sales people attempt to reinforce desired behaviors of clients by 
reinforcers (compliments, smiles, lunches, Christmas gifts) . Buying 
behaviors are shaped with sales promotions, discounts, coupons, samples, 
and contests.<br>
Vicarious conditioning - behavior is influenced by observing the actions of 
others and by modeling or imitating those actions. Many advertising strategies 
make use of appealing puppet-models (Jordan, Spice girls, whatever) using a 
product or experiencing its positive outcomes in the hopes the consumer will 
imitate the behavior. Effectiveness of the puppet-model increases in the 
following instances: 1.The puppet is physically attractive. 2. The puppet is 
"successful". 3. The puppet is shown overcoming difficulties and then succeeding.<br>
Of course, the more dependent, and the lower the self-esteem of the consumer 
the more prone he/she will be to model the behavior of successful puppets. Note 
that this also apply, more generally, to the 'celebrities' hype all over the 
media. The slave masters use vicarious learning for 3 purposes. Puppet's actions 
can be used to create entirely new types of consumer behaviors. Puppets can 
be used to decrease the likelihood that an undesired consumer behavior will 
occur. Puppets can be used to facilitate the occurrence of a previously 
learned consumer behavior.
<p>
<b>Motivation</b><br>
Time to examine what the slave masters call 'motivation'.<bR>
Motivation refers to an activated state within a consumer that leads to the 
goal-directed behavior. It consists of drives, urges, wishes, affect or 
desires that initiate the sequence of events leading to the goal-directed 
behavior. It begins with a stimulus that is processed by the consumer, going 
through the information processing stages of exposure, attention, and 
comprehension. That stimulus can come from inside the consumer or from 
outside the consumer.<br>
Need activation ­ a discrepancy caused when the stimulus processed causes 
the actual state of being to diverge from the desired state. Needs can be 
innate or learned and are never fully satisfied. Needs produce drive states. 
Affect is the central concept behind the experiential perspective of consumer 
behavior. Evidence suggests that even low intensity feelings created by advertisements 
may affect cognition and behavior. Evidence also indicates that consumer responses 
to advertisements have two emotional dimensions ­ positive and negative affect. The 
emotion created can activate a consumer and place the consumer into a drive state.
There's a bias called 'the fundamental attribution error' which is widely used by 
the slave masters: people are unfortunately biased to make internal 
attributions. I.e. they tend wrongly to believe that a person's actions or 
words are caused by that person's true beliefs and preferences, and that 
they are not making  certain statements about a product influenced by 
environmental pressures like the company they work for and the money 
they gain for that. That's another of the reasons behind the use of 
the celebrities puppets and of 'average people', 'good granny', 'old 
dentist', 'cooking grand-ma' or various 'people­on­the­street' interviews 
and ads.
<p>
<b>Psychoanalytic theory and promotional strategy</b><br>
The slave masters, using Psychoanalytic Theory, use symbols and flights 
of fantasy to propel consumers to buy their products. All symbols that exist 
in Psychoanalytic Theory are being used, such as phallic and ovarian symbols, 
for instance, to release sexual energy or libido.
<p>
<b>Product symbolism</b><br>
Products may act as symbols for consumers, expressing a stereotyped "something" 
about their owners. Of course the lower the self-esteem of the consumer the more 
he will view his possessions as extensions of himself.
<hr><fonr color=olive>Wicklund and Gollwitzer observed that people make use of 
material possessions, amongst other strategies, to compensate for perceived 
inadequacies in certain dimensions of their self-concept. For instance, by 
displaying a recognised masculine symbol, such as strutting around in a black 
leather motorbike suit, a young man can compensate for not feeling 'masculine' 
enough by using the object to tell both himself and others that he is indeed 
'masculine'. This compensatory function of material objects obviously entails 
that the 'symbols' have to fit in with a person's gender (amongst other social categories) 
to provide a potential bridge for closing perceived discrepancies 
between actual and ideal dimensions of self.
</font><hr>
 Certain products have 
a self-image/product­image congruence. Example: Automobiles, health products, 
cleaning products, grooming products, leisure products, clothing, retail 
store patronage, food products, cigarettes, home appliances, magazines, home 
furnishings<bR>
All products that consumers use to communicate themselves to others act as 
symbols and have three characteristics. 1. They must have visibility in use 
­ their purchase, consumption, and disposition are readily apparent to others 
2.The product must show variability ­ some consumers have the resources to own 
the product and some do not. 3.The product must have its 'personalizability' ­ 
the extent to which a product denotes a stereotypical image to the average user.
<p>
The LOV (list of values) scale used by the slave masters has 3 dimensions:<bR> 
1.Individual values (self­fulfillment, excitement, sense of accomplishment, and 
self­respect). 2.Focus on the external world (belonging, being well­respected, 
security). 3.Interpersonal orientation (fun and  Enjoyment, warm relationships 
with others).
<p>
<b>Halo effects and imaginary attributes</b><br>
<u>Halo effects</u> occur when consumers assume that because a product is good on 
one product characteristic it is also good on another product characteristic. Example: 
if a consumer believes that crest toothpaste is the best cavity fighting toothpaste, 
he might also belief it has the lowest abrasive qualities. 
<p>
<u>Directing consumers' attention to an existing (or not existing) attribute</u><bR>
Directing consumers' attention to an attribute, and causing them to allocate 
cognitive capacity to the attribute increases the perceived importance of the 
attribute. It doesn't matter in the least if said attribute does not exist. 
Example: in the 80s, burger king convinced consumers that an 
important attribute of fast food hamburgers was the particular method of cooking ­ flame 
broiling . Colgate used for year a non existent additive 'Gardol' (most 
toothpaste and soap advertisements resort to fantastic chemicalfictionist 
constructions)
<p>
<b>Mere exposure phenomenon and behavior</b><br>
Mere exposure phenomenon is a method through which positive feelings may be formed 
through repeated exposures to a stimulus. This is of course not cognitively based, 
as a matter of fact it has no rational motivation whatever: positive feelings from 
repeated exposures can occur without the person consciously knowing or perceiving 
the repetitions or familiarity of the object. The slave masters use mere exposure 
by developing strategies that ensure that the product, its name, or symbol, are 
repeatedly encountered by the consumer, e.g., Coke, Budweiser, since behavior 
formation corresponds to the behavioral influence perspective. In fact behavior 
results from people engaging in behaviors because of environmental or situational 
factors. Example: large retail chains design the physical layout of departments 
within the store to create behavior directly (see +ORC's essay). The entrance to 
a department store may have high status products directly in front of the door 
(jewelry, cosmetics) with sensuously appealing options to the right (lingerie). The 
consumer's first hurdle is to walk past the 'attractive' departments without buying 
anything there.<br>
Physical layout can induce behaviors through aisle arrangement or then use of 
textures, smells and lighting. This is called Atmospherics. Atmospherics are 
"the effort to design buying environments to produce specific emotional effects 
in the buyer that enhance his/her probability of purchase" this is pure pavlovian 
conditioning btw.
<p>
<b>The Fishbein models</b><br>
A mathematical model used by the slave masters (Fishbein)<bR>
The Fishbein attitude­towards­the­object model relies on an algebraic formula 
to explain the decision process consumers actually go through.<bR>
The formula is:<pre> 
Ao = bi x ei
Ao ­ the overall attitude towards the object. 
Bi ­ the belief of whether the object "o" has some particular 'magic' 
     attribute or achieves some particular 'lure' goal. 
Ei ­ the evaluation of the goodness of the attribute to the consumer.
</pre>
Later Fishbein developed another model  (BI = w1 (ab) + w2 (SN)) that 
contains a new construct called the subjective norm which assesses what 
consumers believe other people think they should do, but we don't need 
to get into such details here.
<p>
Ok, how do the slave masters assess if  the promotion was able to influence 
attitudes (i.e.: has the slave's behavior changed after being bombarded)?.<bR>
Usually the consumer is tied into a low­involvement information processing where 
cognitive responses are less likely to occur. Since the consumer is not considering 
the pros and cons of the issue, he uses peripheral cues (attractiveness and expertise 
of the source, the number of arguments presented, positive or negative stimuli 
in message context, music, etc.) to determine acceptance or rejection of the 
message. Research has indicated that using peripheral cues, such as the physical 
attractiveness of a model as an endorser, had great impact on consumers. 
Companies attempt to create a unit relation between the endorser and the brand 
(x) by 1. Hiring puppets who are supposed experts (or seen as experts) in using 
the product, 2.Signing the endorser to long­term, exclusive contracts so that 
the celebrity puppet is associated only with the same company's brand, 3.Having 
the puppet consistently wear or use the product when in public to strengthen 
the association with the product.
<p>
<b>Techniques of ingratiation (Lying)</b><br>
Ingratiation tactics.<br>
These are self­serving tactics engaged in by one person to make him/herself more 
attractive to another. As the attractiveness of 1 person increases, the likelihood 
of another complying with his/her wishes increases, this is a very subtle way of 
obtaining increased power over another person.<br>
Ingratiation efforts are manipulative and calculating.<bR> 
Appearing to be similar to the target ­ the ingratiator appraises the target person's 
attitudes, opinions, and interests and modifies his/her statements to match the 
perceived beliefs of the other<br>
Conforming to the target's wishes ­ making the target feel important<br>
Offering compliments, and gifts ­ rewards for the target.<br>
Expressing liking ­ the target is likely to return the liking<br> 
Asking advice ­ makes the target feel respected.<br>
Ingratiation techniques are used in personal selling situations, yet a 
problem occurs if the target gets wise to the techniques , since even easy targets feel 
manipulated if that happens :o)
<p> 
The foot-in­the­door technique.<bR>
To increase the likelihood of a prospect saying yes to a moderate request, a person may 
ask for a smaller request first. By saying yes to the first, small request, the person may 
agree to the second request to maintain consistency with self­perception. This technique 
has been used most frequently to increase response rate to market research surveys. 
<p>
The 'Istanbul bazaar' technique<bR> 
This is the opposite of the foot­in­the­door technique. The initial request is very 
large ­ large enough that no one could be expected to comply with it. It is then 
followed by a smaller, more reasonable request. This technique relies on the norm 
of reciprocity. The norm of reciprocity states if a person does something for you, 
you should do something in return for that person. Illicitly invoking the norm, the 
requester makes a large request (although never expecting compliance) then appears 
to give up something by making a smaller request. The target then feels as though he 
or she must return the favor 
 <p>
Even­a­penny­will­help technique.<br> 
This technique is based on the tendency for people to want to make themselves 
"look good." Since everyone has a penny, one would look foolish to say no to 
the request. The target cannot simply give a penny without looking foolish. The 
target tends to give whatever is appropriate for the situation. 
<p>
Inherent in all 4 techniques is the attempt by an influencer to manipulate 
another by engaging in subtle subterfuge. Remember a simple truth: in using 
the techniques, the influencer is always lying.
<p>
<b>"Persuasion"</b><br>
Ultimately communications are given to persuade.<bR> 
Persuasion is a process in which a communication is delivered in order to change 
beliefs and/or attitudes in a desired manner.<br>
The match­up hypothesis indicates that endorsers who match­up with the product 
on relevant attributes may be more effective regardless of their likability. Example: 
Karl Malden played a TV cop for many years. He is an effective spokesperson in 
explaining the warnings against carrying a lot of cash instead of the American 
Express card. Yet if  they use a source that is perceived as overexposed ­ the 
audience understands that the source has been bought off.
<p>
<b>Fear appeals</b><br>
Fear appeals communicate the message that unfortunate circumstances will result 
if the consumer fails to use a particular product or service. Fear appeals (Hitler's 
and all religious fanatics' methods) are effective at producing attitude change 
when the message contains one or 
more of the following types of information: Specific instructions on how to cope 
with and reduce the fear. An indication that following the instructions will solve 
the problem. Giving a high­fear message to an audience that feels highly 
threatened and vulnerable to the threat. A supposed solution to the problem 
can be quickly presented. Fear appeals can be effective by creating emotional 
responses that focus attention on how to cope with a supposed problem giving 
for acquainted the problem without questioning it.
<p>
<b>Primacy and recency effects</b><br> 
Primacy effect occurs when material early in the message has the most 
influence. Recency effect occurs when material at the end of the message 
has the most influence. Information in the middle of a message is relatively 
poorly remembered and has the least impact.
<p>
<b>Repetition effects</b><br> 
This refers to how much repetition is enough and how much is too much (advertising 
wear­out).  Usually the slave masters believe that 3 exposures should be sufficient 
to dumb the consumer and 4 would be too much. In fact even among the lowest forms 
of TV-watching drooling beings, counter arguments increase as the number of 
repetitions increase, causing attitudes toward the ad to become (very slowly) 
more negative. In order to avoid negative reactions due to boredom, the slave 
masters try to vary the same ad with each repetition to avoid wear­out.
<p>
<b>Representativeness heuristic</b><br> 
The representativeness heuristic is a rule of thumb in which a person determines 
the probability that "object a" belongs to "class b" by assessing the degree that 
object a is similar or stereotypical of class b. "knock­off" brands that have 
names and packaging similar to leading brands make use of this heuristic. There 
are at least twenty macaroni producers in Europe that use purposely (almost) the 
same blue boxes as the universally famous Italian "Pasta Barilla".
<p>
<b>Time scales</b><br> 
Because people tend to discount the psychological value of the future loss 
and having the good now is so important, a consumer might pay a higher price 
in the future to have the good in the present ­ the delay­payment effect. If a 
consumer "just missed" a sale, he will feel more of a loss than if the sale 
was 6 months prior. Consumer self­control refers to the ability of people to 
delay gratification and avoid making purchases that provide pleasure in the 
present but pain in the future.
<p>
<b>Frequency heuristic</b><br> 
The frequency heuristic occurs when choice is influenced by the mere number of 
positive and negative attributes associated with a brand, or by the mere number 
of dimensions on which one brand outperforms another. Consumers act as though 
they simply count the number of features on which one brand surpasses 
another ­ little or no attention paid to the relative importance of the 
features. The slave masters utilize this heuristic when they provide 
buyers with a series of extra gifts for a purchase to increase the perceived 
number of benefits, e.g., fragrance companies that offer a "$60" make­up 
case with the purchase of a $40 bottle of perfume.
<p>
<b>Decision makers' bending</b><br> 
Marketers can sometimes bend the decision maker's frame, e.g., meat that 
is "75% lean" as opposed to meat that is 25% fat. "Best before" as opposed 
to 'Do not consume after' and so on...
<p>
<b>Impulse purchases</b><br>
Purchases made with no cognitive control in an automatic manner. It is the 
antithesis of rational consumption.<bR>
Clear symptom of a successful strategy implemented by the slave 
masters. It's defined as a buying action undertaken without a problem 
having been previously recognized or a buying intention formed prior 
to entering the store ­ a spur of the moment decision based on positive 
feelings toward an object, it's in reality the effect of some of the 
techniques used by the slave masters and explained above. There are some 
defenses against this, the main one being the very old trick of NEVER 
buying anything that you didn't list on paper before leaving your 
house... whatever your mind keeps telling you :o)
<hr><font color=olive>
Impulse buying constitutes a substantial 'non-rational' segment of purchasing 
behaviour, which can assume 
such excessive proportions that individuals find themselves in considerable 
financial debt and psychological distress. Empirical studies on 'shopping 
addiction' or 'compulsive buying' have been carried out recently in the 
United States (e.g., Friese and Koenig, 1993; O'Guinn and Faber, 1989; 
Hanley and Wilhelm, 1992), Canada (e.g., Valence, d'Astous, and 
Fortier, 1988), Germany (e.g., Scherhorn, Reisch and Raab, 1990; 
Reisch and Scherhorn, 1994) and the United Kingdom (e.g., Elliott, 
1994). All suggest that extreme impulse (compulsive) buying is on 
the increase, affecting an estimated 5% to 10% of the adult population, 
and that at least occasional bouts of impulse buying are much more common 
than that. Scherhorn, et al. (1990) describe 25% of German adults as 
showing some mild compulsive shopping tendencies.
</fonT>
<hR>
<p>
<b>Group psychology</b><br>
I won't enter too much in this huge field. Suffice to note that there are two main 
groups used scientifically for consumer enslaving purposes: <u>Aspiration groups</u>: those 
sets of people to whom a consumer wishes to belong and <u>Dissociative groups</u>: 
those sets of people from which the consumer hopes to separate.<br>
To explain this, remember that in a group there are <u>roles</u> and that a "role­related" 
product cluster is a set of products necessary for playing a particular role inside an aspiration 
group: An example is given by a "business person's" suit, expensive pen, 
expensive attache case, secretary, etc.<bR>Note also how people that ARE REALLY part 
of the 'aspiration group' (real rich people, real businessmen, real celebrities etc.) 
often refuse the 'role-related' product clusters ("real rich" despising  
any "Lacoste crocodile"  (even to the point of  
sewing it off their T-shirts) or any similar mass-consumer logos, for instance.<br>
One more observation about any "age groups" subdivision: 
Elder "Mature consumers" group members feel always <u>younger</u> than they actually are, 
while "teenagers" feel always <u>older</u> than they actually are... the 
implication is that all slave master's promotional materials focus 
on portraying both elderly and youngsters at the age <u>they feel</u> not, 
their chronological age (with clear and dangerous implications: fast cars, 
cigarettes, booze, etc.). 
<p>
<b>"Don't waste a second without consuming"</b><br>
Distribution systems have more and more 'flexibilized' their opening times.<br>  
Nowadays you can consume something else in the middle of the night, should you 
feel that you have not consumed enough during the day. This is also perfectly in line 
with the increasingly successful struggle of the slave masters in order 
to destroy any 'Sunday' 
(intended as the only one day 'without consume') in the name of 'rationalization' 
and 'globalisation' 
and 'progress' and 'more flexibility'. In reality the existence of the simple concept 
of a 'Sunday' (man! a whole day WITHOUT consuming!) is a blasphemy for the slave 
masters: kids 
and grown up slaves could eventually come to the idea that consuming 
is after all NOT so important.<br> 
Hence the growing push -everywhere- in order that retail stores can be open weekends and 
evenings (a trend feebly countered by obsolete churches or almost destroyed 
worker unions, NOT countered by any 
mass media or 'opinion leader'). At the same time 
Mail­order purchasing has increased in "popularity". People are so conditioned that 
they simply NEED to buy something during those long terrible TV-ads filled 
Sunday afternoons, and mail-ordering 
gives them at least the 'good feeling' that they are not condemned to endure a 
whole day without 
throwing some more money away :o)
<p>
<b>Rituals</b><br>
In our society goods are able to carry and communicate "cultural" meanings to individuals.<bR>
The transfer of meaning from consumer goods to individuals may 
take place through various rituals, including possessions, 
exchange, grooming and divestment rituals.<br>
Certain rituals or symbolic actions link people to material 
goods ('forced' exchanges at birthdays and 'forced' presents at 
Christmas).<bR>
A typical (negative and alarming) symptom of the decay of the society we live in 
can easily be seen just examining the evolution of print advertising <u>themes</u> 
during the last 10 years:  
<u>Utilitarian themes</u> (where a product's benefits were described in terms of 
practicality and efficiency) have dramatically decreased and <u>Luxury themes</u> 
increased dramatically (where having the possession is <u>the end in 
itself</u>, a destructive activity that 
leads -and is motivated- by the  "cultural" meanings of envy, possessiveness, 
selfishness and greed). 
<p>
<b>Trends</b><br>
Trends (the "<b>slave masters' whips</b>", as +ORC called them) have such an importance that 
apparel companies had to introduce clothing for working women that does not go 
"out of style" each year. If you observe this kind of clothing you will notice 
a very interesting series of "no-no-frill" common (functional) characteristics. 
As a simple rule of 
thumb, the more of these characteristics carries <u>your own</u> clothing, the less 
probably it will 'look' obsolete during the next 5-7 years (not that you could care 
less about that, I know, but nevertheless... :o)
<p>


<hr width=33%>
<b>Hope for the future?</b><br>
OK, this all said, there are some (small) signs of relief. I'll list some of them:<bR>
1) Advertisement is more and more frowned upon. This is a consequence, <i>inter alia</i> 
of the development of the telecommunication market and of the Web itself.<br>Clearly once 
you know that you can get a cellular phone  FOR 
FREE if you decide to listen to some advertisement while you'r using it (Berliner experiment 
in Germany, Sweden, Benelux experiments, 
now elsewhere too) you may decide to get it for free, but you (and anybody else) begin to realize 
at the same time that 'publicity and advertisements' are for poor people and lusers, real 
rich can AFFORD not to have to listen/see to any advertisement.<bR>
The mere promotion of all these 'free in exchange of ads' campaigns (email addresses on the web, cellular 
phones, television channels etceteras) contributes therefore to the more and more perceived 
truth that 'advertisements are for slaves and lusers' (as they in fact are, btw) and to a growing 
refusal of the same advertisement if there's nothing (or <i>not enough</i>) in exchange...<br>
2) The main "segmentation" purpose of the slave masters' strategy (always trying to identify 
<u>target groups</u> that have divergent time pressures, characteristics or 'gullibility', 
or targeting certain household segments in order to 
deliver product designs that should meet AT THE SAME TIME the time needs, characteristics or gullibility 
of diverse segments) means that the final product will NOT be able to really satisfy well 
the (perceived) needs of anyone of 
the different segments and will therefore just be a minimal common denominator for many and 
not 'the best possible solution' for each one (hence a general bad mood -even among 
slaves- when indulging in useless consuming). This can of course be exploited and reversed 
by us.<br>
<!-- Begin mover -->
<hr>
<center>
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"><IMG SRC="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" ALT="reality cracking" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Reality Cracking</font>
<bR>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="aca200.htm#anchorecent" tppabs="http://members.xoom.com/tsehp_/aca200.htm#anchorecent">most recent essays</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">CGI antismut</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="history.htm" tppabs="http://members.xoom.com/tsehp_/history.htm">history of this site</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="javaco1.htm" tppabs="http://members.xoom.com/tsehp_/javaco1.htm">AntiMicro$oft</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a>
</center>
<!-- End mover -->
<hr size=1>
</body>
</html>
<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>flip2syn</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">



<h4><center>POPIt Visual Basic 3.0 Protection Scheme Explained<br>
(but not solved)<br>by flipper<br>
(19 October 1997)<br></center></h4>

<center><hr><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> Courtesy of Reverser's page of reverse engineering<br>
<br><i>Well, some interesting points are made here by flipper! (Opentrap 
seems a must-have program for our <a href="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a> collection, BTW)<br>
I have already sent this to +Sync a couple of days ago, but I have also decided to publish it (pending 
flipper's authorization :-) and I'll keep it (accessible only from the 
blackboard, just to reduce the lamers' load) until flipper will send a revised 
essay. I believe that there are quite a lot of important things in here!</i>
<hr></center>
<pre>
Reverser+,

  I read +Sync's message on your blackboard, so I decided to write up a
little something. Instead of just sending an e-mail, I typed it in edit so I
could attach it at a later time. I hope this helps out.

            POPIt Visual Basic 3.0 Protection Scheme Explained
                             (but not solved)
                         Written by flipper (upg)

This is the message that appeared on October 12, just last week from +Sync.
<font color="purple">
&quot;I have spent several days looking at a VB3 program called POPIt, and
have had very little success.  I have talked to Razzia as well as
several others on IRC and it seems that this program has not yet been
cracked.  I was hoping you could possibly post a challenge on the +HCU
page, looking for information on the scheme this program uses.  It
claims that it uses the hard drive serial number off of your computer as
part of the protection, but I have doubts as to the validity of this&quot;
</font>
For the past couple of hours, I too was intrigued by this protection scheme.
Normally, the first thing you think of when cracking VB programs is to run
DoDi's VBDIS Decompiler, but it just won't work here. You get various error
messages, and the program quits. Sometimes, it even says the mysterious
phrase &quot;Cheat&quot; for no reason at all. I hope this 'essay' of sorts starts up
a new +HCU project, because what I'm about to tell you may very well change
the way you look at Visual Basic projects again.

Okay, why not use SoftIce here? Well why not? The truth is, I have yet to
install the new version, and my video card is incompatible with SoftIce.

So, what next? I took one of my own VB compiled programs, and tried to de-
compile it. It worked alright, without any errors. So I decided to download
&quot;Decompiler Defeater&quot; from NPI's website (I trust you can find this program
if you need it, check for &quot;OVERRIDE.ZIP&quot; using Altavista). After using it on
my own program (UDP Sniffer), I saw that it was nothing more than a useless
toy for lazy VB programmers. Look closely, it's protection can easily be
defeated. All it does is overwrite selected &quot;important&quot; bytes from the VB
executable file, like the main form's header 'code', or the actual form names
themselves. No wonder my programs stopped working after protecting them with
this piece of junk.

I checked out POPIT.EXE (16 Bit &amp; 32 Bit vers), and discovered that NONE of
these tricks had been used. I tried to change bytes around various headers,
but nothing worked. So now it was obvious, this was no ordinary VB compiled
file. Back to Altavista, I searched for &quot;OVERRIDE.ZIP&quot; and came up with a
homepage that had another file listed on it called MAKE_MAK.ZIP. The descrip-
tion is as follows.

Description.......: Make_MAK is a Visual Basic AddOn-Compiler.
                    Together with an existing VB.EXE (any version !) this
                    program compiles one or more projects faster than you
                    ever could operate VB !
                    Besides, EXE-files will partly be essentially shorter
                    since VB is now unable to store data-'junk'.
                    Make_MAK supports drag'n'drop from any file manager.
                    ANTI-DISCOMPILER: check &quot;DecompDefeat&quot; and your apps
                    will be immune against 'reverse engeneering' !

That sounds like a nice program to protect my VB file, let's download it.
After searching Altavista again, I found a homepage where I could download
this wonderful gadget. You can get a copy at the following URL.

<a href="FRAVIA_index.htm#165" tppabs="http://members.xoom.com/tsehp_/index.htm#165">http://www.programmersheaven.com/files/file1.htm</a>

So I decided to test this one out. Guess what? It stopped DoDi's decompiler
before it even had a chance to pick out my object data. But wait, it still
loads up the VBX files.. strange, let's have a look at my EXE file again.

Here's the original file, at the form resource entry point. To find it in
any VB file, search for the pattern '03 20 81 80' in hex, there's only one
location for it.

00001C00  03 20 81 80 FF FF 53 4E-49 46 46 00 00 00 00 06   . ....SNIFF.....
00001C10  00 01 00 53 4E 49 46 46-00 00 43 0B 00 00 FF 01   ...SNIFF..C.....
00001C20  FF 01 56 2F 57 43 53 50-49 4E 47 2E 56 42 58 00   ..V/WCSPING.VBX.
00001C30  46 0A 04 80 48 00 FF 01-54 E8 01 53 4E 49 46 46   F...H...T..SNIFF
00001C40  2E 46 52 4D 00 00 00 58-00 00 00 1A 00 1B 00 AF   .FRM...X........
00001C50  00 00 00 00 58 01 00 00-1C 00 1D 00 AF 00 00 00   ....X...........
00001C60  00 58 02 00 00 1E 00 1F-00 AF 00 00 00 00 58 03   .X............X.

Now, what about the same location in the &quot;protected&quot; one made by MAKE_MAK?

00001E00  03 20 81 80 FF FF 53 4E-49 46 46 00 00 00 00 06   . ....SNIFF.....
00001E10  00 01 00 53 4E 49 46 46-00 00 43 0C 00 00 FF 01   ...SNIFF..C.....
00001E20  FF 01 D2 18 FF 43 53 57-53 4F 43 4B 2E 56 42 58   .....CSWSOCK.VBX
00001E30  00 46 0A 04 80 48 00 FF-01 D4 20 02 00 00 AB 55   .F...H.... ....U
00001E40  1E DC 05 4D 5D 00 00 00-58 00 00 00 1A 00 1B 00   ...M]...X.......
00001E50  97 00 00 00 00 58 01 00-00 1C 00 1D 00 97 00 00   .....X..........
00001E60  00 00 58 02 00 00 1E 00-1F 00 97 00 00 00 00 58   ..X............X

Notice how the &quot;SNIFF.FRM&quot; file reference is missing? And the filesize of
the protected executable is smaller than the original version.

This means that something is happening DURING the compilation process.

I used OpenTrap (grab a copy at <a href="FRAVIA_index.htm#167" tppabs="http://members.xoom.com/tsehp_/index.htm#167">http://www.zdnet.com/</a>, look for OPENTR.ZIP)
to see what was going on behind the scenes in Windows.

[ here's my log file, unimportant items clipped to save space ]

000144 VB opened C:\TEMP\~VB1139.TMP at 23:43:06.180
000145 VB closed C:\TEMP\~VB1139.TMP at 23:43:06.180
000146 VB opened C:\TEMP\~VB1139.TMP at 23:43:06.180
000147 VB closed C:\TEMP\~VB1139.TMP at 23:43:06.180
000148 VB closed D:\MIX\F\SNIFF.FRM at 23:43:06.230
000149 VB opened C:\TEMP\~VB1139.TMP at 23:43:06.230
000150 VB opened C:\VB\VB.EXE at 23:43:06.230
000151 VB closed C:\VB\VB.EXE at 23:43:06.230
000152 VB failed to open D:\MIX\F\SNIFF.EXE at 23:43:06.230
000153 VB opened D:\MIX\F\SNIFF.EXE at 23:43:06.230
000154 VB closed C:\TEMP\~VB1139.TMP at 23:43:06.560
000155 VB opened C:\TEMP\~VB1139.TMP at 23:43:06.560
000156 VB closed C:\TEMP\~VB1139.TMP at 23:43:06.620
000157 VB closed D:\MIX\F\SNIFF.EXE at 23:43:06.620
000158 VB closed C:\WINDOWS\SYSTEM\CSWSOCK.VBX at 23:43:06.670
000159 VB opened C:\WINDOWS\VB.INI at 23:43:06.730
000160 VB closed C:\WINDOWS\VB.INI at 23:43:06.730
000161 VB opened C:\WINDOWS\VB.INI at 23:43:06.840
000162 VB closed C:\WINDOWS\VB.INI at 23:43:06.840
000163 VB closed C:\VB\VB.EXE at 23:43:06.890
000164 WSASRV closed C:\WINDOWS\WINSOCK.DLL at 23:43:06.950
000165 WSASRV closed C:\WINDOWS\SYSTEM\WSASRV.EXE at 23:43:06.950
&gt;000166 MAKE_MAK opened C:\TEMP\~EXE1174.TMP at 23:43:07.0
&gt;000167 MAKE_MAK closed C:\TEMP\~EXE1174.TMP at 23:43:07.0
000168 MAKE_MAK opened D:\MIX\F\SNIFF.EXE at 23:43:07.0
&gt;000169 MAKE_MAK opened C:\TEMP\~EXE1174.TMP at 23:43:07.0
&gt;000170 MAKE_MAK closed C:\TEMP\~EXE1174.TMP at 23:43:07.0
000171 MAKE_MAK closed D:\MIX\F\SNIFF.EXE at 23:43:07.0
&gt;000172 MAKE_MAK opened C:\TEMP\~EXE1174.TMP at 23:43:07.0
000173 MAKE_MAK failed to open D:\MIX\F\SNIFF.EXE at 23:43:07.0
000174 MAKE_MAK failed to open D:\MIX\F\SNIFF.EXE at 23:43:07.0
000175 MAKE_MAK opened D:\MIX\F\SNIFF.EXE at 23:43:07.0
000176 MAKE_MAK closed D:\MIX\F\SNIFF.EXE at 23:43:07.0
000177 MAKE_MAK opened D:\MIX\F\SNIFF.EXE at 23:43:07.0
&gt;000178 MAKE_MAK closed C:\TEMP\~EXE1174.TMP at 23:43:07.0
000179 MAKE_MAK closed D:\MIX\F\SNIFF.EXE at 23:43:07.0
000180 MAKE_MAK opened C:\WINDOWS\CHGTOOLS.INI at 23:43:07.110
000181 MAKE_MAK closed C:\WINDOWS\CHGTOOLS.INI at 23:43:07.110
000182 MAKE_MAK opened C:\WINDOWS\CHGTOOLS.INI at 23:43:09.580
000183 MAKE_MAK closed C:\WINDOWS\CHGTOOLS.INI at 23:43:09.580
000184 MAKE_MAK opened D:\MIX\F\MAKE_MAK.EXE at 23:43:09.640
000185 MAKE_MAK closed D:\MIX\F\MAKE_MAK.EXE at 23:43:09.640
000186 MAKE_MAK opened D:\MIX\F\MAKE_MAK.EXE at 23:43:09.640
000187 MAKE_MAK closed D:\MIX\F\MAKE_MAK.EXE at 23:43:09.690
000188 MAKE_MAK closed C:\WINDOWS\SYSTEM\CTL3D.DLL at 23:43:10.900
000189 MAKE_MAK closed D:\MIX\F\MAKE_MAK.EXE at 23:43:10.900
000190 MAKE_MAK closed C:\WINDOWS\SYSTEM\VBRUN300.DLL at 23:43:10.900
000191 MAKE_MAK closed D:\MIX\F\MAKE_MAK.EXE at 23:43:10.960

Sorry for the extra long log file description, but I thought it was im-
portant to note what's happening here.

First, MAKE_MAK is loading, then you pick a MAK file to compile, it loads
up VB.EXE (the compiler), and then proceeds to compile the program, BUT
somewhere in between it accesses one of the temp files VB is making, and
does something to it.

&gt;000166 MAKE_MAK opened C:\TEMP\~EXE1174.TMP at 23:43:07.0
&gt;000167 MAKE_MAK closed C:\TEMP\~EXE1174.TMP at 23:43:07.0

Visual Basic's compiler created that file in my temp directory, and then
used it to compile the final application. Somehow, MAKE_MAK modified this
file, and changed its contents so that the final EXE file is in &quot;shrouded&quot;
form. I tried jumping to DOS and running undelete. I managed to salvage the
file above, but I came up with random strings from a recent Windows memory
dump of sorts.

That's about it. I know a few more things about POPIt though. You must con-
figure it to enable the registration button, then possibly someone could use
SoftIce on it to get a working reg name/num.

I'm working on a &quot;Decompiler Defeater&quot; re-build program that'll take care of
that kind of protection, but as for this new form of protection, I'll con-
tinue to work on it, but if anyone else has any ideas, feel free to e-mail
me with them.

Also, as a final note, I checked out MAKE_MAK's claim that it works with all
VB versions, and they were right. It successfully removed all references to
any FRM files from my VB executables (v3.0, v4.0, and v5.0).

flipper (upg) [box01@ids.on.ca]

</pre><font color="green">
(c) flipper, 1997. All rights reversed.</font>
	
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">  
<center><i>You are deep inside reverser's page of reverse engineering,    
choose your way out:</i></center>  
<br><center>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">  
<a HREF="blackbo.htm" tppabs="http://members.xoom.com/tsehp_/blackbo.htm">Back to the Blackboard</a><hr width="33%">  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">  
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84">homepage </a>  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">   
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73">links </a>   
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">  
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </a>   
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82">students' essays </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </a><br>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </a>  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </a><br>  
  
  
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </a></center>  
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>  
</body>  
</html> 
<HTML>

<HEAD>

<TITLE>makepa3.htm  Fravia explaining easy Javascript password encryption techniques</TITLE>

<META NAME="keywords" CONTENT="fravia, reversing, protection, java, JavaScript, js, password, authorization, CGI, login, protect, protection, security">

<META NAME="description" CONTENT="A living workshop about simple methods to bring authorization features into web page without using CGI or any other server side programming"> 

<META NAME="author" CONTENT="fravia+"> 

</HEAD>

<body bgcolor= "C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">

<center><Font size=+2>Fravia's javascript encryption methods</Font></center>

<bR>We will use an encryption called Vigenere. Although this kind of encryption 

technique has not got any chance against 

reversers, it will probably be more than enough to keep most lusers out.<bR>

The Vigenere cipher is easy to code and good enough to demonstrate 

that JavaScript can be used to encode and decode encrypted documents.<br> 

You will therefore be able to protect (somehow :-) your Web pages from unwelcome 

visitors, once you elaborate on it a little.<br><br>

The code is not originally mine: it is available on many sites of the web (that's the 

reason I 

cannot offer a reference to its real Author, too many haven copycatted it), 

and I have -exactly like all other authors- 

only slightly modified the original one: I have made it 

case insensitive, have choosen an incredibly easy password (Hint: use "<font color=red>aaaaaaaaa</font>" and see what 

happens :-) 

and have given you 

a "one to one" relationship.It's actually dead easy as you will see, I even prepared a special "debug" 

function for your experiments...

<hr><center>~ <font color=blue>begin encrypted document</font> ~</center>

<script>



// courtesy of fravia, for your own experiments here comes a handy "debug window"...

// open the debug window



 // bug = window.open("","bug","status=1 toolbar=1 width=400");

 // bug.document.write("<HTML><HEAD><TITLE>Fravia's debug window</TITLE></HEAD>");

 // bug.document.write("<BODY><H1>Debug output</H1><HR>");

 // function debug (text) {

 // bug.document.writeln(text); }



// end of debug window



function decode (input, key){

        var alphabet =   "ABCDEFGHIJKLMNOPQRSTUVWXYZ"

                       + "abcdefghijklmnopqrstuvwxyz";  

  

        key = key . toUpperCase ();        

        

        var key_len = key . length;

        var i;        

        var adjusted_key = "";



        for (i = 0; i < key_len; i ++)        {

                var key_char = alphabet . indexOf (key . charAt (i));

                if (key_char < 0)                        continue;

                adjusted_key += alphabet . charAt (key_char);        }



        key = adjusted_key;        key_len = key . length;

        if (key_len == 0)        {                key = "a";

                key_len = 1;        }        

	var input_len = input . length;

        var output = "";        

	var key_index = 0;        

	var in_tag = false;

//	see an example of the debug window use...

//      debug("Value of key is: " + key);

	for (i = 0; i < input_len; i ++)        {

                var input_char = input . charAt (i);



                if (input_char == "<")                        in_tag = true;

                else if (input_char == ">")                   in_tag = false;                



		if (in_tag)

                {       output += input_char;

                        continue;                }

                var input_char_value = alphabet . indexOf (input_char);

 

                if (input_char_value < 0)                

                {       output += input_char;                        

                        continue;                }

                var lowercase = input_char_value >= 26 ? true : false;

                input_char_value -= alphabet . indexOf (key . charAt (key_index));

                input_char_value += 26;              

		if (lowercase)

                        input_char_value = input_char_value % 26 + 26;

                else                        input_char_value %= 26;

                output += alphabet . charAt (input_char_value);

                key_index = (key_index + 1) % key_len;       

 }

        return output;}





ciphertext = 

  "<center><Table border=1><TR><td><Font size=+3>Hyojae feoopew vnxzyukijv tmrn Azaaza'n wnj...<br>zf twu hrn...</Font>"+ 

"</td><tD>...</td><td><center><Font size=+2>Nw lteg</Font></center></td></tr></table></center>";

key = null;while (key == null)

        key = prompt ("Enter your decryption key to view this document.");

plaintext = decode (ciphertext, key);document . write (plaintext);</script>



<center>~ <font color=blue>end encrypted document</font> ~</center>

<hr width=44%>

Your page may begin with an unencrypted header, followed by

a section of script which contains five main elements:<br><b>1)</b> 

a decryption function definition (try to follow the code); <b>2)</b> 

a string -as long as you fancy- of encrypted text ("ciphertext"); <b>3)</b>  

a few lines of code that prompt the user for a key; <b>4)</b> 

a call to the decryption function using the ciphertext and key as parameters; <b>5)</b> 

a write statement that outputs the string returned by the decryption function <bR>

The document ends with an unencrypted footer. However, you will not see 

the unencrypted text unless you enter the correct password. The "View Source" 

command won't help much, either, because the password is not contained in the 

source and the text is scrambled. 



Of course, you can encrypt your documents with nearly any encryption technique, 

as long as you are able to write the JavaScript code that decrypts it. To get 

you started, here is the basic scripting pattern you should use in 

JavaScript-decoded Web documents: 



<prE>

&lt;script>



// Copy the ciphertext into a string variable:

text = "jdiownvuizsponmwe";



// Obtain a password from the user:

password = get_password ();



// Use the password to unscramble the text.

text = decode (text, password);



// Display the result in the document:

document . write (text);



&lt;/script>

</prE>



With a correct password (used as key) decoded text will 

be written to the browser window. Otherwise, the output 

will look like one to one (with Uppercase and lowercase 

respected) garbage. 

 

If you are going to encrypt many pages of your site, you could 

store the decryption function in a separate JavaScript file that 

you can load automatically with each page by setting the src 

property of the &lt;script> tag. 





<HR ALIGN=CENTER WIDTH=100% SIZE=3>

<center><i>You are deep inside fravia's page of reverse engineering,  

choose your way out:</i></center>

<br><center>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"> 

<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>

<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM

BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</A>



<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</A>

<IMG

SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM

BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</A><br>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="corporate.htm" tppabs="http://members.xoom.com/tsehp_/corporate.htm"> corporate</A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</A><br>





<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A

HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm"> Is reverse engineering legal?</A></CENTER>



<hr size=3>

</center>

<!-- Begin signet -->

 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  ALIGN=CENTER 

BORDER=0 HEIGHT=13 WIDTH=13 ALT= "red"></a><font color=green>(c) 

<a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Fravia</a> 1995, 1996, 1997, 1998, 1999. All rights 

reversed</fonT>

<!-- End signet -->

<hr>





</body>

</html><HTML>
<HEAD>


	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>iceman.htm: Tweaking with memory in Window95</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>


<center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR><font color=gray>Back to the HCU Papers</fonT></center><hr>
<prE>
			Tweaking with memory in Window95
			      - An API approach -

						by Iceman


	
Intro
------

	I decided to write this after I read NaTzGUL's tutorial called "How to 
access memory of another process".This time want to take you deeper inside 
Windows95 ,revealing some useful tricks.The basic fact is that if we want
to write good tools for reverse engineering on WIN32 hosted platforms we have
to take full control over the OS.That means system level programming
techniques such: virtual memory management,Debug API functions,Ring 0 programming
using VxD or Call gates,Image Manipulation functions.

So let's learn how this OS work!

	My future projects are based on Ring 0 programing.I am especially 
interested in Call gates and WIN32 debug API.Two of the most powerful
functions of WIN32 API are contained in debug API.They are GetThreadContext & 
SetThreadContext.You can do amazing things using them,such as injecting
code and executing code in another process adress space.
	I want to thank to Matt Pietrek for his articles about WIN32 
platforms.Reading those was a pleasure and very instructive.In fact 90% of
my knowledge regarding system level programming in Windows was gained reading
his work.In my humble opinion Matt is one of the best official "reverse 
engineer".Thank you,Matt,thank you for sharing knowledge with us!
	Next,let's give Reverser the credit he deserves.His WEB site is a treasure
for knowledge seekers.Is the best page in reverse engineering business I ever
seen.
	I know , I know my english is very bad.Please forgive me.
	This essay is structured as below:

Chapter1:Short Introduction to Windows95 memory management
Chapter2:Tweaking with virtual memory functions
Chapter3.Short intro to Toolhelp32 functions
Chapter4.How do I:
		4.1.Write self-modifiable code.
		4.2.Modify the code pages of another process. 
		4.3.Modify functions inside system Dll's.
		
========================================================================

Short Introduction to Windows95 memory management
--------------------------------------------------

	I assume that the reader is familiar with process and threads functions 
and have a basic knowledge on how Windows95,using the paging mechanism on
386+ processors,manage memory.Let's remember some facts:
		1.Windows 95 implements a page based virtual memory system. It 
uses a 32 bit linear addressing system.Internaly,all memory is managed in
4096 bytes segments called pages.The entire memory that CPU can address
in theory is called "address space".That's 4Gb.
		2. In Windows95 each 32 bit application is provided with an 
independent 4 Gb address space,regardless of how match phisycal memory is 
installed in your computer.This address space is structured as below:



	4Gb		------------------------         
			|                      |
			|                      |
			|          VxD	       |
	3Gb		------------------------
			|     System DLLs      |
			|  	   MMF	       |
			|  Top W16 Global Heap |
	2Gb		------------------------
			|		       |
			|		       |
			|    User process      |
			|        area	       |		
			|		       |
			|		       |	
	4Mb		------------------------
			|  Base W16 Global Heap|
	0		------------------------		
			
	The portion 0 to 4Mb is shared between processes.It usually contain
16 bit system dll's.The next region begin at 4Mb and ends at 2Gb.This is
the user process area.Each process have code ,data ,resources loaded in
this region.
The region is not shared! The third region begin at 2Gb and ends at
3 Gb.This region is shared between processes.Usualy the system load here
The system dll's .This region is also used to map Memory Mapped Files.The
MMF must be in a shared region because they are utilized to share data 
between processes.Finaly , the last region begin at 3Gb and ends at 4Gb		
Here the system loads Ring0 components (VxD).
	When a executable image is loaded,the system loader maps the file 
in the user process area starting with address 0x0040000 (4Mb).
This is the base address of the most PE files.
Of course ,an executable image can be rebased,so don't relay blindly on this 
address.(Microsoft provides a set of functions for image manipulation.
This functions reside inside imagehlp.dll. Some of them can be
quite useful ,so don't miss them.

============================================================================

Tweaking with virtual memory functions
--------------------------------------

	Following functions are used for Virtual Memory Managemnt.They are part 
of WIN32 API:
		VirtualAlloc
		VirtualFree
		VirtualLock
		VirtualUnlock
		VirtualProtect
		VirtualProtectEx
		VirtualQuery
		VirtualQueryEx

	VirtualAlloc is used to allocate virtual memory in process address space.
	VirtualFree  is used to free virtual memory.
	VirtualLock and VirtualUnlock are used for locking/unlocking pages in memory.
	VirtualProtect and VirtualProtectEx are used to change protection
attributes of virtual memory pages.
	VirtualQuery and VirtualQueryEx are used to query virtual memory pages. 
Using this function you can retrieve all information you need about a memory
region.
	VirtualProtectEx & VirtualQueryEx are extended versions of 
VirtualProtect & VirtualQuery functions.They can be used to query and
modify protection attributes of memory pages in another processes address space.
	Why bother with this functions? The answer is very simple.If you try to 
write to a code page using WriteProcessMemory the function will fail. This
is because the OS always write-protect the code pages,protecting them from
being modified.Any attempt to write to a write protected page will generate a
Access Violation exception.

So , if I want to modify something inside a write-protected 
page I must change it's protection attributes. Here is the step where
virtual memory functions can help.All you have to do is to change page 
protection attributes with VirtualProtect or VirtualProtectEx.You have 
to use VirtualProtect if you want to modify protection our own process 
memory pages and VirtualProtectEx to work on another process.
Those function also saves old protection attribs., so then you finish 
your work restore them.
	You can use this method to:
		1.Write self-modifiable code.
		2.Modify the code pages of another process. 
		3.Modify functions inside system Dll's.
		4.Read from read-protected areas.
		5.Injecting and executing code into another process
		  address space.
	This is not a limitative list.Just use your imagination!
	Let's see now how you can modify protection attributes with 
VirtualProtectEx:

	BOOL VirtualProtectEx(

		    HANDLE hProcess,
		    LPVOID lpAddress,	
		    DWORD dwSize,
		    DWORD flNewProtect,	
		    PDWORD lpflOldProtect 	
   			     );

We need:
	1.HANDLE hProcess: A handle to target process.The handle must have 
PROCESS_VM_OPERATION access.See OpenProcess for further reference.(I
usually use OpenProcess with PROCESS_ALL_ACCESS to get all possible access rights)
	2. LPVOID lpAddress: A pointer to the base address of the region of 
pages whose access protection attributes are to be changed.(I usually use a
DWORD with a type cast)
	3.DWORD dwSize: A dword that specify the size in bytes of region whose 
protection attributes are to be modificated.If dwSize excedes a page
boundary both pages will change protection attributes.
	4.DWORD flNewProtect:A dword that specify new protection atributes.This 
can be a one of following flags:

	PAGE_READONLY		Enables read access to the committed region of pages. 
				An attempt to write to the committed region results in 
				an access violation. If the system differentiates between
				read-only access and execute access, an attempt to execute
				code in the committed region results in an access 
				violation.
	PAGE_READWRITE		Enables both read and write access to the committed region

				of pages.
	PAGE_WRITECOPY		Gives copy-on-write access to the committed region of pages.
	PAGE_EXECUTE		Enables execute access to the committed region of pages. 
				An attempt to read or write to the committed region results 
				in an access violation.
	PAGE_EXECUTE_READ	Enables execute and read access to the committed region
                                of pages.
			        An attempt to write to the committed region results in an access
				violation.
	PAGE_EXECUTE_READWRITE	Enables execute, read, and write access to the
                                committed region of pages.
	PAGE_EXECUTE_WRITECOPY	Enables execute, read, and write access to the
				committed region of pages. The pages are shared 
				read-on-write and copy-on-write.
	PAGE_GUARD		Pages in the region become guard pages. Any attempt to read 
				from or write to a guard page causes the operating system 
				to raise a STATUS_GUARD_PAGE exception, and turn off the guard
				page status. Guard pages thus act as a one-shot access alarm.
				The PAGE_GUARD flag is a page protection modifier. 
				An application uses it with one of the other page protection 
			        flags, with one exception: it cannot be used with PAGE_NOACCESS.
			        When an access attempt leads the operating system to turn off 
				guard page status, the underlying page protection takes over.
				If a guard page exception occurs during a system service, 
				the service typically returns a failure status indicator.
	PAGE_NOACCESS		Disables all access to the committed region of pages. 
				An attempt to read from, write to, or execute in the 
				committed region results in an access violation exception,
			        called a general protection (GP) fault.
	PAGE_NOCACHE		Allows no caching of the committed regions of pages. 
				The hardware attributes for the physical memory should be set 
				to "no cache." This is not recommended for general usage. 
				It is useful for device drivers; for example, mapping a video 
				frame buffer with no caching. This flag is a page protection 
				modifier, only valid when used with one of the page protections
			        other than PAGE_NOACCESS.

	5.PDWORD lpflOldProtect: A pointer to a DWORD to save old protection
attributes.


	A handle to another process is easy to obtain.You can use several methods
for this:
	1.Use CreateProcess to create target process.Then retrieve the handler
from PROCESS_INFORMATION structure.(basically you use the loader method here).
	2.Use of ToolHelp32 functions.This method is more elegant than previous
one. The first step here is to retrieve a PID of target process.
	Use CreateToolhelp32Snapshoot,Process32First and Process32Next functions.
After you have the PID use OpenProcess to obtain a handle to target
process.(Be sure to set access flags to PROCESS_ALL_ACCESS).Warning: Toolhelp32 functions
are not portable!
	3.The methods described by NaTzGUL in his essay "How to access memory of
another process".
	The rest of parameters are self-explanatory.Now let's modify the
protection attributes of first code page of target process.


		HANDLE hTarget;              	// Handle to target process 
		DWORD  codebase = 0x0040000;  	// Assuming image is based at 0x0040000
		DWORD  oldattr;			// Here we will store old prot. attribs	
		VirtualProtectEx( hTarget , 
				LPVOID(codebase),                //Change attribs of 
				4096,                            // first code page to 
				PAGE_EXECUTE_READWRITE,		 // enable read , write
				&oldattr);			 // and execute access.
		
		//
		// Do something useful here
		// 
		//
		 VirtualProtectEx( hTarget , 
				LPVOID(codebase),                //Restore old attr.
				4096,                            // 
				oldattr,		         // 
				&oldattr);

	Querying the virtual address space is another important thing.By use of
VirtualQuery and VirtualQueryEx you can get various info about memory regions in a
process address space.
 Fire up Soft-Ice and type Query.Do you like the screen now? What you can
see is a map virtual address space of target process.Every memory region 
is listed there with some additional info.Not only Soft-Ice can do this.
You can too!By the way: A memory region from Virtual memory API point of view 
is a region whose protection attributes , type and base allocations are the same.
Let's the API: 

	DWORD VirtualQueryEx(
				HANDLE hProcess,	// handle of process 
			        LPCVOID lpAddress,	// address of region 
			        PMEMORY_BASIC_INFORMATION lpBuffer,	// address of 
									// information buffer 
				DWORD dwLength 	// size of buffer 
   			     );	
 
The parameters:
		1.HANDLE hProcess: Handle to target process.Must have
PROCESS_QUERY_INFORMATION
access flag set.
		2.LPCVOID lpAddress: Pointer to se address of the region of pages to be
queried.
This value is rounded down to the next page boundary.
		3.PMEMORY_BASIC_INFORMATION lpBuffer pointer to a
MEMORY_BASIC_INFORMATION structure to receive region info.

		typedef struct _MEMORY_BASIC_INFORMATION { // mbi  
    			PVOID BaseAddress;            // base address of region 
		        PVOID AllocationBase;         // allocation base address 
		        DWORD AllocationProtect;      // initial access protection 
		        DWORD RegionSize;             // size, in bytes, of region 
		        DWORD State;                  // committed, reserved, free 
		        DWORD Protect;                // current access protection 
		        DWORD Type;                   // type of pages 

		} MEMORY_BASIC_INFORMATION; 
		typedef MEMORY_BASIC_INFORMATION *PMEMORY_BASIC_INFORMATION; 

     BaseAddress	Points to the base address of the region of pages. 
     AllocationBase	Points to the base address of a range of pages
			allocated by the VirtualAlloc function. The page pointed 
			to by the BaseAddress member 
			is contained within this allocation range. 
     AllocationProtect  Specifies the access protection given when the
			region was initially 
			allocated. One of the following flags can be present, along with the 
			PAGE_GUARD and PAGE_NOCACHE protection modifier flags. 	
     RegionSize		Specifies the size, in bytes, of the region beginning at
			the base 
			address in which all pages have identical attributes. 		 
     State		Specifies the state of the pages in the region. 
			One of the following states is indicated:
			MEM_COMMIT	Indicates committed pages for which physical storage 
					has been allocated, either in memory or in the paging 
					file on disk.
			MEM_FREE	Indicates free pages not accessible to the calling 
					process and available to be allocated. For free pages, 
					the information in the AllocationBase, AllocationProtect,
					Protect, and Type members is undefined.
			MEM_RESERVE	Indicates reserved pages where a range of the process's 
					virtual address space is reserved without allocating any
				        physical storage. For reserved pages, the information in
				        the Protect member is undefined.
 

     Protect 		Specifies the access protection of the pages in the region.
			One of the 
			flags listed for the AllocationProtect member is specified.
     Type		Specifies the type of pages in the region. The following types
			are defined: 	  	
			MEM_IMAGE	Indicates that the memory pages within the region are 
					mapped into the view of an image section.
			MEM_MAPPED	Indicates that the memory pages within the region are 
					mapped into the view of a section.
			MEM_PRIVATE	Indicates that the memory pages within the region are 
					private (not shared by other processes).
	4.DWORD dwLength: Specifies the size, in bytes, of the buffer pointed to
			by the lpBuffer parameter. 
			  Usually set to sizeof(MEMORY_BASIC_INFORMATION).
 	
	Now let's retrieve this information for the code section of target
process:

		HANDLE Hare;              	// Handle to target process 
		DWORD  codebase = 0x0040000;  	// Assuming image is based at 0x0040000
		MEMORY_BASIC_INFORMATION mbi;   // 
		VirtualQueryEx(hTarget,
LPCVOID(codebase),&mbi,sizeof(MEMORY_BASIC_INFORMATION);

        After VirtualQueryEx returns you have in mbi all information you
need about code	memory region  of target process.
	To retrieve info about all memory regions of a process address space all
you have to do is to start enumerate all memory regions from 0 to 4Gb.Initially call
VirtualProcessEx with
LPCVOID lpAddress set to 0 .After the function returns start iterate  calls
to VirtualProcessEx with LPCVOID lpAddress incremented by the size of region
it queried previously.
Be sure to save away contents of MEMORY_BASIC_INFORMATION structure before
next call.Usualy I use a do - while  loop.
=============================================================================
		
	3.Short intro to Toolhelp32 functions
	-------------------------------------
	
	Nice set of functions!Unfortunately they are NOT portable to other
implementations
of WIN32 such as WIN32s or WINDOWS NT.Those functions are designed to
retrieve info about
processes and threads running in your system.They are very useful to design
debuggers for
WIN95 environment.
	The keyword  is "snapshot".A snapshot is an object in OS memory that lists
all 
possible information about processes and thread runing.Snapshoots are
created with
CreateToolhelp32Snapshoot functions.This function returns a handle that you
can use for 
future access to snapshot object.Destroying the snapshot object is very
simple.All
you have to do is to call CloseHandle function.The snapshot objects are
continue updated
by OS to reflect the real state of system,so you don't have to worry that
the information
is outdated.
	They also provide an easy method to create an "Attach to process"
function.A good 
tool must provide a way to dynamically attach to other processes.Using this
functions is 
very easy to do it.
	Those functions resides in Kernel32.dll,but they are not exported through
kernel32.lib
I think that in Visual C they are exported through tlh32.lib.You must also
locate the 
appropriate header file.The linker does not link implicitly with
tlh32.lib!You have to add
the lib to your project.
	The API:
		CreateToolhelp32Snapshoot
		Heap32First
		Heap32Next
		Heap32ListFirst
		Heap32ListNext
		Module32First
		Module32Next
		Process32First
		Process32Next
		Thread32First
		Thread32Next
		Toolhelp32ReadProcessMemory

	After you use CreateToolhelp32Snapshoot to create system snapshot you can
use
other functions to retrieve the info.
	Process32First & Process32Next are used to walk the process list in
snapshoot.They
return process information in a PROCESSENTRY32  structure.Use
Process32First to get info
about the first process,then Process32Next to retrieve info about
subsequent processes.
Use GetLastError to retrieve the error status.
	This functions are the subject of one of my future essays,so I don't
present them in 
details here.They are very simple to use.I put this short section here only
to provide you
an idea how to retrieve some really cool info.
============================================================================
====================


	How do I....
	------------



		1.Write self modifiable code?

			A. Call VirtualProtect on code pages you want to modify.
			   DWORD flNewProtect must be PAGE_WRITECOPY.
			B. Write to code pages.
			C.Call VirtualProtect on code pages you want to modify to
			   restore old attribs.(PAGE_EXECUTE)
			D.Call FlushInstructionCache to empty the invalidate instruction cache.
			  This step is required because this portion of code may be already
			  in cache memory.		


		2.Modify the code pages of another process(single thread).
			A.Get a handle to target process 
			B.Get handle of target process main thread.
			C.Stop thread using SuspendThread.
			D.Call VirtualProtectEx on code pages you want to modify.
			  DWORD flNewProtect must be PAGE_READWRITE.
			E.Save away the code pages (not required. may you don't need
			  them anymore.Use ReadProcessMemory
			F.Use WriteProcessMemory to write to target pages.
			G.Call VirtualProtectEx on code pages you want to modify to
			   restore old attribs.(PAGE_EXECUTE)
			H.Resume thread using ResumeThread.

			
		3.Modify functions inside system Dll's

			This is can be very dangerous.Write something wrong inside kernell32.dll
		,for  example,and BYE-BYE Windows.But,sometimes it may be very useful
that a
		WIN API function to return without doing nothing,to return faked
values,or to
		do anything but not what was supposed to do.Please take a look at
Madmax's essay
		"Cracking using KERNEL32.DLL??" in Reverser's pages of reverse engineering
to get 
		the point. He chose to patch the file kernel32.dll itself.I don't like
this
		method.I want as far as possible my system files unmodified.So I have to
tweak
		with memory.Let's see how:

			A. Use GetModuleHandle to get a handle to Kernel32.dll
			B. Use GetProcessAdress to get the address of the function we
			   want to patch.
			C.Call VirtualProtect on code pages you want to modify.
			  Use value returned by GetProcessAdress as  LPVOID lpAddress
			  parameter.DWORD flNewProtect must be PAGE_EXECUTE_READWRITE.
			D.Modify (patch the function). Write some code there.Anything
			  you want.I keep hoping that you know what are you doing! 
			E.Call VirtualProtect to restore previous protection attributes.
	      Enjoy your new kernel!
	      Let's see some code.We want to patch
			
		HANDLE hKernel32;
		DWORD oldprot;
		hKernel32=GetModuleHandle("kernel32.dll");
		VirtualProtect(GetProcessAdress( hKernel32,"GetDriveTypeA"),4096,
						PAGE_EXECUTE_READWRITE, &oldprot);
		//
		//
		//Write new code
		// 
		VirtualProtect(GetProcessAdress( hKernel32,"GetDriveTypeA"),4096,
						oldprot, &oldprot);	
			
		As an exercise,try to make this function to say that your HDD is a
			ramdisk.
		Note that the small code snippet presented above does not perform ANY
			error checking.This is bad.This is very bad!I suggest an 
			extensive error checking and or exception handling when you
			play with memory.For example if somehow the first call to
			VirtualProtect fails then trying to access that memory range
			to write will generate a superb AccessViolation Exception.It
			will crash into pieces.I also make intensive use of 
			IsBadWritePtr,IsBadCodePtr,IsBadReadPtr API functions.
			So please, do always !at least! a basic error checking!
============================================================================
===================

Final Notes
-----------

	1.Any corrections and additions are wellcomed.Please append them at the
end of
this document and also include your name (or your nickname ).Slightly
editing minor mistakes
and typos is admitted in-place and without notice.
	2.You can contact me at folowing e-mail adress ice_man81@hotmail.com
</pre>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->

<center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR><font color=gray>Back to the HCU Papers</fonT></center><hr>
<br><bR>


<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>
	



			  			 
		  
			
			   
			   	 
				


























		

				<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=FrontPage.Editor.Document>
<meta name=Generator content="Microsoft FrontPage 4.0">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="new_page_1.htm" tppabs="http://members.xoom.com/tsehp_/finished.htm">
<title>===============================================================</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Tsehp</o:Author>
  <o:LastAuthor>Tsehp</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2000-01-08T20:50:00Z</o:Created>
  <o:LastSaved>2000-01-08T20:51:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>801</o:Words>
  <o:Characters>4567</o:Characters>
  <o:Company>Vegavista</o:Company>
  <o:Lines>38</o:Lines>
  <o:Paragraphs>9</o:Paragraphs>
  <o:CharactersWithSpaces>5608</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
pre
	{margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
</head>

<body lang=EN-GB style='tab-interval:36.0pt'>

<div class=Section1><h1 align="center"><font color="#FF0000">Immortal
  descendants</font></h1>
  <h3 align="center">ADDING functionality to a program<br>
  By Volatility<br>
  Published by Tsehp Jan 8 2000</h3>
  <pre><span style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>INTRODUCTION<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Greetings!<span style="mso-spacerun: yes">&nbsp; </span>This essay is being written specifically for the<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Reverse EngineerZINE, as the target, douby's Reverseme is now <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>the official practice for the zine, but I'll add it to our <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>database as well, as it should serve purpose there too :)<span style="mso-spacerun: yes">&nbsp; </span>The<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>target can be found here: <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><a href="http://acrigs.com/FRAVIA/zipped/reverseme1.zip" tppabs="http://members.xoom.com/tsehp_/zipped/reverseme1.zip">reversme1.zip</a><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>What we're going to learn to do today is actually ADDING <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>functionality to a program -- this is TRUE reversing in my <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>humble opinion :)<span style="mso-spacerun: yes">&nbsp; </span>I have to thank douby of DREAD right off the <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>bat, for holding my hand while entering this uncharted <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>territory :)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>TOOLS NEEDED<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>W32dasm or IDA (I'm using Wdasm in this essay)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Soft-Ice 4.02<span style="mso-spacerun: yes">&nbsp; </span>(or any version you wish)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>HIEW<span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;</span>(or other hex editor)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>MSDN<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>THE ESSAY<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>After reading douby's readme file, we'll see that there are<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>four tasks for this Reverseme: 1) enable the load function 2)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>enable the save function 3) enable the exit function and 4)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>add a scrollbar to the edit box.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>For this essay, we'll be completing task 4 - adding the <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>scrollbar.<span style="mso-spacerun: yes">&nbsp; </span>If I complete the other tasks, I may add to this<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>essay, or I might just write a new one... we'll see :)<span style="mso-spacerun: yes">&nbsp; </span>Let's <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>get started!<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Before actually digging into the code, we have to complete<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>some pre-requisite steps.<span style="mso-spacerun: yes">&nbsp; </span>We know all windows are created <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>with CreateWindow or CreateWindowEx, except for dialogs, so <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>let's disassemble, and see what it uses.<span style="mso-spacerun: yes">&nbsp; </span>Once disassembled,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>take a look at the imports... from this, we can see that the<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>program uses CreateWindowExA.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Now, get your MSDN cd's ready... if you don't have the cd's,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>we'll just use msdn.microsoft.com for now, so load the page<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>and lets do a search for CreateWindowEx.<span style="mso-spacerun: yes">&nbsp; </span>There will be <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>several links, just click on the first one.<span style="mso-spacerun: yes">&nbsp; </span>Now we have all<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>the specifications of the CreateWindowEx function.<span style="mso-spacerun: yes">&nbsp; </span>What <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>we're interested in, is &quot;DWORD dwStyle,<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// window style&quot;,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>since scrollbars are a style.<span style="mso-spacerun: yes">&nbsp; </span>Let's click on the &quot;dwStyle&quot; <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>link, and then the &quot;window styles&quot; link.<span style="mso-spacerun: yes">&nbsp; </span>What do we see all<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>the way at the bottom?<span style="mso-spacerun: yes">&nbsp; </span>WS_VSCROLL :)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Now that we have the style, let's look into the actual window<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>a bit.<span style="mso-spacerun: yes">&nbsp; </span>Let's go back to the main CreateWindowEx page, and<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>look for the type of window we'll be working with.<span style="mso-spacerun: yes">&nbsp; </span>Down <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>towards the bottom of the page, we'll get a table of the<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>class names.<span style="mso-spacerun: yes">&nbsp; </span>You can probably figure out which of these <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>it is...<span style="mso-spacerun: yes">&nbsp; </span>if not, take a look at &quot;EDIT&quot;, and read what it<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>says :)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>From all this, we know know that the code would look <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>something like the following: <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>CreateWindowEx(dwExStyle, &quot;EDIT&quot;, lpWindowName, dwStyle, etc.)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>What good does this do us?<span style="mso-spacerun: yes">&nbsp; </span>Well, take a look at the EDIT <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>parameter...<span style="mso-spacerun: yes">&nbsp; </span>looks like a string, doesn't it?<span style="mso-spacerun: yes">&nbsp; </span>Now we have<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>something to look for in Soft-Ice.<span style="mso-spacerun: yes">&nbsp; </span>Let's set a breakpoint<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>on CreateWindowExA in Soft-Ice, run the program, then F12 out<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>and see what we can find.<span style="mso-spacerun: yes">&nbsp; </span>You should be here:<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401182<span style="mso-spacerun: yes">&nbsp; </span>68C4008050<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes">&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;</span>508000C4<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401187<span style="mso-spacerun: yes">&nbsp; </span>6A00<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>00<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401189<span style="mso-spacerun: yes">&nbsp; </span>68D4504000<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>004050D4<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:0040118E<span style="mso-spacerun: yes">&nbsp; </span>6A00<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PUSH<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>00<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401190<span style="mso-spacerun: yes">&nbsp; </span>FF15D0404000<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CALL<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[USER32!CreateWindowExA]<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401196<span style="mso-spacerun: yes">&nbsp; </span>5F<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>POP<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>EDI<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>015F:00401197<span style="mso-spacerun: yes">&nbsp; </span>A344554000<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MOV<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>[00405544],EAX<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>The first push is the hardcoded value for all the combined<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>styles.<span style="mso-spacerun: yes">&nbsp; </span>What should the second push be?<span style="mso-spacerun: yes">&nbsp; </span>Well, remember the <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>&quot;EDIT&quot; string we talked about?<span style="mso-spacerun: yes">&nbsp; </span>Let's do a d 004050D4, and <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>what do we see?<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Now that we know we're at the right place, how do we add a<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>scrollbar to the editbox?<span style="mso-spacerun: yes">&nbsp; </span>We already have the first value:<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>508000C4, but we need the value of the WS_VSCROLL parameter.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>I remember that this value is 0x00200000, but if you don't,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>you can look it up in Winuser.h, which is included with <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>programming languages such as VC++, or do an ftpsearch.<span style="mso-spacerun: yes">&nbsp; </span><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Now, all that's left to do, is OR the values:<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>0x508000C4 OR 0x00200000 = 0x50A000C4.<span style="mso-spacerun: yes">&nbsp; </span>Now let's try a<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>memory patch to make sure we're on the right track :)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Set a breakpoint on CreateWindowExA again, F12 out of there,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>and set a breakpoint on one of the pushes above the <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>[USER32!CreateWindowExA] call.<span style="mso-spacerun: yes">&nbsp; </span>The line above the one we<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>are going to edit (PUSH<span style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>508000C4), should work just<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>fine, so clear, or disable the CreateWindowExA breakpoint,<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>and set a breakpoint on the line above the one we're going<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>to edit, and ctrl+d again.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Let's clear or disable this breakpoint, and now edit the<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>value with our new one.<span style="mso-spacerun: yes">&nbsp; </span>Do a e 015F:00401182 (NOTE: the<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>first four values will be different on your system, but <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>the 00401182 will remain the same).<span style="mso-spacerun: yes">&nbsp; </span>Now let's edit the <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>bytes from C4 00 80 50 to C4 00 A0 50, and press ctrl+d.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Task completed!<span style="mso-spacerun: yes">&nbsp; </span>Now just search for the bytes in a hex<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>editor, and make the patch permanent.<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Volatility (Volatility@ImmortalDescendants.com)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>GREETINGS (in alphabetical order, not importance :)<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>===============================================================<o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>INDIVIDUALS: ACiD_BuRN, alpine, Corn, douby, JosephCo, knotty, <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>Latigo, LaZaRuS, Lord Soth, Lucifer48, Neural, _pain, +Sandman, <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>S^Witz, Tornado, WarezPup, X-Calibre, Yoshi, and everyone I forgot <o:p></o:p></span></pre><pre><span
style='mso-bidi-font-family:"Courier New"'>(probably MANY)<o:p></o:p></span></pre>

<p class=MsoNormal><span style='mso-bidi-font-family:"Courier New"'>GROUPS:
DREAD, HellForge, RingZer0, Tres2000</span></p>

</div>

</body>

</html>
<html>
<head>
<title>razziak2</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">razzia's  Tutorial on Key Generators<br></font><font size="+2">
(second part, for the first part see <a href="razzia2.htm" tppabs="http://members.xoom.com/tsehp_/razzia2.htm">here</a>)</font>

<h4>by Razzia<br>
<br>
(22 August 1997)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of reverser's page 
of reverse engineering<br><br><i>Well, another great contribution of
 master Razzia... read and enjoy!</i></center><hr size="7">

<pre><center><font size="+2">razzia's  Tutorial on Key Generators

(second part)</font></center>
							      
                          <b>Tools!</b>

  For tools you need a minimum of debugger like SoftIce for Windows
(hence WinIce), and a C compiler with its Dos libraries.


                         <b>Content!</b>

  In this tutorial I will show how to make a key-gen for Ize and
Swiftsearch. The protection that these programs use is the wellknown
Enter-Name-and-Registration-Number method. After selecting 'register',
a window pops up where you can enter your name and your registration 
number. 
  The strategy here is to find out where in memory the data you
enter is stored and then to find out what is done with it. Before
you go on make sure you configure the SoftIce dat file according to
my <a href="razzia2.htm" tppabs="http://members.xoom.com/tsehp_/razzia2.htm">PWD tutorial #1</a>. 


                <b>Part 1: Scanline Swiftsearch 2.0!</b>

  Swiftsearch is a useful little program that you can use to search 
on the web. I will explain step by step how to crack it.

  step 1. Start the program :) 

  step 2: Choose register from the menus. You will now get a window 
where you can enter your name and your registration number.

  step 3: Enter SoftIce (ctrl-d)

  step 4: We will now set a breakpoint on functions like GetWindowText(a)
and GetDlgItemText(a) to find out where in memory the data that we
just entered is stored.  The function that is used by this program
is GetDlgItemTexta (trial and error, just try yourself :).
  So, in SoftIce type BPX GetDlgItemTexta  and then exit SoftIce 
with the g command.

  step 5: Now type a name and a registration number  (I used razzia 
and 12345) and press OK, this will put you  back in  SoftIce. Since 
you are now inside the GetDlgItemTexta function press F11 to get out
of it.  You should see the following code:

  lea eax, [ebp-2C]           :<--- we are looking for this location push eax push 00000404 push [ebp+08] call [USER32!GetDlgItemTextA] mov edi, eax :<--- eax has the length of the string and is stored in edi for later usage. We see that EAX is loaded with a memory address and then pushed to the stack as a parameter for the function GetDlgItemTextA. Since the function GetDlgItemTextA is already been run we can look at EBP-2c (with ED EDP-2c) and see that the name we entered is there. Now we know where the name is stored in memory, normally it would be wise to write that address down, but we will see that in this case it wont be necessary. So, what next? Now we have to allow the program to read the registration number we entered. Just type g and return, and when back in SoftIce press F11. You should see the following code: push 0000000B lea ecx, [ebp-18] : <--So, ebp-18 is where the reg. number push ecx : is stored. push 0000042A push [ebp+08] call [USER32!GetDlgItemTextA] mov ebx, eax : <--save the lenght of string in EBX test edi, edi : <--remember EDI had the lenght of the jne 00402FBF : name we entered? We see that the registration number is stored at location EBP-18, check it with ED EBP-18. Again, normally it would be wise to note that address down. Also we see that it is checked if the length of the name we gave was not zero. If it is not zero the program will continue. Step 6: Ok, now we know where the data we entered is stored in memory. What next? Now we have to find out what is DONE with it. Usually it would we wise to put breakpoints on those memory locations and find out where in the program they are read. But in this case the answer is just a few F10's away. Press F10 until you see the following code : cmp ebx, 0000000A :<--remember EBX had the length of the je 00402FDE : registration code we entered? These two lines are important. They check if the length of the registration code we entered is equal to 10. If not, the registration number will be considered wrong already. The program wont even bother to check it. Modify EBX or the FLAG register in the register window to allow the jump. Continue Pressing F10 until you get to the following code (note that the adresses you will see could be different) : :00402FDE xor esi, esi :<-- Clear ESI :00402FE0 xor eax, eax :<-- Clear EAX :00402FE2 test edi, edi :00402FE4 jle 00402FF2 :00402FE6 movsx byte ptr ecx, [ebp + eax 2C] :<-- ECX is loaded with a : letter of the name-string :00402FEB add esi, ecx :<-- Add the letter to ESI :00402FED inc eax :<-- Increment EAX to get next letter :00402FEE cmp eax, edi :<-- Did we reach the end of the string? :00402FF0 jl 00402FE6 :<-- If not, go get the next letter. Well, we see that the program adds together all the letters of the name we entered. Knowing that ESI contains the sum of the letters, lets continue and find out what the program does with that value : :00402FF2 push 0000000A :00402FF4 lea eax, [ebp-18] :<-- Load EAX with the address of the : registration number we entered :00402FF7 push 00000000 :00402FF9 push eax :<-- Push EAX (as a parameter for the : following function) :00402FFA call 00403870 :<-- Well, what do you think this : function does? :) :00402FFF add esp, 0000000C :00403002 cmp eax, esi :<-- Hey! :00403004 je 00403020 We see that a function is called and when RETurned ESI is compared with EAX. Hmm, lets look at what's in EAX. A '? EAX' reveals : 00003039 0000012345 "09" Bingo. That's what we entered as the registration number. It should have been what's inside ESI. And we know what's inside ESI, the sum of the letters of the name we entered! Step 7: Now we know how the program computes the registration code we can make a key-gen. But we should not forget that the program checks also that the registration number has 10 digits. A simple C code that will compute the registration number for this program could look like this: #include &lt;stdio.h&gt; #include &lt;string.h&gt; main() { char Name[100]; int NameLength,Offset; long int Reg="0," Dummy2="10;" int Dummy="0;" int LengtDummy="1;" int Lengt , Teller; printf("Scanline SwiftSearch 2.0 crack by raZZia.\n"); printf("Enter your name: "); gets(Name); NameLength="strlen(Name);" /* the for loop calculates the sum of the letters in Name */ /* and places that value in Reg */ for (Offset="0;Offset&lt;NameLength;Offset=Offset+1)" { Reg="Reg+Name[Offset];" } /* the while lus calculates the lenght of the figure in */ /* Reg and places it in Lengt */ while (Dummy !="1)" { if ( Reg &lt; Dummy2 ) { Lengt="LengtDummy" ; Dummy="1;}" else { LengtDummy="LengtDummy" + 1; Dummy2="Dummy2*10;}" }; printf("\nYour registration number is : " ); /* First print 10-Lengt times a 0 */ Lengt="10-Lengt;" for (Teller="1;Teller&lt;=Lengt;Teller=Teller+1)" printf("0"); /* Then print the registration number */ printf("%lu\n",Reg); } <hr>
                <b>Case 2 Ize 2.04 from Gadgetware</b>
	
  Ize from Gadgetware is a cute little program that will put a pair of
eyes on your screen which will follow your mousepointer. It has a 
register function where you can enter your name and a registration
number.
  The strategy in this case is still the same : Find out where in memory 
the entered information is stored and then find out what is done with 
that information.

  Step 1:   Start Ize. Chose register and enter a name and a number. I 
used 'razzia' and '12345'.

  Step 2: Enter (CTRL-D) Softice and set a breakpoint on GetDlgItemTextA.

  Step 3:  Leave SoftIce and press OK. This will put you back in Softice. 
You will be inside the GetDlgItemTextA function. To get out of it 
press F11. You should see the following code : 

  mov esi, [esp + 0C] 
  push 00000064
  push 0040C3A0      :<--on this memory location the NAME we entered : will be stored. mov edi, [USER32!GetDlgItemTextA] :<--Load edi with adress of : GetDlgItemTextA push 00004EE9 push esi call edi :<-- Call GetDlgItemTextA push 00000064 :<-- (you should be here now) push 0040C210 :<--On this memory location the NUMBER we entered : will be stored push 00004EEA push esi call edi :<-- Call GetDlgItemTextA We see that the function GetDlgItemTextA is called twice in this code "fragment..class" tppabs="http://fravia.org/fragment..class" The first call has already happened. With ED 40C3A0 we can check that the name we entered is stored on that location. To allow the program to read in the number we entered we type G and enter. Now we are inside the GetDlgItemTextA function again and we press f11 to get out of it. We check memory location 40C210 and we see the number we entered is stored there. Now we know the locations were the name and the number are stored, we note those down! Step 4: Ok, what next? We now know where in memory the name and the number are stored. We need to find out what the program does with those values. In order to do that we could set breakpoints on those memory locations to see where they are read. But in this case it wont be necessary. The answer is right after the above code : push 0040C210 :<--push the location of the number we entered : (as a parameter for the next call) call 00404490 :<-- call this unknown function add esp, 00000004 mov edi, eax :<-- save EAX (hmmmm) We see a function being called with the number-location as a parameter. We could trace into the function and see what it does, but that is not needed. With your experience of the Swiftsearch example you should be able to guess what this function does. It calculates the numerical value of the registration number and puts it in EAX. To be sure we step further using F10 until we are past the call and check the contents of EAX (with ? EAX). In my case it showed : 00003039 0000012345 "09". Knowing that EDI contains our registration number we proceed: push 0040C3A0 :<-- push the location of the name we entered : (as a parameter for the next call) push 00409080 :<-- push an unknown memory-location : (as a parameter for the next call) call 004043B0 :<--call to an unknown function add esp, 00000008 cmp edi, eax :<--compare EDI (reg # we entered) with EAX (unknown, : since the previous call changed it) jne 004018A1 :<--jump if not equal We see that a function is called with two parameters. One of the parameters is the location of the name we entered. The other we dont know, but we can find out with ED 409080. We see the text 'Ize'. This function calculates the right registration number using those two parameters. If you just want to crack this program, you can place a breakpoint right after the call and check the contents of EAX. It will contain the right registration number. But since we want to know HOW the reg. # is calculated we will trace inside the function (using T). We will then try to find out HOW the contents of EAX get in there. Step 5: Once inside the interesting function you will see that we are dealing with a rather long function. It wont be necessary for me to include the complete listing of this function, because we wont need all of it to make our key-gen. But in order find out which part of the code is essential for the computation of the right registration number, you have to trace STEP by STEP and figure out what EXACTLY is going on! After doing this I found out that the first part of the function computes some kind of "key". Then this "key" is stored in memory and in that way passed on to the second part of the function. The second part of the function then computes the right registration number, based on this "key" AND the name we entered. The code that is essential and that we need for our key-gen is the following: ( Note that before the following code starts, the registers that are used will have the following values: EBX will point to the first letter of the name we entered, EDX will be zero, EBP will be zero, The "key" that we talked about earlier is stored in memory location 0040B828 and will have 0xA4CC as its initial value) :00404425 movsx byte ptr edi, [ebx + edx]:<-- Put first letter of the : name in EDI :00404429 lea esi, [edx+01] :<-- ESI gets the "letter-number" :0040442C call 00404470 :<-- Call function :00404431 imul edi, eax :<-- EDI="EDI*EAX" (eax is the return : value of the the previous call) :00404434 call 00404470 :<-- Call function :00404439 mov edx, esi :0040443B mov ecx, FFFFFFFF :00404440 imul edi, eax :<-- EDI="EDI*EAX" (eax is the return : value of the previous call) :00404443 imul edi, esi :<-- EDI="EDI*ESI" ( esi is the number : of the letter position) :00404446 add ebp, edi :<-- EBP="EBP+EDI" (beware that EBP : will finally get the right reg#) :00404448 mov edi, ebx |<-- these lines compute the lenght :0040444A sub eax, eax | of the name we entered :0040444C repnz | :0040444D scasb | :0040444E not ecx | :00404450 dec ecx :<-- ECX now contains the lenght :00404451 cmp ecx, esi :<-- end of name string ? :00404453 ja 00404425 :<-- If no, go to start :00404455 mov eax, ebp :<-- SAVE EBP TO EAX !!!! :00404457 pop ebp :00404458 pop edi :00404459 pop esi :0040445A pop ebx :0040445B ret _____ :00404470 mov eax, [0040B828] :<-- Put "key" in EAX :00404475 mul eax, eax, 015A4E35 :<-- EAX="EAX" * 15A4E35 :0040447B inc eax :<-- EAX="EAX" + 1 :0040447C mov [0040B828], eax :<-- Replace the "key" with the new : value of EAX :00404481 and eax, 7FFF0000 :<-- EAX="EAX" && 7FFF0000 :00404486 shr eax, 10 :<-- EAX="EAX">&gt;10
:00404489 ret


  The above code consists of a loop that goes trough all the letters of 
the name we entered. With each letter some value is calculated, all these 
values are added up together (in EBP). Then this value is stored in EAX
and the function RETurns.
  And that was what we were looking for, we wanted to know how EAX got 
its value! 

  Step 6: Now to make a key-gen we have to translate the above method
of calculating the right reg# into a c program. It could be done in the 
following way : 
(Note : I am a bad c programmer ) 

#include	&lt;stdio.h&gt;
#include	&lt;string.h&gt;
main()
{
    char Name[100];
    int NameLength,Offset;
    unsigned long Letter,DummyA;
    unsigned long Key = 0xa4cc;
    unsigned long Number = 0;

    printf(&quot;Ize 2.04 crack by razzia\n&quot;);
    printf(&quot;Enter your name: &quot;);
    gets(Name);
    NameLength=strlen(Name);
    for (Offset=0;Offset&lt;NameLength;Offset=Offset+1)
        { 
         Letter=Name[Offset];
           DummyA=Key;
           DummyA=DummyA*0x15a4e35;
           DummyA=DummyA+1;
           Key=DummyA;
           DummyA=DummyA &amp; 0x7fff0000;
           DummyA=DummyA &gt;&gt; 0x10;
         Letter=Letter*DummyA; 
           DummyA=Key;
           DummyA=DummyA*0x15a4e35;
           DummyA=DummyA+1;
           Key=DummyA;
           DummyA=DummyA &amp; 0x7fff0000;
           DummyA=DummyA &gt;&gt; 0x10;                 
         Letter=Letter*DummyA; 
         Letter=Letter*(Offset+1);
         Number=Number+Letter;
        }         	                   
    printf(&quot;\nYour registration number is : %lu\n&quot;,Number);
}
<hr>
                      <b>Final Notes</b>
     
  For feedback and suggestions pls contact me :)


  january 1997 - razzia 	  </pre>
 <font color="green">(c) razzia 1997. All rights reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#82" tppabs="http://fravia.org/tppmsgs/msgs0.htm#82">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>

 

                                                                                                                                   raZZia
<HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>menusspa.htm: Theory and practice of menus reversing
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
Theory and practice of menus reversing
</fonT><br><FONT SIZE="+1">
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" 
ALT="papers" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Papers</FonT>
</center></td></tr><tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
June 1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
+Spath.
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">

<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's pages of reverse engineering</center> 
</center></TD><td BGCOLOR="898030"><center>

</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font color="#C4C0CF">fra_00xx<bR>980616<br>+Spath<br>0110<br>PA<br>AD<br></fonT></td><td><i><center>
<!-- Your truly+ comments -->
A worthy addition for our papers section.  I hope that many reversers will build on 
this and offer us additions and ameliorations and suggestion, so that we will be able 
to produce some 'basic' reversing papers (menus, save/save us crippled, internet background connections, 
printer smearing, etcetera) 
that could be used as 'quick reference' by fellolw reversers all around the word...<bR>
Note also the lookup table reversing and the 
quick crack of Jeremy Likness' software cracking 
challenge.<br>Unfortunately the file I downloaded is corrupted, and therefore 
you'll miss a small part at the bottom. I'm sure that +Spath will soon send the 
missing snippet.<bR>
Enjoy!
</i></center></td><td><center><IMG SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" 
ALT="Advanced" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Advanced</FonT></center></td></tr><TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><font color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> (X)<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
An essay to understand how menus and messages work, to be able to efficiently reverse 
function-disabled programs.
<HR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
Theory and practice of menus reversing
   </FONT><BR>
   <FONT SIZE="+2">

   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
+Spath.
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table><pre>
This text is an introduction to functions disabled programs ; I wrote it 
because I did not find any essay describing both graphical (menus related) 
and system (messages related) parts of this problem. My goal here was to 
explain basically how menus work and to give a few tips and examples, so 
that any beginner can start working in the right direction.

As you may have already understood, I'm not a native english speaker, so 
please forgive my mistakes.


I) MENUS
  1) Creating a menu
  2) Modifying a menu
  3) Reversing a menu definition
II) WINDOWS MESSAGES
  1) Messages and Windows
  2) Messages to an application
III) REVERSING A FUNCTION-DISABLED TARGET
  1) Before you start
  2) A few tips
IV) HANDS ON
  1) CAP 1.0
  2) Sigmastat 2.0
  3) Bestwin  
  4) Flipper   

</prE><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table><br>
One eye and one brain are required. This text is long, so some tea may help also. 
<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table><br>
See IV)
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>
</fonT></center></td></tr></table><br>
None.
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<pre>
I) WINDOWS MENUS

1) Creating a menu

Menus can be created using either a menu template or menu creation 
functions. 

- Creating menus using a menu template :

This is the most common method ; most of the times menu templates are 
defined as resources and are contained in a separate file from real source 
code. A menu template completely defines a menu, including all functions, 
separators and all submenus. Here's a typical C/ASM menu template :

IDR_MENU1 MENU DISCARDABLE 
BEGIN
    POPUP "File"
    BEGIN
        MENUITEM "&Open...", ID_BROWSE 
        MENUITEM "&Execute", ID_EXECUTE GRAYED 
        MENUITEM SEPARATOR
        MENUITEM "E&xit", ID_CANCEL
    END
END

This defines a menu bar that contains one popup menu, named File (from 
here on, popup menus will be refered to as menus). In this menu, some items 
are defined, as well as a separator (that cause a horizontal line to be drawn 
between two menu items). Each item is described using this format :

MENUITEM  String,  MenuID   [Options]

String  : the menu item's characters enclosed in " ". The '&' symbol before 
          a letter means that this letter will be underlined in the menu 
          (most of the times to indicate a keyboard shortcut).

MenuID  : a number that becomes the low word of the wParam that is passed 
          with the WM_COMMAND message (I will discuss that in details 
          later).

Options : how the item is to appear : CHECKED, GRAYED (inactive and gray), 
          INACTIVE (inactive), MENUBARBREAK, MENUBREAK (both place item on 
          new line).


- Creating menus at run-time : 

Using menu creation functions, you can create menus at run time or 
add menu items to existing menus. You first can use the CreateMenu() 
function to create an empty menu bar and the CreatePopupMenu() function 
to create an empty menu. Then, to add items to a menu, AppendMenu(),
InsertMenuItem() and InsertMenu() can be used : AppendMenu() just 
appends a menu item to the end of a menu or submenu, while the two 
other ones let you insert a menu item at a specified position.
Both functions allow you to specify the attributes of the menu item, 
including whether it is enabled, disabled, grayed, checked, or unchecked.

After a menu has been loaded or created, it must be assigned to a window.  
The first method is to do it at class' registration : before creating a 
window, a program must register its class to Windows via RegisterClass() 
or RegisterClassEx(). The parameter of these functions is a pointer to a 
WNDCLASS or WNDCLASSEX structure : 

typedef struct _WNDCLASS {        typedef struct _WNDCLASSEX {  
    UINT    style;                    UINT    cbSize; 
    WNDPROC lpfnWndProc;              UINT    style;  
    int     cbClsExtra;               WNDPROC lpfnWndProc; 
    int     cbWndExtra;               int     cbClsExtra;
    HANDLE  hInstance;                int     cbWndExtra; 
    HICON   hIcon;                    HANDLE  hInstance; 
    HCURSOR hCursor;                  HICON   hIcon; 
    HBRUSH  hbrBackground;            HCURSOR hCursor; 
    LPCTSTR lpszMenuName;             HBRUSH  hbrBackground;
    LPCTSTR lpszClassName;            LPCTSTR lpszMenuName;
} WNDCLASS;                           LPCTSTR lpszClassName; 
                                      HICON   hIconSm; 
                                  } WNDCLASSEX;

The lpszMenuName parameter of this structure describes which menu will 
be associated to a window of this class (created with CreateWindow() or 
CreateWindowEx() ). The other method is to assign the menu after the 
window has been created, which can be done with SetMenu().

Just a remark about context menus (also called floating menus), which are 
the ones that are activated by right mouse button : they are most of the time 
displayed via TrackPopupMenu() or TrackPopupMenuEx() when a WM_CONTEXTMENU 
message is processed.


2) Modifying a menu

Several functions enable you to change menus or menuitems after they 
have been loaded or created.

- SetMenuItemInfo() allows you to change the attributes of an existing 
menu item ; attributes include its type, state, identifier, submenu, 
bitmaps, item data, and text. Before modifying a menu, GetMenuItemInfo() 
can be used to retrieve informations about an item. This function returns 
a MENUITEMINFO structure, which specifies the attributes to retrieve and 
receives their current values.

- ModifyMenu() replaces the specified menu item with a new item. It can 
be used to enable, disable, gray, check or uncheck the text string or the 
bitmap of a menu item. 

- EnableMenuItem(), the very famous one : this function specifically exists
to enable, disable, or gray a menu item.

EnableMenuItem(
    HMENU hMenu,	      // handle to menu
    UINT uIDEnableItem,	// menu item to enable, disable, or gray
    UINT uEnable	      // menu item flags
   );

The menu item flag contains two informations, the action to perform on 
the item and the selecting method :

MF_ENABLED  (00h) : the function can be used. 
MF_GRAYED   (01h) : the function is grayed and cannot be chosen.
MF_DISABLED (02h) : the function is not grayed, but clicking does 
                    nothing (no WM_COMMAND message is sent).

MF_BYCOMMAND (00h)   : uIDEnableItem gives the menuID of the menu item 
                       (this is the default method).
MF_BYPOSITION (400h) : uIDEnableItem gives the zero-based relative 
                       position of the menu item.

To gray an item, you usually use 03h (MF_GRAYED + MF_DISABLED)

- DeleteMenu() or RemoveMenu() to delete a menu item from a menu,  
function. If the item being deleted is one that opens a submenu, 
DeleteMenu() deletes the associated submenu, discarding the menu handle
and freeing the memory used by the submenu. The RemoveMenu() function 
deletes a menu item, but if the item opens a submenu, the function
does not destroy the submenu or its handle, allowing the submenu to 
be reused.


3) Reversing a menu definition

Let's take the sample resource file of 1) and compile it : here's how 
it looks like in the EXE file :

10 00 46 00 69 00 6C 00-65 00 00 00 00 00 E8 03  ..F.i.l.e.......
26 00 4F 00 70 00 65 00-6E 00 2E 00 2E 00 2E 00  &.O.p.e.n.......
00 00 00 01 EA 03 26 00-45 00 78 00 65 00 63 00  ......&.E.x.e.c.
75 00 74 00 65 00 00 00-00 00 00 00 00 00 80 00  u.t.e...........
02 00 45 00 26 00 78 00-69 00 74 00 00 00 00 00  ..E.&.x.i.t.....

which can be decoded this way, if you remove the widechar format :

10h  "File" 
00h, 03E8h, "&Open..."
01h, 03EAh, "&Execute"
80h
00h, 0002h, "E&xit"

The main modification of the resources (apart from the wide char format) 
is the inversion of the parameters (the order is now Options, MenuID, 
String).

Before each option, you see the low word of the wParam value of the WM_COMMAND 
message that will be sent to the application when the function is selected ; 
this value is equal to the MenuID value defined in the resource file. 

Documented options values correspond to the associated item flags : they
are grayed (01h), inactive (02h), checked (08h), menubarbreak (20h), 
menubreak (40h). No option corresponds to value 00h, which means that the 
item is active. As you see, each option use only one bit of the byte, to 
ease combination (for instance, 09h is grayed + checked). Other values 
are :

04h (MF_BITMAP) to use a bitmap as the menu item.
10h (MF_POPUP) must be used for menu definition, it just crash USER.EXE
    when used with an item.
80h (MF_HILITE) is used for menuitem separators.

With the resource file of 1), the Execute option is grayed ; so to enable 
it, we just have to replace the 01 (2 bytes before the "&Execute" string) 
by 00.

Now let's see a VB menu definition : 

...mnuFile.....&  05 07 00 6D 6E 75 46 69-6C 65 00 13 03 05 00 26   
File.....&......  46 69 6C 65 00 07 FF FF-02 26 00 00 00 06 0B 00  
mnuFileSave.....  6D 6E 75 46 69 6C 65 53-61 76 65 00 13 03 0A 00  
&Save Text......  26 53 61 76 65 20 54 65-78 74 00 08 13 00 FF 02  
.......mnuFileSe  1D 00 00 00 07 0C 00 6D-6E 75 46 69 6C 65 53 65  
p_1.....-.....!.  70 5F 31 00 13 03 01 00-2D 00 06 FF FF 02 21 D1  
.....mnuFileExit  00 00 08 0B 00 6D 6E 75-46 69 6C 65 45 78 69 74  
.....E&xit......  00 13 03 05 00 45 26 78-69 74 00 08 11 00 FF 03  
........mnuAbout  02 1E 00 00 00 09 08 00-6D 6E 75 41 62 6F 75 74  
.....&About.....  00 13 03 06 00 26 41 62-6F 75 74 00 07 FF FF 02  
"......mnuAboutR  22 00 00 00 0A 0B 00 6D-6E 75 41 62 6F 75 74 52  
eg.....&Register  65 67 00 13 03 09 00 26-52 65 67 69 73 74 65 72  
..........mnuAbo  00 FF 02 1F 00 00 00 0B-0B 00 6D 6E 75 41 62 6F  
utAbo.....A&bout  75 74 41 62 6F 00 13 03-06 00 41 26 62 6F 75 74  
..........+@....  00 FF 03 03 04 06 00 00-00 DC 2B 40 00 01 00 01  

It can be interpreted this way :

05 0700 "mnuFile"00      1303 0500 "File"00       07FFFF02 2600     0000
06 0B00 "mnuFileSave"00  1303 0A00 "&Save Text"00 081300FF 021D00   0000
07 0C00 "mnuFileSep_1"00 1303 0100 "-"00          06FFFF02 21D1     0000
08 0B00 "mnuFileExit"00  1303 0500 "E&xit"00      081100FF 03021E00 0000
09 0800 "mnuAbout"00     1303 0600 "&About"00     07FFFF02 2200     0000
0A 0B00 "mnuAboutReg"00  1303 0900 "& Register"00  FF021F00          0000
0B 0B00 "mnuAboutAbo"00  1303 0600 "A&bout"00     FF030304 0600     0000

Here's a description of the fields :
1 : number of the item which will be defined.
2 : size of the next string.
3 : name of the menuitem as it has been entered during its creation in 
    VB ; this is a 00 terminated string.
4 : special delimiter between the two strings ; these values are used to 
    check that the strings' sizes are correct.
5 : size of the next string.
6 : name of the item as it will be displayed. Note that "-" is a special 
    value reserved for menuitem separators ; this is also a 00 terminated 
    string.

Other fields are left as targets for mighty reversers' curiosity. :)

Hey, but where are the MenuID values ? Well, they are not stored here, actually 
we will see later that they are not stored at all... 


II) WINDOWS MESSAGES

1) Messages and Windows

When you type a key or move the mouse, the corresponding device driver 
converts the input into messages and places them in the system message 
queue. Then Windows gets messages from this queue, determines what 
window is currently active, and sends the message to the queue of the
thread that created this window.

A message is a structure declared as:

typedef struct MSG {
   HWND hwnd;     // handle of the window for whom the message is destined
   WORD message;  // type of message (WM_COMMAND, WM_PAINT,...)
   WPARAM wParam; // first parameter, depends on the type of message
   LONG lParam;   // second parameter, depends on the type of message
   DWORD time;    // time when the message occured
   POINT pt;      // location (X,Y) of the mouse when the message occured
}  

Depending on which API you use (Win32 or Win16) the contents of wParam and 
lParam and the size of wparam can vary. For example, a WM_COMMAND message is :
in Win16 : wParam(16-bits) - Identifier for the command
           lParam(32-bits) - LOWORD: Window handle, HIWORD: Special modifier

in Win32 : wParam(32-bits) - LOWORD: Identifier, HIWORD: modifier
           lParam(32-bits) - Window Handle

Note that Softice does not handle these subtelties, thus it sometimes recognizes 
wrong wParam and lParam values (with accelerators for instance, see 2) ). 

Each thread of each application has an internal message queue, where Windows 
can put one or more messages ; then, the application retrieves the messages 
from the queue (in the same order they have been put into) and process them. 
That means the application
  
- reads the message from the queue by using GetMessage(). 
- translates keyboard messages (key up/down) into char messages by TranslateMessage().
- dispatches them to the appropriate window procedure by using DispatchMessage(). 

Actually, there are two ways Windows can send a message to an application :
it can either place the message in the thread's queue with PostMessage() 
(they are called queued messages) or it can send it directly to a window 
procedure with SendMessage() (they are called nonqueued messages).

Queued messages include all user input messages (like WM_MOUSEMOVE, 
WM_LBUTTONDOWN, WM_KEYDOWN, WM_CHAR, ...) and some system messages 
(WM_TIMER, WM_PAINT, WM_QUIT). All these messages use a MSG structure.

For nonqueued messages, only the first four arguments (ie not time and mouse 
position) are passed, but if the window procedure needs them, it can get them
via GetMessageTime() and GetMessagePos(). Windows typically sends nonqueued 
messages to notify a window of events that affect it (WM_ACTIVATE, 
WM_SETFOCUS, WM_SETCURSOR, ...) or when an application calls certain Windows 
functions (for example, Windows directly sends the WM_WINDOWPOSCHANGED 
message after an application uses the SetWindowPos() function to move 
a window). 

Note also that WM_PAINT is an exception to the FIFO message queue : this special 
message has the lowest priority, that means it is sent to the window procedure 
only when the queue contains no other message.


2) Messages to an application.

Now, the question is : how does an application know when Windows has
put a new message in its queue ? Well, it does not really know it. 
Actually, the application is just stuck in an infinite loop where it keeps 
on retrieving and dispatching messages. This is called the "message pump"
or "message loop", and its simplest form is  : 

; Process messages, quit when WM_QUIT received.
;
msg_loop:
      push   0                  ; maximum value of message to filter
      push   0                  ; minimum value of message to filter
      push   0                  ; handle of the window (0 = all messages) 
      push   offset msgbuffer   ; where to store the message
      call   GetMessageA        ; get the message from the queue and store it
      or     eax,eax            ; if eax=0, WM_QUIT as been posted 
      je     end_loop           ; in that case, we leave the app
      push   offset msgbuffer   ; where the message is stored
      call   DispatchMessageA   ; send message to window procedure
      jmp    msg_loop           ; loop 

; Terminate program.
end_loop:
      push   [msgbuffer.msgWparam]
      call   ExitProcess

A window procedure is a function that receives and processes messages sent 
to the window. Every window class has a window procedure, and every window 
created with that class uses that same window procedure to respond to messages. 
Because a window procedure is shared by all windows belonging to the same 
class, it can process messages for several different windows. To identify 
the specific window affected by the message, a window procedure can examine 
the window handle passed as first parameter of a message.

Window procedures are usually just a big 'CASE' statement, where all types 
of messages are routed to different pieces of code :

; The window procedure, where messages are routed.
;
MainWndProc:
        mov    eax,[esp+8]        ; get message type
        cmp    eax, 0000000F      ; is it WM_PAINT ?
        je     paint_client       ; yes, go and paint something
        cmp    eax, 00000111      ; is it WM_COMMAND ?
        je     execute_command    ; yes, go to command procedure
        cmp    eax, 00000201      ; is it WM_LBUTTONDOWN ?
        je     LeftMouseDown      ; do something
        cmp    eax, 00000001      ; is it WM_CREATE ?
        je     creating_window
        cmp    eax, 00000002      ; is it WM_DESTROY
        je     start_destroy
        jmp    DefWindowProcA     ; delegate other message processing

Note that by default there is a call to DefWindowProcA(). This is the 
Windows default window procedure which MUST be called to handle any 
messages that a window procedure does not handle. A program can have 
many windows and therefore many window procedures : when a message is 
not processed by the main window procedure, the message is passed to 
the next one via DispatchMessage(). 

We saw that a WM_KEYDOWN/WM_KEYUP combination of messages can be 
translated into a WM_CHAR message (and reposted to the thread's own 
queue) by TranslateMessage(). But a WM_KEYDOWN can also be translated 
into a WM_COMMAND message by TranslateAccelerator(), the function which 
processes accelerator keys for menu commands (like Ctrl+C  for copy). 
Also, if the keyboard combination corresponds to a menu, WM_INITMENUPOPUP 
is sent to the application and the popup menu is opened. Note that you 
can differentiate a WM_COMMAND message translated from a keyboard input 
from a message triggered by the mouse, since TranslateAccelerator() sets 
the high-order word of the wParam parameter to 1 ; in this case, Softice 
wrongly thinks that it's the lparam hiword that is set.

In addition to the APIs we have covered, Windows has some other APIs that
you should be aware of that let you perform various actions on messages 
and the message queue :

PeekMessage() - read messages in the queue without removing them.
RegisterWindowMessage() - to declare specific message for your application.
WaitMessage() - suspend the thread until a message is put on the queue.


C) Messages and Menus

When the user activates an item on the menu bar, the owner window first 
receives a WM_SYSCOMMAND message. This message includes a flag that 
indicates whether the user activated the menu by using the keyboard 
(SC_KEYMENU) or the mouse (SC_MOUSEMENU). 

Next, before displaying any menus, Windows sends the WM_INITMENU message 
to the window procedure so that an application can modify the menus before 
the user sees them. Windows sends the WM_INITMENU message only once per 
menu activation.

When the user points to a menu item that opens a submenu, Windows sends 
to the owner window the WM_INITMENUPOPUP message before displaying the 
submenu. Again, this message allows the application to modify the submenu 
before it is displayed. Each time the user moves the highlighting 
from one item to another, Windows sends a WM_MENUSELECT message to the 
window procedure of the menu's owner window. This message identifies the 
currently selected menu item ; some applications (Words, Wordpad,...) handle 
this message to display informations about the selected menu item at the 
bottom of their main windows.

When the user chooses an item from a menu, Windows sends a WM_COMMAND 
message to the window procedure. The low-order word of the WM_COMMAND 
message's wParam parameter contains the identifier of the chosen item. 
The window procedure should examine the identifier and process the message 
accordingly.

For context menus (opened by right button clicks), a WM_CONTEXTMENU 
message is sent, so that the application can process it and display 
its menu.


III) REVERSING A FUNCTION DISABLED TARGET

1) Before you start

Before you even think about cracking a function-disabled program, you 
should check a few things :

- is it the best solution ? If you can register with a code or a keyfile, 
try this instead, because this will remove all visible (and invisible so 
far) annoyances and/or limitations in one row.

- is the code of the disabled functions in the program ? If the code is 
not there, you will have to add it, and that's a different challenge... 
There are many clues that can lead you to a conclusion, like the registration 
scheme, the imported APIs, some text strings, etc

Ok, for some reason you decided to crack it this way. Now you must always 
keep in mind where you are and what you want to do ; basically, you will 
have to : 
- ungray the disabled function (or make it appear) in the menu.
- link this function to the correct piece of code.

Part one is most of the times fairly easy, and can lead to a typical 
error : you put a breakpoint on EnableMenuItem, find where the flag is 
stored and change it to MF_ENABLED. Now you have ungrayed the function, 
so you're pretty confident, but when you click... nothing happens :(

That's the second part, which can be more or less complicated, depending 
on how the program has been stripped : you must first find the piece of 
code that corresponds to the function, then you must find and modify the 
message loop or/and the window procedure.


2) A few tips

It's quite easy to ungray a item, just have a look at the imported APIs,
and find what is used to create and maybe modify the menus. The main 
difficultys is to find where the message loop and the appropriate window 
procedure are.  

A few ways to find a message loop :

- via the the messages specific APIs, like GetMessageA(), DispatchMessageA() 
or DefWindowProcA(), that are almost always called in each message loop.

- via the message values : some message are always processed, like 
WM_COMMAND (0111h) or WM_DESTROY (0002h). So you can search for 
00000111 in a disassembled listing to find a "cmp xxxx, 00000111h", 
that may be the 'case WM_COMMAND' statement.

- in SoftIce, with a BMSG command 
SoftIce's BMSG breakpoint is quite useful to break on specific messages. 
You can also log without poping the messages going to a window procedure 
with the 'L' option ; note that the messages are logged in the SoftIce 
history buffer, so be sure to have a well chosen size. Also use WMSG to 
have a list of messages recognised by SoftIce.

You can construct an equivalent BPX-style breakpoint using a conditional 
expression. Use the HWND command to get the address of the window procedure, 
then use the following BPX command : 
bpx postmessagea if @(ss:esp+8)==WM_COMMAND


A few ways to find a window procedure :

- via the RegisterClass() and RegisterClassExA() functions.
The window procedure address is the second parameter (for WNDCLASS) and
the third parameter (for WNDCLASSEX), so some

BPX RegisterClassA do "u @(@(ss:(esp+4))+4) ; d @(@(ss:(esp+4))+24)"
BPX RegisterClassExA do "u @(@(ss:(esp+4))+8) ; d @(@(ss:(esp+4))+28)"

will display the registered class and unassemble the piece of code of 
the corresponding window procedure. Also watch for CreateWindowA() and
CreateWindowExA(). Actually, this is interesting only if you find 
window procedures that belongs to the target ; most of the times, it
will not be the case, because the application will use system or 
application global classes (from Windows, MFC,...).

- with Softice, with HWND and CLASS : the first function gives informations 
about all windows of a process, including the window procedure address :

:hwnd
Window Handle   hQueue  SZ  QOwner    Class    Name     Window Procedure
0080(0)         206F    32  MSGSRV32  #32769 (Desktop)   17CF:00004C44
                                                         ^^^^^^^^^^^^^  
The second function gives informations about the classes used by a process :

:class notepad
Handle  Class Name               Owner           Wndw Proc       Styles
-------------------------- Application Private -----------------------------
403C    Notepad                  NOTEPAD         1467:00000350   07001000
--------------------------- Application Global -----------------------------
401C    SysAnimate32             COMCTL32        1467:000000FE   03004008
400C    msctls_hotkey32          COMCTL32        1467:000000E8   03004000
3A04    msctls_progress32        COMCTL32        1467:000000D2   03004003
...

A very underestimated command is "HWND -X", which gives you all the
informations you need about a window ; here's an example :
:hwnd -x notepad
Window Handle : (01B8) Level (1)
    Parent        : 16E7:000204CC
    Child         : 16E7:000235D8
    Next          : 16E7:00024F7C
    Owner         : NULL
    Window RECT   : (-4,-4) - (804,576)
    Client RECT   : (0,38) - (800,572)
    hQueue        : 238F
      Size        : 32
      QOwner      : NOTEPAD
    hrgnUpdate    : NULL
    wndClass      : 16E7:4184
    Class         : Notepad
    hModule       : NOTEPAD (1A07)
    lpfnWndProc   : 1467:0000033A
      ...

- with a BPR on the code of the application : when the DispatchMessage() 
function is called, you leave the message loop and start executing some 
code of the USER32 DLL. Most of the cases, the next piece of code of the
application that will be executed is the window procedure. Even if the 
window procedure's entry point is not contained in the application, this 
kind of breakpoint on the application is always interesting.

Note that you can easily find the memory space used as message queue,
since it uses its own selector. Here's an example :

:task
TaskName   SS:SP      StackTop  StackBot  StackLow  TaskDB  hQueue  Events
Stat32d    0000:0000  00CFD000  00D00000            2D1E    2B27    0000
...                                                         ^^^^

:ldt 2b27
Sel.  Type      Base      Limit     DPL  Attributes
2B27  Data16    80155B80  0000009F  3    P   RW

The message queue for the Stat32d application start at address 80155B80
and is 160 bytes large. For details about how messages are stored in the 
message queue's memory space, read Matt Pietrek's book (or files).

Finding the piece of code corresponding to a missing function can be
the most difficult part of the job, because here you have to mostly use
your intuition. Hopefully, most applications use the standard Windows 
dialog boxes for opening, printing and saving files. These are the 
COMDLG32 DLL's GetOpenFileName (for Open) , GetSaveFileName (for Save and 
SaveAs), PrintDlgA (for Print).


IV) HANDS ON

1) Cryptographic Analysis Program (CAP) 1.0

Location:     www.plu.edu/~spillmrj/cap.html
Description:  a basic cryptanalyis tool 
Limitations:  Save, SaveAs and Print functions are disabled
Language:     delphi

To register, you must send to the author a number (derived from your 
HD number) and he sends you back the correct code : a very nice thing 
for us, because we are sure we already have all the code.

Let's have a look at the imported APIs : for the "menus" part, we have
everything we want : CreateMenu(), EnableMenuitem(), InsertMenu(), 
RemoveMenu(), SetMenu(),... The message part is interesting : we find 
no GetMessage() imported, but the message queue is tested with 
PeekMessage() (maybe a specificity of delphi ?)

Let's put a breakpoint on EnableMenuItem() to see what functions are 
disabled : since MF_GRAYED value is 01, we just have to break for any 
flag whose bit 0 is set, that means with a 

:BPX EnableMenuItem IF ((@(ss:(esp+0c))&1)==1) 

Here are the calls to EnableMenuItem() that trigger the breakpoint :

 MenuId  0588 058C 058C 058C 05D4 05D4 0614 0614 0620 0620
 FctId    20   04   05   07   49   4A   51   52   56   57
 Flag     03   03   03   03   03   03   03   03   03   03
                   
In this case, all these functions are grayed and disabled (03h). 
He, but we see that only in menu 058C we find 3 disabled functions whose 
FctId values (04, 05, 07) correspond to the order of the 3 disabled 
functions we are interested in (Save, SaveAs, Print). With the STACK 
command, we find out that EnableMenuItem is invoked from 42639B for 
these 3 functions.

:00426383  mov    eax, dword ptr [4*eax+004996D8]   ; flag
:0042638A  or     eax, 00000000
:0042638D  push   eax
:0042638E  movzx  eax, word ptr [esi+34]
:00426392  push   eax                               ; function id
:00426393  mov    eax, edi
:00426395  call   00426194
:0042639A  push   eax                               ; menu handle
:0042639B  Call   EnableMenuItem

At line 426383, a lookup table seems to be used to get the flag 
corresponding to every function ; for our 3 disabled functions,
eax=0 and ds:[4996D8]=03 is used each time. Let's take Hiew,
and change this byte at .996D8 into 00 : now, all these functions 
are enabled.

Let's disassemble the program and search for an line containing 0111 
(WM_COMMAND) in the disassembled listing ; here's what we find :

:00423177  cmp   dword ptr [edx+04], 00000111  ; is it WM_COMMAND ?
:0042317E  je    004231A0                      ; yes : go on
:00423180  mov   esi, dword ptr [edx+04]
:00423183  cmp   esi, 00000200
:00423189  jle   00423193
:0042318B  cmp   esi, 0000020A
:00423191  jle   004231A0

Do you notice how the range 200-20A has a special meaning for this 
piece of code ? Well, a quick look at our message reference shows 
that this range contains all mouse related messages. This means that 
this piece of code is very likely to be a part of the message processing. 
So let just put a breakpoint to pop on any WM_COMMAND message :

:bpx 42317E if (ZFL==true)   

Now we click on Save... the breakpoint is triggered.
Let's trace a bit to see how the message will be processed. As expected, 
we soon reach a DispatchMessageA() procedure, where the message is 
sent to the appropriate window procedure.

To find this procedure, let's do something elegant, that means a  
little "breakpoint combo" :

:bc *
:map32 cap_prj          

Owner     Obj Name  Obj#  Address        Size      Type
CAP_PRJ   CODE      0001  0137:00401000  0009753C  CODE  RO
...

So we know that the code of this program is stored in memory
between 137:401000 and 137:49853C ; I therefore put a bpr on this
zone so that any piece of code from CAP_PRJ that is executed will
trigger this breakpoint. Then, 

:bpr cs:401000 cs:49853c r     
:bd 0                          
:bpx 42317E if (ZFL==true) do "g DispatchMessageA ; be 0; g"

The breakpoint at 42317E will trigger first when a WM_COMMAND message 
will be received. Then, it will process to the next DispatchMessageA 
procedure, enable the first breakpoint and run. From here only the 
code from DispatchMessageA() and its subprocedures will be executed, 
so BP0 will trigger on the first opcode executed from CAP_PRJ, which 
must be the window procedure entry point.

The breakpoint is triggered at 428F48 ; if we trace a bit, we find 
this piece of code :

:004266B4  push  ebx
:004266B5  cmp   byte ptr [eax+2D], 00      ; test a value
:004266B9  je    004266CC                   ; leave if 0
:004266BB  cmp   word ptr [eax+62], 0000    ; test another value
:004266C0  je    004266CC                   ; leave if 0
:004266C2  mov   ebx, eax
:004266C4  mov   edx, eax
:004266C6  mov   eax, dword ptr [ebx+64]
:004266C9  call  [ebx+60]
:004266CC  pop   ebx
:004266CD  ret

Let's see what happens at 4266B4 when we try a few options in the 
menu : 

Function  Status      EAX     [EAX+2D]    [EAX+62] 
---------------------------------------------------
Open     enabled    101ABD0      01          48
Save     disabled   101AEDC      00          48    
SaveAs   disabled   101AE58      00          48
Print    disabled   1019698      00          48
Exit     enabled    1018108      01          48

It's quite clear now, we just have to change the values at [eax+2D]
from 0 to 1 to enable the registered functions.


2) SigmaStat 2.0

Location:      www.spss.com
Description:   a statistical tool
Limitations:   Save disabled
Language:      C++ / MFC

This is a typical C++ program, but it uses the famous Microsoft 
Fundation Classes (MFC 3.0 here), and that changes everything ! MFCs 
really add a shell around your application to completely handle 
interaction with the user : the message loop, the window procedures and 
even all the common functions of a File menu (New, Save, Print...) are 
executed within the DLL.

Here's how menus are handled by MFC : every time you click on a menu, 
- MFC gets the menu handle via GetMenu(), then the number of items in 
  this menu via GetMenuItemCount().
- for each item of this menu, it checks if this starts a submenu via 
  GetSubMenu(). If a submenu is here, another sub-loop is entered,
  where it starts by getting the number of items via GetMenuItemCount().  
- for each item in any menu/submenu, MFC gets the messageID associated
  to this item via GetMenuItemID() and disable it if needed with
  EnableMenuItem().

Here's this last part (the ORD_3BF procedure at offset 6854h of 
MFC30.text segment) ; this piece of code is executed for each item

of each menu, and each time you select this menu :

:7FB27848  cmp    dword ptr [esp+10],01   ; should we disable ?
:7FB2784D  sbb    eax,eax                 ; yes / no     
:7FB2784F  and    eax,03                  ; keep the two lower bits
:7FB27852  mov    ah,04                   ; set MF_BYPOSITION
:7FB27854  push   eax                     ; pass the flag
:7FB27855  push   dword ptr [esi+08]      ; choose the function
:7FB27858  push   dword ptr [ecx+04]      ; choose the menu
:7FB2785B  Call   EnableMenuItem          ; enable or disable it

See what happens ? If the value at [esp+10] is zero, then the carry flag
is set and the SBB EAX,EAX instruction sets EAX at 0 minus 1 = FFFFFFFFh. 
If the value at [esp+10] is not zero, then the carry flag is not set and 
EAX is set to 0. As a result, the EAX value passed as flag is either 0403h 
(if [esp+10] was 0) or 0400h ; as usual, the two lower bits are the most 
important ones for us.

Tracing back where the [esp+10] value is set to 0, we quickly find this 
interesting piece of code :

:0040D599  mov    [ebp-04],ecx
:0040D59C  push   00              ; set the flag here !
:0040D59E  mov    eax,[ebp+08]    
:0040D5A1  mov    eax,[eax]
:0040D5A3  mov    ecx,[ebp+08]
:0040D5A6  call   [eax]           ; call 7FB27836 (to EnableMenuItem)               
:0040D5A8  jmp    0040D5AD        ; stupid compiler flush the PIQ :(
:0040D5AD  pop    edi
:0040D5AE  pop    esi
:0040D5AF  pop    ebx

This piece of code can be found 3 times in the code of Stat32, that's 
right 3 times the same piece of code, separated by a bunch of useless CCh
bytes ; obviously the Microsoft compiler use a standard "disable procedure"
that is just put as many times as necessary in the application's code.
Now there's something very interesting about that : if we replace the 
"push 00" by a "push 01", not only the items are enabled, but the 
corresponding functions are executed... the job is done :)

Just for fun (and knowledge), let's see how messages are processed by MFC ;
A breakpoint on GetMessageA() gives us the location of the message loop 
(in MFC30 DLL) :

:7FB24CEF  push   edi
:7FB24CF0  lea    esi,[ecx+30]
:7FB24CF3  mov    edi,ecx
:7FB24CF5  push   00                          ; (0,0,0) <=> get all the
:7FB24CF7  push   00                          ; messages
:7FB24CF9  push   00
:7FB24CFB  push   esi                         ; message buffer offset
:7FB24CFC  call   GetMessageA                 ; get message from the queue
:7FB24D02  test   eax,eax                     ; WM_QUIT received ?
:7FB24D04  jz     7FB24D31                    ; yes : leave program
:7FB24D06  cmp    dword ptr [edi+34],0000036A ; message 36A received ?
:7FB24D0D  jz     7FB24D29                    ; yes : ignore it
:7FB24D0F  push   esi
:7FB24D10  mov    eax,[edi]
:7FB24D12  mov    ecx,edi
:7FB24D14  call   [eax+38]                    ; handling of 201h and 202h
:7FB24D17  test   eax,eax                     ; (mouse-related messages)
:7FB24D19  jnz    7FB24D29
:7FB24D1B  push   esi
:7FB24D1C  call   TranslateMessage            ; translate keyboard inputs
:7FB24D22  push   esi
:7FB24D23  call   DispatchMessageA            ; send message to wndproc
:7FB24D29  mov    eax,00000001
:7FB24D2E  pop    edi
:7FB24D2F  pop    esi
:7FB24D30  ret

Let's try to break in this message loop when a WM_COMMAND message is 
received ; therefore we will watch the message buffer. The ESI value at 
line 7FB24CFB is always 5D7048, and this is pointing to a data section 
of Stat32d. There starts a MSG structure where every message taken from 
the queue is temporarly stored before being processed ; at offset 4 of 
this structure is stored wParam. So to break on a WM_COMMAND message we 
can use a :

:bpx 7FB24D02 if (@(ds:(5D704C))==0111)

Now if we try the same combo as in CAP, we get lost, because we are just 
bouncing between MFC30.DLL code and the program's lookup table.

Let's try the dead-listing method : we disassemble MFC30.DLL and use the 
same method, that means searching for "00000111" ; here's the first hit :

:7FB21074  cmp   ebx, 00000111    ; 111h = WM_COMMAND
:7FB2107A  je    7FB2110C
:7FB21080  cmp   ebx, 0000004E    ;  4Eh = WM_NOTIFY
:7FB21083  je    7FB21138
:7FB21089  cmp   ebx, 00000006    ;  06h = WM_ACTIVATE
:7FB2108C  je    7FB21176

We can stop here, this is the good one. Why ? Because in every MFC 
application, message processing is splitted between the CCmdTarget objects 
that handles WM_COMMAND, WM_NOTIFY and WM_ACTIVATE (CN_UPDATE_COMMAND_UI) 
and the CWin objects that process most of the other Windows messages. The 
values of the 3 first messages are found here, so this must be the piece of 
code we are looking for. If we look 7FB2110C, it's quite promising :

:7FB2110C  mov    ecx,[ecx]
:7FB2110E  mov    esi,[ebp+10]   ; lParam is the first parameter
:7FB21111  push   esi            ; 
:7FB21112  mov    edi,[ebp+0C]   ; wParam is the second one
:7FB21115  push   edi            ; 
:7FB21116  mov    [ebp-14],ecx
:7FB21119  mov    ecx,[ebp-10]
:7FB2111C  mov    eax,[ebp-14]
:7FB2111F  call   [eax+48]       ; call WM_COMMAND processing

Ok, now we trace a bit in the WM_COMMAND processing to find where all 
different messages are routed, and we quickly find this piece of code :

:7FB29DBF  push   00
:7FB29DC1  mov    eax,[esi]      ; get adress
:7FB29DC3  push   00
:7FB29DC5  mov    ecx,esi
:7FB29DC7  push   ebp
:7FB29DC8  push   edi
:7FB29DC9  call   [eax+14]       ; execute the function

Look at this nice lookup table, it's just a pure array of code offsets, which
is the core of the message routing mechanism :

:005E7664 72 87 5A 00 32 82 5A 00-C0 F4 44 00 2C 82 5A 00  r.Z.2.Z...D.,.Z.
:005E7674 26 82 5A 00 20 82 5A 00-1A 82 5A 00 14 82 5A 00  &.Z. .Z...Z...Z.
:005E7684 6C 87 5A 00 10 F1 44 00-02 82 5A 00 FC 81 5A 00  l.Z...D...Z...Z.
:005E7694 F6 81 5A 00 66 87 5A 00-EA 81 5A 00 E4 81 5A 00  ..Z.f.Z...Z...Z.
:005E76A4 90 29 40 00 60 87 5A 00-DE 81 5A 00 5A 87 5A 00  .)@.`.Z...Z.Z.Z.
:005E76B4 D2 81 5A 00 CC 81 5A 00-C6 81 5A 00 80 EF 44 00  ..Z...Z...Z...D.
:005E76C4 BA 81 5A 00 54 87 5A 00-AE 81 5A 00 A8 81 5A 00  ..Z.T.Z...Z...Z.
:005E76D4 4E 87 5A 00 9C 81 5A 00-48 87 5A 00 42 87 5A 00  N.Z...Z.H.Z.B.Z.

A trained eye could recognise this kind of lookup tables just by looking at the
hex dump of the code section. Indeed, since these are all word-aligned offsets 
to the application's code, so you will always find 4 pairs of columns equal to 
"XX 00" (where XX is the first byte of the offset) at offsets 2, 6, 10 and 14 
of this table.

:map32 stat32d
Owner     Obj Name  Obj#  Address        Size      Type
STAT32D   .text     0001  0137:00401000  001D5784  CODE  RO

Here, XX can have any value between 40h and 5Dh, which are all printable 
chars, but as you see most of the times you find ("Z",00h) pairs.

Reversing a MFC disabled target can be very painful, because most of the 
work is done in the DLL while, even if you switch to/from the application 
very often. Not to mention that both MFC DLL's code and the code inserted by 
MFC in your application are ugly.


3) BestWin

Location: reverser.org/jn_essay.htm
Description:  an encryption tool
Limitations:  the Decrypt function is disabled (that's annoying :)
Language:     C (compiled with a french version of lcc-win32 2.4 in his 
                 c:\lcc\bestwin directory :)

Before the fortress' attack, Jeremy Likness proposed a software cracking 
challenge, quite pretentiously called "New Chaos Protection", to protect 
an implementation of his encryption algorithm (which is also weak btw, 
but that's another story). Here follows a description and a quick crack 
of his method.  

A quick disassembly in W32dasm gives these interesting menu references :

MenuID_0258
      File {Popup}
           Encrypt  [ID=00C8h]
           Decrypt  [ID=00D2h]
           Set Key  [ID=00DCh]
           Exit     [ID=012Ch]

The MenuID value for "Decrypt" is D2h, so let's search for "000000D2" in the 
disassembled listing :

:00402677  cmp    dword ptr [ebp+0C], 000000D2  ; Decrypt asked ?
:0040267E  je     004026B1                      ; yes : go on
 ...
:004026B1  push   755647E4                      
:004026B6  call   PROT._pGetFuncbyCode          ; which code to run ?
:004026BB  add    esp, 00000004                 
:004026BE  mov    dword ptr [ebp-04], eax       ; EAX = code offset
:004026C1  call   [ebp-04]                      ; execute our code
:004026C4  jmp    004026EA

When "Decrypt" is selected, BestWin asks PROT.DLL (via 
PROT._pGetFuncbyCode) which piece of code is associated to this 
function, then it runs it. 

Let's load BestWin in SoftIce to have a closer look at this 
_pGetFuncbyCode... what ? SoftIce is asking for source files ?? 
Looks like Jeremy forgot to remove the symbols :) Let's have a look :

:sym
.text(014F:00401000, 00002B88 bytes)
      0137:00401ABA _Decrypt
      0137:004028A4 _DefaultFunc
      0137:00401E4F _EnableDecrypt
      0137:00401CC4 _SetKey
        ...

Hehehe, our job is done : the _Decrypt label at 401ABA is the beginning 
of the decryption routine. Therefore, we only need to associate this 
piece of code to the "Decrypt" function of the menu in the WM_COMMAND 
message processing, just like that :

004026BE  E8F7F3FFFF    call 401ABA  ; _Decrypt procedure
004026C3  90   
 
>
<HR><H3>Transfer interrupted!</H3>


We also need to enable the Decrypt function in the menu ; _pGetFuncbyCode 
is also used to "hide" functions that does not belong to any menu. For 
instance, when you set the key, this piece of code is run :

:00401E1C  push   75564714
:00401E21  call   PROT._pGetFuncbyCode
:00401E26  add    esp, 00000004
:00401E29  mov    dword ptr [ebp+FFFFFBAC], eax
:00401E2F  call   dword ptr [ebp+FFFFFBAC]

If we are registered, the _EnableDecrypt function is executed, which 
ungray Decrypt in the menu. If not, the infamous messagebox is displayed.

As you see, we did not even have to study PROT.DLL to nullify this protection, 
we simply had to replace the relative calls by the absolute correct ones, just 
like this :

00401E2F  E81B000000    call 401E4F  ; _EnableDecrypt procedure  
00401E34  90            nop 

His protection is based on a dialog between the main program (BestWin) 
and its protection DLL (PROT.DLL) : first, the "you must register" 
messagebox is set as default function (via PROT._SetDefaultFunc).
Then, when a registered item is selected, BestWin asks PROT.DLL (via 
PROT._pGetFuncbyCode) which piece of code to run. If we are not 
registered, the offset of the default function is returned, and 
the evil message is displayed.

Another major error is that all the functions are first defined 
(via PROT._AddFunc) with the offset of the correct piece of code 
(so that _pGetFuncbyCode knows the correct offset to give back 
to registered users).

A pretty interesting idea, badly implemented : quite disappointing 
for such a hype name. 


4) Flipper 

Location:     crackmes.cjb.net
Description:  crackme
Limitation:  File menu is grayed for the first 10 seconds
Language:     Visual Basic 5.0

Well, this is not a full "disabled functions" protection, but it is
small and does everything we need to understand how VB handles menus.
Visual Basic handles all the GUI by itself, so that the coder has no
idea what is done ; so we can assume that all VB programs define 
menus the same way. All is done in the __vbaI4ErrVar function.

First some empty menus are created with CreateMenu(). Then each menu and
each item are added with InsertMenuA() ; note that all the parameters 
of InsertMenuA() are stored in a structure based on EBP ; actually, EBP 
gets only two values in this piece of code, one for all the items and one 
for all the menus.

:0F05191A  push  [ebp-10]                ; address of menuitem text string
:0F05191D  push  [ebp-0C]                ; handle of the new item
:0F051920  mov   eax, dword ptr [ebp-08] ; get flag
:0F051923  or    ah, 04                  ; add MF_BYPOSITION
:0F051926  push  eax                     ; pass the new flag  
:0F051927  push  [ebp+18]                ; the position of the new item
:0F05192A  push  [ebp+0C]                ; menu handle
:0F05192D  call  InsertMenuA

The first parameter (menu handle) is returned by a previous call to 
CreateMenu(). The second parameter (position) is always 0FFFFFFFFh, 
so that each new item is always appended to the existing menu. 
The third parameter (flag) has a default value equal to 0, which is 
reloaded after each item insertion. The fifth parameter (menuitem string)
is just copied from the menu definition (see "Reversing a menu definition").
The most interesting parameter is obviously the fourth one, the item's 
message ID. As we saw before, it's not stored in the menu definition, 
contrary to what most of the other languages do. Here VB is tricky, because 
it distributes message IDs at run-time, by this piece of code :

:0F051834  mov   eax, dword ptr [ebx]         ; get previous ID message
:0F051836  inc   eax                          ; increment 
:0F051837  mov   word ptr [edi+000000D0], ax  ; 
:0F05183E  mov   dword ptr [ebx], eax         ; store new ID message

For instance, here's the message distribution for this application :

1 : Menu "File"     
2 :   Item "SaveText" 
3 :   Item Separator
4 :   Item "Exit"
5 : Menu "About"
6 :   Item "Register"
7 :   Item "About"  

It's clear and simple (something surprising from Visual Basic).

When you start the application, the "File" menu is grayed for 10 seconds.
A breakpoint on InsertMenuA() show that when the menu is created, the flag 
used is 400h (MF_BYPOSITION), so that the menu is enabled ; later, the menu
is grayed using EnableMenuItem() with a 403h flag. After 10 seconds, the
same API function is used again to ungray the menu. For now, let's skip the
ungraying part and focus on the message routing (you'll see later why) :

:hwnd app1
Window Handle   hQueue  SZ  QOwner    Class Name            Window Procedure
 0E2C(1)        0D87    32  APP1      ThunderRT5Form        1497:000007DE
  0E30(2)       0D87    32  APP1      Edit                  1497:000007DE
  0E34(2)       0D87    32  APP1      ThunderRT5Timer       1497:000007DE
  ...

All window procedures' adresses are pointing to the KERNEL DLL, so to find 
which part of app1 is involved in menu handling, we will use again a breakpoint 
on the application's code :

:map32 app1
Owner     Obj Name  Obj#  Address        Size      Type
APP1      .text     0001  014F:00401000  000069A4  CODE  RO

:bmsg 02EC WM_COMMAND do "bd * ; bpr 14f:401000 14f:408000 r ; g"

The breakpoint is triggered in MSVBVM50.DLL, at F03A2FD, where the
adress of the window procedure is fetched from a table in app1.

:0F03A2F8  mov    ecx,[eax]                ; get table base address
:0F03A2FA  mov    eax,[ebp+14]             ; get item
:0F03A2FD  push   dword ptr [eax*4+ecx+0C] ; calculate address
:0F03A301  call   0F03A546

and if we trace a bit, we find this piece of code :

:0F01E597  mov    eax, dword ptr [ebp+08]  ; get address from stack
...
:0F01E5A7  call   eax                      ; go !

All the EAX values lead to a kind of table structure, where we jump 
to the real window's procedure, after the first stack parameter 
is adjusted to a fixed value (4114C5) :

:004024FB  sub   dword ptr [esp+04], 00000033  ; About item
:00402503  jmp   00403B0A
:00402508  sub   dword ptr [esp+04], 0000004F  ; Register item
:00402510  jmp   00403CC9
:00402515  sub   dword ptr [esp+04], 00000057  ; Exit item
:0040251D  jmp   00403DDF
:00402522  sub   dword ptr [esp+04], 00000047  ; SaveText item
:0040252A  jmp   00403E43
:0040252F  sub   dword ptr [esp+04], 0000003F  ; triggered each second
:00402537  jmp   004040A1                      ; during 10 s countdown
:0040253C  sub   dword ptr [esp+04], 0000004B  
:00402544  jmp   0040425E

For the SaveText item, we jump at 402508, then at 403CC9.

Now let's find which piece of code we would like to execute : well, the 
rtcMsgBox is called at 404030, and just a bit upper, we find this 
interesting API calls :

:00403FE0  call  __vbaFileOpen
...
:0040400F  call  __vbaPrintFile
...
:00404029  call  __vbaCloseFile

and again a bit upper, this part :

:00403E85  mov   ax, word ptr [00408030]  ; registered flag
...
:00403E8D  cmp   ax, 03FB    ; bigger than 3FBh ? 
:00403EC4  jnl   00404035    ; yes : do nothing 
:00403ECA  cmp   ax, 001B    ; smaller than 1Bh ?
:00403ECE  jle   00404035    ; yes : do nothing           
:00403ED4  cmp   ax, 00FE    ; min registered value 
:00403ED8  jle   00404030    ; yes : go to rtcMsgBox

Just change [408030] into FFh, and it's done. 

Ok, now let's ungray this File menu : we saw that the initial state of 
this item is "enabled", and that it is grayed afterwards. And guess how ?
It's done by using the same table : 

:004024D4  sub   dword ptr [esp+04], 00000037   ; gray File menu  
:004024DC  jmp   00403A04

This is a nice place to patch ; let's replace this JMP to the graying function 
by a harmless one. Oh, but look how the next lines look interesting :

:004024E1  sub   dword ptr [esp+04], 0000FFFF
:004024E9  jmp   00403B00
:004024EE  sub   dword ptr [esp+04], 0000FFFF
:004024F6  jmp   00403B05

Not only is the FFFFh value a bit strange, but between the two JMPed addresses
there are only 5 bytes ; let's see what code is at 403B00 : 

:00403B00  xor   eax, eax
:00403B02  ret   0004

Well, it looks harmless enough to me, so we just patch at 4024DC to force a jump 
to this address, and everything works fine.

Most of the times, programs that display a message box for disabled functions 
are much easier to reverse than those that use grayed items. Indeed, in this 
case, lazy protectionists will use a switch between real and fake code after 
message decoding instead of trying to (for instance) modify the menu definition.
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>
</fonT></center></td></tr></table>
<pre>
I hope that you now have a good overview of how menus work ; of course, comments 
and corrections are welcome. This is really a large subject, and there are still 
plenty of interesting things to talk about in this field (subclassing, superclassing, 
adding functions, ...) ; if you're interested in this subject, I suggest that you have 
a look at +HCU project 6 and Reverser+'s filemon essays. Good night, dear reader.


+Spath. (Spath@iname.com) (05/99)   
                                      

Greetings:
+ORC, Reverser+, +Greythorne and all +HCU members.
+Frog's Print, BeLZeBuTH, Ethan, CyberbobJr, KellogS, Jeff, Rhayader, Eternal Bliss, 
CrackZ, Iczelion, Virogen.

All my admiration goes to Razzia+, Stone, mammon_, Iceman, Quine and 
especially to The Owl. Thanks for giving me inspiration.

</pre>
<br>
<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->

</prE>

<hr><center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:<br><br></i></center>
<br>
<center><bR><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=88% HEIGHT=6 BORDER=0
VSPACE=0 HSPACE=0><br><br>
<!-- Begin Javascript relocator <font color=red>~</fonT> Javascript code by reverser+ -->
<form name="ReversersForm">
<script language="JavaScript">
<!--

function FravPage(list) {
	      location.href = list.options[list.selectedIndex].value
}

// -->
</script>
<div align="center">
<center>
<p center="&lt;center&gt;&lt;/center&gt;">&nbsp;<select name="fraviale" size="1">

<option>Choose another page!</option>
<option value="index.htm">Main page</option>
<option value="academy.htm">Software reversing Lab</option>
<option value="realicra.htm">Reality cracking Lab</option>
<option value="noanon.htm">Anonymity Lab</option>
<option value="ideale.htm">Site busting Lab</option>
<option value="howtosea.htm">How to search Lab</option>
<option value="sealight.htm">--Search engines (light)</option>
<option value="searengi.htm">--Search engines (heavy)</option>
<option value="links.htm">Links</option>
<option value="tools.htm">Tools</option>
<option value="javascri.htm">Javascript reversing</option>
<option value="screamin.htm">Screaming truth</option>
<option value="entran.htm">Main entrance</option>
<option value="new_what.htm">What's new on reverser's</option>
<option value="info.htm">Mail reverser+</option>
<option value="http://greythorne.home.ml.org">+Greythorne's</option>
<option value="http://www.InsideTheWeb.com/mbs.cgi/mb186724">Tools of our trade msgboard</option>
<option value="http://www.InsideTheWeb.com/mbs.cgi/mb155985">Main msgboard</option>
</select>

<input type="button" value="Let's go!" onclick="FravPage(this.form.elements[0])">
<br>
</div>

</form>
<!-- end Javascript relocator -->
<bR><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=88% HEIGHT=6 BORDER=0
VSPACE=0 HSPACE=0><br><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0>
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=BOTTOM
BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13"><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</A>

<bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0
VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?
</A></CENTER>
<hr size=4>

</body>
</HTML>
<HTML>
                 <HEAD>
                 <!--  formamus.htm version 02 February 1998 
                       INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
                       SEARCH THIS TEXT FOR THE STRING "Your_" 
                       AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
                       THANKS A LOT: this will allow automated retrieval -->
                 
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>Linux cracking</TITLE>
                 </HEAD>

                 <BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%
                 HEIGHT=" 22">
                 <TR><td></td>
                 <td>
                 <center><FONT SIZE="+2">Linux cracking</fonT><br>
                         <FONT SIZE="+1">How to crack in Linux without a
                 disassembler</fonT>
                 </center>
                 </td>

                 <td>
                 <!-- Choose  a PROJECT GIF, leave this if unsure -->
                 <center><a href="student.htm#student_loo_na" tppabs="http://members.xoom.com/tsehp_/student.htm#student_loo_na"><IMG SRC="images/notassi3.gif" tppabs="http://members.xoom.com/tsehp_/images/notassi3.gif"
                 ALT="student" 
                 ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
                 HSPACE=0></a>
                 <br>
                 <font color=gray>Not Assigned</FonT>
                 </center></td></tr>
                 <tR>
                 <td bgcolor="#FFFFEA"><center>
                 <FONT COLOR="890000">
                 <!-- CHOOSE A DATE (will probably be changed) -->
                 26th October 1998
                 </FONT></center>
                 </td>
                 <td bgcolor="#FFFFEA"><center>by <font size=+3>
                 <!-- CHOOSE A HANDLE (wont be changed) -->
                 adq
                 </fonT></center>
                 </td>
                 <td VALIGN="center" bgcolor="#FFFFEA">
                 <!--
                 <a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
                 WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
                 -->
                 </td>
                 </tr>
                 <TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
                 ALIGN="BOTTOM" 
                 BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
                 <TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
                 reverse engineering</center> 
                 </center></TD>
                 <td BGCOLOR="898030">
                 <center>
                 </center></td>
                 </TR>
                 <!-- this is for the
                 data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
                 <tr><td><font
                 color="#C4C0CF">fra_00xx<bR>98xxxx<br>handle<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>
                 Well, well: adq is back with a Linux reversing essay that will surely 
be welcome among the rapidly growing community of Linux users among my readers (I wonder how comes that noone that 
made the 'great sprung' and went from windoze to Linux, happened to go back to Windoze :-) 
As a matter of fact many good reversers are (almost) not publishing essays any more because they 
have lost any interest whatsoever in windozed targets... in fact -as you should know- 
if you'r seriously working (and not just playing with a mouse) you can work in Linux 
QUICKER, BETTER, and with a greater efficacity... I guess that the last one of my readers 
 remaining in windoze will have soon to turn the lights off in an empty room... 
you don't believe me? Look 
better around you: see Micro$oft's building over there? Getting dark isn't it? That's 
because there 
are less and less people behind 
its windows... :-)
                 </i></center></td>
                 <td></td>
                 </tr>
                 <TR><td></td>
                 <!-- Leonard Coehn's old song, because we are poets, not only crackers
                 -->
                 <TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in
                 everything 
                 That's how the light gets in</b></center>
                 <!-- Leonard Coehn's old song, because we are poets, not only crackers
                 -->
                 </center></TD><td></td>
                 </TR>
                 <TR>
                 <td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
                 Rating</FONT></FONT></center>
                 </TD>
                 <td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
                 <!-- CHOOSE A RATING (may be changed) -->
                 ( )<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> (
                 )<B>Expert</B></FONT>
                 </center></td>
                 <td></td>
                 </tr>
                 </table>
                 <!-- END HEAD  -->
                 <bR>
                 <!-- CORPUS  -->

                 <!-- CHOOSE A COMMENT (may be changed)  -->
                 This is for anyone running linux with gcc and who knows a bit of C.
                 <hR>
                 <center>
                    <FONT SIZE="+2">
                 <!-- CHOOSE A TITLE (wont probably be changed) -->
                 Linux cracking
                    </FONT><BR>
                    <FONT SIZE="+2">
                 <!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
                 How to crack in Linux without a disassembler
                    </FONT><BR>
                    <FONT COLOR="0B7FC1">
                 <!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
                 adq
                    </FONT>
                 </center><br><br>

                 <!-- INTRO STARTS HERE -->
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
                 HEIGHT="22" >
                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font
                 color=blue>Introduction</fonT>
                 </fonT></center></td></tr></table>
                 The following describes how to modify the behaviour of a linux program
                 by 
                 replacing any external library functions it uses.
                 <br><br>

                 <!-- TOOLS STARTS HERE -->
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
                 HEIGHT="22" >
                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools
                 required</fonT>
                 </fonT></center></td></tr></table>
                 Linux, gcc, emacs
                 <br><br>


                 <!-- REAL ESSAY  STARTS HERE -->
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
                 HEIGHT="22" >
                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font
                 color=blue>Essay</fonT></fonT>
                 </center></td></tr></table>
                 I have been reading the various other essays on linux, but no one else
                 seems to have mentioned this very easy way of modifying a compiled
                 program's
                 behaviour... without even looking at a disassembly.<P>

                 First of all, write a demo program, called timetest:<BR>

                 <PRE>
                   #include &lt;stdio.h>
                   #include &lt;time.h>

                   int main(int argc, char* argv[])
                   {
                     time_t curTime;
                     struct tm *curTimeDecoded;

                     time(&curTime);
                     curTimeDecoded = localtime(&curTime);
                  
                     if (curTimeDecoded->tm_year > 95)
                       printf("Too late\n");
                     else
                       printf("In time\n");
                   }
                 </PRE>

                 Put this in a file, "timetest.c", and compile as follows:<BR>
                 <PRE>
                         gcc -o timetest timetest.c
                 </PRE>

                 You will end up with a program which checks the year. If the year
                 is more than 1995, it will print "Too late". If less than or equal to
                 1995, it prints "In time".

                 To patch this in windows so that it always prints "In time", would be
                 a simple
                 matter of loading the thing into a debugger, tracing through it to
                 find the
                 call & patching it. Or perhaps you prefer to use a dead-listing and
                 IDA.<P>

                 On linux, there is another, much easier way. Edit a new file, this
                 time
                 called "time.c", and put the following in it:
                called "time.c", and put the following in it:
                 <PRE>
                   #include &lt;time.h>
                   #include &lt;stdio.h>

                   time_t time(time_t* tp)
                   {
                     printf("haha\n");
                   
                     return(2000);
                   }
                 </PRE>

                 As you can see, this is a replacement time() function, which prints
                 "haha", and
                 returns a system time of 2000.<P>

                 This time, compile it as follows:<BR>
                 <PRE>
                         gcc -c time.c -o time.o
                         ld -shared -o time.so time.o
                 </PRE>

                 The second line transforms the normal object file produced by the
                 first line
                 into a shared object library. This step is essential, or you will end
                 up with strange errors such as "ELF file's phentsize not the expected
                 size".<P>

                 Now, to fix the program, type "export LD_PRELOAD=./time.so". This
                 instructs
                 the linux runtime linker (ld.so* or ld-linux.so*) to look in this
                 library
                 for functions before consulting the normal system libraries, when it
                 is
                 attempting to satisfy the program's dependencies.<P>

                 Run the program, and it will print "haha", followed by "In time", no
                 matter
                 what the system time is. Be warned though... since you exported
                 LD_PRELOAD,
                 this will affect every program in your current shell until you either
                 unset 
                 LD_PRELOAD, or exit the shell.<P>

                 However, there is a slight problem. If you only want to fiddle the
                 times on certain occasions, but use the normal time() call on others,
                 you 
                 cannot simply call time() - that will call yourself and you will end
                 up with 
                 a nasty recursive loop. The way I got round this was by finding the
                 import
                 table in the ELF binary, and changing the name of the function it
                 imports
                 from "time" to something like "Xime". Then, I wrote my own version of
                 Xime,
                 which is obviously then free to call the real time() function, since
                 we
                 haven't overridden it. This can all be done within emacs, using normal
                 text
                 search & replace. There is probably a better way to do this though.<P>




                 <br><br>

                 <!-- FINAL NOTES STARTS HERE -->
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
                 HEIGHT="22" >
                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final
                 Notes</fonT>
                 </fonT></center></td></tr></table>
                 I wish windows could do this :)
                 <br><br>

                 <!-- OB DUH STARTS HERE -->
                 <TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"
                 HEIGHT="22" >
                 <tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob
                 Duh</fonT></fonT>
                 </center></td></tr></table>
                  <center>
                    <i>doesn't apply</i>
                 </center>

                 <!-- WAY OUT STARTS HERE -->
                 <hr>
                 <center><i>You are deep inside reverser's page of reverse engineering,  
                 choose your way out:</i></center>
                 <br><center>
                 <!-- EITHER A NICE GIF LIKE THIS -->

                 <!-- 
                 <a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
                 ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
                 HSPACE=0></a>
                 <br>
                 <font color=gray>Back to project 3</FonT>
                 <br><bR>
                 -->

                 <!-- OR JUST A LINK LIKE THIS -->

                 <!--
                 <IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to
                 Your_chosen_project</A> 
                 <hr width=33%>
                 -->

                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
                 <br>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
                 <br>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A
                 HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
                 <br>
                 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
                 BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering
                 legal?</A>
                 </CENTER>
                 <hr>
                 <!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
                 </BODY>
                 </HTML><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>luring.htm: Enemy investigation: how to lure your enemies on the web
</title>
</head>
<body bgcolor="C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<a name="top"><center>
<table CELLPADDING="4" CELLSPACING="0">
<tr>
<td colspan=3><center><font size=+4>Luring and social engineering tricks</fonT></tD></tR>
<tR><td><center><a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"><img SRC="images/anon1.gif" tppabs="http://members.xoom.com/tsehp_/images/anon1.gif" ALT="noanon" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a></center></td><td><center>...<cnter></tD>
<td><center>  
<a href="luring.htm" tppabs="http://members.xoom.com/tsehp_/luring.htm"><img SRC="images/luring.gif" tppabs="http://members.xoom.com/tsehp_/images/luring.gif" ALT="luring" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a>
</center></td></tR><tR><tD><center><font color="gray">Reverser's Anonymity Academy</font>
</center></td><td><center>(Updated: June 1999)</center></td><td><center>
<font color="gray">Luring and social engineering</font></center></td></tr></table>
<table><tr>
<td><IMG SRC="images/luringb.jpg" tppabs="http://members.xoom.com/tsehp_/images/luringb.jpg" ALT="Found?..." 
ALIGN=LEFT WIDTH=305 HEIGHT=434 BORDER=0 VSPACE=0 HSPACE=0>
<br></tD>
<td>
<center>
<h1>Luring and social engineering</h1></center>
<center><font size=+2><i>(Reverser shows you what you can do - or try - and where you can learn some 
advanced luring techniques)</i></font>

 <br>~<br>
Enemy tracking, a very difficult art, can be divided into stalking, reversing language patterns and luring. In order to 
stalk you need a deep knowledge of Usenet spamming (and war) techniques like flaming, 
trolling and crossposting. A good reverser can moreover easily 'reconstruct' (part of) the 
snailtrail of his 
enemies and defeat their smoke curtains  
applying some easy semantical reverse engineering tricks. Finally the reverser will 
lure his targets into the open web and identify it.
<hr width="33%">
<a href="statoo.htm" tppabs="http://members.xoom.com/tsehp_/statoo.htm">0) Some simple stalking tools</a><bR>
<a href="enemy.htm" tppabs="http://members.xoom.com/tsehp_/enemy.htm">1) General stalking techniques</a><bR>
<a href="staltec1.htm" tppabs="http://members.xoom.com/tsehp_/staltec1.htm">1.1) Simple email stalking techniques</a><bR>
<a href="lanpat.htm" tppabs="http://members.xoom.com/tsehp_/lanpat.htm">2) Reversing language patterns</a><bR>
<a href="luring.htm" tppabs="http://members.xoom.com/tsehp_/luring.htm">3) Luring and social engineering tricks</a><bR>
<hr width=33%>
</CENTER>
</Font>

</Td>

</TR>
</TABLE>
</center>
<!-- Fun with colors End -->
<br>

<hr size="3"><center><h1>
Luring and social engineering</H1>
</center>
The various techniques of Luring (preparation, page-setting, bait-tracking, multiple luring) are described <font color=blue><u>on a page of my site</u></fonT> that has NOT yet 
been opened, for 'ethical' reasons (I will have to devise an 'ethical' strainer to 
allow access there, but I do not have the time at the moment). Yet there are some essays 
about social engineering that I wish to publish. And you'll still find something in 
this 'in fieri' Luring Lab...<hR>
<a href="social_1.htm" tppabs="http://members.xoom.com/tsehp_/social_1.htm">social_1.htm</a>: An example of social engineering, 
one of the easiest ways to gather informations, by _A&amp;T, June 1999




<hr size="3"><center>
<!-- Begin mover -->
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="pageadvi.htm" tppabs="http://members.xoom.com/tsehp_/pageadvi.htm">reverser's antispam related page</a>
 <hr width=33%>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>
<br>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots wars</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI tricks</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript tricks</a>
<br> 
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
 <img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  HEIGHT="13" WIDTH="13" ALT="red"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is software reverse engineering illegal?</a>
</center>
<!-- End mover -->
<hR>
<!-- Begin signet -->
<Font color=green><a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"  ALT="red" WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 
HSPACE=0></a>(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998, 1999.</font> 
All rights reserved
<HR ALIGN=CENTER WIDTH=100% SIZE=3>

</body>
</html>


<html>
<head>
<title>siul</title>
</head>

<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<a NAME="anchortop"></a>
<!-- HTML code by Reverser, Yeah, go ahead, steal my code, sucker -->

<h2><center>
CRACK FOR PRO PINBALL (The Web)</h2><br>
   by siuL Hacky, April 1997<br>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<i>Courtesy of reverser's page of reverse engineering</i>
</center>
<hr size="3">
<pre>

I like specially pinball games, they are also a good chance to find good software
(what?). In pinball fantasies there was a good assembler work, and an old 286
seemed to be right with that program. But it was before my slavery life, and now 
that I am free again I have discovered new good pinballs. The best of all is my 
cracking target: Pro Pinball The Web. A really cool game by Empire. They offer to the 
poor world a demo of 60 seconds and one ball, and I am gonna show you we can enjoy 
the usual 3 balls and endless time (si tienes un poco de habilidad con los palicos).
The exe-file cracked is 342.555 bytes, pro-pinball v1.40x and I've lost the 
original date.
	I have used a mixed method (dead listing and Softice 3.0) coz both of them are
necessary (es mas yo diria imprescindibles). If you don't know the game 
(download it right now in <a href="FRAVIA_index.htm#205" tppabs="http://members.xoom.com/tsehp_/index.htm#205">http://www.empire.co.uk</a>) 
it shows a counter with the seconds (que error mas pardillo) in a state-of-the-art dot 
matrix. We can  also be aware that the actual ball has been manipulated and we are in 
the third and last ball.
	The easiest job of the crack is to disable the time protection. If we run the 
game under SIce, we break it when the countdown is active, and it's easy to search 
for some of the strings such as CREDITS, BALLS and so on. Very close to them we find 
the ASCII values of the seconds count. We breakpoint them, so we find something like 
this routine (is taken from Wdasm7  listing . All the listings are taken from dasm):
	(the memory locations are gonna be different, of course)

:0001750C A1B06C0000              mov eax, [00006CB0];load counter
:00017511 85C0                    test eax, eax         ;jump if 0
:00017513 7457                    je 0001756C
:00017515 89C2                    mov edx, eax          ; edx=counter
:00017517 C1FA1F                  sar edx, 1F           ; edx=0
:0001751A C1E20F                  shl edx, 0F           ; edx=0
:0001751D 1BC2                    sbb eax, edx
:0001751F C1F80F                  sar eax, 0F           ; eax/=32k
:00017522 89C2                    mov edx, eax          ; edx=seconds
:00017524 B90A000000              mov ecx, 0000000A
:00017529 C1FA1F                  sar edx, 1F           ; edx=0
:0001752C 89C3                    mov ebx, eax          ; ebx=seconds
:0001752E F7F9                    idiv ecx              ; eax=tenths
:00017530 89C2                    mov edx, eax          ; edx=tenths
:00017532 C1FA1F                  sar edx, 1F           ; edx=0
:00017535 F7F9                    idiv ecx              ; edx=tenths
:00017537 A148270000            mov eax, [00002748]; eax=offset_asci_ten
:0001753C 83C230                  add edx, 00000030     ; tenths is ascii
:0001753F 8810                    mov [eax], dl ; write tenths
:00017541 89DA                    mov edx, ebx          ; edx=seconds
:00017543 89D8                    mov eax, ebx          ; eax=seconds
:00017545 C1FA1F                  sar edx, 1F           ; edx=0
:00017548 F7F9                    idiv ecx              ; edx=units
:0001754A A148270000            mov eax, [00002748]; eax=offset_asci_ten
:0001754F 83C230                  add edx, 00000030     ; units in ascii
:00017552 885001                  mov [eax+01], dl      ; write units

Don't worry about the useless SARs, they are not important  in this phase of the 
game (they are useful when the program doesn't want the counter to be seen anylonger). 
In our case, the counter is located in [6cb0]. IN YOUR CASE IT'S GONNA BE DIFFERENT 
(ya se que lo sabes, pero otra gente no lo sabra). We just have to breakpoint the 
tick counter and we get:

:0000DE7F A1C07F0000              mov eax, [00007FC0]
:0000DE84 8B1DB06C0000            mov ebx, [00006CB0] ;<<<<< :0000DE8A 29C3 sub ebx, eax :0000DE8C BAB06C0000 mov edx, 00006CB0 :0000DE91 891DB06C0000 mov [00006CB0], ebx :0000DE97 85DB test ebx, ebx :0000DE99 7D08 jge 0000DEA3 :0000DE9B 31FF xor edi, edi We use the old good noopping: let's change 29C3 to 9090 and we have: :0000DE7F A1C07F0000 mov eax, [00007FC0] :0000DE84 8B1DB06C0000 mov ebx, [00006CB0] :0000DE8A 90 nop :0000DE8B 90 nop :0000DE8C BAB06C0000 mov edx, 00006CB0 :0000DE91 891DB06C0000 mov [00006CB0], ebx :0000DE97 85DB test ebx, ebx :0000DE99 7D08 jge 0000DEA3 :0000DE9B 31FF xor edi, edi You just have to use an hex-editor, search for A1C07F00008B1DB06C0000, change the following two bytes and you CAN PLAY HUNDREDS OF OURS, if you save the only ball. But I realize that's not a great improvement for many people. We want to play the whole game with 3 balls (and even use the extraballs). First I thought: these good pinball programmers are not that good protection programmers. Let's try to correct the initial value of the ball counter to start at 1, and everything will be ok. That was not exactly accurate (though they are bad protectionists anyway). We look for the character (the number after BALLS) and ta,ta,ta,ta. Procede the same way we did with the countdown. Get a memory location. Breakpoint it and get something like what we had before... and ALWAYS remember that what the newbyes always forget: /* THE VALUE OF THE OFFSETS ARE ONLY USEFUL AS A THEORETICAL POSSIBILITY... YOU SHOULD ALWAYS LOOK FOR THE BYTES OF THE INSTRUCTIONS WITH YOUR HEXEDITOR (OR EXAMINING THE DEAD LISTING MADE THROUGH DASM. THE OFFSET VALUES ARE NEVER ABSOLUTE VALUES */ :00000F54 B801000000 mov eax, 00000001 :00000F59 89BAF8760000 mov [edx+000076F8], edi :00000F5F BB03000000 mov ebx, 00000003 ;<<< HERE! :00000F64 89823C770000 mov [edx+0000773C], eax :00000F6A 89D0 mov eax, edx :00000F6C 899AF0760000 mov [edx+000076F0], ebx ;SAVED! ; edx="0" IRL Change bb03000000 and write bb01000000 (bytes of target's code "you.class" tppabs="http://fravia.org/you.class" should change through hexediting see the line above). Now we have mov ebx, 00000001 instead of mov ebx, 00000003 and this should be the right preset... i.e. we should now start with ball 1, not with ball 3. Yet if we run the program, nothing new happens. What's wrong? Nothing, we simply need to finish this (master)piece of cracking (ole la modestia). Till now everything was so easy, and we could master it with Softice and an Hexeditor (coser y cantar que se dice). The hard job is coming. I checked the modifications to the ball counter when the game ends, and found that it was set to 0 (with other vars as the credits) in the following routine. ;------------function that zeroes a lot of locations :0000157C 53 push ebx :0000157D 51 push ecx :0000157E 52 push edx :0000157F 56 push esi :00001580 55 push ebp ... some boring lines .... :000015EC 31ED xor ebp, ebp :000015EE 8935A8220000 mov [000022A8], esi :000015F4 892DC0860000 mov [000086C0], ebp :000015FA 892D1C800000 mov [0000801C], ebp :00001600 892DF87D0000 mov [00007DF8], ebp :00001606 892D20800000 mov [00008020], ebp :0000160C 892D28800000 mov [00008028], ebp :00001612 892DF0760000 mov [000076F0], ebp :00001618 891D50220000 mov [00002250], ebx :0000161E 89154C220000 mov [0000224C], edx :00001624 5D pop ebp :00001625 5E pop esi :00001626 5A pop edx :00001627 59 pop ecx :00001628 5B pop ebx :00001629 C3 ret This "obsession" resetting of variables makes us think it's an evil routine. Let's have a look at the dead listing (xref) of the caller: this function: ; function :0000E617 BB02000000 mov ebx, 00000002 :0000E61C 31C9 xor ecx, ecx :0000E61E 891DF0BB0000 mov [0000BBF0], ebx :0000E624 890DECBB0000 mov [0000BBEC], ecx :0000E62A E8E1A20000 call 00018910 :0000E62F E8482FFFFF call 0000157C ;<<<<<< here calls zeroing! there's no evidence of conditional jmp here, or something else suspicious, so if we try to extend it, the dasm reports us no entry point; so we've got probably an indexed jumping. WHO CALLS THIS CALLER? A bit of Zen cracking and I could save time... else let's winice!(thank you Numega, God will pay our licenses) we do some backtracing and the real caller of the evil routine is: :DBF0 2EFF2485DCDA0000 jmp dword ptr cs:[4*eax + 0000DADC] and in this case eax="7." Keep in mind this instruction. ****IF THIS EAX="7" THEN BEGGAR OFF!**** With the backtracing done we realize that we have lots of conditional jumping before the evil routine is called. I lost much time checking some suspicious ones. Now try another approach. The program has been manipulated and some part of the code are not executed. E.g. INCreasing or DECreasing the number of balls. Well, we should get something searching in the listing for [000076f0]. There are several matches, but this one seems right: : our holy routine :0000DEE8 31ED xor ebp, ebp ...... :0000E368 8BB8F0760000 mov edi, [eax+000076F0] ;fetch location :0000E36E 8D2C19 lea ebp, [ecx + ebx] :0000E371 01DF add edi, ebx :0000E373 892D20800000 mov [00008020], ebp :0000E379 89B8F0760000 mov [eax+000076F0], edi ;change location Using Winice we see this function starting at :0000dee8 is never executed, and in the listing there's no entry point. It's not the first time; again these annoying indexed jumpings. Let's go deeper in our old indexed jump and in its previous instructions : :DBE2 A1F87D0000 mov eax, [00007DF8] :DBE7 83F807 cmp eax, 00000007 ;is it seven? :DBEA 0F87720A0000 ja 0000E662 :DBF0 2EFF2485DCDA0000 jmp dword ptr cs:[4*eax + 0000DADC] ;IF EAX="7" BEGGAR OFF! If we bkpoint [7df8] it has different values during the game (they are consecutive): 0 : start of the demo. No game yet. 1 : pressed the key to start playing, but we cannot play yet 2 : cannot play yet 3 : can play 5 : game over 7 : game over (this value calls the evil routine!) 0 : game over and no restart. Somehow this var shows the "state" of the game (ya le tenemos pillado por los huevos :-) There're two missing values, specially "state 4" could be interesting coz this value lays at the border between playing (3) and not playing (5). Two possibilities (rational one and intuitive one): (1st) Rational if [7df8]="4" our indexed jumping is jmp cs:[daec] looking in the listing, it is jmp dee8 (our holy routine) we got it (2nd) Emotional directly change [7df8] to 4 when it is assigned 5. we have the real game. Searching in the listing for [7df8] we find a setting to 5 twice: :0000DDF3 7D53 jge 0000DE48 :0000DDF5 C705F87D000005000000 mov dword ptr [00007DF8], 5 and :0000E3A6 C705F87D000005000000 mov dword ptr [00007DF8], 5 the first is executed by the demo, and the second is never executed. So the trick of the demo it's to assign 5 to [7df8] prematurely, when it should get assigned instead a value of 4. The 2nd assignment is the true one (the game calls it when you loose your three balls). You have the previous instruction written for locating easily (and change) the instruction with the Hexeditor. Search 7D53C705F87D000005000000 (jge thattaway and mov [7DF8],5) and change these values to 7D53C705F87D000004000000 (jge thattaway and mov [7DF8],4) There i still a "naggy" problem that we should try to solve. You can play three balls, and so on, but you can start the game just once each session. I mean when the game is over, you must exit and run again. A problem for amauter players. Let's solve it. If you try to trace after the reading_keyboard routine, you'll get crazy. Now let's use a completely different technic, it's like dead listing but live at the same time; call it "zombi listing": launch Game Wizard 32 Pro and use the advanced search. (It's like the snap compare we used with DOS-softice in +ORC's lesson 1... a search for values that change/not change when the target runs). We know that when we launch the demo the game starts pressing "S", but when we finish the first run and press "S" again nothing happens... the target does not start. In this case, even a stupid censor would be aware that a flag is used for disabling any further start. I supposed (and I was right) that the flag was changed just after begining to play. The flag has two states: flag off--------*------------------flag on---------->launch-&gt;presenting...-&gt;press &quot;S&quot;-&gt;play&amp;lose-&gt;presenting...-&gt;escape

	So when we know that the flag is off, we search for values that don't change. 
Press &quot;s&quot; and start, search (JUST ONCE) for a memory change, then search again for
no-change values (the flag remains on).Escape, and search once for a change (the 
flag is off now). You have to run the game several times (I needed six or seven) 
until you get a table (about 70)of memory location that behaves the way you said.
Following your zen-cracking feelings get only the group that toggles between 1 
and 0 (about 6 locations) and try to freeze it when the flag is off. I was very 
lucky 'cause the first value of the list was the flag.

flag off =0
flag on  =1

The only problem is to translate that memory location to the identifier number 
inside the dead listing. Get with Game Wizard the location of our [76f0] (number of 
balls) using search and use the offset to translate the equivalent memory 
number in the dead listing . Just find when is set to 1 and we got our job done. Aja, 
the number acording to our wdasm listing is [225c], and look: it is changed here:

:0000DE68 7515                    jne 0000DE7F
:0000DE6A BD01000000              mov ebp, 00000001 ;bad flag
:0000DE6F B800001E00              mov eax, 001E0000
:0000DE74 892D5C220000            mov [0000225C], ebp ;<<<<<<<< :0000DE7A A3B06C0000 mov [00006CB0], eax :0000DE7F A1C07F0000 mov eax, [00007FC0] :0000DE84 8B1DB06C0000 mov ebx, [00006CB0] :0000DE8A 90 nop ; look, the time protection :0000DE8B 90 nop ; that we have disabled :0000DE8C BAB06C0000 mov edx, 00006CB0 :0000DE91 891DB06C0000 mov [00006CB0], ebx These memory locations are a real "hot area". Search for 7515BD01000000 and change it to 7515BD00000000 (that naughty bit again). Come on try, it's easier to do than to explain. It took me just 25 minutes. Well it's time to enjoy the game, by far the most realistic pinball game I know (let me know if I'm wrong). DAMAGE MICRO$OFT AND ITS PLUG&PRAY FATWARE. AND REMEMBER: "Long is the way and hard, that out of Hell leads up to the light." (c) April 1997 siuL Hacky </pre>

<hr><center>
<i>a small addition by reverser+...<br>
usually this kind of games have &quot;hidden&quot; switches, that allow the programmers 
to play undisturbed with infinite balls and times in order to test them. I just
tried here to substitute to</center></i><pre>
:00000F5F BB03000000              mov ebx, 00000003 ;<<< HERE! not :00000F5F BB01000000 mov ebx, 00000001 as out good friend siuL (vale amigo!) reccomends, but :00000F5F BBFFFF0000 mov ebx, 0000FFFF </pre><center><i> 
and I got infinite balls (which may be less &quot;respectful&quot; of the original 
settings of this game than siuL's crack, but may be funny for people  
interested in extra functions THAT ONLY CRACKED VERSIONS CAN GIVE, that 
you would not find in the original programs :-)
<br></center></i>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#84" tppabs="http://fravia.org/tppmsgs/msgs0.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#73" tppabs="http://fravia.org/tppmsgs/msgs0.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="students.htm" tppabs="http://members.xoom.com/tsehp_/students.htm" > student</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
<i>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Reverser 26 Apr 1997
</i>
</body>
</html>


<html>

<head>

<title>reverser's ADVANCED 

STEGANOGRAPHY PAGE</title>

</head>

<body bgcolor= "CCCCCC" text="#001010" vlink="#405040" Alink="#00FF50">

<!-- Begin Introdo -->

<center><table><tr><td><center>

<a href="ad__st_.htm" tppabs="http://members.xoom.com/tsehp_/ad__st_.htm">                                                           
                                                        
                   </a>

</center></tD>

<td><center><a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"><IMG SRC="images/anon1.gif" tppabs="http://members.xoom.com/tsehp_/images/anon1.gif" ALT="noanon" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="114" height="43"></a></center></tD></tr>

<tR><td><center>

<Font color= gray>Advanced Steganography</fonT>

</center></tD>

<td><center>

<Font color= gray>Anonymity Academy</fonT></center></tD>

</tr></table><bR>

<font size=+3>reverser's 

STEGANOGRAPHY<br>

ADVANCED PLATFORM</font><br>OK, you found it sunny boy

<br>

<TABLE CELLPADDING=1 CELLSPACING=2 BORDER=1><tr><td 

bgcolor="#262256"><font color=red>Updated September 1998</font></td><tr></table>

</center>

<hr size=6>

<center><Font size=+3>Advanced readings</Font><br>

<Font size=+2>

<font color=blue>How to (try to) see some light 

through steganographical smoke</fonT></Font>

<hR>

~ <a href="ad__st_.htm#anchorappro">approaches</a> ~ hints ~ 

<a href="ad__st_.htm#anchortric">tricks</a> ~ links ~

<bR><hR>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"

ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="13" height="13">Courtesy of reverser's page 

of reverse engineering<hr>       

<i>Well, I have received so many questions about steganography, it was about 

time that I could give some 'cracker' answers... what I mean is: you'll be able to find on the 

web many (good) pages about steganography, yet I don't believe that you'll find 

many good pages about steganographical CRACKING.<bR>And the aim of this page is 

exactly that: to teach you how to hide and how to un-hide information. You already had 

to perform some relatively easy steganographical cracking in order to get here (else 

you are either one of the administrators of my servers (Hi Sharp! Hi Camilo!, 

Hi Tony!) or a friend with the keys (Hi +gthorne!)  

or an idiot that has received this URL from somebody more able and is 

wasting his and my time). Yet landing here, as you will see, is only the beginning of a very long trip! In this page we will see how you can 

crack ALL currently used steganographical programs.<bR>Let's first of all have a look at 

how zeezee, +ReZiDeNt and all the other ones have cracked the 'Andromeda' pictures... Clearly each one 

of you coming here should mail me a short (altough interesting and 'crackling') 

essay, explaining how HE got the right path... You learn, you teach: you teach, 

you learn!<bR><br></i>

<hr size=3>

<a name="anchorappro"></a>

<Font size=+4><font color=gray><center>

The approaches</fonT></fonT></center>

<br>

<a href="ad__st_.htm#anchorrez1">+ReZiDeNt's approach</a><br>

<bR>

<a href="ad__st_.htm#anchorzee1">zeezee's approach</a><br>

<br>

<a href="ad__st_.htm#anchorcap1">caprine's approach</a><br>

<bR>

<a href="ad__st_.htm#anchormas1">Massimiliano's approach and his anticontraband proggy</a><br>



<br>

<a href="fabian2.htm" tppabs="http://members.xoom.com/tsehp_/fabian2.htm" >Fabian Hansmann's short essay</a><br>

<br>

<a href="sanity1.htm" tppabs="http://members.xoom.com/tsehp_/sanity1.htm" >Sanity_sync's anticontraband c code</a> 

<br>

("programs i wrote that help crack contrab stegged

texts")<bR>



<br>

<a href="pri_ca!.htm" tppabs="http://members.xoom.com/tsehp_/pri_ca!.htm" >Caprine's short answer to Jean Flynn</a> 

<br>

("Let's work together")

<bR>

12 February 1998<bR>





<br>

<a href="jjpes__1.htm" tppabs="http://members.xoom.com/tsehp_/jjpes__1.htm" >Joe Peschel's Steganos, The Duke of Earl, and The Dancing Men</a> <font color=red>__NEW__</fonT>

<br>

("Cracking the T_tamra7.bmp")

<bR>

04 March 1998<bR>



<br>

<a href="ediadste.htm" tppabs="http://members.xoom.com/tsehp_/ediadste.htm" >Edi's work</a>

<br>

("I had to reverse engineer steganos again, on my own")

<bR>

26 March 1998<bR>





<br>

<a href="capri_dr.htm" tppabs="http://members.xoom.com/tsehp_/capri_dr.htm" >Caprine's beautiful story</a> <I>A great dragon 

known as Steganos</i>

<br>

(Steganos Key Relief (Reducing the key search burden))

<bR>

22 April 1998<bR>





<br>

<a href="gary_a_d.htm" tppabs="http://members.xoom.com/tsehp_/gary_a_d.htm" >Gary Benson's</a> <I>Unconventional Access: My 

way into the Advanced Steganography pages</i>

<br>

(Steganos Key Relief (Reducing the key search burden))

<bR>

23 September 1998<bR>





<!--  THE TRICKS -->



<hr size=3>

<a name="anchortric"></a>

<Font size=+4><font color=gray><center>

The Tricks</fonT></fonT></center>

<br>

<br>

<a href="stegaad.htm" tppabs="http://members.xoom.com/tsehp_/stegaad.htm" >The HackLab</a>'s Steganography Thumbprinting <font color=red>__NEW__</fonT>

<br>

("methods of detection")

<bR>

18 March 1998<bR>











<bR>

<a name="anchorrez1"></a>

<hR>

We will begin with +ReZiDeNt's approach:</center><hr withh=66%>

<prE>

A lazy brute force approach to cracking the 'Andromeda' picture, by +ReZiDeNt



OK, here is how I retrieved the text file hidden inside the 

stegonated Andromeda picture (outfile.gif) on reverser's+ very 

interesting page about steganography



Firstly, I downloaded Hide and Seek 4.1, and took a look at it. 

Reverser+ had already told us that the code we needed was four digits 

long - so I first tried a few 'common' combinations (e.g. '1984',

1997', '2001', '2010' etc.) - this didn't find it, so I knew I would 

have to try another approach: I decided to 'brute force' the number. 

In other words, I would try every single combination of fou

digits until I found the right one. Using four digits there are 

10,000 possible combinations, so typing these all in would be long 

and tedious to say the leas



Obviously, I would need to make a program (in C of course, the only 

'real' language IMHO) to do this for me, and automate the typing in 

of the different codes. All I would need to do is make a prog

m that passes the SEEK.EXE program a code, and then checks to see 

whether it has successfully extracted the hidden file.



So I first tried to look at the Hide and Seek source code and see if 

I could edit it a bit, to change some things I didn't like (I didn't 

like the 'press any key' prompt that it showed you before a

empting to extract the hidden file, and I wanted to stop it from 

showing the image as it worked). However, the program uses a 

commercial graphics library and although I tried to edit those out it 

n't work. 



Oh well, let's crack it instead! So I did - I used SoftICE and set a 

breakpoint on INT21 - sure enough, SoftICE snapped just before the 

'press any key' message - I just had to nop the INT call out 

d that took care of that problem. I decided not to bother getting rid 

of the image display, so I was now ready to make the simple C 

progra



The C source is shown below (I compiled this with Borland C 4.5, but 

it should work with any ANSI C compiler):</prE><xmp>/* START findit.c */



#include<stdio.h>

#include<ctype.h>

#include<stdlib.h>



FILE *fp;



void main()

{

	int code = 0;    /* starting value for the code */

	int found = 0;

	char cline[80];  /* this will store the command line */

	

	while(!found && (code <= 9999))

	{

		/* the below line creates the command line */

		sprintf(cline, "seek.exe outfile.gif found.txt %.4d", code);

		code++;        /* generate the next code "*/.class" tppabs="http://fravia.org/*/.class"

		system(cline); /* now execute the command line */

		

		/* the line below checks to see if we have found anything */

 		fp = fopen("found.txt","r");

		if(!fp)

		{

			found = 0;

		}

		else

		{

			/* if we have found the hidden file, save the */

			/* code in key.txt for future reference       */

			found = 1;

			fclose(fp);	

			fp = fopen("key.txt","w");

			if(fp)

			{

				fputs(cline, fp);

				fclose(fp);

			}

		}

	}

}



/* END findit.c */</xmP><prE>





On my Cyrix P166+ with 16MB RAM (under Windows 95) this took about 

half an hour to forty-five minutes to find the hidden file, running 

the program as a foreground task. It took slightly less than o

 second per iteration (e.g. it took less than a second to test each 

code), so the maximum time it would have taken (in minutes) is:



10000 / 60, about 166 minutes, nearly three hours. 



The above program is very simple, starting from 0 and going up to 

9999. In all but the simplest cases, you would probably have two 

counters, one starting at 0 (counting up) and one at 9999 (countin

down), to speed things up. I'm not going to tell you how long it took 

me to find the code, because that would enable you to cheat and make 

a guess :



Anyway, I found that to be good fun and a very worthwhile evening's 

entertainment. :-)



Good Hunting,

+ReZiDeNt



--------------------------------------------------------------------- 



Cya,

+ReZiDeNt</prE><hr>



<a name="anchorzee1"></a>

<hR>

We will continue with zeezee's approach:<hr width=66%>

<prE>

hi, reverser+



Thanks for Christmas puzzle with Andromeda! Nice picture, btw.



The working codes (.BMP version) are: 0995, 4575 and 8155.



It was a simple but enjoying &quot;source code reversing&quot;.





My way of thinking was (assuming p0/1/2/3 are password digits):



1. Goal: Searching for: BlkSize, Offset and XOR all made from p0/1/2/3.

   Algorithms are near the end of .C file

2. Opened .C source in notepad

3. Created .DIF file between two .BMP files using fc

4. Bytes differ from offset 003F to 150B ie min. during 5324 bytes

5. Divided 5324 by 587 to compute BlkSize. It's 9.

6. Blksize is 8 + p1 % 4. So

     p1 may be 1, 5 or 9

5. To determine Offset I checked various p0 values to get 537 bytes long

   outfile. So I determined that p0 + p1 = 1.

     Possible combinations are:

     09..

     45..

     81..

Then I tried to decode using password 4555 creating a file 4555.txt

6. Assuming that there is a 'http://' phrase repeating in the text I determined

   that near start of file (offset 1,2) are identical bytes. Let's assume

   they should be 't'.

7. Determined XOR between 'ist' and 'soll' and computed existing mask

   Mask for 4555 is CF.

   Should be E3.

   So one of the codewords is 4575.

   Works!

8. Created two additional codewords so that XOR is E3.



9. Checked the files mentioned in the file.

   Most of them are since long time on my HD, one gives 404.



10. Mailed to reverser+.



Merry xmas and many good cracks in New Year!



zeezee</prE>

<a name="anchorcap1"></a>

We will continue with caprine's approach:<hr width=66%>

<prE>

Dear reverser,

 Although I have spent many hours learning from and enjoying your pages, 

I admit this is the first time I have taken the time to bestow my humble 

&quot;thank you&quot; for the passion you have for teaching 'KNOWLEDGE' (but you 

probably get too much email anyway)



A quick observation about 'contraband' :

 After reviewing the source, and with your hint of the 587 byte file 

 size and a little file probing, one can quickly determine that the 

'offset' = 9. 



    Offset=((PIN[0]-'0')+(PIN[1]-'0'))%11; 



Therefore , the PIN 0 &amp; 1 combinations can be '09', 

'18','27','36','45,'54','63','72','81',or'90' (down to 1000 

possibilities already)



A quick FC -b Androm.bmp _ndrom.bmp(we all remember those nice little 

DOS tools don't we) tells us the last modified byte is at offset 5387. 

block size (high probability) = (5387-96)/587 = 9



    BlockSize=8+(PIN[1]-'0')%4;



That means PIN[1]= '1','5',or'9' 

Now the valid PIN 01 combo's are '09','45',or'81'



Now I got a little lazy. I extracted 3 files using passwords 

'0900','4500',and '8100'. Now a quick little program to read each file 

and xor all characters with 0 thru 255 and display. To my surprise, all 

3 files decoded your file. That means (In this case) their are 3 valid 

passwords.

'0995','4575'(yours),and '8155'. 



Well, anyway, it suprised me and I thought I would mention it. So if 

this common knowledge,or you really don't care, just write this off as 

someone who doesn't have anything better to do. 



Got to go look for the advanced steganography' pages now.  Thanks again.

</prE>

<a name="anchormas1"></a>

We will continue with Massimiliano's approach:<hr width=66%>

<prE>

Thank you for giving so much information about the stegonated

androm.bmp!!!

I just asked myself: would have been possible to decode the file 

without knowing so much about it ? (length=578, type=text file, 

content=urls).

The answer is in a small utility I wrote in a few spare hours.

Although not yet perfect, it can be useful to show that contraband

is a fairly breakable tool (even if the attack I prepared is far from

perfect).

It could also be possible to search the entire keyspace, but this is

unnecessary. I'm giving this tool to your advanced readers just to keep 

people from using contraband, since it is indeed flawed.

Keep publishing your site, I love it, and I greatly appreciate 

(and enjoy) your work. Happy new year.



Download here Massimiliano's <a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/uncontra.zip">anti-contraband</A> program</prE>

                                                                                                                                                                        





<prE>

</prE>

<hr size=3>

<!-- Begin mover -->

<center>

<a href="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"><IMG SRC="images/anon1.gif" tppabs="http://members.xoom.com/tsehp_/images/anon1.gif" ALT="noanon" ALIGN=BOTTOM BORDER=0 VSPACE=0 HSPACE=0 width="114" height="43"></a>



 <Font color= gray> _ _ _ _ _ _ _ _ _ _ </fonT>

<a href="stego.htm" tppabs="http://members.xoom.com/tsehp_/stego.htm"><IMG SRC="images/stego.gif" tppabs="http://members.xoom.com/tsehp_/images/stego.gif" 

ALT="stego" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 

VSPACE=0 HSPACE=0></a>

<br><Font color= gray>Back to Reverser's Anonymity Academy</fonT> ___<Font color= gray>Back to the Stego 'normal' page</fonT>



<bR>



 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>

<br>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI tricks</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript tricks</a>

<br> 

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>

<br>

 <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT= red width="13" height="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is software reverse engineering illegal?</a>

</center>

<!-- End mover -->

<hr size=3>

<! Begin signet -->

 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" 

ALT="red" BORDER=0 VSPACE=0 

HSPACE=0 width="13" height="13"></a>

<Font color=green>

(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998.</font> 

All rights reserved 

<HR ALIGN=CENTER WIDTH=100% SIZE=3>

</body>

</html><HTML>
<HEAD>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>lazcalc.htm: LaZ-Calc: Adding functionality to the Windows Calculator
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
LaZ-Calc
</fonT><br><FONT SIZE="+1">
Adding functionality to the Windows Calculator
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm"><IMG SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" 
ALT="Advanced" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Advanced</FonT>
</center></td></tr><tR><td bgcolor="#FFFFEA"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
14 September 1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
LaZaRuS
</fonT></center></td><td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</TD><td BGCOLOR="898030"><center>

</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font color="#C4C0CF">fra_00xx<bR>980914<br>LaZaRuS<br>0010<br>AD<br>PC<br></fonT></td><td><center><i>

A "must read" reversing essays for all true reversers out there: adding functionalities to programs 
is the sublimest reversing art, like Sung-style ink painting, and if LaZaRuS will bless us with more essays along these lines I will open 
a special (and I am sure most coveted) section for this kind of essays.<br>
Feedback on this essay is MOST important. I hope many will work on this and contribute.
</i></center></td><td></td></tr><TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><center><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>

<!-- Leonard Coehn's old song, because we are poets, not only crackers -->

</TD><td></td></TR><TR><td VALIGN= "MIDDLE" 

bgcolor="#C6E7C6"><center><font color=blue>Rating</font></center>

</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><center><font color=blue>

<!-- CHOOSE A RATING (may be changed) -->

( )<B>Beginner</B> ( )<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></font>

</center></td><td></td></tr></table>

<!-- END HEAD  --><bR>

<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
A small example to the (for me) most interesting part of reverse engineering: Adding 
functionality to a program. 
<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
LaZ-Calc
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
Adding functionality to the Windows calculator
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
LaZaRuS
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table>

You surely know this: You enter huge formula into the Windows Calculator and see that the

result must be wrong. You made a mistake and this means: Reentering the complete formula once

more (this time with more attention). In this essay I will describe how to add an edit field to

the calculator, where you can enter this formula, so you can easily correct it, when a problem

should appear. Well, what should I say: An interesting essay for guys that feel like I do :)


<br><br>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>

</fonT></center></td></tr></table>

Let's see, I used quite many tools this time:<br>

Soft-Ice (for debugging and assembling in memory)<br>

W32Dasm (for deadlistings)<br>

Hex-Workshop (for applying changes to the file)<br>

Borland Ressource Workshop (for adding objects/strings)<br>

Customizer (for simulating different things)<br>

MASM (for compiling some ASM code)<br>

A Win-API reference is necessary

<!-- PASTE HERE YOUR REQUIRED TOOLS -->

<br><br>



<!-- TARGET URL STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>

</fonT></center></td></tr></table>

<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->

Target is the wrong expression, as this is no cracking essay, but we deal with the Windows

calculator which was shipped with Win95. You will find the English original (which I used) inside <a href="http://acrigs.com/FRAVIA/zipped/lazcalc.zip" tppabs="http://members.xoom.com/tsehp_/zipped/lazcalc.zip">lazcalc.zip</a>.

<br><br>



<!-- PROGRAM HISTORY STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Program History</fonT>

</fonT></center></td></tr></table>

<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->

Don't think there's something important to say here.

<br><br>



<!-- REAL ESSAY  STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>

</center></td></tr></table>
<prE>
At first I define what exactly we want to have when this essay is finished: We need an edit box,
a checkbutton, a normal button and a new menu point "LaZ-Calc" with the sub-menus "Center 
Window", "Stay on Top", "Start Notepad", "Help", "About", "Quit". Look at the screenshot 
scr1.gif or at lazcalc.exe that comes shipped inside <a href="http://acrigs.com/FRAVIA/zipped/lazcalc.zip" tppabs="http://members.xoom.com/tsehp_/zipped/lazcalc.zip">lazcalc.zip</a> to see how it should look like.
We add the components (buttons, menus...) with the Borland Ressource workshop. I won't explain
how this works, only the most important facts about the components:
The edit field, the check button and the standard button are added to the ressource "DIALOG"-
"SC", the Menus are added to "MENU"-"SM". It is important to add the "LaZ-Calc"-Menu after the
last menu (which is "Help"). If you don't do this, the menu will screw up, as the (original)
menus are not checked or enabled through the ident, but through the position.
The "Center Window" menu has the ID 666, the "Stay on Top" has 667, "Start Notepad" is 668, 
"Help" is 669, "About" has 670 and "Quit" has 672. Why not 671? I don't know, just saw it right
in this moment. Must have been a typo, when I first created it. You can use 671 if you want, but
don't forget to apply the change to the sourcecode that comes later.
Now we need to add some bytes where we can add code. There are some "caves" (many following 
00-Bytes), that cannot be used, as they are too small. Now comes the first weakness of my essay:
As I still can't "mess" with the PE-header, I needed another way to enlarge the file size. I
just added a huge string with BRW to the file. I guessed the size of this string and was lucky
at the end, as I nearly ran out of space. I needed 392h (=914) bytes, so you gotta create one
or more strings with a length of 457d chars, as BRW adds them in Unicode-Format with a 00 
between two chars and you get double the amount of bytes of the string length. To see how my 
file looked like at the end, see hexdump.txt. If you say that this is a lame way, at least 
recocgnize that I found a nice workaround. :)

Now, the edit field. We have to be able to enter a serial. That is a small problem, as when you
try to enter something, the key is interpreted as hotkey and immediately a message to the
corresponding button is send. That's why I have created the check box. If it is checked, it
should be possible to enter formulas and if it is not checked, the keys you press should be
immediately interpreted as hotkeys. So, we have to find the code that does check, if a hotkey 
is pressed. What API functions can be used? Don't even try to look for "Hotkey" in your 
API-reference. The thing we are dealing with is called "Accelerator". The "Accelerator Table" 
can be viewed in BRW, but at this moment, we cannot do anything useful with it. Here comes a 
short extract from my API reference about the fuction we will deal with: TranslateAccelerator

The TranslateAccelerator function processes accelerator keys for menu commands. The function 
translates a WM_KEYDOWN or WM_SYSKEYDOWN message to a WM_COMMAND or WM_SYSCOMMAND message 
(if there is an entry for the key in the specified accelerator table) and then sends the 
WM_COMMAND or WM_SYSCOMMAND message directly to the appropriate window procedure.

int TranslateAccelerator(
    HWND hWnd,	        // handle of destination window
    HACCEL hAccTable,	// handle of accelerator table
    LPMSG lpMsg 	// address of structure with message
   );

So, this function checks, if the key (or keycombination) that was pressed is an Accelerator. If
so, it sends a WM_COMMAND to the button, that is associated with that key, which means the 
button gets pressed and the function that this button has is executed. Now it is time to get a
disassembling of calc.exe for searching the place TranslateAccelerator is called. You will find
no direct call, but the following code which moves the address where the function is located
is moved to edi.

* Reference To: USER32.TranslateAcceleratorA, Ord:020Ch
                                  |
:00401307 8B3DFCE34000            mov edi, dword ptr [0040E3FC]

Few lines below, you will find that call to edi.

:0040132B 8D45DC                  lea eax, dword ptr [ebp-24]  <font color="#FF0000">;; eax gets addr of MSG struct</font>
:0040132E 50                      push eax

:0040132F FF3598B44000            push dword ptr [0040B498] <font color="#FF0000">;; address of AcceleratorTable</font>
:00401335 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; Handle of main window</font>
:0040133B FFD7                    call edi <font color="#FF0000">;; call TranslateAccelerator</font>
:0040133D 85C0                    test eax, eax <font color="#FF0000">;; was key an Accelerator (eax=1) ?</font>
:0040133F 7510                    jne 00401351 <font color="#FF0000">;; if so, then jump</font>

Now we have to redirect the flow of instructions to an area of code we have created in order
to find out, if the checkbutton is checked and executes what to do then. My solution looks like
this:

:0040132B E900050100              jmp 00411830
:00401330 90                      nop
:00401331 90                      nop
:00401332 90                      nop
:00401333 90                      nop
:00401334 90                      nop
:00401335 90                      nop
:00401336 90                      nop
:00401337 90                      nop
:00401338 90                      nop
:00401339 90                      nop
:0040133A 90                      nop
:0040133B 90                      nop
:0040133C 90                      nop
:0040133D 85C0                    test eax, eax
:0040133F 7510                    jne 00401351

It is not necessary to nop out all the pushes and the call, but I had aesthetical reasons for
doing this. I prefer compact code where the pushes are directly in front of the call and not 
somewhere in our redirected code. Well, the jump at :004132B goes to offset DA30h in the file.
Here I added the following code:

:00000000 60                      pushad <font color="#FF0000">;; save all registers</font>
:00000001 669C                    pushf <font color="#FF0000">;; save all flags</font>
:00000003 68AEEA4000              push 0040EAAE <font color="#FF0000">;; push "USER32.DLL"</font>
:00000008 FF1590E24000            call dword ptr [0040E290] <font color="#FF0000">;; call GetModuleHandleA</font>
:0000000E 682D1B4100              push 00411B2D <font color="#FF0000">;; push "IsDlgButtonChecked"</font>
:00000013 50                      push eax <font color="#FF0000">;; push Handle of User32.dll</font>
:00000014 FF15DCE24000            call dword ptr [0040E2DC] <font color="#FF0000">;; call GetProcAddress</font>
:0000001A 68A3020000              push 000002A3 <font color="#FF0000">;; push handle of check box (2A3=675)</font>
:0000001F FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; push handle of main window</font>
:00000025 FFD0                    call eax <font color="#FF0000">;; call IsDlgButtonChecked</font>
:00000027 0BC0                    or eax, eax <font color="#FF0000">;; check eax</font>
:00000029 751A                    jne 00000045 <font color="#FF0000">;; if eax == 1 (Button checked), then jump</font>
:0000002B 669D                    popf <font color="#FF0000">;; get all flags from stack</font>
:0000002D 61                      popad <font color="#FF0000">;; get all registers from stack</font>
:0000002E 8D45DC                  lea eax, dword ptr [ebp-24] <font color="#FF0000">;; here comes exactly</font>
:00000031 50                      push eax                    <font color="#FF0000">;; the same code</font>
:00000032 FF3598B44000            push dword ptr [0040B498]   <font color="#FF0000">;; that was there </font>
:00000038 FF35D8B54000            push dword ptr [0040B5D8]   <font color="#FF0000">;; before I redirected</font>
:0000003E FFD7                    call edi                    <font color="#FF0000">;; the instructions</font>
:00000040 E9BBFAFEFF              jmp FFFEFB00                <font color="#FF0000">;; jump back</font>
:00000045 669D                    popf <font color="#FF0000">;; get all flags from stack</font>
:00000047 61                      popad <font color="#FF0000">;; get all registers from stack</font>
:00000048 33C0                    xor eax, eax <font color="#FF0000">;; IMPORTANT: set eax to 0</font>
:0000004A E9B1FAFEFF              jmp FFFEFB00 <font color="#FF0000">;; jump back</font>

Well, let's analyse:
The pushad/pushf is absolutely necessary as we have to pass all register and flags and their
current states to the call edi" (TranslateAccelerator) and they are messed up, when we call 
all the other functions before. We have to find out, if the checkbox is checked. We can use 
the API-function "IsDlgItemChecked" for this purpose. Here starts the first problem: You can
assemble directly in the RAM using SICE, but if you enter "a"-"call IsDlgButtonChecked" SICE
will create a *direct* call to the Kernel of your system. That means it will create Opcodes
that are only valid on your machine. So we have to find another way, an indirect way: I 
demonstrate with GetModuleHandleA, as IsDlgButtonChecked will have another problem. Get into
your disassembling in W32Dasm and search for "GetModuleHandleA" somewhere in the middle of the
code. The first appearance will be here:


Remark 1:
Don't think I guessed the source I present you here. I coded a test app, that should simulate 
the Windows calculator. Here I developed all functions first. You should do this, too as it
is quite annoying to code larger part directly in SICE (as I experienced many bugs in my V3.23).
End of Remark


* Reference To: KERNEL32.GetModuleHandleA, Ord:010Eh
                                  |
:0040544C FF1590E24000            Call dword ptr [0040E290]

Here we see an example for an indirect call. The function GetModuleHandleA can be called by
a call to dword ptr [0040E290]. We can use this value for our purposes, too. But wait, why do
we deal with this function? We need the dword ptr address for "IsDlgItemChecked". Well, search
for it and you'll find nothing. This function isn't automatically loaded, so we have to do it.
For this purpose we need GetModuleHandleA and GetProcAddress. GetModuleHandleA gets the handle
of a module (read: DLL-file in RAM). As IsDlgItemChecked is part of USER32.DLL (see W32Dasm
API definitions of another file, that uses this function) we have to find out the handle of 
this DLL. The string User32.dll is surely to be found somewhere inside calc.exe - So search for
it and you'll find it at offset BEAEh which is :0040EAAE during runtime (s 00400000 l ffffffff
'USER32.dll' to find this address). So we need to "push" this string and then call dword ptr
[0040E290] which is an indirect call to GetModuleHandleA. Then we need to call the function
GetProcAddress to find out where the IsDlgItemChecked it located. We need to push a string with
the name of that function. As there is no such string, we have to create it: I located it at
offset DD2Dh. The second push (push eax) is the handle of USER32.DLL which was given back from
the first call. After GetProcAddress eax contains the location of IsDlgButtonChecked and we
can use it with "call eax". IsDlgButtonChecked wants two parameters. The first one is the handle
of the checkbox, the second one the handle of the main window. Now watch out: There are two
possible opcodes that represent "push 2A3" (for the checkbox handle) - If you assemble with 
SICE, the wrong one will be chosen and the API function will only return crap. The reason seems
to be that the API wants a dword as parameter, but the "wrong" SICE-opcode pushes a word. A
small workaround is pushing a dword at first (like "push 11111") and then changing the opcode
with the "e"-command. The rest of the above code should be easy to understand. If the
checkbox is checked, eax gets cleared and the program will keep on running, as if no key was
pressed. If the checkbox is unchecked, TranslateAcceleratorA (call edi) will be called and the
return value will be used for the further execution of the MessageLoop. It is important to clear
eax when the button is checked, or we will mess up the MessageLoop!

Now we have changed the MessageLoops in a way, that we should be able to enter chars into the
edit field, when the checkbox is checked. If it is unchecked, the keys we press are interpreted
as hotkeys. Let's turn to the next thing-to-do now. We have to find the code that is executed
when a menu is chosen by the user. In W32Dasm I have chosen "Menu Reference" and then "Menu: 
SM, Item: "Copy   Ctrl+C"" - Look where this appears first time any you'll see:

* Possible Ref to Menu: SM, Item: "Paste   Ctrl+V"
                                  |
:00403161 3D2D010000              cmp eax, 0000012D
:00403166 7725                    ja 0040318D

* Possible Ref to Menu: SM, Item: "Copy   Ctrl+C"
                                  |
:00403168 3D2C010000              cmp eax, 0000012C
:0040316D 0F83A1060000            jnb 00403814

This code looks is a first part of the routine, that checks which Menu was chosen. 12D and 12C
are the handles of the menupoints. If you put a breakpoint on :00403161 you and choose a menu
you will see that it breaks. So, we need to insert a jump to another self-coded part here.
I made it this way:

:00403161 E91AE70000              jmp 00411880 <font color="#FF0000">;; this jump leads to our next section</font>
:00403166 7725                    ja 0040318D

* Possible Ref to Menu: SM, Item: "Copy   Ctrl+C"
                                  |
:00403168 3D2C010000              cmp eax, 0000012C
:0040316D 0F83A1060000            jnb 00403814

Well, we have to make thoughts what to do in the section we jump to. Btw: We still have the
problem, that we have to handle clicks on the button and the checkbox. No, we don't have this
problem. When you push the button (with breakpoint on :00403161) you will see that it'll break
there, too. So we can use the jump to :00411880 for this purpose, too :)

Now let's look at the first code I inserted at :00411880 (which is at offset DA80h):
At first I handle the click at the checkbox. If the checkbox is checked, the button should be
enabled, if not it should be disabled.

:00000000 3DA3020000              cmp eax, 000002A3 <font color="#FF0000">;; is eax the handle of the checkbox?</font>
:00000005 753D                    jne 00000044 <font color="#FF0000">;; if not, then jump</font>
:00000007 803558B6400001          xor byte ptr [0040B658], 01 <font color="#FF0000">;; see explanation below</font>
:0000000E 90                      nop <font color="#FF0000">;; see explanation below</font>
:0000000F 90                      nop
:00000010 90                      nop
:00000011 90                      nop
:00000012 90                      nop
:00000013 90                      nop
:00000014 90                      nop
:00000015 90                      nop
:00000016 90                      nop
:00000017 90                      nop
:00000018 90                      nop
:00000019 90                      nop
:0000001A 90                      nop
:0000001B 90                      nop
:0000001C 90                      nop
:0000001D 90                      nop
:0000001E 90                      nop
:0000001F 90                      nop
:00000020 68A1020000              push 000002A1 <font color="#FF0000">;; ID of the button</font>
:00000025 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of the main window</font>
:0000002B FF1540E34000            call dword ptr [0040E340] <font color="#FF0000">;; call GetDlgItem</font>
:00000031 8B1D58B64000            mov ebx, dword ptr [0040B658] <font color="#FF0000">;; get Enable-flag value in ebx</font>
:00000037 53                      push ebx <font color="#FF0000">;; Enable-flag</font>
:00000038 50                      push eax <font color="#FF0000">;; handle of the button</font>
:00000039 FF15DCE34000            call dword ptr [0040E3DC] <font color="#FF0000">;; call EnableWindow</font>
:0000003F E9A218FFFF              jmp FFFF18E6 <font color="#FF0000">;; jump to :00403166</font>

So, let's analyze the code. At first I wanted to use the API-function IsDlgButtonChecked, to
find out, if the button has to be enabled. As this API function is not loaded by calc.exe I
have chosen to set a flag for the status of the checkbox. The checkbox is not checked by 
default, so I searched a byte that is 0 by default and that is unused by the Calculator.
I found it at 40B658. If this byte is 0, the checkbox is unchecked, if it is 1 the button is
checked. At first I changed the state of this flag with something like this:

if (flag==0)
  flag=1;
elseif (flag==1)
  flag=0;

That resulted in a bunch of crappy code (where the NOPs are now). That was unacceptable for me,
and I made some thoughts how to change the flag shorter. The solution is XORing the flag with 1.
When it is 0 (at the start) it will become 1, if it is 1 it will become 0. Removing the NOPs
would only work if I rewrite my code again and update the jumps, but I am too lazy for this.
The rest should be clear (at least with an API reference). I get the current handle of the
button with GetDlgItem and then I enable it with EnableWindow where I use the flag in 40B5D8
as parameter for the API.

Now the most important section, the interpretation of the formula in the edit box. The first
thought that has to be done is, if the formula should be entered as "correct" formula, or as
a formula made created with the hotkey of the Windows calculator. I decided for the second one,
as this is *much* easier to code. The formula must be entered into the edit field in exactly
the same way you would enter it directly. Here is an example:

Correct formula: (3*2+sin(5))^2 (result=37,05346503647)
Hotkey formula : (3*2+5s)@ (result=37,05346503647)

The deal should be pretty easy: Read the text of the edit field char by char and then... Yeah,
what then? I tried several possibilities. At first I wanted to send a BN_CLICK to the button
that is associated with the key, but this caused several problems. It would have been quite
a huge if-elseif-else construct to find out the related button. Second problem: The calc.exe
buttons are no real buttons. Neither SICE, nor Customizer can find a handle for them. Next thing
I tried: Simulating a key with WM_CHAR (and WM_KEYDOWN). Didn't work, too. You can easily see 
what happens, if you use Customizer to send a WM_CHAR message. Now I decided the correct 
solution: A direct call to TranslateAcceleratorA should work. And it worked! See the next part
of the source below:

:00000044 3DA1020000              cmp eax, 000002A1 <font color="#FF0000">;; handle of the button?</font>
:00000049 7577                    jne 000000C2 <font color="#FF0000">;; if not, then jump</font>
:0000004B 68A2020000              push 000002A2 <font color="#FF0000">;; ID of edit field</font>
:00000050 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of main window</font>
:00000056 FF1540E34000            call dword ptr [0040E340] <font color="#FF0000">;; call GetDlgItem</font>
:0000005C 6A32                    push 00000032 <font color="#FF0000">;; push maximum length of text (32h=50)</font>
:0000005E 6888B64000              push 0040B688 <font color="#FF0000">;; buffer where to write text from edit</font>
:00000063 50                      push eax <font color="#FF0000">;; handle of edit field</font>
:00000064 FF15A8E34000            call dword ptr [0040E3A8] <font color="#FF0000">;; GetWindowTextA</font>
:0000006A 3D00000000              cmp eax, 00000000 <font color="#FF0000">;; Length of text = 0?</font>
:0000006F 7451                    je 000000C2 <font color="#FF0000">;; if so, then jump</font>
:00000071 BE88B64000              mov esi, 0040B688 <font color="#FF0000">;; buffer of text</font>
:00000076 AC                      lodsb <font color="#FF0000">;; get one char in al</font>
:00000077 0AC0                    or al, al <font color="#FF0000">;; is char=0?</font>
:00000079 7447                    je 000000C2 <font color="#FF0000">;; if so, jump</font>
:0000007B 8AD8                    mov bl, al <font color="#FF0000">;; move char to bl</font>
:0000007D B880FD6400              mov eax, 0064FD80 <font color="#FF0000">;; address of the MSG structure</font>
:00000082 80FB61                  cmp bl, 61 <font color="#FF0000">;; if BL < a</font>
:00000085 7208                    jb 0000008F <font color="#FF0000">;; then jump</font>
:00000087 80FB7A                  cmp bl, 7A <font color="#FF0000">;; if BL > z</font>
:0000008A 7303                    jnb 0000008F <font color="#FF0000">;; then jump</font>
:0000008C 80EB20                  sub bl, 20 <font color="#FF0000">;; convert small letter to capital letter</font>
:0000008F 885808                  mov byte ptr [eax+08], bl <font color="#FF0000">;; see below</font>
:00000092 80FB41                  cmp bl, 41 <font color="#FF0000">;; if BL < A</font>
:00000095 720D                    jb 000000A4 <font color="#FF0000">;; then jump</font>
:00000097 80FB59                  cmp bl, 59 <font color="#FF0000">;; if BL > Y</font>
:0000009A 7708                    ja 000000A4 <font color="#FF0000">;; then jump</font>
:0000009C 66C740040001            mov [eax+04], 0100 <font color="#FF0000">;; 0100=ASCII</font>
:000000A2 EB06                    jmp 000000AA
:000000A4 66C740040201            mov [eax+04], 0102 <font color="#FF0000">;; 0102=Virtual Key</font>
:000000AA 50                      push eax <font color="#FF0000">;; Here comes</font>
:000000AB FF3598B44000            push dword ptr [0040B498] <font color="#FF0000">;; the call</font>
:000000B1 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; to TranslateAcceleratorA</font>
:000000B7 FF15FCE34000            call dword ptr [0040E3FC] <font color="#FF0000">;; again</font>
:000000BD E9B4FFFFFF              jmp 00000076 <font color="#FF0000">;; jump back and get next char</font>

Getting the handle of the edit field and reading the text of it should be pretty clear. The
only question is how I found out where to save the Text. I just looked around in SICE until I 
found a vast area with 00-bytes. That became my buffer. Next question should comes at line 7D.
How did I find the value 64FD80? Take the unpatched calc.exe and set a breakpoint on Translate-
AcceleratorA. Eax will *always* have the value 64FD80, when it breaks regularly. This is the 
address of the MSG-structure that is passed to TranslateAcceleratorA. To understand what 
happens then, we have to look at the definition of the MSG structure:

typedef struct tagMSG {
    HWND   hwnd;	 // DWORD (eax)
    UINT   message;      // DWORD (eax+4)
    WPARAM wParam;       // DWORD (eax+8)
    LPARAM lParam; 
    DWORD  time; 
    POINT  pt; 
} MSG;

Now, for simulating an Accelerator, we have to change the message and the wParam to our needs.
The wParam is the key that should be simulated ([eax+8]), the message ([eax+4] contains either 
"VKey" or "ASCII". See the AcceleratorTable in BRW and you should understand what to use for
which key. At the end we just have to "push" the parameters and call TranslateAcceleratorA. 
The hardest things are done now, let's head for the menus.
The first menu I will handle is "Center Window". The menupoint has the handle 29Ah.

:000000C2 3D9A020000              cmp eax, 0000029A <font color="#FF0000">;; is "Center Window" chosen?</font>
:000000C7 756E                    jne 00000137 <font color="#FF0000">;; if not, then jump</font>
:000000C9 8D45AC                  lea eax, dword ptr [ebp-54] <font color="#FF0000">;; eax=adress of RECT structure</font>
:000000CC 50                      push eax <font color="#FF0000">;; RECT</font>
:000000CD FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of main window</font>
:000000D3 FF151CE34000            call dword ptr [0040E31C] <font color="#FF0000">;; GetWindowRect</font>
:000000D9 68AEEA4000              push 0040EAAE <font color="#FF0000">;; "USER32.DLL"</font>
:000000DE FF1590E24000            call dword ptr [0040E290] <font color="#FF0000">;; GetModuleHandle</font>
:000000E4 681C1B4100              push 00411B1C ;; <font color="#FF0000">"GetSystemMetrics"</font>
:000000E9 50                      push eax <font color="#FF0000">;; handle of User32.dll</font>
:000000EA FF15DCE24000            call dword ptr [0040E2DC] <font color="#FF0000">;; GetProcAdress</font>
:000000F0 50                      push eax <font color="#FF0000">;; save adress of GetSystemMetrics</font>
:000000F1 6A00                    push 00000000 <font color="#FF0000">;; SM_CXSCREEN</font>
:000000F3 FFD0                    call eax <font color="#FF0000">;; GetSystemMetrics</font>
:000000F5 2B45B4                  sub eax, dword ptr [ebp-4C] <font color="#FF0000">;; these few lines</font>
:000000F8 0345AC                  add eax, dword ptr [ebp-54] <font color="#FF0000">;; calculate the</font>
:000000FB D1E8                    shr eax, 1 <font color="#FF0000">;; new position of the right border</font>
:000000FD 8BD8                    mov ebx, eax <font color="#FF0000">;; and save it in ebx</font>
:000000FF 58                      pop eax <font color="#FF0000">;; load adress of GetSystemMetrics</font>
:00000100 6A01                    push 00000001 <font color="#FF0000">;; SM_CYSCREEN</font>
:00000102 FFD0                    call eax <font color="#FF0000">;; GetSystemMetrics</font>
:00000104 2B45B8                  sub eax, dword ptr [ebp-48] <font color="#FF0000">;; these few line</font>
:00000107 0345B0                  add eax, dword ptr [ebp-50] <font color="#FF0000">;; calculate the</font>
:0000010A D1E8                    shr eax, 1 <font color="#FF0000">;; new position of the upper border</font>
:0000010C 50                      push eax <font color="#FF0000">;; and save it </font>
:0000010D 8B45B0                  mov eax, dword ptr [ebp-50] <font color="#FF0000">;; these two lines calculate</font>
:00000110 2945B8                  sub dword ptr [ebp-48], eax <font color="#FF0000">;; the width of the window</font>
:00000113 8B45AC                  mov eax, dword ptr [ebp-54] <font color="#FF0000">;; these two lines calculate</font>
:00000116 2945B4                  sub dword ptr [ebp-4C], eax <font color="#FF0000">;; the height of the window</font>
:00000119 58                      pop eax <font color="#FF0000">;; load position of upper border again</font>
:0000011A 6A40                    push 00000040 <font color="#FF0000">;; SWP_SHOWWINDOW</font>
:0000011C FF75B8                  push [ebp-48] <font color="#FF0000">;; right border</font>
:0000011F FF75B4                  push [ebp-4C] <font color="#FF0000">;; upper border</font>
:00000122 50                      push eax <font color="#FF0000">;; width</font>
:00000123 53                      push ebx <font color="#FF0000">;; heigth</font>
:00000124 6A00                    push 00000000 <font color="#FF0000">;; HWND_TOP</font>
:00000126 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of the window</font>
:0000012C FF1558E34000            call dword ptr [0040E358] <font color="#FF0000">;; call SetWindowPos</font>
:00000132 E9AF17FFFF              jmp FFFF18E6 <font color="#FF0000">;; jump back to MessageLoop</font>

Actually nothing special here:
This code-snippet gets the current coordinates of the window first. The address of the RECT
structure (ebp-54) is found accidentely, but works good. Then we have to load the address of
GetSystemMetrics in the way that was mentioned earlier, again as this API-function is not 
loaded, too. With the help of the coordinates we get from a call to GetSystemMetrics, the new
position (Centered) of the window is calculated, with the help of the GetWindowRect call the
size of the window is calculated for the SetWindowPos call in the end.

The next part of code is the one that makes the calculator window stay on top. It is quite
similar to the last snippet, as the only changes are, that we needn't get new coordinates, but
only change one parameter of the SetWindowPos call. Furthermore we have to check/uncheck the
menu which decides, if the window stays on top, or not:


Remark 2:
The follwing code is little sloppy, but it works and recoding it in a better way would take
more time as the result will improve it, as neither speed nor size matter here.
End of Remark

:00000137 3D9B020000              cmp eax, 0000029B  <font color="#FF0000">;; is it "Stay on top" ?</font>
:0000013C 0F85C2000000            jne 00000204 <font color="#FF0000">;; if not, then jump</font>
:00000142 8D45AC                  lea eax, dword ptr [ebp-54] <font color="#FF0000">;; prepare the GetWindowRect</font>
:00000145 50                      push eax

:00000146 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of main window</font>
:0000014C FF151CE34000            call dword ptr [0040E31C] <font color="#FF0000">;; GetWindowRect</font>
:00000152 8B45B4                  mov eax, dword ptr [ebp-4C] <font color="#FF0000">;; the next lines calculate</font>
:00000155 2B45AC                  sub eax, dword ptr [ebp-54] <font color="#FF0000">;; the width of the window</font>
:00000158 8945B4                  mov dword ptr [ebp-4C], eax <font color="#FF0000">;; and save it in EBP-4C</font>
:0000015B 8B45B8                  mov eax, dword ptr [ebp-48] <font color="#FF0000">;; the next lines calculate</font>
:0000015E 2B45B0                  sub eax, dword ptr [ebp-50] <font color="#FF0000">;; the heigth of the window</font>
:00000161 8945B8                  mov dword ptr [ebp-48], eax <font color="#FF0000">;; and save it in EBP-48</font>
:00000164 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of the main window</font>
:0000016A FF1554E34000            call dword ptr [0040E354] <font color="#FF0000">;; GetMenu</font>
:00000170 50                      push eax <font color="#FF0000">;; save the handle of the menu</font>
:00000171 50                      push eax <font color="#FF0000">;; save the handle of the menu</font>
:00000172 50                      push eax <font color="#FF0000">;; save the handle of the menu</font>
:00000173 90                      nop <font color="#FF0000">;; part of later improvement</font>
:00000174 90                      nop <font color="#FF0000">;; same</font>
:00000175 68AEEA4000              push 0040EAAE <font color="#FF0000">;; "USER32.DLL"</font>
:0000017A FF1590E24000            call dword ptr [0040E290] <font color="#FF0000">;; GetModuleHandle</font>
:00000180 90                      nop <font color="#FF0000">;;part of later improvement</font>
:00000181 90                      nop <font color="#FF0000">;;part of later improvement</font>
:00000182 90                      nop <font color="#FF0000">;;part of later improvement</font>
:00000183 680F1B4100              push 00411B0F<font color="#FF0000"> ;; "GetMenuState"</font>
:00000188 50                      push eax <font color="#FF0000">;; handle of User32.dll</font>
:00000189 FF15DCE24000            call dword ptr [0040E2DC] <font color="#FF0000">;; GetProcAddress</font>
:0000018F 5B                      pop ebx <font color="#FF0000">;; load handle of the menu</font>
:00000190 6A00                    push 00000000 <font color="#FF0000">;; MF_BYCOMMAND</font>
:00000192 689B020000              push 0000029B <font color="#FF0000">;; ID of the menu point</font>
:00000197 53                      push ebx <font color="#FF0000">;; handle of the menu</font>
:00000198 FFD0                    call eax <font color="#FF0000">;; call GetMenuState</font>
:0000019A 3D08000000              cmp eax, 00000008 <font color="#FF0000">;; is checked?</font>
:0000019F 7533                    jne 000001D4 <font color="#FF0000">;; if not, then jump</font>
:000001A1 90                      nop <font color="#FF0000">;; fell away when optimizing</font>
:000001A2 90                      nop <font color="#FF0000">;; fell away when optimizing</font>
:000001A3 90                      nop <font color="#FF0000">;; fell away when optimizing</font>
:000001A4 58                      pop eax <font color="#FF0000">;; load handle of menu</font>
:000001A5 6A00                    push 00000000 <font color="#FF0000">;; MF_UNCHECKED</font>
:000001A7 689B020000              push 0000029B <font color="#FF0000">;; ID of Menupoint</font>
:000001AC 50                      push eax <font color="#FF0000">;; handle of Menu</font>
:000001AD FF154CE34000            call dword ptr [0040E34C] <font color="#FF0000">;; call CheckMenuItem</font>
:000001B3 6A40                    push 00000040 <font color="#FF0000">;; The following lines</font>
:000001B5 FF75B8                  push [ebp-48] <font color="#FF0000">;; prepare the</font>
:000001B8 FF75B4                  push [ebp-4C] <font color="#FF0000">;; call to</font>
:000001BB FF75B0                  push [ebp-50] <font color="#FF0000">;; SetWindowPos</font>
:000001BE FF75AC                  push [ebp-54] <font color="#FF0000">;; still preparing</font>
:000001C1 6AFE                    push FFFFFFFE <font color="#FF0000">;; HWND_NOTOPMOST</font>
:000001C3 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of window</font>
:000001C9 FF1558E34000            call dword ptr [0040E358] <font color="#FF0000">;; SetWindowPos</font>
:000001CF E91217FFFF              jmp FFFF18E6 <font color="#FF0000">;; return to messageloop</font>
:000001D4 5B                      pop ebx <font color="#FF0000">;; load handle of menu</font>
:000001D5 6A08                    push 00000008 <font color="#FF0000">;; MF_CHECKED</font>
:000001D7 689B020000              push 0000029B <font color="#FF0000">;; ID of Menupoint</font>
:000001DC 53                      push ebx <font color="#FF0000">;; push handle of menu</font>
:000001DD FF154CE34000            call dword ptr [0040E34C] <font color="#FF0000">;; CheckMenuItem</font>
:000001E3 6A40                    push 00000040 <font color="#FF0000">;; and preparing</font>
:000001E5 FF75B8                  push [ebp-48] <font color="#FF0000">;; SetWindowPos</font>
:000001E8 FF75B4                  push [ebp-4C] <font color="#FF0000">;; once again</font>
:000001EB FF75B0                  push [ebp-50]
:000001EE FF75AC                  push [ebp-54]
:000001F1 6AFF                    push FFFFFFFF <font color="#FF0000">;; HWND_TOPMOST</font>
:000001F3 FF35D8B54000            push dword ptr [0040B5D8] <font color="#FF0000">;; handle of window</font>
:000001F9 FF1558E34000            call dword ptr [0040E358] <font color="#FF0000">;; SetWindowPos</font>
:000001FF E9E216FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to MessageLoop</font>

At first we have to call GetWindowRect again. It will return (after some calculation) the
parameters we use for the SetWindowPos call. The well-known GetModuleHandle/GetProcAddress
for getting the address of GetMenuState. In combination of GetMenu we can find out, whether the
menupoint is checked or not. Then, after the conditional jump (condition: menu checked?) at 
:19A we set the new position of the window using the parameters HWND_NOTOPMOST and HWND_TOPMOST.

The code for "Start Notepad":
:00000204 3D9C020000              cmp eax, 0000029C <font color="#FF0000">;; is "Start Notepad" chosen?</font>
:00000209 7525                    jne 00000230 <font color="#FF0000">;; if not, then jump</font>
:0000020B 68ACE64000              push 0040E6AC <font color="#FF0000">;; push "KERNEL32.DLL"</font>
:00000210 FF1590E24000            call dword ptr [0040E290] <font color="#FF0000">;; "GetModuleHandle"</font>
:00000216 68071B4100              push 00411B07 <font color="#FF0000">;; "WinExec"</font>
:0000021B 50                      push eax <font color="#FF0000">;; handle of Kernel32.dll</font>
:0000021C FF15DCE24000            call dword ptr [0040E2DC] <font color="#FF0000">;; GetProcAddress</font>
:00000222 6A01                    push 00000001 <font color="#FF0000">;; SW_SHOW</font>
:00000224 68EA174100              push 004117EA <font color="#FF0000">;; "Notepad.exe"</font>
:00000229 FFD0                    call eax <font color="#FF0000">;; call WinExec</font>
:0000022B E9B616FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to MessageLoop</font>

You see: It's getting easier :) This time just finding out the address of WinExec and then
passing the string "Notepad.exe" to WinExec which I wrote at offset D9EAh into lazcalc.exe.

I won't explain the rest of my changes, as they can easily be understood just reading the
comments (and perhaps your API reference).

The code for "Help":
:00000230 3D9D020000              cmp eax, 0000029D <font color="#FF0000">;; is "Help" chosen ?</font>
:00000235 7516                    jne 0000024D <font color="#FF0000">;; if not, then jump</font>
:00000237 6A00                    push 00000000 <font color="#FF0000">;; no additional data</font>
:00000239 6A03                    push 00000003 <font color="#FF0000">;; HELP_INDEX</font>
:0000023B 68F6174100              push 004117F6 <font color="#FF0000">;; "lazcalc.hlp"</font>
:00000240 6A00                    push 00000000 <font color="#FF0000">;; didn't specify a window handle</font>
:00000242 FF1514E34000            call dword ptr [0040E314] <font color="#FF0000">;; WinHelpA</font>
:00000248 E99916FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to messageloop</font>

The code for "About":
:0000024D 3D9E020000              cmp eax, 0000029E <font color="#FF0000">;; is "About" chosen?</font>
:00000252 7519                    jne 0000026D <font color="#FF0000">;; if not, then jump</font>
:00000254 6A00                    push 00000000 <font color="#FF0000">;; MB_OK</font>
:00000256 68E1174100              push 004117E1 <font color="#FF0000">;; Caption of the box</font>
:0000025B 68AE174100              push 004117AE <font color="#FF0000">;; Text of the box</font>
:00000260 6A00                    push 00000000 <font color="#FF0000">;; no window specified</font>
:00000262 FF150CE44000            call dword ptr [0040E40C] <font color="#FF0000">;; MessageBoxA</font>
:00000268 E97916FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to messageloop</font>

The code for "Quit":
:0000026D 3DA0020000              cmp eax, 000002A0 <font color="#FF0000">;; is "Quit" chosen?</font>
:00000272 750D                    jne 00000281 <font color="#FF0000">;; if not, jump</font>
:00000274 6A00                    push 00000000 <font color="#FF0000">;; Exit code = 0</font>
:00000276 FF1500E34000            call dword ptr [0040E300] <font color="#FF0000">;; ExitProcess</font>
:0000027C E96516FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to MessageLoop</font>
:00000281 E96016FFFF              jmp FFFF18E6 <font color="#FF0000">;; back to MessageLoop</font>

The only thing that is worth to ask is why my code ends with two jumps: Well, in this case
it is easier to add new functions, as the second jump is just to be replaced by a "cmp eax,..."
if you want to add more.
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final Notes</fonT>

</fonT></center></td></tr></table>

<pre>
Wow, you have come so far, despite my writing style. Either you are hard to bore, or you only
read Introduction and Last Words of the essay.
OK, now the last words:
Don't even think about, that this was an easy task. Also the essay is written as if I needed
only short more than half an hour, I in fact needed nearly two weeks, but nevertheless I believe
that the result is quite acceptable and I felt really good when I finished :)
My thanx go to #cracking4newbies for (most time) quick help when I was stuck. For detailed
greetings consult the helpfile that comes shipped with <a href="http://acrigs.com/FRAVIA/zipped/lazcalc.zip" tppabs="http://members.xoom.com/tsehp_/zipped/lazcalc.zip">lazcalc.zip</a>

If you have the desire to add more functions, or to improve my code, please send your result to
<a href="mailto:lazarus_hf@hotmail.com">lazarus_hf@hotmail.com</a> If you want to tell me something else, use this address, too.
<!-- PASTE HERE YOUR FINAL NOTES (if any) --><br>
Possible functions you could add:
1. Make LaZ-Calc work in Standard-mode or at least auto-uncheck the checkbox<br>2. Center window at startup
3. Change the caption of the window<br>4. Get rid of the checkbox and auto-choose LaZ-Calc options if the edit field is enabled
5. Add hotkeys for LaZ-Calc buttons/menus...
6. Make it possible to use the buttons that need a key combination with STRG or ALT...<br>7. ... (a million more)<br>
If you need some more information to realize this, don't hesitate to contact me.
<!-- OB DUH STARTS HERE -->
</pre>

<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >

<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>

</center></td></tr></table><center><i>Doesn't apply, does it?</i></center>



<!-- WAY OUT STARTS HERE -->

<hr><center><i>You are deep inside reverser's page of reverse engineering,  

choose your way out:<br><br></i></center>

<br><center>

<!-- EITHER A NICE GIF LIKE THIS -->

<!-- 

<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 

ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>

<br>

<font color=gray>Back to project 3</FonT>

<br><bR>

-->

<!-- OR JUST A LINK LIKE THIS -->



<!--

<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 

<hr width=33%>

-->



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>

<br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>

<br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>



<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>

<br>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 

BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>

</CENTER>

<hr>

<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->

</BODY>

</HTML><html>
<head>
<title>crook</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to crack &quot;uncrackable&quot; test4 by LordByte<br>
(Improved protection cracking)</h2><h4><i>by Crook</i></h4>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page of reverse engineering</center>
<center>~<br>
<i>Well, I'm sorry about this, I publish this VERY GOOD essay about cryptography and 
reverse engineering for the second time. The vagaries of the internet protocol transfer have 
had as result some interpolated lines in the final uuencoded part (solver.zip).
I'll link to that and eliminate the uuencoded part as soon as crook reads this and 
tells me where I can download server.zip<br>This said, if you read and study this 
essay, you'll become a &quot;Xor_master&quot;, like Crook</i></center> <hr size="2">
<pre>
                 How to crack &quot;uncrackable&quot; test4 by LordByte

                            by Croock, 14 June 1997

                                What is test4?


     Test4  is  fourth  in  row of small challanges from LordByte. This one is
1251 bytes long and it was uncrackable for some time (I don't know when it was
written).  Quoting author of this test &quot;the only purpose of it is to challenge
superior Crackers. ONLY password can be accepted. NO PATCH can qualify!&quot;.

     The  technique  used  in  this  test  is  called  one-time  pad. If every
variation of this method is so easily cracked, you can forget about it.

     TEST4  in  UUENCODED  form is available on the end of this text (as a ZIP
file  with  some  other  stuff,  like  source  codes  to all C programs). It's
patched  a  little bit, because LordByte wrote a routine which changed colours
of  frame  on  the  screen and I simple don't like it. If you want to look how
original  effect looked like change bytes in offset E9 to BA 16. My patch DOES
NOT  change  the  way  of  password  is  processed, so it's not a violation of
LordByte's  condition.  Passwords generated by my genpass.c (in ZIP file) work
in both versions of test4: patched &amp; unpatched.


                       Target audience of this tutorial

     Everyone  wishing  to  learn  something. You MUST know assembly and basic
math before trying to read this. Of course you can read without even trying to
think  how  was it done, but it's just wasted time. The knowledge of C is also
an advantage, because I'm going to show you program in C which does whole work
for us.

                                 Brute force

     When there are passwords around there is also a brute force approach. But
after short calculations I've started to think about some smarter method.
     There  are  2^96  possible  passwords.  Assuming  that  you've  written a
program,  which can check 1 million passwords per second, it means you have to
wait 2^49 years, until it finishes.
     After  I've  cracked  test4  I  realized  that  there  are  2^60 possible
passwords.  But  even knowing this brute force is slow: statisticaly for every
2^36 wrong passwords, there is one good. Checking million passwords per second
it would take about 18 hours. My method takes about 1 minute on 486DX/33... ;)
                                         [This paragraph was dedicated to ACP]


                                 Let's start


     The  first  thing  you  must  do is to understand the test4.com. Run your
favourite  debugger  (Turbo  Debugger will be enough) and look deeply into the
code,  trying  to  understand  what's  doing  inside  of  it.  Without perfect
understanding  of method password is processed you won't be able to understand
further  parts  of  this  tut. However, below is disassembly of vital parts of
test4.com to help you with this task.

     mov dx, offset text1
     call show_text
     call hook_int
     mov dx, offset text2
     call show_text
     mov dx, offset buffer
     mov ax, 0A00h         ; get password
     int 21h

     This  is  the start of TEST4. You're writing some messages on the screen,
hooking  time interrupt to blink the frame (patched by me, so there will be no
such   effect),  and  getting  password  into  the  buffer.  As  far,  nothing
complicated.

start:
     mov ebx, 0
get_4_bytes_out_of_password_into_eax:
     lea esi, [ebx+offset password]
     lea edi, table
     mov eax, [esi]
     cmp ah, 0Dh
     jz manipulate_with_password
do_xor:
     xor [edi], eax
     rol eax, 2
     inc edi
     cmp dword ptr [edi+4], 0
     jnz do_xor
     inc ebx
     jmp short get_4_bytes_out_of_password_into_eax

     Let me tell you what's going there. In start you're zeroing ebx, which is
index register from now on - it's char number in password. Next, load into esi
address  of  char  number  ebx in password, and into edi address of the table,
which will be xored by the values depending on password. Then you're getting 4
bytes  of  the  password  into  eax  and  checking if you're on the end of the
password. If you are, then you must change password (of course by xoring it by
some values).
     Code  after  do_xor label is the main part of this program. Four bytes in
the  table  are xored by the eax. Then eax is rolled 2 bits to the left, index
in  the table (edi) is increased by one. You don't want to xor anything except
the  table, so there must be checking if you're out of table boundaries, which
is  done  in the next line. If you've whole table xored, the ebx (index in the
password) is increased by one, and the whole story begins once again.

manipulate_with_password:
     lea esi, table
     mov eax, [esi]
     lea esi, password
     xor [esi], eax
     xor [esi+4], eax
     xor [esi+8], eax
     inc pass_count
     cmp pass_count, 3
     jnz not_3_pass
     mov xor_key, eax
not_3_pass:
     cmp pass_count, 5
     jnz start

     This part is easy to understand: get first four bytes from the table into
eax,  then xor password with it. Next increase pass count. If it's third pass,
you're storing eax for later use (to decrypt ciphered message). If it's fifth,
you can go further.

     mov ebx, 0
check:
     lea esi, [ebx+offset table]
     lea edi, [ebx+offset target_table]
     mov eax, [esi]
     xor [edi], eax
     jnz bad_password
     add ebx, 4
     cmp dword ptr [esi+4], 0
     jnz check

     This  piece of code is also pretty obvious - the good password transforms
original  table  into  target_table  (also  stored  in  file). Checking if the
password  is good is reduced to check if both, table and target_table, are the
same.  Above  snippet  of code does just that - if the tables are different it
means the password is bad. If they're the same - OK, user is a good cracker ;)

     mov si, good_password_message
     mov eax, xor_key
xor_message:
     xor [si], al
     rol eax, 4
     inc si
     cmp byte ptr [si], 24h
     jnz xor_message
     mov dx, good_password_message
     call show_text
     jmp short end_program

     Here  the  text  is  decrypted. The algorithm is very simple, however you
should study it, because it's important part of the crack.
     If you perfectly understand what is going on you can read furher - if you
have  any  doubts  then  read this again and again until you understand. It is
strongly recommended to know exactly how it works.


               Main idea of crack (or, should I say, croock ;)

     The  target_table  can  be  presented  as a row of bits. Nothing exciting
about  this. But it can be also presented as value (0 or 1) and number of bits
from the password it is xored. And that's exciting, because it's the main idea
which  allowed  me to make C program to crack this program. Don't worry if you
don't understand anything - I'll show you an example.

     Let's  assume  you've got target value: 0xe9, and the source value: 0x5f.
You've got also a &quot;magic box&quot; which transforms source value into target value:

source value (0x5f) --&gt; [MAGIC BOX] --&gt; target_value (0xe9)

     You  also know that magic box uses just xor to transform values. You even
know  the  schema  of this xors, but we don't know the password. Let's say the
password has 4 bits.

0 bit from source xored by 0, 1, 3 bits from password gives 0 bit from target
1 bit from source xored by 1, 2, 3 bits from password gives 1 bit from target
2 bit from source xored by 0 bit from password gives 2 bit from target
3 bit from source xored by 1, 2 bits from password gives 3 bit from target
4 bit from source xored by 3 bit from password gives 4 bit from target
5 bit from source xored by 2, 3 bits from password gives 5 bit from target
6 bit from source xored by 0, 3 bits from password gives 6 bit from target
7 bit from source xored by 1, 3 bits from password gives 7 bit from target

     This  allows  us  to  recover the password. How? By creating eight linear
equations. Symbol 0s means bit 0 from source, 7t - seventh bit from target, 2p
- second bit from password. Above 8 conditions can be written as:

0s xor 0p xor 1p xor 3p = 0t
1s xor 1p xor 2p xor 3p = 1t
2s xor 0p = 2t
3s xor 1p xor 2p = 3t
4s xor 3p = 4t
5s xor 2p xor 3p = 5t
6s xor 0p xor 3p = 6t
7s xor 1p xor 3p = 7t

     You  know source and targets bits so you can change 0s, 1s and so on into
values:

(0x5f)           (0xe9)

1 xor 0p, 1p, 3p = 1
1 xor 1p, 2p, 3p = 0
1 xor 0p =         0
1 xor 1p, 2p =     1
1 xor 3p =         0
0 xor 2p, 3p =     1
1 xor 0p, 3p =     1
0 xor 1p, 3p =     1

     By xoring both sides of equations by the values on the left side (this is
basic math I've written earlier) you get:

0p xor 1p xor 3p = 0
1p xor 2p xor 3p = 1
0p               = 1
1p xor 2p        = 0
3p               = 1
2p xor 3p        = 1
0p xor 3p        = 0
1p xor 3p        = 1

     Solving  this set of equations (using whichever method - e.g. using sheet
of paper and a pencil ;) you get:

0p = 1
1p = 0
2p = 0
3p = 1, so the password is 1001.

     I  think the main idea is clear now: you must build up a schema of xoring
for every bit in the table, on then solve the equations. This is not so simple
as  in the above examples - the table is 122 bytes long, so it's 976 bits, and
for  each  you must build up an equations. Then you must solve these equations
using some smart method, because solving 976 equations on sheet of paper would
take  ages. Using some programming language (e.g. C) you are now able to write
a program which will do crack for us.


                              Hey, wait a minute

     Above  explanations  are true, but you're forgetting about one thing - in
the  third  pass  (if you don't remember - please study the code again) you're
storing  eax into memory, and then this value is used to decipher some crypted
text.  Who  can  guearantee us, that password which will transform target into
target_table will also generate valid key for decrypting this text? That's why
you  must build 32 equations extra for this condition. Finally you've got 1008
instead of 976 equations.


                               Finding xor_key


     All  right,  but  how  can  you find this key? The answer is simple - the
decrypted  text  should end with three bytes 0xd, 0xa, 0x24 (if you don't know
why,  study  some info about int21/ah=9 function). The layout of the test4.com
in memory looks like this:

0100 code
02c4 buffer for password
02d3 &quot;Enter password&quot; text
02ea table
036a ciphered text
03b5 target_table

     target_table  is  zeroed  after comparing function (check label) if table
and  target_table  are  the same, so the last three bytes of the ciphered text
are  stored  in  03b2,  03b3  and 03b4 offsets. It's 0x9e, 0x40 and 0xfe. 0x9e
should be xored to 0xa, 0x40 to 0xd and 0xfe to 0x24. That means 0x9e is xored
by 0x94, 0x40 by 0x4d and 0xfe by 0xda.

0x9e xor 0x94 = 0xa
0x40 xor 0x4d = 0xd
0xfe xor 0xda = 0x24

     In  eax  you've  got  the  key.  I'm assuming every letter is a nibble (4
bits):

eax: abcdefgh
al: gh

     So, first byte is xored by gh. Then eax is rolled 4 bits left:

eax: bcdefgha
al: ha

     Second  byte  is  xored  by  ha, and so on. Look what happens when you're
xoring ninth byte:

1: abcdefgh
2: bcdefgha
3: cdefghab
4: defghabc
5: efghabcd
6: fghabcde
7: ghabcdef
8: habcdefg
9: abcdefgh

     It  means  that key is same for bytes which are in the same column of the
dump pane in TD.

DS:036A D7 22 B4 C1 13 71 70 EC <-- This is dump panel from TD DS:0372 F8 2C AE .. .. .. .. .. ... DS:03B2 9E 40 FE .. .. .. .. .. Xoring D7,22,B4 by 94,4D,DA you get "Con". This should be beginning of the "Congratulations" string. Let's go further: xor D7,22,B4,C1,13,71,70,EC with "Congratu". You're getting 8 bytes: 94,4D,DA,A6,61,10,09,99. You've got whole information, but you must "pack" 8 bytes into 4. The lowest byte is 0x94. Then, after ROL EAX,4 you should get 0x4d in al. That means the highest nibble is 0xd. After next ROL al is 0xda, so the second highest nibble is 0xa. Going further, you can reconstruct the key, which is 0xda610994. Using this value, you can decrypt text: "Congratulations. You have done the what cannot be done .. Tell me how ?!" Wow! First success! You haven't done anything spectacular by now, but you will, don't worry ;) Program Whole source code "for.class" tppabs="http://fravia.org/for.class" testcrk.c which is the main part of my work is included in ZIP file, UUENCODED at the end of this file. Below are the main parts of the code, commented as good as I can. #define KEYCHARS 16 #define KEYBITS KEYCHARS * 8 #define XORCHARS 122 #define XORBITS XORCHARS * 8 #define EQUATIONS XORBITS + 32 #define KEYSIZE KEYBITS * (KEYBITS + 1) #define XORSIZE XORBITS * (KEYBITS + 1) KEYCHARS number of chars in the buffer KEYBITS number of bits in the buffer XORCHARS size of table XORBITS number of bits in the table EQUATIONS number of equations to solve KEYSIZE size of whole TabKey table XORSIZE size of whole TabCipher table char huge TabKey[KEYBITS][KEYBITS+1]; // password char huge TabCipher[EQUATIONS][KEYBITS+1]; // table for XOR char AktKey[32][KEYBITS+1]; // current key char Temp[2][KEYBITS+1]; // temporary for ROL char TabPass[KEYBITS]; // password divided into bits char password[KEYCHARS]; char TempEqu[12 * 8 + 1]; // temp for swap_equ unsigned char solved[EQUATIONS]; TabKey table where the key (whole 16-char buffer) will be stored, divided into bits. If the n-th bit is set to 1 (0 < n < KEYBITS), that means this bit is XORed by n-th from the buffer. If the KEYBITS bit is set it means it is XORed by 1. TabCipher table where the table is stored, divided into bits. Format same as above. AktKey key divided into bits (value stored in eax, used to XOR bytes from table). Format same as above. Temp temporary table to perform ROL EAX,2 on AktKey TabPass password divided into bits. If the n-th bit is set, it means the n-th bit in the password is 1. If not the bit is 0. WARNING: I've implemented other bit numbering system: bit 0 is the most significant bit, and the (KEYBITS-1) is the least significant. password password in bytes. Used by do_test() routine. Just for testing purposes. Left for historical reasons ;) TempEqu temporary swap space for swap_equ functions, which swaps places of two equations solved if the n-th element of this table is set, that means it was used to calculate some bit in password. More details on solve() functions comment FILE *org; char passsize; char size_pass[]="{11," 14, 14, 14}; char passchars="0," passbits="0;" char yesorno; org file struct, used on file operations passsize current password size, more details on create_table() function comment size_pass table to get passsize from, more details on create_table() function comment passchars number of letters in password. Set by user. passbits number of bits in password. Set by user. void create_table() Function which is the alfa & omega here. Creates the XOR schema. int i, j; unsigned char mask, chr, byte[XORCHARS]; long cipherpos; int pass, keychar, bits, xor_char; unsigned char buffer[KEYBITS + 1]; i, j counters, used in various for loops mask, chr, byte, cipherpos used when loading ORG.DAT pass pass index keychar char index from the password processed bits bit index when xoring table by eax xor_char char index when xoring table by eax buffer buffer used when reading from CIPHER.DAT if ((org="fopen(&quot;CIPHER.DAT&quot;," "rb")) !="NULL)" { fread(byte, 1, 1, org); if (byte[0]="=" passchars) { printf("reading from CIPHER.DAT...\n"); for (i="0;" i < EQUATIONS; i++) { fread(buffer, KEYBITS+1, 1, org); // we cannot use _fmemcpy, coz it fails sometimes on huge tables for (j="0;" j <="KEYBITS;" j++) TabCipher[i][j]="buffer[j];" } fclose(org); return; } } Above piece of code loads the equations from CIPHER.DAT, instead of creating them from scratch. This file is created on the end of create_table(). Speeds up the process of cracking after first time. memset(TabPass, 0, KEYBITS); _fmemset(TabKey, 0, KEYSIZE); // initiate TabKey for (i="0;" i < passbits; i++) // set passbits bits TabKey[i][i]="1;" TabKey[passchars*8][KEYBITS]="0;" // char after password is 0x0d ... TabKey[13*8][KEYBITS]="0;" // 13th char is 0x0a ... TabKey[14*8][KEYBITS]="0;" // on 14th pos we've got 0x0d ... TabKey[15*8][KEYBITS]="0;" // on 15th there's is 0x20 ... passsize="passchars;" Initialization code. Sets up bits like in the original test4.com: x|x|x|x|x|x|x|x|x|x|x|x|0xd|0xa|0x0d|0x20| this is the case when the password has 12 chars. x|x|x|x|x|x|x|x|x|x|0xd|0|0|0xa|0x0d|0x20| it looks like this, when the password has 10 chars. if ((org="fopen(&quot;ORG.DAT&quot;," "rb"))="=" NULL) { printf("ORG.DAT not found!\n"); exit(255); } _fmemset(TabCipher, 0, XORSIZE); // initiate TabCipher cipherpos="0;" fread(byte, XORCHARS, 1, org); fclose(org); for (i="0;" i < XORCHARS; i++) for (mask="0x80;" mask !="0;" mask>&gt;= 1)
  {
    if ((byte[i] &amp; mask) == mask) TabCipher[cipherpos][KEYBITS] = 1;
    cipherpos++;
  }
------------------------------------------------------------------------------

     Loads  the  ORG.DAT  into  memory and transforms it into bits. ORG.DAT is
table stored in separate file.

------------------------------------------------------------------------------
for (pass = 0; pass <5; pass++) { for (keychar="0;" keychar < (passsize 1); keychar++) { putch('.'); memcpy(AktKey, TabKey[keychar*8+24], 8*(KEYBITS+1)); // get current key memcpy(AktKey[8], TabKey[keychar*8+16], 8*(KEYBITS+1)); // but reversed memcpy(AktKey[16], TabKey[keychar*8+8], 8*(KEYBITS+1)); memcpy(AktKey[24], TabKey[keychar*8], 8*(KEYBITS+1)); When you execute instruction MOV EAX,[ESI] and in [ESI] you've got ABCD where A, B, C, D are bytes, in EAX you get DCBA That's why you must copy to AktKey using this strange-looking code. for (xor_char="0;" xor_char <="(XORCHARS" 4); xor_char++) { for (bits="24;" bits < 32; bits++) do_xor(TabCipher[xor_char * 8 + bits 24], AktKey[bits]); for (bits="16;" bits < 24; bits++) do_xor(TabCipher[xor_char * 8 + bits 8], AktKey[bits]); for (bits="8;" bits < 16; bits++) do_xor(TabCipher[xor_char * 8 + bits + 8], AktKey[bits]); for (bits="0;" bits < 8; bits++) do_xor(TabCipher[xor_char * 8 + bits + 24], AktKey[bits]); memcpy(Temp, AktKey, 2 * (KEYBITS + 1)); memmove(AktKey, AktKey[2], 30 * (KEYBITS + 1)); memcpy(AktKey[30], Temp, 2 * (KEYBITS + 1)); } Does right XORing. Because the XOR [ESI], EAX behaves like written in above comment we have to do it also in reverse byte order. The next 3 instructions are equivalent to ROL EAX,2 for (bits="0;" bits < 32; bits++) { do_xor(TabKey[bits], TabCipher[bits]); do_xor(TabKey[32 + bits], TabCipher[bits]); do_xor(TabKey[64 + bits], TabCipher[bits]); } After finished pass you must XOR password with the beginning of table. if (pass="=" 2) set_eax(); if (passsize < 12) passsize="14;" When it's third pass (first pass has number 0 assigned) we must build that 32 additional equations (done in set_eax()). Remember when the process of XORing was stopped, and next pass was begining? When the AH was 0dh. So, when the 0dh put after password by int21h/ah="0a" function is inside the 12-byte snip, it's being XORed by some values from table and there's no 0dh to stop. The nearest 0dh is on the 14th position, and that's way when we have less then 12 chars in password we must set passsize after first pass to 14. create_equations() This function converts data stored in TabCipher to equations (also stored in TabCipher). The target_table, used for creating right hand side of equations is store in XOR.DAT file, which is a dump from TEST4.COM solve() This function solves the equations created in TabCipher by create_equations() using Gauss-Jordan method. Let me show you the algorithm on example. Let's say we've got following set of equations a xor b xor d="1" c xor d="0" a xor c xor d="1" a xor c="0" It can be written also as 1*a xor 1*b xor 0*c xor 1*d="1" 0*a xor 0*b xor 1*c xor 1*d="0" 1*a xor 0*b xor 1*c xor 1*d="1" 1*a xor 0*b xor 1*c xor 0*d="0" Writing it in compact form: 1101 1 0011 0 1011 1 1010 0 It's the format the equations are stored in TabCipher after create_equations() function was called. The Gauss-Jordan algorithm works like this: Let's eliminate 1 from the first column, leaving it just in first equation. How? By XORing all equations with 1 in the first column by first equation. 1101 1 0011 0 0110 0 <- 1101 xor 1011="0110," 1 xor 1="0" 1010 0 And XOR also fourth equation: 1101 1 0011 0 0110 0 0111 1 <- 1101 xor 1010="0111," 1 xor 0="1" We haven't got 1 on second column and second row, so let's exchange second equation with third. 1101 1 0110 0 \ 0011 0 / 0111 1 Let's eliminate 1 from second column (except second row), firstly XOR first equation with second 1011 1 <- 1101 xor 0110="1011," 1 xor 0="1" 0110 0 0011 0 0111 1 Now XOR fourth equation by second 1011 1 0110 0 0011 0 0001 1 <- 0111 xor 0110="0001," 1 xor 0="1" Do the same with third column. 1000 1 0101 0 0011 0 0001 1 And, of course with last, fourth. 1000 1 0100 1 0010 1 0001 1 The result is on the right hand side first bit in first row, second in second, and so on. In my solve() I'm using a variation of this algorithm. I don't swap the equations, but I set appropriate bit in solved table. When bit is set in the solved table, that means this equation was used as a "base" to calculate one of the bits. More details in the source code "if.class" tppabs="http://fravia.org/if.class" you want know how it works study it. After testcrk.c After running testcrk you'll get two new files test.out and equ.dat. Reading the first one will bring first success second and third bytes are, respectively, 'a' and 't'. EVERY valid, 12-char, password has to have "at" string on the second and third chars. I've written a showequ.c which converts equ.dat into equ.txt human readable form. If you have thoroughly examined testcrk.c you'll also be able to understand showequ.c with ease. Run showequ and read equ.txt. The only two additional (to "at" string) conditions are: 1. password[1]="password[12]" xor 6 2. password[4]="password[5]" xor password[6] xor ... xor password[11] xor password[1] xor 57 Just these three conditions should be met to generate a VALID password! (Look into genpass.c for details) I don't know the "original" password LordByte used but I'll get sonner or later. Hey! Password generated by genpass.c doesn't work! The reason for this is very simple. Remember how test4 checks if it's the end of the password and it should begin next pass? It's checking for 0dh in ah register. When 0dh appears in some strange place (after xoring password with values from the table), the schema of xoring changes dramatically, so the equations produced by testcrk.c are useless, what makes password bad. Try entering "KurwaMac" (pozdrowienia dla wszystkich Polakow <- sorry, a bit of Polish here) into genpass, and then generated password into test4. Then run TD and look where this mysterious 0dh is appearing in the password. Counting password I don't know the exact number of passwords, that can be accepted by test4. However, using caculus of probablity, I give you a good approximation. As shown in the previous paragraph, there is 8 significant (changeable) chars in password, 2 of chars are "checksums" of this eight, and 2 are constant ("at"). So, theoretically, there is 2^(8*8) password, which is 2^64. But you must remember about 0dh appearing in the password after XORing it. Let's assume (I don't know if it's right assumption. If you can give me a strict mathemathical proof, I would be pleased. Send all your tries to: croock@priv.onet.pl) that appearing 0dh on each of 12 positions has same likelihood. There are 4 passes where 0dh can appear, so it gives us 48 possible positions. The likelihood of appearing 0dh in one position is like 1 to 256. So the sumary likelihood of appearing at least one 0dh in password is 48/256, which is equal to 3/16. So, 3/16 of passwords has 0dh inside. 3 3 * 2^64 * 2^64="---------" * 2^60 16 2^4 As stated above, this is only good approximation. Why? Maybe there are some passwords with 0dh, which are good ones. Maybe the the likelihood on each position is not the same. Maybe... However, the number of passwords is so big, it makes no difference ;) Final words I hope you understand this whole crap I wrote above, and I think you'll find it useful. If you have any comments, questions or some remarks please write to croock@priv.onet.pl. Message to all lamahows: don't steal my code, it is supposed to be a learning assistance, not the occasion to change CR00CK to your nick and tell the whole world how good you are. Greetz must go to LordByte for his test4 and Razzia for his (moral) support ;) Really final words Look out! TEST5 is going out. Search for another tutorial by me, now on cracking test5 :-))) mat="ByCr00ck" 1at:14061997 begin 644 solver.zip M4$L#!!0``@`(`#2*R"*]IZ3>OR```/8@```+````1T5.4$%34RY%6$5MFE=02
MT\_7QK_I(8204$,Q!!&amp;D2Q.19@`IHF`HTE6J(*(B)&amp;&quot;A)(2:!*2IH*@T%<0"* MBOXH2@O2!*6)%%$!Q<2@TJ23O,[\;]^+G3EGSCSG,^="B9Y^=72">?%0`'```8X
M((&quot;$0@R$#`(`Z+]<\=_r]"03(3"2?!t"s.z!]+.[z:vs8)=z<<`%#j\1nk"'q M&'R\6XVERQ;[0]-^P%#HE/4F:]RQ!KETS^'2[ZQ)#,)0:#C1A`;>$B$-,6#='
M#)FF6KU9HSYEEGX00-&quot;V2LT:+\MEP[.K,C,0&gt;]@O*KA11LF@$LF.%D/6*(!<2 MJQ<F;BT^F0FP04+43&#4%5K?ZA@1GH%A`O6@H1E&1R`'^?OG6A;0-*[UDV5IW M"J<K#@O!T8AF^,Z,$GAG3Y0ZI*?<#R8#V5D#'?IC;\:.DF,,HP$*0M^3BO$;9 MQ/J7Q;*V>]%\&quot;`\%_C+^9/QP97%YAT))!D)K-!=1Z^CIPC@Y]&amp;-CD#63LQFKK
MI@MGW&amp;C&amp;(NHAK[7&gt;;RT]I#\W@$G%V--Z;]4&amp;0:)(8@MY@!AA7QW(:W6I<=!;n MQ$*S-K2B__!AHH-(%*@?(DLJJ[QIPSN4BT65GL6^C_YME$&8E@]IOBZZ7""-F M1[50T'6DWHS&R(,TM0X$R/!7VUF7(:CZ5VX_(#1.I\NGEK].SM8/!9%GP`4TW M#\_D?FPF8P$X>8*3F51S:KY^S_)8,1I*&amp;[:;7M495_`3HXC(%10U<%&1Y2#6"
M7.UNPA&F'=AN?SW&(83(@X`(=9\O[/5X2`EZ%4,?AJ8R+[:;7(:YH^,Z]!/HR
M0:E,6J])TE-MU1[[HH8RD+J:$H<P>N&-S$GU$BFHM,-%*4V8*SW.H01.,Y7BI
MM'F!6!^7X)_-OE#DU`X(-;0PS*/C=0:_]J"[HJ&LUJ&.4CA_IK+F(T5AO,P^S
M$R\T%':%F`2?!//;X2&>S1:O.>YHU519]-T5S),H>-L`E)-4\AVMTSDGT3*.8
M)$6_JR<\&O88/_'K;7@Q]Z>P#K*PF@?:M_@;-KX4]M#&!\=H!Z?;;)*(&]CY4
M+T>0P79^M['(Y+K?7XXC#X#C1["RV332]QWQT^V("NUW1<K0T>EF@FF"J&`>L
M<5%E=>#0.E('1?W8)(6HA&KAFGEI;?GL"8^$EBQ_-&?IGF1W>7$R(M'2"%X:I
M%-R!8T<&2,1G4A8L#""V>\F)-#*$#MF;M(_,P!*<]I=*]DF:MSYRUP[<,>)5K
MK$`*+B#+@ZSDH%`\%BMK19*1AH*DL%!)$E8"9(6#PK`[S<)>[R`4RC_QB#]VK
M;/OQ))S?2J3"ZM;*^)+:=P90/3-VT(RTU,;W][0.IA_GT/`>,4C1%>HE/(&amp;/&gt;
M$=IY_2ZZ(9J6P`!2MVRW&quot;UMEYB#O)&amp;\YS\@DP%US)?/.(/&gt;9_(;,P^$Q4.Z)K
M;&gt;]&quot;E&gt;-M[^ZW<lfit/o]3nxkyt.ajkac^>22%W:G]Z8<i/n(7ch:n.c\;zo'v M23,$7@F0)D\@P_@$C)DLZ/`OV+_,%UO]'.6OE\CKA&,2]RSEFTQDA(/7M63^+ MD^.^0AIT\+[<[#VX'9N0GZLJ\3J%RM@Y\Q>^I)^`TKN!'D5N[HKUHGU@@*/<" M2+UH9XQH="]79">!SI+:4#=@2O8[\Z-LJ@7<z,^3pc;f"<hs6x9!.9+f4wxr#"` M7W#U+X>(ME#_9CI_;D5#WFTQH=HHW6TWB&quot;D?[/_EX?2?ZM]=`*)IHHL8OO`=V
M?5N??AG.]JI+6D956]`#/NP*/_,NA2%P(6#H#XPP,=NUUDR;IX%;7NU(#WCG3
M;C`?1CCT35&quot;8'&amp;C*6DWKL@&amp;?F(7787OY$K4'8+?N5S%R7@JX/,WMA4Z[+&gt;13L
M\:D-OIR\$WIE2UQ(+.]LMV#4]T$Y;J_EK<'gq.%;f.nh1^r%$^:jqq--"vx(' M$W()\1Y0;^.4.+7^;_+`10/:ZP88B*J5AYKH'\<W6VOCDO8DSO+<(76I;I]F] MX2UXYPU^M1E3O9/RB#R*Y-F_:8<<?#"]<K6G(TT">%20,9E\PXP;)\&gt;\?2#:*
MX-<;:="d^'n6_2_=!r:5ak$rmty-tiqa9!!_f/%'+ruai4ju)tmw]0?(i8/?7 M<NPZLB$$!CU)KC4X\N39LU-??"LJB#,:I:R<9CB_C0"B%!&N-2$C@]&H+#8"C MNRZYK;>RVDE$)HLPA%X4*,0_TVZ-',38B(EEJ89<3_0(.o8va'm@46d#4]"yq M!HQFX[?Q5/%7D_^UD`554`HX_%TNK\/E4MPYR3+/KY)<MF)$<DZ,.?W4BO;H@ M"G`%[&IN2I'F[$F<1[3ZL"?X"F(<7S!6`>OJMAJ[L]3'-@7+=1!(FX<h[#('< MY['&W#3!H'F/NAY1E="+ZJK*[;4BTAJ8)TWZXH!($+=7@PG#ZT6X;-776*6):4" M^<A`Q26.XP5/[KD2.I2WL7U:JVPY)"4HQS"NJ!`D9WK3<6="^+;QM6_9-DA1%$" M0]KYX48D/,GDY#5$4[Q$ELI%D;R&3^L+.Y-7$C_"F5.(MKJGSR!84U[VMI,N+ M-X*M]">N)&quot;6^*&gt;H;19ZHR$B/D_DSY.S<e7w3blt[mlt'm%k$bv00f0dc]2fwm MEJH>U47^,:=JG:#&quot;AL\&quot;GVJ9_:RU&amp;LC0GQU`/0*TLV?P._+,R&quot;/SS`6UX^Q,<m59u4,'7*5"ivde:x;u2s#8!_!_>_87PDE0.&quot;+BI5;)G_@5<z,#).?u-$e^g8^ M<HXC="TE6Z!V[SOI,U/S=4O96HS@Y?.1Z'@799H7=D&lt;T77[06L3O3_K`U:7">/M

MF9U9O&quot;,&amp;[?+D1&gt;8EL2<s9dz'rg#/:v$!w2d3zpinh!.+!`3+ib8usba'f"!yi MY<'DNSF-UIB1J;4_,?R[O'J/0\C'<;:N+I]<W%`^:&"OH#M.G\FE_="*+TK1/5" MW4;)="DG@O*">)\`M&amp;S_8?5I&gt;)MG-^`Y0.3,=U@3_P7U;N73=8A4L2N_-Y)R'*#

MH(.<>R(R\`QX]O6KN##D&gt;`#]VV=\!&gt;+AR[93PVT?T%UM][M&amp;VKZ8MG6\:B.:1

MN]'XBET[-T5B)&amp;:(FK$POP($!+ES]V.ZJ.E8],$GM+7_=C7XKC]31.V&quot;&gt;W@RZ

MH(+[C[J)9_N;P@KR;BNL<&c49c,;4-_x#.n$'p@=yv.n14%0y64$a'1'94<\( M="*_6&quot;DM`(#FC9IP8Z[MB=4&amp;1X&quot;@-&lt;SWJ&amp;8-VK(ER&lt;(RU@7&amp;J^46*BY">+OA,_^

M^N,3Y6NPH#/[%[=P_$+&gt;@\.&quot;_$#9T5E4M@%51;G]3QB+^@3@&amp;7Z?H^I4HQ^Z6

MR.)-\[A_!:\[HJJOL_&amp;KIZS](?.2&amp;U3ME*XCR;<'cktom8f>Y&amp;O:P*=NI/5,U

M0XIPDJT2VLHC5'L_:V*N?)GYP$CH/.OC=5K&quot;Q#-9UNJX&gt;:K1A&amp;4-YD3D]QV*C

MO[$;GKT9?)EFRX8K;'`/0&gt;4&amp;8U&quot;&gt;E!#'SQR-.2`7;B9C$&quot;`6K34^,--Y/?#]J

M<had^+?x\(z52hnv^i*obsew)v8r^a4`:tq^u(=bz7^g$#=a[4#icb"zvk*8: MXG8="`&quot;:O'HWS%W/(!ZFIAM+C^6&quot;B&amp;Y[1CBR&amp;0_OS':\\L-9;N'U?+V6FVT(88" M6&"M%&7$87:`UMN&L:E?3:P#2="#LW5(D#?N'.FSZ=?U!Q9+?H&lt;6V9/+/1#:+Y" M0-YM<#FW!2"?Y!BGP^P%SG/4/23`S<45GID:+M1:8Y/)G@\_H^ZYPO2"063G* MA-^9X!]-"!]OW\*.5'!&_!>U_ACYPIIJ&quot;&gt;4J'*,M\3?WT:DY7A@P#LF(F4&gt;5J

M_3!P-.S&amp;*3HO&quot;M(G,OZJ?E[+S=$KYH,&gt;&amp;7QC]=]J'C5.)):`_*,EF7=MX`Q9*

MM:!NA\RA<co<yg]]v=m`[%k["(c?+x7z5:d!?i,&gc[z_f_'%"3=h_cx"\8i@ M05G/%RCZ+!%FRGV0@W%:M="L1&amp;%J*?&quot;'NE\&lt;S@12H0XW')F!VD.-@+BY:@F]XX" M"7[>RXB0X7[QQ?FT[T(H]&gt;-G_`I]]$W@&amp;BVZYT76TZ[A8Q52N=IZ!1WG8^6N&quot;

M\=+8<p,zxe_cyk\a(6t@7r3/<,+ou@kq%n7%wr_%@[+"w@alb,([^k')\$-_\ MYK;^"Q(@Y0EA<.SS7@AXO,/N+Y`\LVDX*&.[077F8SO$_*M+CU@7VB\0AH[!Q MA="MUCS!_I4">_9SZ[UC@8%]0Y&gt;+ECY8`1VK@#)FW3R9&gt;TQ$%=PR.8,YN9.T&quot;*2

M;MSMOS((EL?*B<%X_?1%(/VLTP7Z=L/38+%48^$^&XNB1DMB$Q\;72Q+&N865

M;%>;CD\]]%&amp;6OUK)-<t"jc<sg1ntunen:>_-!F8%@1&amp;\NX#&amp;+:.&gt;+AG[ZD:%@

M_@C?C-)%7MN<n*0554rys$()3t"(3ko31]haj>R6!9M.AX3F=<`<sb5ofsfoa MQ"0?C5;FI5##<J\!9R'U@*="+YHE&amp;M\BGKI!8%3+K&quot;J.R9HXBXK;QVEYV&amp;)%BJ" M"8^X*3&147I]X!4%+_M][64%A(;C+FZIT2QTJ*!#6@.\\_TZ'A9&%-$G^7^-P M?TL="_9CPY_=T(/9CPD]A8@.WY:K\*ECBQ%H=S&amp;:G18$.PI%Y:I.V=5[YEJ=1Q" M8DB%X.F>*(6+%[-]K+RHN-9\TF%B]KE%<'s+5p#w"s(x@@+0?'@ud7miz[#9j M6.+*LUTDT&RU'C="L2VUZD^X9&amp;!07X+Y;JX">0/*[&amp;A)H'F2*]O(@WC:@(&gt;=HCP

MKLW6H<-i/3,6e28e%=/k-vpdm,:*kyy_#n&"->=%)Q)$6/]LK/2VM2H#?^KBS

MT+Y,T<x[aidk=g5d39s;'.2w6mrb(@5h1e0/=uy/y\f$`//9`=6j7(a7]v9ka M*G6--D>./_6U_=Y'Q(<//p4/zw+??s)5*h`<t$97bn5]5m&^@\;(840]m;>&quot;U

MYK0[V=H1X&gt;&gt;TM:/XHBH%XF:^).0X5@;W&amp;E??W)JJ75[\!%Z]Y`%U/&quot;^V^I-<i M4N,3L2+6K!-WZ(K,\R.E]^T95@KED<75V3<R="MPE=*5!9WS:S&lt;^_Z4[;,EN-O" MC@MI="4&quot;QYM=:^[&quot;7!=`_\*5[?+.&amp;\?E7P/,)#@6W,=">OHMX5M1F-5+DWO8&quot;QV

MXBLMQS]NI(]RBSA5:_&quot;I+<?_4*u'4n*7tx?iu=y@lvb:(:*lr+"%+]()swn74 MCVP+.\XY@]7N@4AJ%-W6Z`H\>=$42V^-0NF@S'JCX6E8E$=N5UCYVQ1OQP.%&gt;

MKOT7_HNW7,8B;]O.ASRO@'?8.:QC4<ym]?&%hs5#7d24^19o='_o9r8bw4*@f MP[[U;IBAN0L>JPMP*R5K,=4([F$07TTKIOA^?X-9?,33+6'6F=!ZMH?I\:*]\

MS$ROI_X[1/UU&amp;98OPDQV&gt;QHRU1YZD:\=9AT;R?J]]1[+];\W(Z-\X\SN2=/8M

MX`@&quot;TT.\/6:K%OQ?C&gt;*/CV'G4/4O18X<>38^DKQ'4%QQVA8CBFLT+&quot;D'U9ZKL

MC):-^Z,XVT66KWA01Z_0-[6XFES^U^$MH@W<>71O%X1'4&amp;DO+4@(1H9F'K;T:

MPG=)#/S9X?<s`/25d^>=FBQCF?\*_0N^=@=W=`\1WX#SGA^+BQ:(W%WTYTNU3

MGX&quot;7.3TR0G3WFGX7*I]'TLP;5GX850_&gt;G:+72CS'<a%3`1sh_),$/1v"2_u*? MRY@W;2O91J0W6#P>UH?E7S`'_ZV&amp;4.4ZIP#Y3A[&gt;GVZDEB:H!=4CX+1.+_Z$<m.8fz/?>1_12M3]ND6-6Q9G`&amp;$Z]YG`7B/&gt;N*+$T:YL@]$&quot;4<'afi>/271)+&amp;*

M12&amp;JQ0M4:ID,X,T+P-4D)4Q[K3@W4O@Z1,K;JP19_CV89@K_EIBN5@6OF2`DI

M,HWR2Q]I##H*$[LYOTU1'12IXD&amp;5L`D3U&gt;&gt;&amp;#`)E=_L4)$82&quot;B=%HR7@&quot;(Q=B

M@V7IGZ2^C&amp;HY<k<h88=:<?+li7^v!7[caa+3?k[ayp<yu_]0y?<%,;-h'#W8 M5&gt;5KV&amp;H;H]LQDN\@52)ESSTW:M::]LR5UMRWB9?UK[\(K2CF//Z[/T^G6[WII MV6!7B)YJ/0SH[ZGIWMW%?GYPFH?X="9-F^^UZ0`R\U[DB&\55@)U[M:ROLW!=;" MJY,$)[Q5E&quot;&gt;@4XJY="S==FR_<vvr$5l8.?#5=1z?uva)0&quot;5/glo;g<uz\z2rr;" MV6?15'DTG8"-#@7].(""YN<S@\/X1M39?&[TM#5%Q34-\Y"D="!K2[\KK-KO0/" M<4B="2SZ#$SWG-I*1(#BIUU!O5G\Z'O71J!&/$:*,-O@:*4$JSHT;5T%0="&quot;9K

M^<$$)]i`-r0!_g"kxh0ysjr3vg>KAZ:W[`=G\*%1EO(8,\*BTC6N-?`-9<]y3 MTL?9/P\GJ;!BP2M0$"(^P]C`G$\TVS<@IK+.="0=*B?;@,D-WGRZ?_1FRRZ!TI" M-^[8AB]'*&X6*(I?N)XD`ZU8BH0@,K0V#VQFZ1ZU^BSVS0"HUX?)O*1P3LD@` M5L_DS&?X35UVTTF$WS#&6/)/WSH'/="`:MWG:2&lt;4NRMG)V!`OND+!'E],VG,N&lt;" M^GABJ6S'><x70n3sd]->VI,'[WQX<=05%dj*,e85""v02;nb(=4meo.h."462 MX5CPA%SRT'Y$M'S!9;/Q/`+U+_="49+`RLX&quot;M^#9BT!1$E&amp;3-,SJ0^_=%\[AG:" M]LRW7^7`H!)!=":2:*W**7!I,%">03/7B=\Z1$U&amp;O:?\*M_Z7S`POISU*LT8R%N

MM,B1@G@OQ@X$@P-]#/%-GE$^/;9^7%Z&amp;BR]9G&amp;U*3U[6GL_6Z,Q&gt;@NR[LK@V,

M&gt;7W6J_G9.LNC]T]=C+_+1V5IH2]$Z[:X$@&amp;14+#6_GBN#.V!&quot;^+!!I;N6&gt;UL%

MP.\BB)ZH'&amp;J'3QFTQ<&19@.q>ULNO+%'WLE8@G!27'4ACGP&quot;:[.I!?8+K-6OI

M(1L;OFC:-EY@+2VC]'9L!W??F*G;X+O<hhu:i%ixtz-]+d]t`d?$#]v/[8?1' M="T_3KVX@A?@&amp;,8N">*'1L^;#6&quot;)^;)ARC'YTR%U\YF13BR27LR-[6NNQ[/--0N

MJ+8E_TE01`<0b@k@5w&1hqf]`]rn%.+i[=;^/[zk2sm\f*.v&)f7av_\3#09& MT.Q/+VR<60NK3Y#>=<7]xaom6bds:0k)k1;,]5m;w!"tn=tsc8*.fg0\`_+gf MI6JRA>GHO&amp;%N9Q8X7&amp;2#G6$&amp;?XXV.%24\?,R&gt;M+R?#SJ&gt;&gt;Z58\J[*JV6-41.&amp;

M'K+EVI`<mo@nc(#xa&7s((t/31[n5x7##zi"!m=kbe"&)+5*]cz&'9bk^vx'% M12$S!'="@.MSH.O/3D1[E&quot;)%[Z^WJ'JYJ&amp;6QWL/99:D78H_+Z]/5#.5">_&gt;4`'(

MK&gt;5$+*QM)4(#K8BNW(D5/E8-#_;UXCR$?%;,/73J+K.?\1B.[S<;b]4q-e[7? MR-3_DJBZ.%^@O-].3="$I)D;CL&amp;QFBJ0P,U-\1?9J?`'SO9-^3$">^Y8=KW&gt;%X7

M*:;NP]^=-43^AV-1=T%F9@E_KVF)^M*+W;4[?]I^U01=\*;JZA!I63,&amp;&amp;;*:L

MEH*BKZ@D220[&quot;HYQH:1_6?93N&gt;%-NUGWI`*%E-4.)),J4K@W-[#XS%1_H76JK

M=MQNY??KUM8H!`ZFCRQ(M:)[H,;2^^?$/'AYXOH7&quot;W8O.Y#=,^*X.&quot;O[Y/`C5

MZNHURLPZ`=PGC,#;+Z!8-@9;RIS&quot;.+TZQRYP1N]WCO$86(U=K=<*/e0+j4.'1 M:_="Q+I&lt;O&quot;9]ZW8\XK-5W@?3-]=FBHJK#`TW7IY7;J?U-G:TWU9XD\WUS/SQ.3" M2;EW!"0:9;G21J/N3>JV-NQF#5Q/TW5]E?P0[;=`(7D(?+RCY!2^6W\RD3#;N

MQQ&quot;)A9W98_GNOVNOP-R]/VSL%ET^75U(!.YPS^F+G-H?C['3/<&pl&r)tubu5 M!2,3JU`!*J>']M_NL[-3VY=M(&amp;\2&amp;9XA.\O7TSTG`8=\2R25$S7VDD4W2Q4OA

M%&amp;-C[D&gt;:=5#$#.[R:ZFX8&quot;<l_^zwcv^ofmivv@g*?>7\FQ8A?(G5@^`/B&gt;(02

MI`<w4.b]86@9a?6p_&%i)%te</*zr#`'"-_<m?%2unp+hfe7"@w;%an>CG=0!

MGB^2M)%61U#A_COX(H?(A#':`6U+D+VOF^-\]A4LWLH*K'1+]:221Y?N@MXL4

M]HO`6W9&amp;J]N&gt;D9\\^2GAQ=NXY+N%&amp;BQ+N6,@&gt;C#XI*`3&gt;N_'09P^RC-*@'_/+

MU`GKGM7&gt;^=EIH^;SC(EM*C@(#WGM398)KXD<="yqo4^^]lgcs6,u4>\&quot;;3&quot;$F

MEPQ@VRC&amp;+$6=T?\&quot;D=F6GETINKN\VAPW1%_?2(+Y25#JX@3*N[8RNHQF&amp;27E`

M8KW<g5,-.n<t&ye41&>*^=.MGJW;J.&gt;%:@2<u^1ug>P3U?@'<g[%k)r#uk'-& M4D"8<?VR)%C5[('%?))C['-<];8WMV9V3P;_SD</5"2$VU5V`^ZXB_Q,U:];9 M\NF51ZHSXI0#3ZJ^)!TC4!VH&#="(HD&quot;,F/$Y7&lt;!&amp;GE%B'#G[]C+YY:^0=]Z'[" MNV_%;*^F*_-N`)Q1L6`3-,L/Y3W/1$0THG!Q[I;Y6'*PD_*9WT@[^DEG6EK\` MN`CZ*\I-V,[HX]]'="D=,R'/.2,EU(,XUA!Y_B#VA8FWJM.5MX5((1YKP,RY6?" M\"Z_-!72+-4[J,$_*?VL)_+?BFNO/331_+S'N3XH="Q&lt;!&lt;;_1;*(:&amp;.!M+=V+_" M!I7;X\C*="8?EK^W&lt;VXTTZ^;O:TU\ZIO/=)P^8`%#_HP0D%S@I5T([CHC_E.[1" M*8R_?-S63S)=",?'M]NZ[]9F/^BAXO8M">8DDW9SVYVYOP5WNSQKT[].7&amp;7/4'*

M'ES)KFE+_XG:7C&quot;8H:/.@N*O=,,C=JR+B`:TMZ!Z=NJNCF8XRQ9C_PS]^HG%5

MOO']<5fy,n>30[K&gt;!?ZULTS;BM^Q4M(.GKG2F3/RC4.R5&quot;7[.N0*OO+#&quot;CR67

M&amp;%6^M-`M&quot;\UIXL$F^+!G_2(B!Q8TJ^;/AGYB'U:9XO8*)&quot;;*@UID9X[Y#71:C

M4S3X\B7'A+*-E(GRV6)!7=?NG]H\T+&quot;#&gt;I;SN/RG0['34,M'P3/@2X[PF[H=K

M9G;)T2ZE]D4;)@;*[#?*H*+I2]\%$:T7CHE(R)=&amp;H[+0TP`_97)@'B;5&amp;:?P%

M^@]*SU<k==&v98f/!o:8kg3)noh+6v>_*^NJ;C/:?O:O%8,.SO&amp;*`'&quot;6PT$\#

M<bh+ti5#"5#iypgy?b-i%e]b]^!\i"3;w-</!d.!q^en=gsq9^]<[3rvy>_FR

MY_0(;/0Z^7+9?S3!QS&gt;SL?<$qp4a.>-J[&amp;^YSU`2I8J^*5_)QM\OD2SL7*/$0

M(-%C/FR_.T,)EZ<z&i7ydfj]l3!i`p-^h'.-9y]g6^3gk4?k[v."=,2"2`^g/ ME_F*?;AYN%O6UTR[;;+M'L2P+V*+"2$\--ND@OF%6!2Q"[LZIM!"3':9J7STT M]<X>5<>K#BV^6ILWGM6<:.z6*p&^la^i&kv7(/9i(%%=[]9*]@_j4##4r`4d3 M.-$KKUP_AJEXW[AOO^="&amp;LS%&amp;T.,Z&lt;QK9&quot;57[ONPBM8:.[:G7=EIW-5INO">E`[

MP6D:&gt;7#-UOU#?&amp;Y!T&gt;E&quot;8Q\8JW;!^S5NJ1/&gt;&amp;;CBU2$_F+'3&gt;(%(L11]OFG:&quot;

MDCP',=K]M!+/:71?],Y8[/&amp;$M$H(+VQ!^3BQB!\_4MRNY\397@=1H7WR?W9.(

MM7FR^5;U8ZW0+&gt;+AG-5^A]#LDW(C.&amp;1&gt;H-\NBA&amp;[W:%$N_=(TZ<m^<m5u0>/&gt;

MH)2^,]MPT7RQ&quot;E*PO-_[L9]@8BG'@.[7:%%\(=C,$MIT]C-OZO4%9EFT?-K05

ML[4O&amp;/.O.;@?5VJ23+XHOFKJ).57/?_D41%Y;'7WXV&amp;BGH9,1LP&amp;N4,^W&quot;FO1

MZK'\B4-O\X]&gt;_FR.2O'N$*N[X]P<y)>9&gt;K%E9$2KG_X=O4$#XG;/&gt;[!?MZ3Z]

ML@X^Z\\Y(0'+53]M\1I&amp;K=;/?.DN8GV\<ga`ud)]/d8ya>ZAK$/$G<'`\mydz M:D+:M#!WT_LE?ISTS_,';8+]`Y5J2?$GQ4V;#CW'>NU2O[SK\&amp;0A)HEP,A?;'

M&gt;3^_<&7)r_mh2<35:w.`!d`c6i^/b@c`h\\%$vvt=(mto/(b+yt.u3l=1m'?6 M_R9`!W'HQ-5N?UW`F6K#B&2?.?W^?`CC="32W;&quot;;L;&quot;I&lt;#'4P)E,F^,FKNYA;R" M'5:!9R\Z]@04S(2&/C_49SH6="W]Y],&lt;W,!G(`_&lt;@Z'22H+L/AC20:6P@V@-';" MT.ZV;D:[4P,O'>DM#+8V?T\)GSMJ?=[CX.7\!F7%O`]6IC%ANV<#nd*<?\6>4

M&amp;9=<*lc;^)l;&h%=v.>O9^.JE]9^&amp;(DL=[&amp;5EC$):C2*KLH[/QT&gt;M7C\YNE74

M5;B%!%B)^ISSJ=!D@X:IGQ]C;9^&quot;X7&gt;5[#O</4u#dwt6^g6#xo_;9^%x;#g'r M\$Y/Q/S?^>A:)JR&gt;L&quot;9Y&quot;Z8@Y':*U2A_Y&gt;O%\NNJ@\A-.!=@.J71[;OM]JZF

M,CKGS%8=^DLCV6`4SXLI9_M2^R4(2R.!',#6V:!L*20)&gt;N`BH(Z'%B-WF'&gt;:&quot;

M$P%KY#*D&quot;'`W$_D@N3@I'I'7*Z[NBR1\($D$B]M`WMLL[)28M)Y!&amp;-&quot;8&quot;&quot;SF?

MEE3X??]KD&amp;+T5=+N3F?)P3D8_&amp;J=FINT0C1&amp;!D<b$s2tu2'@zow^0;+`4*&%! MN(K,`X6]FM1Q!<7"OC,+9>_Q=CYFO/E;;RU55)&gt;<k^p`pd"t@&hlz1`$8@7m' MGU2&V(DC4-)IDF@18H"H%.9K$E*R2`)+I]^M@B-:94;$<+4-VT1Q&`FHJ5,_K M5R6C\16_="`D$B+WYD(.'0$5ZD1&quot;RYA%Q660;&amp;N&amp;5)-/`$&amp;L-Q:*FW^.GX6A[^" M"5$,HPV'GM\,C7,V09-LCCJ1K5R8;R*C#,J)T4$!U<].F6I/1YPW)6M+A,Z(1 MN)>?M5L&gt;ZP[E$YG0,R'!^F?<20q9dg2zzb0&#<%@[tf)-@7iz#>#@&quot;IV'_V79

MA]PLF#7)USL\M%6MO4%@9(.@S7]L0,BL&quot;9!T-DA&gt;Z14-H+<m@?]=o3>/U4EWQ

M-W/&gt;)E8+`0'K#9.W,D9KQ0YQ-2<38,r^h>\<bns*!.omm<>LT:&amp;OU_Y7Y$,X7

MK#$.B_OXVG,L9^#[8<hrys&+^qp;a2s_e\5n4!9jp-qg0g-p5$2l20v4^t#h! M[<;Z*&BEXLB><!F$84L-S5"X5(4XZ65E.'%4C;G#V$2<LFJ<+NYP:8&UP>+X^

MNCSDO_S7XKRP`00PNVBM,(=$Q-`T[:<2'v$u-$w_>1?@N@DMA&quot;!*&quot;*2-]5&amp;KX

MOQX,\.X#J):B&amp;@C75&amp;@.B16C0*$POC8W0&quot;@%XZN:0RF*4(2Y6)0&quot;!54CSL4+B

M85,G^80:#!?S+U+B2_W32,&amp;97?]@0].,GTK<5<'_vmzf_'m!!_a.?)]_fb@11 MPQ8N3B@%Y9O]HPP+4"U4T7^SO?T74.!0Q#^<2@W4M0$-T-81%`EKZX%I[HQ`% MT!H]SZT0@-OXL'^XNP(?5E?:(GL4KK14GC7*6N2]%W";!%%0)27$6T]/C\7_="M]V&lt;#N4QLX?\`4$L#!!0``@`(``U?R&quot;+3,;?'?B8``+0F```+````4TA/5T51$" M52Y%6$5M6F="0$VK334\((0DA]!:J=&amp;DBW=`!Z2A=.H**C22`2`F$FM!$4;!&lt;E" M05`1RP5$!?0BA`XBO0LB*"8$E2)52#YGWK_?CV="F=W;.GMU?N^">9=?:K!^`!B

M```(<!+(X]T#NP$!`,A?7^KO\_9V(X"A1(F&,%!N+W@PMR>U-0;LWL@'<(?!j M:GGNN2,TCIAGK;G[?NY8\U&`'L\YOR-_VK$6L?'0_LK/_%DT7(^G-].,!O013 MP$T<D%:.2'.]]I)^OQQ#)PP@HV&1F3]="490+*WR:EP,_G/NJBA6CGPXL%^IL=" MT6-,`A`[C;R4_?47BR%6"+"R(92R1>W?GB+`<m!t0"-p9)'6&=j&^+f\dp]h] MGE9?9IA7PE,C1GD@4O:E]SE`L:X'?#$JX-[*="S`1L'PM9.27G4ENC#BM3@Q`&lt;" M#AARZ**@\V*P<7I4Q@$'S$:"WNI^GGYXMNRB1F6YC)CZI(QBO:.W@&/0R/<]J M.]MAQI_27*W`.="AO]/L$1.,`6GU@?Z,:UHV/M:/J7!S)!\&lt;0]=NO@_5ECC8`&lt;" M?="[.#MA'JM4?^AU9;JFI2;!7[`9:8D2)%8_/HAXZ.%@B&amp;:^)IJ2W(SD)V1*W@" M#FYJ#)9X!2-;R*@&HNZAMY<$@<J="&lt;*#">#[XW%Q#S[JQ!@(0*SR`[\[_4=)W**

M2*`;M3`9_!?@G4!+7P,$!;:EY9W.FZI=;3R,^@VACDJ6V2YL:P8(D/GN3HLWJ

M59:PD$&quot;92XR5&gt;B&gt;Z+<ch4".:8&o/!@,o1\@t'*f>&gt;^=%'@V+I:=&quot;X@TS$U#MR

M4)T3B<eag?14jf%ffl8'i;o_]bk;-54`+zo(mletb*a,xh/lrr'q:l+05'qb: MN0<,;T_U,6X#,F#,B3F3SV1Q9?6-8SQT@RK="51&lt;U_:.;!&amp;&amp;T/C@\4ML)XRQ.L" MD"7MGDR+5?#R>!%ZX=U!H`A#3KNW&amp;&gt;R_-M3[S!.B6TJH%_&gt;'T#&amp;P-F8YY)MF_

M6A<.a5ai(7z<'b4ur@0^\^j;+oo!6n9mgvt`qvx6qous*:i:8/`"cm8n97p`o ML8RXK>DBAPU`7+[OV8!=1:0[QIVR0.`M`XH,M2&quot;+(+G#ED+Z8&amp;4M2`9(3CI7)

M9$[#9?Q-RX(,I&quot;(3P=]PM(4B\&quot;5O_8%B[/N&amp;R]%M.V+9Q3I1:0BZ!`[BI+)O/

MGWM5#`M,_(I'HU)FRUMWI&gt;;!%51IR&amp;&quot;.\'CAN1?EZ0D!LEX_)+K&gt;KB-B-`K94

M9^?)P'*B6Y3IGVR;F.^R:AL)3#WUJL3RB'03U^])&amp;O&amp;377??9T,5R7C/*$-(3

M`=G364MH&amp;A9I!YRL?'9<n&`4z$ga?s5:s'0cb`5=if?%r_"+fwd4k4g?7i(j_ M2C7GBJV"DZK/QY0IL<10U9(J<FASG%ZRSLE/I%6J-81`@3;,.'"$7AH.+1+4>

M;7.R9&amp;+=^,KU4'*G6F7KK70GCGB];.#3@`?&quot;<c#k4qqxz6=`a4h-d%[b`km]< MS%&@W2(OI]8K="I6S19'9TN:@"><f3/^_>$MS^8-7YAU6]7S(D8@_5&amp;VP_&gt;(GW*

MH27?'A7Z^!7A&quot;&amp;T5<%K^+U8/WK;O&WB*><\YC>V&XGLD>JWB;-$;M;0;@]D*X

M5;?],EKJH0]TGE]Y?`@"N)(H3./Z)(-34<W>@!P#&#V]!9Y;PECE"&S/F6MH[

MI["_H@L.\C_<`#0\D"A)Z6`:A+'>62QU\B27'UIW&&M;%BE1:_9IP9GR7MZP(

M9*2,Y!(<40C\HQCG0P657HWQ1/TMG+_GZ?DD06(?N1/J)*9IMSTU2:,FY,7.\

M+6)T#:ZI#V]87<K&VR[:\W'6/(.G`PC2FWDN<V#8Z8_[=(@&D@0S->9T/@9U]

M!U<O_*H!S/R$%^0&!7ZK$$%-B`M7P0:R&Y`J]C7#0B$!SF<;EDX:SLL.?$E]P

M7.B==5!O2>>6)^H@)&])$T`<J(+B5V[IJ5-AST4X1^\P"_F>DH>)N1)P#H@17

MG\!TX[*#4;Z_,@MY@\2\$4EE\N;Q<S]^#Z1[_;LE>]P,;V#&6WFI4E`^7MK&+

ML'/[!_1F-<^6ZW*S_N#[RQ<;Y(G,CNQ$JI37S:(,T/9FRR)TRGX)W/JUW5]P7

M/+#-];^L+4V]U^0&J-P`!U=_#"'"4CL2H\`U%593M^^RW5^;LVK8XX@_ZD!MB

MR5)Y!#*\W8PF*01INT)*/RNC#X+M:QQ'/JNP"C15(HN=*KG%"]SON+.Y)^"2#

MJ*S?"`/$ZU+_4X0#*>K7D3/UK\7>8_D%YQDI2^P3+\K!GDM&L.`5ESU.C0W>A

MI(O\S"T:P@X-M0-;>ZYMQ?WLM,H!/"O)N<"\)?T[49Q^[WZCKO**,/7G]PY,X

MV9;6X]/\_:.WXBXP5%Y278"<(M`H[9=V5O+6N['>,/CV=V"?"J<%D:;65%4'B

MJ7]TV%?\Q>D3OI^K;F@2'GQ>8YR<P="`9$Q(<3-"UP5E:XB$(^RP7#A(;VN[]

MBV!%Y:/Q?,B0-6"KT8[;V]H]QO&W2BEJBUW5SH?W&;3NT':T5>@.0"PLF(*)'

MW;9:>\-]2I"%W-8K8G>>^">Q/>K"3KLW2P$>':(HC4D]O<7_V@QP%>1A:DP6U

M7F7([ENL^N7.<"3;5ou![;98#\\#z6r6gwlyef7/a;i.v?*y@jz'&gc26x#ov MBAO600I1+WY68?ZH-:%&50WIS<XE3[#9JBRH3?N^L^RM$U4"EJJ(SMIC&OQFN MWJQ!P3(T>V]H\*&quot;/6?R[M*XC\&gt;Z][E+@-=1M/R58J&quot;/S@,XX9$%6;4!62R7!L

M'&quot;W@S?_B!#_'\UV_T'7Q%#1=&gt;RME`J87$)#D&amp;[+D#1;-9A<>%&quot;BSHLT[F7'K9

M@TG-:&quot;.RA#4V481MX?)UV_G0WU%P\N`C@0-0;^F'B\#SDL<;&y@;3y\)!_pr& M#:1`7S="=6*Z/!]`'&amp;3NUX)%?C&lt;&quot;[\KW#WQ#GQI^9BGU6GIP\I:32HDGY8HR/&amp;" MFZ5>&quot;9M48P87?@,-6B,[:!.`&quot;0&quot;WF_*;,\9^</z4m-b')u'ng::"^rz);dc:u MR9N,N0="I/TV1?2!D^MGQF]?)&quot;*D;6*`J!W-XE*]">N;VZ-3[TG8*MR=&gt;RI&amp;_5S

MJ!FQ&gt;;\KS2,W]&quot;6&amp;CIN(&amp;P1DW[NO\PKXJS80KPYGV.EE[@XD&quot;\5)_'CWSW!KG

M9/^7&quot;Y$[G%)N8_'OP;.)-A[2&amp;&gt;X/6_P`VD&gt;X/8DZ=!;UAW9,&gt;+?:`5+CLJB@1

M4CX!9G?]CE&quot;ZO,C7&gt;A+A;,?00A8*-,9Y[==&amp;NK\+E(<y&;&#!(j(uftcr!#l: M&W@S/J3])A\B`X@;+\V8_)J1,0="^6&amp;P\NL_Z\$$@*E=C">96IX$GEY*'D_R&quot;ZJ

M8G$_#-7BH`$-8(3\H&gt;&gt;I_,93).L7U)TWBDW^NW522$68ES<-pgwtk(=p?k`y+ MJN1ZGN16&Y7RWFYN"GAV?-'G-RIQ'NEGJDZ&/QL1X:X1'="V03,(1]2T&amp;=P/@L" M@EQTINTJQFFAJ:`855-MRKEK<MAP)I]NO9!IK4X\V="TGC^[,(;V+Y7\&quot;E?4?%" MN+9?X%/*?NRS?D/T;:L!,O,&10$E]\O&_PD)X'I?)9*BF1;AGB?:.7B="M&lt;EE#" M'8FIN1G6OGU:!`1>%=JC:&amp;A8.\FOT%\,8*5)LQRU+V*ZM[)Z%\!?<h5:<>,4)

MNU`^PCSNYFC%]YQQ,QICXB8UV;!TWF=[&gt;FGMX11Z.R<p2uuzz1)v+z<qe".r0 MO]DT&08*W))0I0W7`BK")GL2FJ!)528B^9/VZJHBTT.+74X7#="9">1Y8_ZO2`,

M\LJ?,.&gt;SBET6KTU-YP3<&+0,1\>,E94\$'9C<;;#ci&/i"kw7sih`("\w[8)6 M*?GPX8!E#N.^+C&ZHC)RO4YR9:'W+-^XE@<S]1?OFF64>@0N2L<xrcl%uug<[ MJC0]4-\^74GO;&1;`IFCV,QY9\.<+X6'\,3J"KY4,O_-EEP]NY^CXFYA@LM="3" M1Y;+&P%8W9;U%]M##D%M!MD``-2.Z[)".>SI[@'+RSS+4R^G[KAY&quot;TL<g$!"< MNQV!="X,_EB?_S&amp;O.@\+]?/VA]/&lt;&quot;.8.(4N788,G7M3BFG.`/6LI/UC-`)WL:D" MG%,1%;OJB/PNI:O7X[*>(\C-WIR;V;FF5':/`WRF^U[[*V-P,J66``P-)@G1M

M[S^'T\+*1&gt;U-\PX-N%S%;7P^VG8`B-O!^@,Y@VXJ/RH?@3IDD0O'[#?%[X&amp;S4

MO6BQKVBGN9_U)\K/$Z#P&gt;X^'+9RW;6TUG,B(5,ZKZVQ#<&cx&qt#:%.=+4@!k M1L)%#EZ!79HRG<M9C7K5]^0B3P<-H4QLU?[7$0H$DWI?'2UX(GU2M;!(0[ODA MLUN<^$A>UIRZ3,G0_+R_X`Z8&quot;<1vl_4:7]\i>K5%`[V:2$EU%.7IO<1&7#1,2 M/4EYJO1+:/,-8F4O*KY,'/L2I(>9[K3=!`CF_]$;WO/%CQEQL)WYU%:Z-E^I:

M7<=5f*mw\l%bm\fh<.bmo!zomt:^.+.mbjzm32n402?4_5h71va)".+q;r>]%

MMFUB\@_1DW5B4P0^G+?%C,9MK`,..N2VCA9!F\26#7A'K2X9[/U^\8N`3=T3\

M=1_(`K-*#FJ,JZ.B_`H&gt;9!D^:EEV`?[)<ve2w\t:x,)-afi]h^gl^p"5q_z#d M$_)$V;?GS^="(UA_+9C,AM;DN%('@=#,9SR0XOQ^C70R&amp;$&lt;AMZ=KM:%-X_RB1+" MX'9@XK(5RWS<B&5G&-?']%$-P(T`;_>\P+=MWIX&gt;CS448!.,J&gt;TG9#YHN)WGA

MZ']P<]&[&;"9wv,w<74/$lxr$kqv`%&"k/5]9:j9)@7(-7!0'yhm\k("d_d=p MIS87?^)="?T3^3-;:NJSY&amp;,U[S&amp;&amp;U5*UM$]8&quot;%">5W&amp;J#&gt;AF84XO+I/]3]\(V+,

M=.44U&quot;;PM;R=)'PW7CC=AR+H](1X'&quot;1^81V4A$(#AM#@\](``HH#JR&amp;PKNP?K

M-YE*.?Y@BPC1J9&amp;7T69%[<='_`gm%+4]8b%v2+uw6id.,7vtb,@x0g"8h<"!2 M5<]85OL.Q[-Z%Z]7TZ<-%W:-\#CUJ;UX`WXPJVQ]E7\F&:;&Q^@[7"FL.QGB6 M="31O))M_Y&lt;I(_$7]!C">=&quot;+45\&quot;'9G\H67:M]<&>!+@&gt;OEEZ19ZA5?MT:)5;/S

MGTL`RH[I)'7%+6D:U=[T&amp;[[\JJEA*LANO<c_\4'(_`_t1%bz/&9a+,pm(^/.^ M@XR,Q_P9&8,O,C+J7H>D'\9^&quot;@E)N0_%RN#\5B0.T&amp;`;B3*QCGO@$'^PX_:R'

M6[FDWYT#26W^R.'`E^=$I+_B/G0KJ99)Y!SZ*A/2!5GT:Y=<[y`;v#?9)ofn1 MM]K+!\4S5W<.6&-<22)DXR''I&EZH_D#<Z8,T$86W%L9[([YDYM+>@B16UCCS

MR&amp;X;/8<-3y)^mcv5+/nr/[m@j(ktnn==%r#qb"4o(.z[2g0[g^$[ghj37-/ch M[P(K-YYJ/M/^O25A-!5T%6;"),$K[OJ@^;H<(F$W$(H?OQ-*[H'5/.X:@[M]1 MWF-7R7]5-="+$#_^!!,N2P]&lt;H7DNM]+W)?\NGU(-E:&quot;X;_QSA/`V?2H9UIDX#X" M6$>1LV(?/Q[NFZL=:07MLR&gt;]YN<&0ncp[)4us=.?+c^bp>*T$N6`1)QP/;H&amp;D

MSCH.Y,2687M\3;+&amp;DZ+_+M3D@$CQJ-KA4^&amp;];M$^XA&quot;.MXH6S5P65GN(KHQ?P

M.8OT?WN;T1S(C-C?%V&gt;9U)%%OJ[;[?T3J/M:ANX%#XW=KP&gt;]\<g_?j[^:$:`m M/]].E>_Y<7e9;afn7cxc&_v]ogpv%j@5)?3i^sf\5`w,s8tf"#^*t[&m9_4l[ MK\--"3H:7:X!"F"VC)%E,H%NGXF;T?X(T\$;-]3X>(*,#[4Y0'[^$'I<yab8q M%@L;V>G06UR6A&quot;2*^J+-;USD/L-S'&amp;3P[8&amp;PEOK2,3BNU)@\;X382:*:&quot;CS[_

M?NU0/*$&gt;]Q++@L?[M$%6GP:Y,V3<&\u&iwri^u\*^?3$,4'`?bsglbg([#68n M(GXY'B!Q>0\S27!6SN+6`QOG+\-A/IP9TV,F1,K$XCDK%/4/V:)AP5!0=^;B(

MWJ5$PI/!ZC`U*MI3%7A/`B8E)&gt;5I@@ONC&gt;<a6za5/n;if-,`,5`-41:l4x]a< M7>)=+,5[1?DBSAB%!X&amp;I7U.RE86;X)?M;P32A_4?B/2H.O*D],6,80^&quot;R?@RQ

M33-#1I.[KIXNRR6.*`6.%2(&amp;$TDHQ1!X6/*#*LZ.5L6]FI-G^&gt;TN*9&gt;E7_D'Y

MER:*^!8ANS&quot;TVK0<f^da)s+ph?@1mwl%u6.%di.1b%);rjsavp;7iu=(!pu+5 M7LX(FGP0ZIRY%]]"6H/@B%FBRZ1#_M?-5,(?XL(U&Z&`YQ7A48>F)G4O=[K)3

ML__A]#5DX)R2,?^XRR%9EM!/\&gt;PPS05-]2XBRO26D80,&quot;FG!2OCCD;+HN+T`M

M\?PU-$]91Z67,DR1R5]FI4@J;6<9/pvs+b8d>JIAS&gt;26\H]][.7WFL^RIF?%O

MU$TCBZ@HJU+Q3B:GK#*[C/CC[%C(C5-LI.!;AS86Z8$[6&gt;$L`9VNL)IZ;!@\C

MZ#'<%+O06>3&<GM]2.23YWA.,G<@[%ZFR2?]).3MV0D4G`>5V..H,G4$'U_<'

MRZ)#\-33,O(MRL&@'O"`6O)^]2T?B$D7I?_1NL*'WP$P6FI/#-I$9N#!3OZPH

M3(]L06;`G38C/Q15@1$'VH(`_UF$Y1A$B7,()KP[`H5`U@F`G9H[J.*KN)0FP

M__/V]L`,@">K;L^_C8<Q.5XKQHB'5+58@@^NP'..W2K^0[!;?SRG"RB!S7R"<

MDOGYV^#V>MNK.7*O`VY>2H%)OD;7'S=_LPF9=SY_)]',O_\D93>XP8!_B]PSH

M@&TF]_.="FQ(Z<QN6_LF<^EED+R?QJSU/V/O73V@'$",@1*79U9H30*+K)K[:

MK0G*,F3H3C.TFA$C.$G"\W`$QF2:LNF\)\>\1@_1E;)Y:7\.3A5BK-(Z$49'J

M26S6N>86P6-M4(A#KCAD(5A$>]=?"6@&P9P;SBSZ2FOTF?%THT^Y/#83GL,SF

M)G/6LBZ-+R7YT*3AM#;(&,@_?=CR3)WQ$9$AG?*`_B0L']OWBYQJ@=P&^.CVI

MUYTFS?[:E(@-T><E<_25%O<75L(\?YB7B:RL#/Q`>R?''S5IYR7?R88.;3P<Q

MM";K*)J(!,J*17@P44R$R5#<D<6=`JHIX[O@0QRX[:SXG!M'-)[QIVP6I#ZHC

MZO)<U&YG7=+34GC!JN]M&^MHI-K4M.]OST=>".O-6V-'>\<T/QAC''Z[#*ZV-

M0Q=6=?80GQ6:?G\WZ1W5C!NOY*2JL[)XIE.N6U_2,"NN$=PF\]^FA0>17OZG#

M!-`\Y=.(J%'BV7R!Z#USLVAKVR%6]W1A/9>UW>J_C=?<H$_*/Q9YV/=Z^=C=\

M(;7![`^S-^H7`]Y+%YVH?C<?:H$W$2;#6^M!K"-[';>X3.-2M1A(5V=G'0!?8

MF>Y$Y[-'.>%8789>SY3V<%@3F#0"A4EWR#$_BTJ:119=//E2\:J%'-^3WT&Q8

MJO8.+*LDXC['G9;\.RQD+"Q+M:#Y\0E>Q.C3W<SGGK7(W)?*1VFVVD]`FF)DW

M281WL<TQ\O-//O1/.FR^])KD7<$*Y1Q?!WT/4)TBI>I!>]%2R&Z6G8[O,8_^[

MJ]L*)V[@E)4A,1ZL@BT.-DVP*`)T]'A,2[NU<<_J"#A!M!,P:#(5I]G9N:OZC

M4N=SBM(Z1$;.Z&.WU).>6%&OB-I:(5YM+69K8Z$18[O6H-KU42G+[&R!.%T+L

M7TLX^2#G_IA)C(DZ,'G3WR95@[]L^81H]S-Y->#-!@KA\BVJ=9=LJ2CWDC"_T

M"Q*2(O8-AJY@93>S&VP/OP0>N73*31BAY=-11G3G9]W>DVO(RPSFI:-\=EPLD

MJW;3TY%H>?Y0A+:`!?BY<!VVO$/B&?NZ;.B:M@O+OJP*M\L23,M'C&6[R=K<S

M>(YMX&+`*?IL<IV4^?'(T^CCA--"%X047%"Q<?->UI_=M@=J"I7JP8M4JSK]A

M-O:U#=Y_H=A:376B0==7YYX>SV*"H*;=.MIEO]HJK)RA"+ZFB+^]5'S*O=K##

MA*\WFH'+6.)@GB5[J-CZNMK4FW]Y8Q&%NO%4T<PK_=I2RNSNX?Y1\4R?-(Y_!

MC_JT3?^P$U4IQGR+2:6T?CUBJ=?#&.JTTO)P0[6#MJN)3EY</]]OY!AQ2T-)0

MG(G4Y\;2.&C(54'*&T6'+]]^DW>]O;R/E33S`#;D<*,D-"4HNH=6MRQUNLXL-

MSI3/V_TF<.CXM@T(<O?TLWH>0E)!^R,U*7%:EY]N8V,.Y%TH>?>]BSFEH`*#*

MDFB=?R1FY%$WM_U?!RA>![.7='[ZLLLBOEL622B<?,UO6L"Z<*3Z]!OEBMY`N

M:Z5$U19U>@>2T?7XN1'9P!9K*G'4\*SNTJ4<CC9.5"O^`@Q,M,A6/>+6YW!%H

MJ&90(/>722=Y9'3I!R7ZGK-Y&I9SORB`;-KUP-.6:[X\MPYP@7)PV]8@\)423

MA!<K%-.GJ$OKQ*ZC.ON_*SF$:\<BG#4AI69,3*MIS$YTD__F>U,`@;H;]_3+.

MF?KVF8;Z$`'%8KZEY8T-FQB#J#-T%)BD3L;<4UKX*KM'2G=U/QTJG&\*"HVFH

M+>Q;R_5"O$V![Y_;_:?_XW,.GB-]%Y3(^Z59OOBIA7_0>_,)3(H,I@T0NVZM0

M.D*#M*#:HM\NDSQ?FL)QPKU^BFT0KP::W-BM4_M^_^KG!>8<K3&]DBB]!SFD%

MVK^?XE^WJ-T^QF;EWLRV_E*&;$D2Z&QZTQ5[(M+#@KZ>ZXM<7_2]]_>+V\G\$

MVS]'H<4'97[M"LC?5Q?H\,G4.P>^'&9FA9EOL8370D6HMJ2Y4'EQ9.TWPCC1D

MSZ2-P(S[KB&^2P9U1./$60.\P?.NSB("'GX''Q2UUA3=;YFI(E_\X_HD`+'#T

MV952LF`W`GA]YG;)R_-RL8(R'`Z8AMO1?+D-:N4+H:5(!3JD^[\_0O(\IBWL%

MP@/O9*RC&N7`NKTIF:HYCFPG,+TPU+7G^M?FUD&@%V+>T^OX"2MFF2+-%43HX

M_I<CCD%DB_+.CSRU%1-1=(V[(3<7@DD4O1^GKV-'?_Z\WE1<6N4LR+?[']0V^

MI9>V9Y-)?I?<Z01FF_O<?K"K?Y2!+CUDH!YQ4:,'Y#O,>K4HW((-;ET&QLG&#

MT",8@B3Q.FF"\19:G\OP4A_T.)?OLQV?!U(,'+IZ$THS!?`"3M3%XRU+>ODQ5

MVZ5ZS&_:@:\O<V.>R451-)R0`BAI#I_#::LIZK&U#:#=61O'[9NKV#2"Q1%M#

MW+#5^BW,]PC])$5O\?V]+LT>.]J-]-E/R:_Z$HV>ECXS$V\`I8:#@KA=D*=L^

M:]`&TEO!;E#'>]A@P4M'09."+)2LZ`8U;",TJKQTFI/-,SH]+(U`8J4KS$+QX

MJW6,DG1`NC9Y2-Z>,BD2@.#_XMT`LB[L^**NM;>N`!6%*FJ1'38O>G&-TL_(6

MEW])L!<PU&NZ8Q_#4.M^X9V;L__AN^S)I7NET_<-U@1;EU]%%VZF=1B*,Q9`"

M'8JXV^_Q`!T^(1(;I-3J`#8SB>=[N+SG^P@B:+8T?NAJ`'T?S.JNN`5S5'2K[

M4W+UGH"^6(G')\\.;*A]#MZ4D2ZBH,>(*5P!`B0X=PXASJ4Y\8:Q,BLI;TMY#

MGC&^!0"YAQ389#;[%N!8FT`!*\!TZ((('0Z9>6B9>*(4@Y7`.\_WP7ULFS]19

M_ZKL+%2:NB</B^GGW)'OJ3TO@?K7(_P?/CQ;_=\Z:82"DQQZU]?L;A7L!(23B

M(VW*3N!1S4/\*7`GZ81KY!=94F4G=V\Z2DG%A?-\BQ1EX'<I/R<U`$/L_8V'%

M)&"E;O3#XH/W+LO'39T"5N=^`CU*U'N&<Q(:Q,JNV\XCMCOE/A=^&VY=#0D.2

MK@+M^.X^;[$%DN,5S#OKFP+[GU!O$(O22^:*1SY?X?U6,6^&U7<9!!BL;J6S3

M?P"X"=M=/NZ`"QZ])RBH-ZVAI*-N6UV?%CZM)J\0?#66G[8LGVH9!TJ^`GB/9

M;?MR<-VRE>^Y.-H-1#3[+L!K+O=>FJJ67*)?Y=Z;59#+_A-PN4SJQS)Y@J&$D

MYG4EWI/3K8XVK!NK,6<XR.G<NVI0$I>O>E0K^IJ2.[[(#8VP#?,7EP@U=DP\K

M//DON*`;"[S.&$]=X%E^&?3(%@EJ]#GEUU+U>6@QYU;0LT*BPOQZ#?##A^U6V

MLRW?@SA#2`^FS/$;L795_ORVKWJ]69NB1&1705&#@*_JC=I''[,\DMT,>F)M6

M9N<P-OXWUP6;)9?>3*7\^WR!WK]6*P\MO%']!::E\J",KP&6]*G=&/K?SBF;@

MHNQL>*3DU&>1_:/?S1F)&4`!:.:2F1_)3]/?=#H^H(<U1<\9FKU>*&RN6\#O#

M$'%B,75X`3CCT/SFYNJT@[&02"^C+BE[,L?D5)G5.Z<W3ZVL$O/O)3QZF(='X

MM%WF%)^G>Q?:5!*%/PD7%-I`GLX>/F'XD"(;[?-34"Q?-1BAA-58D.E)^06U?

MJ+1(P/].*-(P/[)YR#GB\WO#@H]59GC6!ZY*;2L7FCCNEZ-.5MV,:ICTUS#J>

MH,.UGI0Y64%WV0[W@-<D7&@'GP+\';Z[Y+8L%A03"9R>VY+BN:'NU@6XK<OAC

M'99B3B#U@D^(#XM2N#35NN-E7[0?+P`XO[HS9J4$H"Z7$R63>!^\RDW5;7CO@

M`1?U<VHV?>5^!/.BD^\XGNK]]`>>,5:^9@&\.FNOJ#AO)]\Z8PWK`MOFDT/8:

M4JD\3L!+<[.]YL/Y@_C[V(K>P_*0Z(=129@KO7L1JA4'>:Z]]KU<.;$NCGCW[

M=ACH15)E]D,/ITH7)PGO^L/(E9+-FUK3A9I7-(AFUT_$"!`P_N<^Z.6*X/JKT

M7S^3+$G_[&RGC6H-+<YU\5KY*>PG-K?_S*E&L_N"0"BJ>N$W1VH5YOG.J%LP+

MS_9`HOK<(M4?OD\/::DV^4,!<4I!E@2L^/:49(N[<'KNM'SQ-41J`4C+7_W/,

MK2#B7O''U5C[2-2$QA484<FEW#KV`O*X_:MY(S*:T@I'@%)@J:8_A,_$UEL^7

M$GX4+O`#/3K`G:X+>-P6+K5$?Q!J9X1R>:\Z=D/#IMV;+.A;Z%GNQ8K;/J-A;

M[:$7=;EA:D6OUG=8<J,+IG-2]W1T98[URJ(%V9P_<MO8@\\>FJ&5E"'F,[>^W

M\NJ4@/WQ`)Z@"(2CWQY]W\[EGJU(HJ_?.3R0`DD_^K'2>W_?JTZ$/*';0OV]X

M_B*6DX?@OXG?'GJQ@'3J=/\#JG20?\YVZRNRJ?7.%>^<\+`\l\\7>FU[T#[(!

M!G$MI&quot;BEQ-VP2%^QQ[Y8`_6A^1-`DBDM8N&gt;$))G2F&gt;MK'($CAYW`O-(2+8\+Q

MNH2W;:E/`\);3<ps223([`3[2t4&j;-d!'-&)l?^bf#_1lyfu233-pq--%[l, M8'F-B5P-^(_GI)YA>IF&gt;$[N7=&gt;VD@//SP4&quot;HMT;8G9'(`5/DRYI.`?V)OC,)3

MN7F9\<#5<?7!u#tj(/%0[=u5+[d(?xt:qj#=+"z\4jv\wm$l>L!26B?O-=&gt;O&gt;

MWNT)AK)O0TB,E?,Z'N)G3PAO1SNV=D16@)GJH[W&amp;\B5/JN+:\$&quot;?_V3KXTJ(U

M%__%?,NW&amp;<;zx#s>CD&gt;Y&amp;/GJ\8JON3!)(G&gt;LM0^UDXI63T/L=,:6'1Z]A^PJ^

M6E9A*ULDUGQ=34WL^5:`B+^7%I878Z)#+H03VH.MU,E?--MN7[IR)C**3'/0Q

M,5)!1QLY;&quot;0XP;0`+A1)B4MA`6<bdi*e5ta6ln?%[+3u!9#6l>?KPR]]XY)G\

M]&quot;U&quot;+[1Y&gt;X1T2$6:WW$Y.]:SI/&gt;XR_@0E@JXBW_`AT&amp;]X&quot;*(/?TBT+<`cr8"* MRNZ$C6>FDW[HE=N'G`:<pbw)*v87s[izw;"tedih&i.sv+j^9!p5<2cd1w><0 MD,NYR>F]C:([B9N&quot;44&gt;UL5;MP1[:B*SCB^.V,:39+^+/-&gt;YF4RZ8F1WWZLQZ&quot;

M=:T&quot;/FGOZFWC?K):H?9(Z6PDWWW2?ES^!THHP=B[\V*6G0?FA/._#9?&quot;3KT33

M.*YU+-K'TBD^J6O#_?)]G^C35]RSO?O'SZS#A.]<&f/:1(5#8:xdy+]2u9i74 M*#];8T5-C$;_J].H4$B[6#W/["-QSM5K1N:OGP:$^KAZ.+A@L^V4<DEQ32%M< M]]P?!%PX^33G,KJ2555Q327]YD]A,ZJW:M;R83;'YW9&([V[]"*\0X]HY>IR(

MPL/&quot;VF'UV]1U7XKB98I'*$DC0%_JC:/M*BG]J.K3#).P?;NIJ[NOYX/*)@$K,

MCE3A_/D7._G='M2\L'<hek7%"?fef%"d59%&vlg39p;yy9"#,@#[bw$gezxtz MME\]UUZLHI,IIJMJ3+<`*)WY:"CW,DXF+FSKETIRW]??'#9="0R!HZ-++`U-1&lt;" MP$`KHMT-2$P#H(@@?!J2BH="8`79;H40QA!R`/5^U``#J618($&lt;]D\26D7;WD&amp;" M`CU?MY/*+0],+W03N&"]907NP"1'8"S!,UUK^8B6?C`^+"L8:-;UL0R7J5!&Z MU";R;E&$C*?;BV'B?X1+]-`B:=".&quot;,JH:*EA`O[@D3;0$M@+$&amp;/8K5-6JC&lt;Q)C" M2D6_8`PD!6I+3+="F302XB$\IP=8!)YS=J'I:BE)5IV*!94!`9JLE4`F,@4#`5" M;E",G)`M'"F,X@O)XD\CX-%WYQ&X5"'LTU18Z_UQN$"3B""A$4,\:(`"5/IJ>

M+\@^54V8!PI(C@'$.L`0Q#4^MP].8(PH2@V1QH2+T'P$(INPR('6A04[,1B.-

M'\U$&quot;?ZAH596?:*(+E9&amp;FZX6[J&amp;EEVKB)C_X.IV^[&amp;-<+qy]\?qd6n7b$vje$ M?IM.5D@7[O6YB'!E(C646K4BLM9TF.AFFI^(C5;B;S[5:M$8`<CM3_T1`V;,3 M1OAR7K:,[._)T&"ZD/>_&quot;$2K_!F@<&$41/9="xp*2&5f@h?_g%0::<b4z9/"^ M>/%:&gt;(P..GMKBMJ*'6&amp;IS29#Z?TCW]K(HELSC+[BYXS)D?GB_P4YX#;&amp;5!N#3

M];SX);9MZ-MQ\N^VYPS62VP,HO*O%[='7JL%L&gt;IXIJ&quot;8Z#C#6@CK,<_7ds'!h M;:4(NGG#1.!Z+;54/="[&amp;4WB0CX7">C*LR7=K`$$/&gt;-LC&amp;V%]98^PQVOS=JSFOC

M_Z:XR&amp;L&quot;`NC=U%:H?0I\9(&amp;Z+,N!6XPLI&quot;[?![`\&gt;68\(#D&quot;S&amp;1,J`\V@@#L7

M1P!DR]U:,,N89PJ.$R!#(%&quot;.!BN$AX=RE$PA9&quot;D(W%0@1I*,K,6PQ'C0+T$<; MF5HT"_W7DN7@_V+P,'KW7[*1!="JR+&amp;N;^[^T]\CP1C&quot;`X\SQ^XN)X=-K80GR5" M\!".R5^642ZRA<+_M[>^OP89!H'_I5.HA7@TH0#473@99VDYM,!:Y');2:NL@

M*BZ(R8'^I;O/]6-T9ZWG3L)D-RKS)QGK[`$NJYD;`Y&amp;5A?=Y&gt;WO5_+]W:9(3W

MGG[_!U!+`P04``(`&quot;`&quot;(D7DB?/C`M-$#``#C!```&quot;0```%1%4U0T+D-/3:53&amp;

M?4P39QA_&gt;^WU6F:1`F,9(?A6/H30=`+3,03YJ&quot;UNDN)&amp;76)&quot;XHYRUP];6NZN1

M8W53,?C'&quot;(/XAXF$J,.QCP2S#2W&amp;ML8;I(2I2X<.$t?y8qg[r,5.a6&$b2e[< M^\'P?Y_<O>\OO_?Y_9[GGKN+@-0M@1T2X1800B`P@PD3(#&quot;)^4!*2$5?`RAH:

M<y]w"d-[w^[[&&wne78]4w!9m+f4h"?&,;j!-g<?ep#w0uh;n4ow[4sd(#"%" M0*D4W7I);)%%I;-XU^Y97.R6T,-S<8B[SV[4N(_%]VM7Q+&]-Z8DW-OH[B"2# M="Q]#%&lt;*\34Q?F,.W2U!AB;ZK*M_].&amp;`3&quot;VD@(@T,X8(,&quot;'G`!QI#*A^0AU1!_" M7\Z.D(K_%>_)^338TX)%I)@OIP#QN8CKS&gt;S=@_7_$B&gt;V6(&quot;/\-\F&gt;!$HG)(0Q

M&gt;OW\2O!]:8S4#(5QX0S0?![&amp;&gt;25&gt;LN2O`X6?2/1ZH1O,/^&amp;]N+\&amp;&quot;`X@N`%_7

M&quot;9VB(\$&amp;^%)I`AX&quot;_#L)R#=+8YE:(.P#_)TDMQ3G7@/&quot;&amp;X!?3$K4@.\@$E`%J

M&gt;*5LO:+!(&quot;A118)<g4:gzst^c8y7*3[`1n5!a0(\'rd*"*&ng:,8n)]dv4xg= MTP8K87[9W6IB_NL2<$FTKTKW97HX-WVA^H)7]<>;V6ME:0/#\+MAT6AKD6A:E

M7KHI6ZZENFNN7Q2E(3OE4D;95M.NL8Q4`+ZP569&amp;;WWSTJG1$6WTN+Q/WZP7:

MOU&gt;AD^FWZ60-A5KLHYX\0I[=&gt;FI@4'6Q_/P13'GH]_K*@O1X6_&gt;VCDUD=!S])

M&gt;T7][73JL2-7QS*OS-1]:'FTZ.!O;G87/WA6]/2.O..H?UD]=B.UK7@UR5\-@

M./J#BH^+'R\Z+M_,VK[3=[XVFOO95%12L[&gt;_-_+;Z;^*&quot;G#R0&gt;ID0TF]3;QP`

M8-#[\NFUVRUK;YT<;:tkg_oj\la/[[;4ua]8>3)@ZB]YU3]XXN&amp;FP_;%Z+_U2

M_QP<g(3$<'gun;,gni:yh1\+^np_/qkz<x2y5s%[??6<lk:g?.%&q:y7lka&g M\N3J\@]="_IFW$X^2\G\HY.')%XOOD8&lt;7&amp;BU6%J++J&amp;LVPKS7U=#:#CD+!1EGG" M)W32D'60="CLT6=!*MILI%M*,TP$;T9NM]W`4]&quot;8]*.ALMWN@R\VXG&quot;P5$UHY)" M="&lt;R6&lt;VZ(X[ZLVT4Q5B&lt;#M0QI.DPQ;-*CCH6DO9/TL&amp;K89&amp;@\&quot;$GH6O^$D`UI0" M,E$NCFK30$,3W%]GU.Z%)K(="=KA)NY7VJ.(">XR\XC]D4Q7/CS6]V,HP':C3HK

MZ4@NUH.AR9B8C-5LX3:ZBV6@1-),HLFID'#C?_@/4$L#!!0``@`(`'I?R&quot;(Y$

MYKI5_38``&amp;,W```+````5$535$-22RY%6$5M&gt;W<\v]_w_rl[(b*(c23vjevu9 MQ:A5-&C-UIZE:B14:R2U!455\>Y`=&gt;E&quot;:=%6[=EAM5:'49I(AU6KFOSZ&gt;7S_:

M_?UWQN.<\[a_w'on>9YSG+R#0%(``(`!*64N]ZP:&amp;00`T'_\_V0&gt;'F0&quot;!$:2'

M:(F&amp;Y`]!1O('Z9V&amp;:BZM,,`%#F_@NN2/I[,EW1KL7/;SW[?K`[I<i\+>PAF'8

M!N3&amp;+;NDGX6?,`A=KNYL.S\PS`&gt;T?5'5R!7)`#=IO2$RR@V!@-<rzh4s-u."p MBO+AYV-.Y2:6G[]HV\VT`E4'J'?HTK084SNMW+3]="4#KT:*5H@&amp;,ND43[WJS&amp;" M/9V+:7D+M'JBQQ?3N[$G/ZTF="4^.J:V\@K07]BLRS#Z3H73NZB%P/'*B,C?C]" M8,-XM/8O6V,U"(3U'<3X,E-W)_N&:)="D-=U6;8J1W">3@X0+Q&amp;_^V-\:X7?2G`

M1<vzpu\]o1&"2u@+m:7%_(pc)4hl(%)!$c*'6d">S]OG:V^JGD]J&quot;B-7EY41'

M[`2_@JX@1$DWW9JS2NSEB:C#L]IU-@SB9XDR%OV`'[TA'=5!0;&gt;0H)[/(0,Q9

MBGT(D.X/C0\^\!Y:&gt;R7LU6T(C-D&amp;</7c#y)csy`aitwu(x'v#.`=a%r$81j#o MB3WN'NVWX8;O`#_?81F`\;W),<\&>@C=BJ&amp;+M6FRD&quot;&quot;9EO[+!Z7/^?SP.NEZ4

M$:H*]UL4&quot;]#&amp;POK)02&amp;%XJKPL$6QB$8M!:WVH7*IMD`0OMMY50:J6;,0FMTKN

M8E*3Z0H]1O!SO0L+DH9E9-E5A?FQANN!21W:9^,O%'%%FCGWOT9,WM&amp;J`IT?-

M`_%0QFY7YWBD&quot;9R]6&quot;HQ29&amp;<t3kw98hk\scka!\xrxk=$t3v>-FM-6W7*^H7B

MB,X^$@:*@\^'7PCH)&quot;]EB?0G\'1$04F&amp;B%:9VRNF#<kojy@kw!;(6?$;yp6w. M`%C'<8-S,BGR4Q^1)>L'&quot;538FSML*:\7#&gt;!'V]AX&amp;Z0[W-$L-[ML1_M*Z65(,

M[3[^NN7)8<f0)bl=^*?>[/JLD1[?)YK`27ZV#1)*9KX'G4FO/UTKW^.,LLJ!*

M$DL;Z$5$(Y*Z^TBK-&quot;@!R;M%/<b6ec/g8dj*w[5h'e6xt2&<5t&kh/k?_[#y, MEX#CRHB`CQ54<7;+K=")3X59NPDB#*Q)@*1,;\01H/&amp;GNKQ?">]V272;'(NW@M^

M\NOSS&amp;37XIZ]T+=D9720I9:%KV$&gt;TVGU9/UE%WNCOP3WLI),_]?@[<4";5cq1 M,J33^>JR[0&gt;M*A^,&amp;VT7&amp;R^0Q9@:GUO8FKYSKS-7F\T[7%'!*FG]`)%&amp;8.&quot;G^

M_`=3T-N[7:.,)5`//BU+$U+02.^Z&quot;L+FL1K&amp;RG67P+^9XW1'R$BO`C\PPE.T'

MHZ9R=<7><#>N^YO.[+@9CJL;]1*Z&quot;R0+IW,\4R'M'J_G].=HVGD9&quot;^6,53;?5

M-GWILU8:JQ]&gt;/\A%V#UGZ;^=T]'9KM8YQNHH$F?&gt;X_;E![R:U1NV?O130K-$*

M@78H&quot;#F<+nm>DN[!E(+WI**0Z&gt;GH/_*))VC@.(_M7YA3'[!/FP3??0`&gt;\T/Z\

M8`=LMZ?+EVB_&quot;Q(^+V*+@Z/4QC;2Y_1S<#:+9!1[]405b\;;0=tl</zl;p5yb MN[^YF@="51T&amp;6C=BE7F&quot;;.KSXPL]Z`/'\/CJ$B&lt;+[^8*2EC#24OM@[C-X[,O^]" M5)3J</TN-(!Y^OBBF(2G7./HW9OTYG-WFOXJYUOFV:`3'Y[#FWHBW1%@-FQ(="MX`ZGPN7585%">Q_W\A0'??GJ&gt;&quot;=1Y'1Y]9&amp;T9,=-B_^@AFUE6F^?*$XU&amp;^9\\=

MTU.5WK.QF/#T)*^L$_0P2TMW<,'0uwk]<b@x`bm1n]n`o#-&'l>[]OA&quot;)_7-Q

MD[^SCJSL$5K20A&quot;,6^FMH=Q<=u2vz&e'd0+.o9auo7=ni'u$"z65x6]h`^!u# M2$]O`A="ENUW,6@M_7@TU-PYS]?(('?[8?&quot;@=O6@\2@4+1'4'EH;S;V&lt;W[U`BO" M7\'2O[!Q,CK>YC9MZ%X9#WS1%!03_?='[,6;JC-G,(K[0)?`GCF5KQ&amp;[-09P.

M&quot;10&gt;Q8EPTW1;,&gt;A.]RY\GX%_7%@6KOC`12':1,$H_W3Y%&gt;Y)&quot;O:;._1;IU&gt;&quot;V

M5;(JX'36B/82/N4*HNI&gt;0LTV/95ZA&gt;451EZ20Z8ML!HA]AIN<$tv\,!ycuue< M_(#03[GZJ(KLB&950ZX;^CJE;2VY].T[G;4NSYU[>.575;)XWC7N:YU#K<(vc ME`"R)KQ9XPZ;]TK4[:!0ITB:<Y4[:#S]5QE.*SMUZ^*CP:O2V]]`;/6;KY"\I M=":TEOY_L7;@R^+#OZQ?">XW=,0@C5C/TK`8<?k($hqtm?gfm'hkn*408z"*pnj M":R[M="U/R*)1">=*YGA3H,[#%_`Y96GR/<6])(>UXA?OJCHPZ\PLD,!A7)):Z,

M`T@?7*!6G]MO&gt;'&amp;#DS<q#+z_)pn]x502>:0V.;RHK:?GQOD=YB&gt;E'!=$-3UT4

M*SV)G]0/=C4QHHCNGT'2+\1XLTTML+?`/M:V.%&gt;W##Q)UL&gt;[,$&gt;8273(=`+K+

MFJ&quot;DSC(OO<j4[18r<of.gxqn\<v0>Q,[)=(L1!&quot;=J1$,OF:65UY[[AY(\Y4*<m<_1oi0scs-_sylyw@_@r79'y04!m!qgnp?re=4^$]7qty.]ju^7fbl:5y.*[d M`P.@XOQ!;P/>$7).%;%))O]D$&gt;7`HZXZ6Q]XG`;BUV/!GH&amp;S/)=FXWVNP*K?*

M;:6-PRW%/&amp;$(49L+ER&amp;D)I;U7^LF)%,A`NERYR^:S7\@I;U(DR*#_A-HG2Q2#

M<\-9jgm@@n4=`_r-@</5.d00!0_,4c^tinimw#_a@gktr\27"g^x$+[?]"^w0 MYXTP="AH@X[]:$2#9H;$EY..XR`\F#6&quot;5AH:3RA8%!ZAS1KC$6:MB6N?5]ZI=@" M_J7SX!$[5&_Z)#`)<`:HF^Q1UI/MDW0Q];J[QZ/KZ_8K@?]DG9,]B_C+[(\Q4 M/O\D"@P3YC-.?6C$E5VB(.WFL6S^:@S/P6L="=;(W7TIVVQ@?-Q5$\C]`NXG/O" M>?.WC]<ax;9r"0'n49w8xwy!;)!pd"^`8'@5%0*u&?6i0je1oin?-m([x[w2\ M="7?8S]3&amp;6D]]GY])MG=UJ4?A/+V!1P&lt;Y@\G:">4P:6OR'5ISJ7Y1&quot;H:A`3S$A\

MO!$&gt;OT`.%KE:%F]=T#NZ4`0&quot;OV&gt;S=QK7W'8MOL+5E%@\&gt;]]QX)SNH[SJZ$^(U

MKRL=Q%4&gt;#61CO8%8HRX'55\/57GR)/M0O8Z4;GU].7:@7J36P&gt;WD61I;UJ#H7

M#T^&quot;8+93(JQ+&quot;H&amp;=ARCQ6?,:3<?#hjqwg@td^nqzv>&amp;[,W'P[R7W1('#O+M_7

M+;U2+*M@Y0K02UO=-&quot;K?QIU7PBEBG]9G_%<pr4$#pb9j%$0`0h*s0'>;%PFP]

M,%+;8G!.+R_6(-)WY1-UO3K`<1hf6m2sxoa:;*p#t5@;:7*6xovmp=-3ei5fw MF<B&[5CQ#7RNVC="Y7\'*G:QM9BQOH%$2@52E@SV_7#I7K@+C,:B/5.T`\6,J5" MHMIW+S'?<J(*XNZ6H>IMMD,AJT(4XAY5Z[NEISRNY%$M03I^FJTQ+Z9S)7MH:

M`3*?+]0I^('JLL&quot;C/&quot;]T?8(2G#=F1F!,EM%2MT#!]MLS08&amp;!;S[U,W<405(+d MTC@KJ[W<DQ9L$>[9MI^GP3;^M`D@?4Q=4CGQ0]L&quot;HT!6J156_-%Z&gt;N9._XV^_

M`C:QN[,-M[U2<@d^,e78i=b7s2,+ymx;a<f2jq"hzyy^r&p]l`6ar!#3"$fl^ M;SM1=":2N'/4W:BMMQF(GP)[^-$'^;\@=8*[XHAM&lt;?7%0&quot;;3)PS=HX\;=[8*">6

M8V:K8$S1V3@C*QY)P0P#@E3WUF(&amp;,MO@F'Z`X=\.1YTE'8N`<a'%x+63o\7%a M\OK@S\FDK@ELUIQ08>#9(B4<j=zr[e,7o4q>WF3EYPS`J&quot;*O&amp;!(=5E^V`N4Z*

M'&gt;N/MD?M_;KU`2`'9LMQ_D[5=7-QA1=DG&gt;)J$=1V1#3MR1X;EQX&amp;8KQ1,'DK2

M$&amp;8I]6=!NWHRPMO+QRY''Y<k]%>BLR<ais:x6;#zl$#za[0?s#m7m^+]6>.0L

MW(35D*;E+'O=P68KY_7$+`X!R/F]AMDIBMJKK+H_E*WSE3&amp;BSD<c\)'^^,<+= MY="V8A:83">47E#Z0.*C0+U=ZBT$C`7R!Q)]V9`V*_LZS^450)[DE57J!(_%;3A

M@.2XGQ]I2@_E?&quot;E09.83FF&amp;W,49.VS:<xmp+*c'7d,tezv,l2$$#5!]v^:4->

M6'LD1R9&gt;T,X\&quot;;Z6E&gt;NQV.R<&<v-]812)w\4;/6*y00dh>.'FG^TT!V/E:AK/

ME6<y)(i'[v?[5_ac1\\ds<ve$vpa7:`92y;.a^7_ma9<f[e\jb=%n*_av/g77 M(?0O+\N._:JZ[?4,R<[J1U72L4\V`/!,G\UO@&W\1R!USPOWWI"-[9-([\S3' MXJFP?7\>;N6!!1[]M#(53F@MB%)XKO&gt;KLF$,DUX@L[7.C];O@UGW]K-QDR2H&quot;

M*UG$(X^S2S0^:.+&amp;+-JX,%WZ<^oh9lk.!yf:[''i@#:&k_\^]y!5]w30s>U4B

MQ+\<21*=oml-kc>J&quot;\_VS@Y/N]VXX@GJ^E/@W*:VF_T.Y&amp;P\F@86^X]U9&gt;@VW

M4!#7B&quot;@V&gt;H[9'/^0VPIB=K8UF/M&quot;J:$*49=P^CVFYK3\#MY^/B$9Q*L),Q*3,

M_-?8&gt;2MAWL$5R<j6gbd-]96$m`*i<2["5;[/w5r'm^5"-!do.^]y,2d\i=*_q MWL-@B)OON#="OW&lt;.(&quot;+ZH_CI*$;M]98?V5(&quot;YNJ](.P,Q/4`%V:N-]C#=U_GY)" M*+QJ`;_?M.&.-MVX>G[]42^`DPW^RV4:<mjw7v3).oknm,`,y$u9'm2w_j%_# M:/MG1C/XTJ[Y="I1]+9">4]CM[(<:3*k#61#i"2(]>[[0`IP`S=,A].&gt;`KF@VOJ

M)S`3]X_8X8RGT[9(S%6@7LO:A!FZOSKTQS]?,_]4NI:2VM&quot;,8A[4Q+$?R1])1

MN-Q'G2FN`S$M]NV/9`\MSES2Q^4M[)XU%%2;GMV]*P5AJJSRTE&amp;SJ3R,8&gt;0]+

M(9;7H(=&gt;X:$;.Y?Z(F^VD%43U+XOROU4_+:38H^XM]@_5.<e2`@h6"vt09(]v MZP%!!>;K/Z=CJ-LTL,QW<ljyz#[$2:>5Q]8MNPN/)5\/BC6A`5EL_:I'?;UH4

M9GU]R4A]_&gt;3'_'H23&#01;/.I;8W-(5#Y2L/D](.LH1'-\J&amp;.0I#/PM-;;)KD)3

MEIWA#G4`*@J[R(K5]K`LKG?ZZ*L8A\[?]8<51;j\cl`,[*$y#nx>]$`A-[O<< M_]Z<Y)P7@2YZCY_OW0C8-]Z.]XOHM.OR7+5IVKE]G?,<!-VXQ39NFTE>ZU&quot;?+

M[:8([&quot;%1WT<&xoyt#<3?ll(nk+'q%v\\c"9,&7wkom\.fm^_i0520%urugh\$ M6=",@GR&quot;X2E*(&quot;/G&quot;)V(OF=YS-NXA&amp;I(+`1LX/)4PI^WU`5VRS#/\8=_&quot;0J(:D" MQOWI^ZPCW@="!8@^Y]">UX(T3.&amp;\4#?8R%J'1XHGF&gt;)906(=*$J4<p/x!8ux%sr M@4KN9F_DC6V"`QAA&^E#F4?Q%WO95-EW,:XH6\\\5W&CYI+D9T[T_0-=")7DG!" M)RT#8CW,&1XA!GW[QE;,PZX5\@ZN;RU./Z-JB\OGN;^&).PW@9^M\AVU>R+CK

M[-7$T^'L9<(t0#(x8]fd1j4qzq0).*iyl-h$y#egivn18"]t(46o'dz&zd!g1 MS*$+I-Q%B[6/(/D*.AKMT2>1X/+*3*&quot;3H[Q<+u[y3``?<%=3v#`f("p01g$u* MRK+O7\(="D/EL8W.CVAA5MI.@++;_I3RE94$6I5)U7.%B!N">D&amp;5M,I^%A8,_S&gt;

M?`/DM)&gt;1^1CE<"szr-*#$>J7TK?X'&amp;(1N4GP&quot;3T6R\SKAJ[F'Q.NE2'#G#R/T

MN[1Z/L#CI[UH^S8&amp;//SO'-\<yl2:@'=h$#<*51r0&+_861a!4lr^".$t@5h1z M\(\@3_:L"8DZ><<x4(sviu^<8m$b\*^v$d4e5\\3^eu5:1c78z"#m^$&1e()& M!K?N"+K0([BH#L_7@%D&(';)!%Q/,E@DU_(S090`KC#@Y56-K&4="IQG!OZ;EG" M*%K![)>&gt;R84_M%^KL8;I9NMQ+1X;P5%]%%S5A-S=_V05GDBGR]&quot;48EL@&quot;4)TU

M$&quot;D&gt;G0%&quot;'+DT&gt;K'F.<%ML5[<(XXW]>"Y@HQRO"+Q,"S2EZ`IL]JV<ORLZU'GA

M""?!5$X%_7X.J"?8[HW"#';^8SVD0NOFD8S>?K@]V^U38DW[3OW^"U?HO"])Z

M:N2PK*>%;U]WFWOQ%1_WDBB+P?N^7CI-2I%G_`T6,9=8+T#EWSLUC$4:QHL/R

M%<Z8[[WXFRD=S\Z/L'K"-GA[>6I.&2Y<_9:)O*EZ6*;@:LWZ,:]OS^0:2AEV1

MQ?T.TH3T)RUZS:1PQ5+77%`"-+VG>_MS8B`<DMDO-I<O-(J\^T!1,YMJL+MO.

MXW,L'X2-Z82,%'95^")(C%R,A1-*Y];@*M/EY\/\S:CU`E?U6_*@;L^[//_]"

M_BPS*?[ZWDV7J>^;U[^)=PHO#6S&0D/Q`D87/2((>3/=,8<E?E8?;R<B7XQ?W

MW2L<T=<^>HL9]D`$^L$S9N6:76NWOV=AY$!6II?'IF#F`54H[QB%GS5?S'7II

M939PY+:X:EB_&A2Y$=K0_*#E)23B>$I_\%0;UL!0;612K^I=[6B'I_>+V;R/"

MKQ/96LIS>6UN#`C:QY0;`J'L-V73&DSI99.'ZIE"UD>F6=WSGA72H2X&O(R[V

M!M2<!PS,$[HO[SC_F)OK]A1L2\0-56XI;9OIG4VR9+]Q+V+,J$R=.]`K4IIPO

MXOX@/=.&X#+;VY:KH#M6C6;SR.OTL&3D!GB'[$<HOC"AN;HXBWO0[:Y5+M4X&

MP*1?:P%U\,#$90*8V)R($!1<-<RNCI?JEC,%C,>IJTQ%+AO_Z_Y'A(3#"^'=J

M6[?AV,1-.==1A@SRXMUJ[9DU-U4^_5;W>=3SAY889ASW6$**,MBG&R_\$2[CA

MQI`.VG=XI6.[W30HK_H/POMSB+3?6\@CVIBCRZ4=&Z+O`EA+@P1(Z^C\-<!5#

M:"4@YRT3)BB!1NX$RPK2S@SF_/D;V,.2VVQ#=U`.,_Y`=@K[)VO6U%8?9><UI

MVV+AY#*/F-AQR%;A:&(S!=&LJ\R&(1,J-@[6U@M(?!![<.DH9.J<B373`%2`Z

MSN1CPR_#;U=43,(*7AXGGFB]^=SEYRS%*%RB8,C<3HET:LSHFMZ[\9<3P4SCE

M@;@`DT1$M3.;R+0L^R758=O9$R3J2O[]W60"4TM&NTGG.;J,:51=\I2GPVW&V

M?+`F:OKG&8?ZS!O&?QJ/*%$_U$C\MDN[8F)[_;2XME1V?;J$ZZEE)>$/2Q=MD

M=S1Q'R[_.N\2D\`[M:!\^D+HNKN^][FZH`9!]`^XU[1E]/+MK+['IC<%(>R*&

M2D-Y)J2;]]*2OO96/[Q@\-M`I+:][Z4>1,7&9C;YS&9BIK/54>;O$[R)S6(76

M+<0*4A@?+S?R16H693=.=,9D.)_L-BUA:5W_46V$&6NHMONY]!S&[M;KRBUM&

MM<%Z0X5XK/;XD]-@,[YV!@G(-ITPAYZ)50'[7#VUT26',G>.:Y,(D>.5R73,7

M^-I%=.TB6*[KWFN5%['-91S>,VG:F9/@++>2$3ZAU3F,,Y]+/^)S=<ZI>O&F]

MPE>#+T?*WT##U)B1$,"^U5+3_JM:/TE.1RJF')OEC'ENQH3_CKIS97$+S!`1K

M'YT#8>QOH%,%Y=U*JIN&P>MF.(R;]:>&QYN(F@:#GL0*DIFRQ8AEKWL#%-5DF

MG6>#O$7"S"'1C5'IJ4_?M;[J4BCUO+#\]>4=]=CRWH2'46C!I;.+3'KT`W!EC

MCEQL+O:U/Y#D/C(VY-J?L-!73&;Z@O=P&:ENA@=R4SG"W`@CXQ34\]9)C%Z$U

MF<K('EM%N)!AL+`1&:!\8MK$^K(32JL'!$G=7WI.7S'NI[XQ$%4]KS`-%_0YD

M[A1PN7)SZ`H37Q13`AM1+,4JE4DHE=]66/4;4(:.,C4N#8RU_4Q?(/EL;^1-:

MC2X>"1/QOO*TU95_=G0D9]ECW7NQOYE5K#]RA7SODZB\,A!B3.%[!C2!F?.D3

M`UNYTJT<!S>C,Z%QQ)F^1F!)J^:KPFV#4^@TQN?$?^C*P\@&N<CP(S!CO#VZX

MU"#WDT+P6$4I\V"!&IYXL0AI.[3I;1_D.L;DVS/89Q\/<]ETKYKT-E6O&V"2D

MN-I6R(S?C.A9'RU-^/;U0^E8![`=D2)M:\=INR7F!<W[.)&V?I5'$_2;[90>*

MHCB5#!9]='3=JS9SU$G0X/>.ZVB;.Y2L*-^)QP_=MQ?D<%PM/-?96*+8+`?_H

MGD]2W-@D5?I;+;P`']Y_&"(V8CR=>$!2<E>E3^Q+FL+9U^M$0[F+4M_7RRI%!

MGY\3DI3D\LM(;EEK]N[KY+V_UAQX/!_?#F;F:5C"&@ALWD;]VYO\W]S!QG+1Q

MJ:L^,71UWBI'E7!_'<G\`1+HK1#UI:D636H^@**T4<R!/KXZAT*6"L%K@C#%[

MZ<5`7M6C-\,>)-@)D6/(N[PD=^T%O.M^^,2?)IL!?ZX#44`D(]SRSZAO.5]F+

M!%/JP-WF^DQT\+=J5GZXN:/B.3N43XY,1Z=?1F6@9_V>MF*1%P?6C,+VZ;$BK

M;U6;(:\5>85B\@VB49HVSNBUAY[F[BRYX?6&:YM-34"C0Y+N9YGB-D.7_[[7F

M_IWS/-T1.M\$@<:4KC.ZMBMXSB]S_Y5W#\S`;]1(^.%1OB'N9Z4T;"K97+,V6

M,N5R39/590=F$N194;%U9MF7"CG&O*$(S(<G0N7Q+<J7RTTS57U%EUTUS"<M\

MO:*O-YEY,LHS!+U4?'2TC+[*M=)3Y%:-T1.)".US/.P`3!>_1T>3HV=`G)DCR

M9JN+1CUH:8+3'62,:I"B7,G@^J$IU>XY;Z\X<=D[E@:.QID?>1(5+NS'G'&2R

M?79*X=YG>?LO^/;7O"G`UU1INVK@WB5;09JM5$Y)<%EZVA=!S:&1\2,I_`$*=

MMQ+3$I<0]/AOM&U;,+1WFI^;B'*!(*^-#VP0TVEI&J^3"P1L/2J//+C*2;7);

MY.VW32F-LW#I0$A;])%A7,=(66WB=5(E/+^9Z?VE?G5+*\5C9^N:P+$^_*+\X

M88O`:*C&2X#59.X9S_>UK';)T[QTP87A:B0I=O\B)I&N5]OE'Y(3EF9O8>B!G

MIB9I"NS[(WBH@3CA$TDQ*,SW;R<&$"[E;`>[Z[Q):`B"I/Q-Y9!=!EGWJ'3?[

M7->&H*6!<1]%Z)K.9O(LDVI9<13+\N3^L$^5S]'2;=OZ\UE_$KS0F_"]XJCLC

M^9.2FGHG\=?L3F5PKG2NSTZN7$W');D,.E(_]_^6"K=[^OS\;[EXAJAM.7^G$

M2=R-K+;[Y]HAU_&TW40/-]AX=.ZSV(@`WD)%GE='0DT^N(>SLC-]RF0G#=6JX

MRJHCS!>KJ$0.M2M663=0U+H=/B";OD#MV1^"]B^"VNFE^L-T7!B)+0<NV+NZO

MX"*LK_<1HH!8YAUA=-U;5;FXFOZ65.,(E_ID,#0D\=5NU=AV^46@N>PO.UXT?

M\.6W;7&^XQ?W?;476+5_+ZNCI9SJ:2.T4<JAZ.*T%$\M]V0C9,:=M>*<SKZ.5

M%-Q-RZD[7NRX?>&7$?V#S%-3L]`[7CPH0?K1QIG=,7[(4LY4G7)2A&S>\3]/V

MNI@._-ER!?NW!MA5_>JN\>XM@\31.,W/O0;P2,V@"[53,C<7&25I?Q\$_.TX)

M0/3T-AZ)FQ+`PZ-.WJKBV"N_#CEKPBQGEG`M@WF[J+6.8EY/)TIU'BF""CZ4?

M*^7B$7$9A-]ZY"3S@AH_)I*PA!=`LF:`AHAW?:_5WJOMYR?`H$0V0E!M1QCZ'

ML#0X\4P7O9@<GF(=[R<Q1_7B.EN_DB*R,9_D(&F'2E5N=2Q7-L86=&48?@39^

MC(#<49A8-;63=0)=BKB1EP19>_;Q4Q8YHFY?''J/WR\JUSNJ_3'YO0I_LC#F_

M:F<B.BKT0%PDI"EB^=^-O\?[3$.7,:+SFMJ:OG="D%+GOQ9A*YUS^]8*ZDA;6

M^G7Y,ZF\W,FGUQ0EGFZ\`S@W!9C^LPW?>B"@1(4X:*A\//Y+Y&DIFO[@8]M*T

MM1%7+2?/;:0HVW"HS$8D2XA.SK%B7IW*[>FM,7<&W\?=$O4HY3WH0N.,#5JJ9

M]4%T(_;I"A6^E1BC3?31C$Z=4'Z+-7:,S;05HD*WR[-UX*'+:G4,U:K`I5'>&

M`QW;,'-66%3!/<B9>3=`%$4%5AF=%O7V"JCO;%S++X1:&[%%_E)2RC2F5\WZ;

MU-Z1.E>Q+*A_.@=$%2U:297(<F/>T*E0R5$2=T>#U>EA8#_.":N3`P)$=VQO"

M;`AG*NKPTS@JZEK^T_?BHH^,'>%#US)3+%]T24[O290OFP78Y=S=*`UFY/=D"

MC'9<F;/]>2$:20EJ`<M*S6-CM=3VI,8,8+"?PA3_M08>MTKS#ZK5.7R/E.:]I

M];Y[#3QWG'B3XB[!5*J8?2%0.\#&WA80'LR[:BQ.RW?1'-;Z0/U*B9^/EOYT!

MUT?F_8J8CS0%B4.LG#L<:K&5<,W&-OZ0>N=V`LJA%'IS_J^V+98MM1:X]9XAB

M'6&`]8HS6B"TM;?:X8#DYT7QP?L,!5D#`&)*Y7U_>,I6:4=#Q_;:K,JA;K=#3

MXB50Y"D(LX9;RTD<+(;7VGJ[600&NI1OC/)\SMYW^)(DKR+PAHJU(J9Q^`@:L

M)\=WQ$R+"Z4KM%NACG>NKL+AQA<0/O(8%M0K6-D^W).L)6S=:%LW#7BG2)0*Q

M\UM>*,2QFGHRSMB>Q`[\#CN!65'S2S$16J-E'G-1Y:_[MBU%4D4WLJL?B9DB1

M;U1RTG_!>YI@W^P4W_DA3!7N$*BZYIGTWUZF&K*\0H.6Q&-<P9L0"Q:)2S,[H

M_71HIYDP&I!N>3'6JRKIM:E[R9Q.2ZA__JS[+*=8XZQH3VJ6"+PW`05='67M*

M;]R*!]4>B_,8L$%J_'G;5FA2'6K[(5ZN^"__&<C^Z6*-'G1_`,S8::UBS0.VU

M>W2[/P"`+@K4VJNMYB7N'$F$93&,F_>MCZB0,8DBRU/#C5ZTJ^M>Y>I@:)-)O

M11>0%]A5,$[\B(-#U0;'INHS7,"N.?6"9D`J>KL/L(=CM/"`VFI&,J_;A8U;[

MZ3\?4VM!+/I%P;*H6CFSSTX81O\]&N+;@38%P?$I:^[=2^J[ZG,0U=]\)H1($

M.^;O,=;Y<Z#=%5!D<TLL3X[VL]'`>'.RY^OHV(^K`E09IA<]+D9R4F$9<%`=V

M`SSZD#X;7FSAB:<<1.\>]7BJBJS[N$%#^3&<1G(HJGNC^M0/>K.+_;UBNAS]%

M+8'/Q5Y*@=M:YJ"E.^8J;W9+SO)'!(6->FB[?-_C\T([Y^%T?AD^1)%E+>YEQ

M*30IQK:+6O?:2#YXQ`Y2*)!MC44X,C[0%[C(G!%7.3\_N%>@=X3]EQF]D-[<w M*TW.N?`^RD&)*_4@'_1V9]+?KY2/\]`39N^G9+)?-:S*IFM+Q3:9JF$(,^HRH M/B9!+7P;DX\X2C\&%7.S/SK'3MQ2&;TH[]C]D%@R;+LO\S%9__KE46$NO]FP="MFYGW\,$6\0I[O(V?O'5-`4SBBJ=!RC%YR78X-3Y/1&quot;&lt;M!S">=J*A[LMT'XPVB)

MF:'/4\3A?/!6^X)[7;I[Z[5..DD'0?(6@3IZ=P+5?0:BI8L:($C&amp;T^PQ@#U39

M`A7S,&quot;X&quot;63B<"3'x+^^ntx/2t\uqms&/;#^df[e4t)xke9p>J3-S.=KCT_.@8

M#-A&gt;\[V7;[.,&gt;]]<+#f8f@#w"!_m)a[>HRH]^)R1+V664&gt;28#\LL1B(\Y&gt;W,O

MJ'B-0P7BT&gt;G[+/C[,4HS^L&quot;&gt;I=,W3E7!C`6T/V;?2`/^_MFS8L]!<7?d[5-u] M`T.G!`]JL&6;7$&OU7W+="Q6BYM5*#OJ4E@Z!%)8F;]]Z662/_">)V4X_GS837X

MJ(-4?-;!@E,&quot;_I)K[Z^TVZC0W,6N05'&amp;O]Z-=89XIUFT*B_`C/N_D?4UI\,$)

M\K6<u!f(bo^20x);a]#&5]3j6!?fv3bu(sw=i:l58y\6]*yajlh3,>'G`G9YU

M]K*2&quot;_\#W$!I:-;$@SP@!V[86W&gt;_1KWU(FWPH=3Q\Y\+F\I<;5t<$"f$b]+w` MUJ1_B"Z7IWEUW93H]$^]3_:7VT_T\),[P<FQ:V3C#?="-(%L&quot;.UKX">H[&quot;@-;TF

M4MI=F5H**JO6X@VK2SYR\P')5#DI3JC[C]3DZR?5P<+:$b'^*if==^q(8y^(& MZ*AK4>X/&gt;T2Y'9F?]Q4?-,AJQ3SGJUN`;VS,'OKUU278O\#FKXA*=I&amp;58)&amp;45

M#V(_K\Y8&amp;?V'&quot;F;G*UM9;4]+=@C(NM3*/W]38K_I&gt;[&amp;#[*/V9^_RE;$`E+<@% MHD3\\0O#ZYT"FL8EBV^="5;$7]`VYF-*&lt;!.QF%%4#SYO.!&lt;=5T#FE\@EG,G&lt;.:" MO"_J\^1_OY6J'US3-]P/G3[NC"L\="IAOZ+CLTF(&lt;U:&amp;Q)(4BXNMW?,ACLW##">

MP;7X.-O6&gt;-YF7&gt;'OAJ%*TA.\0N/T1RM4J51S,]B($L:[E1#TF%S=)*;N)S)8)

M:V`R6D-T=W9&gt;?_<u5_b^at!7b:8!-^5(h!24k28,?]95h/`,<q+k>C:Q8+$,4

M&quot;ZLX46*-]'#VV&gt;]9`$_J=!04K#_R@1=04^6K8=NC:KMA37A$=GU''U\<n-9>U

M89&quot;%'2S)[XKK?^1X?EO'M/?(23O4_DVKXNT1.R_[8L?'OYPS<+m<rhfzo(/v% M0`K)B3STH1C6XJ/Z`(="(E=XQ.8IVL]LHS.]X&amp;(?P\3N?D3?*;1'=_,B6*-%S(" M9[+#R@6^U>=U)BA$S+'!#)5&quot;D3)ZX&gt;G66T?J//YKW1R`GA,?8EF`3,^]D8L_9

M@38Y]07JC<39483lme"%?,-3w].m?w"$)v6rbl;t-z^(l[xywbr]=qpwk;c[! MS"5S,\RGQ9]-Y7(BM6\.="^%J-G=-4'=M`C7VPW[SD">D?KUV[0::6-11DQ8V\)

MTX7KSJJ-I`.\$0+)UI7)&gt;S0=NSB3XM:$,;75^M@2&gt;7&gt;1IJ@8,8&gt;[!T:4!1]==

MVE.*<+g\s1)w^%).?da4*ke-,n5l2349i2]xs%b>*&amp;S52HQ,^'X[(J_!7!+2=

MI79).&quot;'8+$1(#K2FTA2J)$-*'BHA&quot;9/#0?:66$^H_(4!?.=_#G#=K='2:-&gt;2Y

M3P]8'Z,+%VZ!]05BIO$X)::5M15@&quot;Y5=L0IWCK=75I@/]B_OG^&gt;-$IVM<0m23 M%)C;'U7CJ:N7*32Z?R5521Q3DD?XC?YOW9EGQ#NPA.+[6C8.AK8+YQ>I/&quot;X&amp;0

M?+P#A7D'PM:?R&amp;^)3O`&gt;_\I[^ROO]@*OG=@*K&amp;(;=N_QQ2])A+U#%X,7UD#)G

MGT`0=-J'J@M='7.0&amp;EA1T=/+M^I+JY:AF7UH?G4YW+KV^74ID+ISC,@'L9KHV

MX1JK!A4=W5P1U,VB!?4S+QC=KES]7-/0\,F.4!NM_4IM2UZUMA]R8D9P*.QQ$

MV4GKZ9SD'SH^C.RT)LM0[VHZT&gt;&gt;KHL\]6R]UMN664\7PE9;T*B^?RDE(^:7X&quot;

M_+\)Q4=\<4(s]+z>LO&amp;U$ZWH6+-N,80&quot;.KEW#@S9T<^##1)rh*ne7(,usi66. M9YP<H55Y64AR04E.Y;!"U\%#!P;/B@L\.9W9[J+12AIBAM,"^\B3BG:CG3DF="MKNH*KNQ#QK$">&quot;Y/&quot;YBMW'T!!<t^jlm++c8^hi74d,so1vb$q,-jecl:ne8\+m M7;+C!_[]$F.<[$@]-!C/&[#X:D8`>L=R`Y9\U`Z$?0&amp;ZH5`)%U_-9J)V[K]O#

M(7WL@#,I)#T@8IUV<).vdd2*u">%?0?1*:</o5o_^15r9iunl$e;32+%&ixc7 MK9L0XHVZGFP6)5.-O62V7LR9%26:S'GM%"4GF7K)[/V//V\F0][GSTDQYU?F3 M!%BGD9C$FCVFK?UOJ['@5M&_G\^G1G!)+33(HRIPJ#9SA)W$G9?6F!6RO9C3/ M<^U<;>HY=;34QMFKL0)@&amp;MO2A!=C`IG2ST/(=AXV<i:d*cgo2-ao%13s'0z?; M]Y@P^9"@.!)-M$D%J"VG?8/#MPK/)="_3K-@$@=:1B#EA$,L7?$JC4HLP&lt;)G1&amp;" M40P3:\'2@B()_VW]:MN"VOFL%LXX$C="NX:]:8GN@VSR=*L[5R$`PEV\.9UE]&quot;" M`DQ6%C3_E1].@"^3"5^QHU8+R)&;_J#V0AQ[B;$`Q9Q@3A;]E/&PZH)^7)<QB MOE(Q<>?T\M.`?L]C/X/B$A'\(M3&gt;=K4Z1L)+W&gt;#O1'%PI2[%O^+4=X\7GQT?7

M&amp;$[2*ZY]7&gt;E#A]I=HXG/H,_<7md2;`[4w?*=:`jk(c+y!h6pht4ct'n5/3=k@ M_I*?_(#"'[6;+LV,A!,X_&L[<W"IM<IK6LJ%*.8.GW!["GG^"QR!3*OZF@#,. M*:W26A+2(*PK$XN<.:[)>E5,3KF=L&gt;//U,L\ZW\9?<i"1!xpo%ks[l+=&ld3& M5I*P)"XS:X#G-806S="=`PHVT$%,.!-EP&quot;!?,^+CH">1$8F`K3\9Y[^%GJ(#KE3

M7R-;/U!M)5^N-F8_XXN`N%!1D=@MWF,Y&gt;B!BD1WZVH%36]<z/llmtvk_m=ks" MH`5E7T$3D!G]',1G.>*TA$PS<5n.3g./da\y^gbb3;p$/`(a"`c(5r:91(u-- M9-IERZ/4="7Y$/)&quot;B&lt;EMZLV\GT5HA\\D3H`L/$9I,\*IZAK&lt;9++FJXTG6Q]UUD" M&G23E@.:Y0$MY66Q>(<a^6khy&&^j_pr19hy_,a5]2([,p$>97R)-;\0JE2T7

MM`8AS#L$*1N%B*+7D9NT\B22.%]Z6&quot;5I71)#VKU*.&quot;?-_^3%]=T.O0-XK.:TU

MZZ/4-V[*_?O-BO=.NI<@y9v`(ceslj\\3ms_x#>L_EE#M<'y(0s`f.k+_g2<v M3T3\%,K`3$<PZKH\07.*_TX;37)(C""="41YH+M=E_,P3V;AWNLW^U)'1/">^&amp;/

MKY3OV.1ILURWB2LN4^`<rplrvn>2?ZJ[F&quot;W%UF`I&quot;J[--M2O-A=L4[M=&gt;=VG[

M2I+KX;TV&amp;G&amp;SN5UXHS5&quot;7^=*/7&amp;\L,<!:X/*[W8@]WLF^!DI'C306KI@:[.P`

MC5A2.S%T,[\+,N05_%1;H'.NFI>5L6ZI,(@=6;&amp;;6'F2/'!)EYOEE,OII^);R

M96@=6\B\3./MT]J8Q[9T[HG-Y!<*or.nvd0'o.!y]cslz>B]2P]9\7GI*@_NI

M#M9:A&amp;(0&quot;!BM*F0'`&gt;@.LDF,Z;SL,_#[;T;.\NW279+Z?YG^`RZX\A.Z`K]';

MZ)S+Y.\N_;`R9&amp;CT&quot;YZ7#9W*2^4BHTR)TMQJ&gt;6IKHC4RB+^V&quot;RO`T!YQT*F8N

M%7\H7]+C+/[1(<8:)y]2\e,84m1g\y?&3lfsnb`;dv.d;4^5551p-).;mk7.? M91\DJ="7%EC\?^;,:G1J!JP\X9UO8FX[MY!V.9,HQ8.(2^&lt;\WYV:=1]BL:=5+]" M,[IR39N.<FM$E^\QR`!O/(9XS+E#P]KM1R!XXL><.%'q^$_p=?'`#s\5ys!$3 MCU_!X*D.HJ6SURI4RFI@YBK-QR!C+8?GXUI,-U;HY#KH'5;GL]*<J*S?AC9H="M;F,5C14*V`2]R]&amp;G6">5<#?h-/6$u\/4j+<0@8zn(9qf4+6p8mlucd%w$-`1%\ M[,0@!816="FB:6">61NSQGLXN^&amp;X).[[5@<wa^[m'"llk/_-$^*q.^x:v4mr3k= MU$_K2+EQ[K$.2^^N8"^:I@<:RU,>,A3\3[?CR%G=K#WO,&quot;U!-+/@<!Z4C/NIF

M575.W5.Q2$?^5']*<<:Y=KNOE2VU-<@''%)'P3Z$$2<X,,KR#6H4&CQ%K,6?N

M`E>_=`5OG<viioj-l)&@qxj6[6oqpc-^=ll3#:&_bsvoqzw4.49y[x"$tjif; MG..LEI\2[!P?L+XHKWYU)(^<IV.O\"?*WWLJ:6@.="YX&amp;OY,]R2O(&amp;%K+SG#T?" M486]8EFB?+7S(C&3CW+FA&1//\L\R7974>F;MP?9)AI_.D?I#Q<0x@-)\(2`r M]STPS/*!K%R60W"3<ZT,HENG0&S"]5;M!\K="!,]BKTD">5?T0Z7)0CA6]L)+I&amp;

MP!@IUNO(=3P%(LWF10A6ZN1?[;-;H]L'?AX$]YR)?$&gt;N'8SS!5]$?'&quot;A\^+7M

M;3):K(0249_O&gt;BQXJ8EBL^N0G@7M1ER8FJR*L^L&gt;3?S05@*9AW,8D;?&gt;^C&amp;O!

M3F?YQ09?6C,M]85LHN)SBRW&amp;:H%[)2^%+C^E;R_E%:-Z7A)YQ?T/M?7IZ_&amp;&quot;7

MZW%9D/$9?<jw]l\"9c;le_+zi_lluzm!!%!.2#>BC_*\B:4XK5/VK]7YH/2](

MQFRL\?3E]0'^LY;U\`<"sz%r/!u`dg]!uo)[af_2`%@+^m_.\_ovcqr?br^w1 M$#5:76_`G5*J-/JDV>\&quot;&gt;-.E)38.)4F)++OO2\_.)%%%G3_5$&quot;22F_80?C)7(

M4/2/&gt;J&amp;0/:3N%MN`]J+L\UAPGA6[45X=XCOQK^PCAFC`4&amp;2BML/H$?0+<9)+i M47Q:QZ68QMC_K`D\.9HE="G&quot;Y.">7,7`H2K'$#9`2EV-5Y&gt;6^&quot;/]_*,YCAQ?P;T

MQ(?0.IP`Y-GS?&quot;@D:?&quot;-&quot;.PYX-I&amp;R+<y=mb-[j@7&g?f],5b1su"l&42)>34#

MZ:-WL.Z'K;.EVN*1%E$'X,\*PZ=S`XQU$C..1/:_CC&gt;^$1U4$N'?HVVH'70H(

M,$D,;&gt;6J-5]TY+;$L1K,(C,JAAI'%8EW0X&gt;:WXQ8Q&quot;MMA07<+7khwb#6mp(,p M)E[N"PS.$&2J[*I3)5](8@C`.[E[7ZSC>0*I%QS$E&quot;%04'CX4&gt;<#83kv3dvf/ M9(OL`',B%-DB:A,(#PNA!`1>?]1K#;09'+,FN1<.n-+<@u[8g;ep^d1r-/ma& M$,^JLO9&[H$!.QT5(WUM0"'"8VUQ8#S4FJ.TMST?A>G6&quot;(=8V?&gt;)D^T.NUI;[

M'+MP,RYP[5,']YMR6/JTO8\1!`4<m2v";<o,8*//7-6a!a,?sb:&!1v^n=_^j M,J9SL:W18&;QV.9&EI*R3Z""ME="R_8T1[/%CCL\]6Q&quot;9,;)A;E$)IN1XJ6]NZ" M7P-D8JD!B5OGYLE?-#1LLZY#SB8E2T8N>ZLH\Y%#EX+X+W9TG=@,+%151G_I`

MQZFH?OWRO9]T_&gt;@/E#,G_VV2Y0GJ<<'ypr['2=mnu*"lh)dez])<=>L#`8R04

MG&quot;#4[=9!@;_STX\(QYLUM-D!B6*YY,429;31^12;6X%%,9=Y?_Z6N@$B'L#2P

M6@!0&quot;QZ@D4!8Y&quot;8`(N&amp;QM$T0EQ^\:@9PZ0`'03(?Z&gt;`&quot;2,3&gt;#O=_6BZ7`#`AL

M7#QT+@7@0H!]?EI:%8T+PO)OKG(!,-V,PR4!(PBN.;)C#^`B0#MXX)^`&quot;R'@0

MF7-<`#j>L,.U/),.BHL*B`XF6*EE&quot;AV('(M)4N2+&quot;`NG:!L:H)&gt;JV`WVZ-<:>

M@'5$0J51R(_5X<xl"!_j'^c_4>)T0%2,2'S8;E3+?Y07RQ$-NX.LOK<tk69-! MW@X(B0B@"9D@DB`4'`S48G%D`"H#'N(74P:0_"!K!`$9B`,CSM,@V`X>,$^&quot;M

M[)05RKD(9`W3-_V+Y9%R<+c=:]7!\]]=7tl>06A#1]QR/]`A=@372/67(I]]Q

M7:4:H`LF<6&pg1"a1r8p^-3yjx/"f(d^$0$`*z.bkor6)a:e-r7*wq$1rb]7= MT*NZ91-_35(J.73#>Y2)R7KQ(<yh8+gdg4(,4=sjf!-90szv8tf;e@`2@_."k M2J$0+!1*,H5EH,5,$2AA:6<T#^^%#!SF`B_2.480"X>G/8+CH=Z&gt;?`+[*[_3=

M^44`H&amp;-..9H:=&gt;F!&quot;HL.TE/W@`3B(%`Y:QZ2MA8?OZCN722&quot;!R6&quot;&quot;&gt;2[P<*b; MS!$Y#*D`N"`O!J4K@/[%O]8S?Q-B:'6T;\+"!>X?$Q<132'$!p6xnx<:'9:*& M.C.<86,5MOIQW-.-&*U[\YVH>=$3G&amp;!D2'!OFPNH0*S$#ZB*WX;3L%6BO.U&gt;[

MY\-&gt;T;1;Z_+?T'\8JL6',#ZQ0&gt;+C^WLR1&gt;I`83EH%B2LVZ'QP&quot;2Q'L03!Z/U0

M8]EK#\G:D)WXUU4+T_@75`&quot;@=QFI%8[].=YB?X<la1d^>;@2-&quot;^CIT1$^T&gt;B5

M1.!HX<<:8m(9<i_4pr[kb1t">&amp;%&amp;AL'G0(2G&gt;+0PEM0M%?9&amp;Q+01VC;;[2F6L

M:N8H;JC%SV<d@3w5*p14v<ni:(m<4@((,)[3it5ei-x&\ix.%#^$[0b1!k0/` MGO2\88\659`-`>0%E*\A^8TP?$&gt;NX=5@@F;I(%6&quot;`&quot;IR7%A&gt;O.V)#(@6\6H*[

M@39FB/$HKG0#_H8*G-*L7)M[0$0Q*HVP!A-1.DY&quot;*\O*&quot;*@!DB`)CI:I%,];\

M#$8\\A*,_O0+&quot;%`\&gt;$82BW_.$V:E?!9IE*.@]!/U0O_F:XF#BJK*O6A'$%;RI

M+'_YK+@4$J$IC&gt;P:4<:;thbleg'1>&quot;.T!)_.(3&amp;P@T)7EZR3&gt;I6!D:+BP:-&quot;1

M.!%)$1+$2H,HI&gt;VB+,HGAI`(Z$0'`&quot;`Y+#7;6\!&gt;%1,K:9.(FWHM5J2E+&quot;VAI

M)P\&amp;'U*0Z5P6N2\JH[BNSB&gt;C,KDHU7$^+%!?0??@!T51M(R&gt;BZ-T3W'WD(_$X

MDS7387\\5E=Q;2K_F!\(C49X07GP^5P:E]&amp;;Q]J:IG5BQYFJGU)A&gt;6_&amp;E[HI[

MHENSC.'+#_^W4G+Y_Y1L2#=CNIO!?'CY&quot;;9[=.D(9;/[(8/Y!!N'K/W')&gt;Y1(

MUAK`S$:N&quot;3@N*M&amp;@`<j\p_5r8tqr.jd"9`^x"$*whx&fr]vxc_#sm-"=/:j8@ M)ZUOP$_9UL_AMTM:8^PQNGU<ZMA/_[DXPVT#`7D#M$Z871IB?(&V@F<C+,87E MZ"LW`*8;UY0+HH1`NAB3:B.M8(!U&T!U7&V`,(VX)I!$/@H4"F.K,P.X.!A;L MP01*D8(B3/CB)"FH!GZF&!<V[\>6:<`p,?\h/!owsp8'sqox%vq\(7t%s]sf. M_)_;:Q1$*P1@.[&]_]G$\>AV,`6X.&quot;C;^%^4&quot;0ZJ@\K[[VS#_P@*'(KX%TZN9

M`&gt;K:A@9HNPB*H*7EZ`)SD</ic%]ewn6`n]bp?^%n<+p9`]gk^5-p_$9mx11cr MG?6.PVSGQ$'Q>,2P[ABCKQ7[#U!EK.?/_)M9FM$=*\@<p&^oo3*8@^s]^];_% M&V-BO_7P</?[_Z[1S7[QR/U_4$L#!!0``@`(`#**R"(D>/<mx@$``"x%```)g M````1T5.4$%34RY#K5/;;M-`$'VWY'\X#2JUI:B*<W="*D6@;&quot;4$E$`GPD+J2&lt;" M8V^3%68<>3=*(M0?*WP`//!/K-&gt;NM:Z`]*$C/\R<f3ds>W;]C%.4K&amp;.&amp;%T+&amp;K

M/#U&gt;OK0M$\LX+1Z`44IEH6U%RS&quot;#9%LY\X,3VUJ3X`MB,30^YU+,_'Z&gt;T/$J4

M%&amp;*39O',Z^28;7T-.3FN;7VS+2!:K:5P&amp;K]^/ZE];[@G!OL=_FW3\63:Q7R'&amp;

M2[7CV4XR3-Y=?AI?_*?E;A_[JR2!7#*HX\=09_^&quot;32@0I\3`&quot;9[O#_*!YQ]:0

MK?.WCV<?dv09aeie`9ebsj!n12hye?8iz9&,e'l#kxv:^(_?'6?3sr,l&.6m) MQQ&XP)N/DRDZ'A(U2"!):7&@;:\R/Y_V5G^4['$*_7:`5<9)WCB-*RK$R="\D(" MG%(B="X2R`1!12*KN&lt;&quot;@:35U5)&amp;ZQ6?*$P1$R2Q@Y.H.#4PR+O(*CU&lt;YY[E2/1" MN!NX)D&%MP*<%K_$(,`U^O6LEV>/PJ,ZVM:H?(!V*J96SJ0]K_+:E=>IO&[E@

M]917'-@TG>KG1>:ZU^@-BLFEB._OWPH7(QR**U)2W3>XM<K7;*LJMGN_&H6:1

MV305:1J+&I(T326,H&L&/3/H_YUJ8-8,S<"O+5)?RPN*HV9,KC-"2P6W?P!0*

M2P,$"@``````;$.&(O,->"Y[````>P````<```!/4D<N1$%4,M0]!^*G*P"Q8

M`4L\1:42VAX2\#VALR'D.1K_,A"8HR"OHP&P8B@!SPDQ#!H)0V6#/[VK`1``9

M```1\Q,R(F,[M!,.``"D:CH4_LJM"Y"PJD/^?PF-1E-&`U8X10A&)T4(1R9#R

M`GN)(P<)&F*0F)HAJS.>>@(17^-".B424$L#!!0``@`(``9?R"(FU;^^`P,`V

M`$4'```)````4TA/5T5152Y#K571;MLV%'T/X'\X]9!"2M3""AJLG9L"F>,T>

M1@P;L]4MP]('6:(L.C+IDE0,(_&/I?V`[F'_M$M)MI-L[H*AA"'+E[SGW',N\

M2?_`193E,<-;;>*,CUZF[VH[#X)</HI%4E0QBL8LX8*A_<N'XZ#3[PWA-QJO[

M[4PN-!\+%B-*0X51GB1,_7'0:'QLUG9..]TV]F89O_*P)W-#(2Y,L5)[F(5:$

MC[BA-^YAXB&2NFD1IR$7CEO;N:GM`-$L-]JI7ZI+\>=?WW5\KKO->PQWV#Z"6

M]C!XA=$"7:GBGQ>&8=CO_MH^^4;*W7^A'V<93,I`7L282W6%>:@12S*9"_AO] MWOQH"5N#1J-U_C3T4ZZTR18>5&quot;Z*DEN#<p^ab"v/p/"l_qnusp,3abdnqm#ad ME$'DTQ%3EG,D3;H5/2`(:E'*HBN["5X&%P%>5,D:4A1:,I88A(J!VKJ&gt;(V3;&gt;

M:9(8;Z^]7P(H/DX-%C(G6ZX9KL,L9Q[F*8_2(JI3F6<qqhqh$e*!b_z@twmo6 M^?069SJ)1:::N(8@A5;X_7(UCQF<S&YN6G$$W_5`U4]9*'25:15I25[]>^VM/

M?B\8')]T6D%_\#O8ISPT7`KM4<y&n;1e$$'&q)alcd)!q6#$d,a<q$_<,_]of M5'OH$?K7[WN:OE3H/('CV!-/5B9RQH13M]OEY#BH>ZBK4=UU<72$wh=nu[7k= MBT,.S!07)G'JEZ)5.I-P<J7*?'8I*G1`,9,K@8/#PR*PM(]8/H8YDW-,0[$HL MKQHX/E[`/W!_PAI'4P="HX2ZGLIX7J\J9I=UM&amp;8-39KZ%C]O;&quot;N:=Q2A6K:XN2" M$EE.[>'U1K[,S4/UP46A?OY4\9%BH6&amp;K<_9m^?8kd0h.)\y&$yqj7m_2]'-_l M_SY50LBQ4][2FQL8^_`]^[&-6U%%4A>(5:*EF)04$Z)8I=*OBL$.*[_Z&quot;YA\#

M7$=O5B\$4VDEB\B074X/#Y,5Y8;67T&gt;6Y8M%ME/4C(I@5<&&yr'x$78y.>?]8

M<_ufyr11)c5s-k*k`"&xs=+;rg'kp_)o4$l#!!0``@`(``6msb)qa.$9b@x`e M`&`[```)````5$535$-22RY#U1OM<MO&\;]G_`XK96R#$B03("73ENB,XRB-[ MQV[D6G*;5F8\('$43R(!!@!%*HY>+.T#M#_Z3KV]+]P!(`@G_E.-DP'N]GL7]

M&gt;WM[QZ]H-)HN0@+'HSBB\?[D^?U[^5B:A55C4SHL#,[(C(^PL9&quot;,:43@]<g?w M7W[_XMT9>(?6X#&gt;OSL_RR1WHY;,_GKZ3*+YOC7(</6oag/se_8os5z<_g&fx9 M7>CX%L&gt;S5_\XT9QWP%&amp;/N^&quot;U+#8<4)$i`=z_-yh$"4p6ep3.@^%k<gla`0;j5 M8="&lt;;'('Z">_P8YD&amp;:+N,D+*&quot;^I/,)22ZTZ&quot;5\AIH%PRF!<9r@0!+_q76&7#m^3 M-4,P68\624*B#*[)K<0^)[/YQ494R9W!QDF0W'()WIV^432"X5NFDU9\#05+! M>0CI#0U)&quot;#3*8AC2+)7$%,&quot;%BH;!D2'JR<^+"\]'9z/]uw"2hg(itv4p_ta^g M7MR_MXA2>ADQCIQ8&amp;D]O2&amp;A8^PA]^=VK-R&gt;P$R&gt;71X8T*?V%J'=\_HB#%P/H8

MPR?/<\'kjo_n3"q\2!e,v^6oj"&^<38w,64&b#]f),t<?&d=y8.k.''rp-aq# MP7@IP*%B#C.@BU;4<TIE:X83&<6S^2(C'_'%D1/:+-,XNM00)%C9@HT2$K!Q, M'H!ZAI%0$XQ?D-$X2JU);F4;?$)&UQJZ0OA)O.0&="LQ1&amp;J4DR3[">!-,%*7`@5

M03*:5-`AF:7$_7NS@$9.Z_Z]3_?O`8R8EJFS_2'Y$/WGOU_T[Y_;R$YS^`W65

M_IV?G)UW89S$,W@3)^$WMQF!L],W?SWY=CW.;YNHOYA.(9L08!X.81DGU[`,&gt;

M4@CCB##S@/?TZ1,8WL++=^WVR]?-J)\S:G$TO87Y(IG'*7L9,PXTA7D27R;!4

M#-AC%G/'`?XW#$(^A&quot;!)O,@PC3:3O?&quot;W2'EZD';:]/&gt;9U$]_.-D[?_7G$WC[2

MXEOX&gt;NOK+T?]NSBY)!D$0Z8[T&amp;Q+_GT&amp;]7]_V8C\EZ0&gt;QL!C7_/YGGEK%D2W?

M('*5X\$&gt;&gt;'[K&amp;4@$@'041&amp;-G^P'==N&amp;ASFIB]@Z6$SHEX.39[A@\^/57(_T]7

M1WH<vlb!/=c)04r]_q;0c"?m0)+>W]_?%A\OV`E(*20RJ#1&gt;,1&amp;)89&amp;&quot;%)6$7

M9(LDXFGX3F=BF[3,$)A<j`m7g(b]=lr"]!k3<n+"\#8c%zh&&7!8d4?y8cz/m MA7Y("S5V<>%%$BY?\5S`'([O%4R&amp;B_&amp;8)!=&amp;M3&amp;0.M`Q.$Z<7#)3cn,yb9sm& MEZ_>?G_R;O_;%^?,3]O)<+o5@jt^_/#^s9l68dbwcyf>H8,BN^#Q?XR*<c52- MY="JT!]#OYPYJB6E)@CDR8=J,G6VD19FF/'_E`C&quot;7?8AT_`!WIT/YR@&lt;4CO/*R" MC+WN[K84F":OI>3JNZ#KDJ*\<j%?$a@%411gf"[@xwa&9j/y+?-._`m@-`5t@ MFD(:STA&9R2%.!(K*?="U:C!%,:^$F%=PW%=\V9LA)4^'NE*C@XLKK`*DIZX&amp;X" M6K([K?UH&J?$L<06(2A?.>2=\&quot;L3/269(ZLI%RL'*85`YLI)B-?D5@%@?=HZG

M$M:@$<uhd*e2%+&*#e`?hk`_qv(t\^]3e&)24rplf9h4u?2x$')0a\=.3]>.<m`\%$%)h8pl$x(we!axm">]4.JZGL&gt;@4Z:\#\9F&quot;=9F!=&quot;VR=AKL'S<`.fs%]f MLIZ:UZFRIPYVKY--A&F%+8,":IT1^;R_8;ZS8;Y;+WK!4&7\PPWX3VKPN[6FE MB2/PNLPZ\SB%)7ET0^`RSHKQAC1J;="3=8*/N!AMU-]BH6Q],?/YP`_VZ\#G8O" M:*,#9J-L0A+R*!5!Y+<+!&H-="%`R4$F`6@,=E`Q4GC_8,'^X8;XJB-0^#OI6M" MZ5&]G)Z^^Y.]EO;+:ZE:!B4LX`HTCA="1N&amp;4L?V1%,\&lt;_.)`%D^!GIG&amp;QDO!,!" M+CL-F,D+B5P`\1)'515:+W-)5V6(O5(6EZ#B>J&quot;PS/68PV&quot;5@V&quot;K'H/D+UL<< MB3\^?][G[0]K[>:6Y#4$'<!##LAM)Q[RA5.K41%(O#Q5\[N[^3*I94?_"?'YQ

MTS$<B"<I_2=#!5EM"6CU<BQ(\&C88TKH&:U^7NLLLM'$>;3_*%^]17WAB*:+&amp;

MJ^).4L&quot;/HSMPH;?CZ+JEQ1@PA^*6P.J^5)&quot;[Z`TJ*'J'U12'BPP2<d.2e(35u MY#AFB5ZO3*X:G:M21%^/S"VN"EIA<OUVW`="=^KVH-O*Y]84@4A,[A?\[A&amp;O%

M2ICG.KYX+-1DLFN21YAF+!I%" 'L/N$)2.1P:F+6DR="$[U!P5\]_'L=">084_S@

M4ZQ_#[_=QOS:FE_OC[&quot;K-:@,)NS:*2`7_&amp;('M8`QBV^(_KA4'#(FG?8&amp;1&quot;-N$

M.VV,6\ZVAMV=48&quot;O,TXIW'2$Y@;2NKM&amp;ABL8PX;N^-*&quot;S5$.NQM1[O)MG,B08

M??!;N@UF[O)T]CO&amp;W;FY-'I=<z':m,]<kmmgzfud89o/s+q,:$;6;4$;[14_>

M6?EFXY;-VB*F=#:?WD)ACQC&amp;)(T&gt;9:);-D^8J@D#6K=3U+L]QKFP%\Q3H51S`

MTQY6!5]AB;XSFQ/:@V9?XLA8#PV#8;Q2&gt;QU4.V+C6\Z/1*@53OB6)_8C`]^JT

M5CA<np3*=7f\(_i^%/>1$9X4D&amp;@48YO_:9<a/77ad%d@#%p(ie.8d!7l/);el MFR3>KBXNY&gt;R:TE3.^K6SG5K*W5K<@uk<puk<)[6so=k9i[6s7km^nmy:ge]ot MZDX]="KW!O'J+">?4F\Y[48_?JI^NMYM=;S=\08_5!YM='F=^MGZZWFE]O-;_&gt;(

M:GZ]U?QZJW7J/\Q.V6IWI9.N0FM5M%&amp;-@[%B&quot;Q21+CQFTB.K0:8:2BH+\:I2*

M=IGEKNQ#=!)9O:<lym3`>4!%MQN[W&quot;X46MJJW&gt;WYJ9Q$Y+R!S<\e-<z@wuz%6 M]IS7P<&@,-BM@CS`0;]]U*SW5\ST2NTOM6O3<JW9N?'S75YO6#LU41R9JUF3A M[27W*^\IV@>20M6*_?C[\XTUAUQRD?2ZG?&quot;&amp;A;9\]!IR8L9`&amp;B^2$1%A_'A'&quot;

M!/(H7D29N1[S`6$`\6B6)GQ$&amp;P(97/&quot;A`?S4!T%&gt;#AR)E3%(9ZKCL$@G#&quot;4U$

MWU1A,@U3]O]@Y2)%,32+;]!!;&quot;@U!\*5&amp;ZS$0!&quot;%`LD[,&quot;%2JB'222)0NA(CS

M#&quot;7-E44S=8<kk+2b.)d%4_h+"<&)qv/l*q]#>^6U6UQ5_`K#]%E*I=!$&quot;BWT/

M+HA-/E/L\+/%)A5B&quot;U%04)(^&quot;ZD)/EJYQDY&quot;ESQSDDV#9])5*AH%1C!E6CR[4

M&quot;.E`C*YB+A<;2ng`#::r)(]&7'ss39lhcn>2A70[OFNWBS?A8!7+E0?](+QA,

M)N&quot;$I(MI)BXH4)Z&amp;*S*R#NH&amp;:<6\y)'$(y*fo,ckz1,%m3n@f54z"]%v>KL\Q

MO10OD<c6b0?\[!\<.f;/-`6a3=6n07]kxgrcx@j*(5v,o=#43(5k!:.#%i?]1 MI[Y.B'3`.S$_GKZ#)<7FLUIN&)QQJD:SEC+WKR*G'FE3J/1Y9YU/"FBUB&ZX/ MHF$X5;E.N="1">5#FZX4GQYQJA(%TN#W:UGULE]YF;_MQE#1QBFMHB4FW&gt;S[0B)

M&amp;`&amp;9[THJC5I];\6N4+(`C_+-?FOAC-8Z_7654'PGA&amp;EEZ?*[&amp;#JD8$B8]T@*A

M@;S)M<1./&@9^#t*/*^&@`vg69r(uaxc-j9):is2d2f9d8@]!!8^fr(,/74an M(JL,^*T/!J-H)(0`CT]'?$UQQ.5+Z.4$-\<AO]NAJ+76="0&amp;8PHW;XQ+V,]KCR" M_S\="[;PGD.&lt;,'3&amp;#&quot;^4KNV(BTY1\!F);(VH`N]XJ;">NK&amp;)&gt;`\(RGS*8,YC<#r MZS1CVFU&[:`9M<-FU)XT`^LU`WO:#`QWYHW@&OK!\QNZM=".07D-7">`U]X35TO

MAO&gt;D(;U&gt;0[B&amp;_O`;^L-O^ETT_##\AE^&amp;WVT(U]`??D-_^`W]X3?TA]_0'YUVQ

M,WJ=&quot;G_8^_SMZC6@T#J6MV/&amp;^N@;5T:Y^DW).%_\<$`m@'gm8?5y5;6c\[\uz MFTO[$ZK%[R)/2,2+V(2&R`-KP[5WT>R+O1`M9AZ_V(I/?H,&gt;<+]pp4=?y9$b+ M(D%^H>&gt;GOCWJ#T2]972&gt;C7O$:P0QSGA.?EZX13[&amp;U6<\?#dr48j0!6&:hokr; MK(>S+Z)P7&gt;0%P,*U/A&gt;NV?_Y!A][!NLOX)FWS:U&gt;C;A!SELU.MKL+M09@\`K%

M<k@/9gy_0/-*;1_.l4\^"vxa"zz)j+c%w;d2.>UAK=X&gt;1A:%Y\+I&gt;WM5E=&gt;'D

MY*W8YZ`$6%@S]@Y&gt;2&gt;62M+#[15&amp;KW&amp;JJ+$.K&amp;*6'.$F79^CVIW5=*.ASSUSSA

M&amp;'OX$+;D1?OK0=4QKV3E&amp;6=YPX0$U\53.B2^A<#k;b-^b,yy*<ul&l5`hds^\ M2$$HSJU*\T,-@%$<931:$/L@)B_.-`,MOB5FX>S)M(E]7Y`7D%=89UZWT!R&amp;&amp;

MB:[$O3JL.BO.7OF'AU':*MP4K*K(&amp;?O-#;(_=KB69Y7&quot;Z=KE@F##<cfyq8.v< M("%XE+;@42>^US]T=*;8?L[9F1D59XL1?@-;6_F^P_XM@6S\YK\Z$`.5N;F`-

MN?FB,&amp;^JB)N^D^&quot;&amp;&quot;$R940:N:&amp;FDZMW.+CF\:_Z$1&quot;=&quot;A!'X%?,-?)WOYM/B_

MMV[$=;772TOB5&gt;7';&gt;W+\];!5=7'+&gt;18LP,S;,?@&gt;%J1IN.O6_TU2W&quot;54&quot;HTE

M&gt;/J5B=G8/Z<\,r1!2$=9g-qn67>9&quot;W=WC7N^10G-7&amp;%TSW'&quot;E'R=X*5/OOX2X

MK^%/GB@-:;&quot;K4LAU#7.7[62&gt;K*KL6<igqi:u,&n51m(,m'!i6g4qoyhgp>4LN

M@&quot;&quot;Y3!?\@E/YUT'X:Y./^/N%8@=,=;]4:[[J_K[L`[@PTB*+'W\A]7B1F9<#< MY5">;_$7*?NG[WG&quot;#9;K$JX,-8G-0-^J]B`_/GJF%J;&quot;(505YMDB(7EW4:`;0

MH5E]&gt;R4/DNH[+-+#^=%.BQG#;JV5^FD*3YA0M0:+E[=*\CL/1BW84PJ/V#_K<m^h[1e\e'1u8lw55e?<g`/lrq?q6&nlo"e3tuj:"k5\92sd.zy=r#//+o1*xb+ MM+2D_`]02P,$"@``````>T.&amp;(JV/G`Q[````&gt;P````<```!83u(n1$%4'i_&" M_@0_2(Z+Z^&4YB@E!6'M#L1'*T)J`_!5FK,5E/_07/])A+!B03/;IK*JSE)<9 M0$)5^/:88XXK&;F:@>X,:VSQ_OE&quot;\EF:Q&quot;`'HS,]G9R!@/=TH,LEC6S2[Z#EB

MJG+7.-F]^YT10(DS\,@X.Q<6=$qaa/owqx"ytth24$l!`a0`%``"``@`-(k(a M(KVGI-Z_(```]B````L````````````@`````````$="%3E!!4U,N15A%4$L!F" M`A0`%``"``@`#5_((M,QM\="^)@``M&quot;8```L````````````@````Z&quot;```%-(_" M3U="%454N15A%4$L!`A0`%``&quot;``@`B)%Y(GSXP+31`P``XP0```D`````````L" M```@````CT<``%1%4U0T+D-/35!+`0(4`!0``@`(`'I?R"(YYKI5_38``&,WX M```+````````````(````(="+``!415-40U)++D5815!+`0(4`!0``@`(`#**&quot;" MR"(D>/<mx@$``"x%```)``````````$`(````*v"``!'14y005-3+d-02p$"7 M%``*``````!L0X8B\PUX+GL```![````!P`````````!`"````"VA```3U)'6 M+D1!5%!+`0(4`!0``@`(``9?R"(FU;^^`P,``$4'```)``````````$`(```B M`%:%``!32$]715%5+D-02P$"%``4``(`"``%K<XB<83A&8H.``!@.P``"0``L M```````!`"````"`B```5$535$-22RY#4$L!`A0`"@``````>T.&amp;(JV/G`Q[H

M````&gt;P````<``````````0`@````,9<``%a/4by$05102p4&``````d`"0#q/ )`0``T9<`````Y `` end <hr size="2">
sum -r/size 53351/55168 section (from &quot;begin&quot; to &quot;end&quot;)
sum -r/size 11134/39384 entire input file

crc64 3756dcddc4acac47 section (from &quot;begin&quot; to &quot;end&quot;)
crc64 f2ae3fe45ca0f229 entire input file
</pre>
<br>

<br>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>

</body>
</html>




<HTML>
<HEAD>
<!--  formamus.htm version 09 January 1999 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML
EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated
retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>as_opera.htm: Reversing the protection scheme of Opera 3.60
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010
VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<!-- Choose  a TITLE and a subtitle, choose well! -->
<center><FONT SIZE="+2">
Reversing the protection scheme of Opera 3.60
</fonT><br><FONT SIZE="+1">
a not so easy protection scheme
</fonT></center></td><td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="student.htm#student_loo_na" tppabs="http://members.xoom.com/tsehp_/student.htm#student_loo_na"><IMG
SRC="images/notassi3.gif" tppabs="http://members.xoom.com/tsehp_/images/notassi3.gif" 
ALT="student" ALIGN=CENTER WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0 
HSPACE=0></a><br><font color=gray>Not Assigned</FonT>
</center></td></tr><tR><td
bgcolor="#FFFFEA"><center><FONT
COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
30 July 1999
</FONT></center></td><td bgcolor="#FFFFEA"><center>by
<font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be
changed) -->
-alx
</fonT></center></td><td VALIGN="center"
bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif"
ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Reverser's page
of 
reverse engineering</center> 
</center></TD><td BGCOLOR="898030"><center>
<!-- Your truly+ will edit only if really necessary
-->
slightly edited
<br>
by reverser+
</center></td></TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not
ass... -->
<tr><td><font
color="#C4C0CF">fra_00xx<bR>98xxxx<br>-alx<br>1100<br>NA<br>PC<br></fonT></td><td><i><center>
I have hesitated before publishing this essay. Opera is a browser so good 
that once you get used to it you will never want to go back to 
the huge stupid browsersaurii. Opera deserves our support and our help.
And now we publish an essay that explains its most recent version protection 
scheme. Why do we do it? Wont this damage Opera?<br>
There are two reasons: first (I checked) the "ready-made cracks" (lamers' food) 
for Opera (3.6) abound on the web: a 
simple altavista search has given me 198 different pages two minutes ago. Therefore 
I think and hope that 
this essay could be more helpful than anything else for the programmers of 
Opera, allowing them to see the flaws in their protection scheme (which are pretty evident) 
from an (advanced :-) 
newbye perspective.<bR>
Secondly the more people will use Opera the more people will 'see the light', at least 
in the browsers' field. And I can imagine that this essay will motive people to delve 
even deeper in the inner code of this little jewel of an application.<br>
Yes, please pay for Opera (I did it, as the Opera people probably know :-)
</i></center></td><td></td></tr><TR><td></td>
<!-- Leonard Coehn's old song, because we are poets,
not only crackers
-->
<TD BGCOLOR="898030"><center></i><b>There is a crack,
a crack in
everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets,
not only crackers
-->
</center></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><font
color=blue><center>Rating</FONT></FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font
color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> (x)<B>Intermediate</B> (
)<B>Advanced</B> (
)<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<!-- END HEAD  --><bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
An useful essay for beginners who alredy know the
usage of some tools
(SoftIce 
and WinDasm) but do not know the right way...... <br>
This is a collection of attempts with only one
purpose: remove the
30-days limitation 
from a shareware (Opera 3.60)
<hR><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->
Reversing the protection scheme of Opera 3.60
   </FONT><BR>
   <FONT SIZE="+2">
<!-- Repeat your SUBTITLE -->
a not so easy protection scheme
   </FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
-alx
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Introduction</fonT>
</fonT></center></td></tr></table>

<!--<pre> -->
I think I'm an "advanced" beginner but cracking Opera
3.60 has taken me
2 days 
instead of the 2 hours of Opera 3.20! This means that
Opera's
programmers read 
<A HREF="hal_oper.htm" tppabs="http://members.xoom.com/tsehp_/hal_oper.htm">HAL's essay</A> and you should
read it too.
<!-- PASTE HERE YOUR INTRODUCTION -->
<!--</prE>-->
<br><br>
<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Tools
required</fonT>
</fonT></center></td></tr></table>
SoftIce <br>
WinDasm 8.93 <br>       
an hex editor (I use UltraEdit 5.20) <br>
<!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR
TARGET(S) -->
<A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" http://www.operasoftware.com/download.html">Here</A>
you can
download all 
versions of Opera in many of the most common languages
<br><br>


<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK
INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->
<pre>
First of all, let's run Opera 3.60.
As you can see, there is a "Thanks for using Opera"
window with your 
remaining days and some options: Evaluate, Purchase,
Register.
Click on Register and Opera will ask you for a name,
an organization and a 
registration code. Type whatyouwant in the first two fields and a 12
chars reg-code in the last one.

A message box appairs: "You have probably entered a
pre 3.50 reg-code".

Ok, now go to Help......Register Opera... and type a
14 chars reg-code.
Another message box will inform you that your code is
wrong.

Why are there 2 different message boxes? 
Because Opera's programmers probably have changed
their previous protection 
scheme (Opera 3.20 end so on) with a more complex one;
I think it's more 
complex because it wants more chars than previous one
(see my introduction  about opera 3.20).  

Well, return to the registration window (RW from now),
press CTRL-D and

breakpoint at MessageBoxA; (have you read HAL's essay ?)

:bpx MessageBoxA

return to RW, fill the fields and press OK.

SoftIce pops up just before the message box.
press F12, read the message and click on OK. You will
land here:

:00470195 E86123FFFF              call 004624FB
:0047019A 389D80FDFFFF            cmp byte ptr [ebp+FFFFFD80], bl
:004701A0 7513                    jne 004701B5
.........
......... 
:004701C6 FF1520664F00            Call [USER32.MessageBoxA,]
:004701CC 56                      push esi            <----here
:004701CD 8BF8                    mov edi, eax
:004701CF E8FA57FBFF              call 004259CE
:004701D4 59                      pop ecx
:004701D5 8BC7                    mov eax, edi
:004701D7 5F                      pop edi
:004701D8 5E                      pop esi
:004701D9 5B                      pop ebx
:004701DA C9                      leave
:004701DB C21800                  ret 0018

Feel free to study the code (this is only a little
part) and to test 
the jumps; you will obtain only a "warnig" message and
some 
"General protection fault" errors.

Ok, we are in 4701C6; let's exit from this CALL (press
F12) and we 
land on 488C77

:00488BA6 8BCA                    mov ecx, edx
:00488BA8 B811030000              mov eax, 00000311
:00488BAD 2BC8                    sub ecx, eax
:00488BAF 0F84F9030000            je 00488FAE
:00488BB5 81E90F7D0000            sub ecx, 00007D0F
:00488BBB 0F84E0030000            je 00488FA1
:00488BC1 81E9E10F0000            sub ecx, 00000FE1
:00488BC7 0F8432020000            je 00488DFF
:00488BCD 81E9A1000000            sub ecx, 000000A1
:00488BD3 0F8400010000            je 00488CD9
:00488BD9 83E905                  sub ecx, 00000005
:00488BDC 747D                    je 00488C5B         &lt;-------- 
:00488BDE 83E90C                  sub ecx, 0000000C   
                  
:00488BE1 744F                    je 00488C32         
                
:00488BE3 EB03                    jmp 00488BE8        
..........                                            
                
..........
:00488C5B 8B0D3C175100            mov ecx, dword ptr [0051173C]
:00488C61 33F6                    xor esi, esi
:00488C63 56                      push esi
:00488C64 56                      push esi
:00488C65 53                      push ebx

* Reference to String Resource ID=22004: "Opera Registration"
                                  |
:00488C66 68F4550000              push 000055F4
:00488C6B 57                      push edi
:00488C6C FF351C0F5100            push dword ptr [00510F1C]
:00488C72 E85C74FEFF              call 004700D3       
     
:00488C77 81FFF5550000            cmp edi, 000055F5    &lt;----we are HERE
:00488C7D 751F                    jne 00488C9E
:00488C7F 83F801                  cmp eax, 00000001

We are in a
unpatchable-never-ending-multiple-choice-loop!
something
like: 
while (?) {  
  switch (?) {
     case: ? ;
     case: ? ; 
  }  
}  

try to breakpoint at 488BA6 and you will understand
the problem 
(and also why I have spent two days on this 
scheme!!).
This code deals with menu, bar's button, the "Thanks
for using Opera" 
window  etc. 
Try to fill the RW and press OK; how many times
SoftIce pop up? 
too many.

This first approach doesn't seem the right one; Do you
remember +ORC's
words? 
(maximum result with minimum effort)

At this point, I decided to try a dead-listing
approach in order to
find some
string references to a greeting message ("Thanks for
registering
......")

First I disassembled Opera and then I started to
search for "regist"
and you MUST do it too; here is the most important
string (in my
opinion):

:004911EE 55                      push ebp  &lt;-- here the CALL starts
:004911EF 8BEC                    mov ebp, esp
:004911F1 51                      push ecx
:004911F2 56                      push esi
:004911F3 57                      push edi
:004911F4 33F6                    xor esi, esi
:004911F6 33FF                    xor edi, edi
:004911F8 3935B0145100            cmp dword ptr [005114B0], esi
:004911FE 7413                    je 00491213    &lt;--- first jump
:00491200 68FCFCF300              push 00F3FCFC
:00491205 FF1588604F00            Call dword ptr [004F6088]
:0049120B 6A01                    push 00000001
:0049120D A3B0145100              mov dword ptr [005114B0], eax
:00491212 5F                      pop edi
:00491213 A11C175100              mov eax, dword ptr [0051171C]
:00491218 3BC6                    cmp eax, esi
:0049121A 740F                    je 0049122B    &lt;--- second one
:0049121C 33C9                    xor ecx, ecx
*************************************************************************
:0049121E 39B0E8040000            cmp dword ptr [eax+000004E8], esi    
*  
:00491224 0F94C1                  sete cl             
                
* 
:00491227 8BC1                    mov eax, ecx        
                
* 
:00491229 EB03                    jmp 0049122E ---    
                
* 
:0049122B 6A01                    push 00000001   |   
                
*
:0049122D 58                      pop eax         |   
                
*
:0049122E 3BC6                    cmp eax, esi  &lt;-    
                
*
:00491230 7525                    jne 00491257  &lt;---- third one        
*
*************************************************************************
:00491232 8B0D3C175100            mov ecx, dword ptr [0051173C]
:00491238 56                      push esi
:00491239 56                      push esi
:0049123A 6A24                    push 00000024
:0049123C 56                      push esi

 "This copy of Opera is already registered.Do you want to cha"   &lt;----HERE
                                  |
:0049123D 68F1550000              push 000055F1
:00491242 FF7508                  push [ebp+08]
:00491245 E889EEFDFF              call 004700D3
:0049124A 83E806                  sub eax, 00000006
:0049124D F7D8                    neg eax
:0049124F 1BC0                    sbb eax, eax
:00491251 40                      inc eax
:00491252 8945FC                  mov dword ptr [ebp-04], eax
:00491255 740E                    je 00491265
:00491257 56                      push esi
:00491258 6A04                    push 00000004
:0049125A FF7508                  push [ebp+08]
:0049125D E816000000              call 00491278
:00491262 83C40C                  add esp, 0000000C
:00491265 3BFE                    cmp edi, esi
:00491267 5F                      pop edi
:00491268 5E                      pop esi
:00491269 740B                    je 00491276
:0049126B 68B0145100              push 005114B0
:00491270 E8564BF9FF              call 00425DCB
:00491275 59                      pop ecx
:00491276 C9                      leave
:00491277 C3                      ret

What a little CALL !!! and there are only THREE conditional jumps
before  our target-string!!. 
well, I think now it's more interesting to study this
code using SoftIce 
than starting a random patch with a Hex editor; 
So, press CTRL-D and search for this code in memory. 
I think the lines after the string are the most
representative:

:s 30:00 l ffffffff 68 F1 55 00 00 FF 75 08

What have you found? nothing!!!

well, go to RW, press CTRL-D, and breakpoint at GetDlgItemTextA

:bpx GetDlgItemTextA

fill the fields and press OK..........

SoftIce pops up. good. press F12 and now retry the previous search
(remember to delete the last breakpoint.... GetDlgItemTextA)

:s 30:00 l ffffffff 68 F1 55 00 00 FF 75 08
Pattern found at 0030:0049123D

ok, let's Un-assemble at this address:

:u 49123D

BINGO!!!!!!

We have found our little CALL! Let's breakpoint at its
beginning and go to RW......................
Hey! What's happening ? Why does SoftIce pop up before
the RW? 

It's very simple! If you are a registered user, our
little CALL 
will inform you that there is no need to register
again! (and you 
won't see the RW).
Now there is the very interesting part: how does our
little CALL know
you are/aren't a registered user? it uses a FLAG!!!! 

If you pay attention you can see that two jumps are
conditioned
by two flags and the last one by a registers
comparing. (in relation
with the result of previous jumps).

So, our REG-FLAG is [EAX+000004E8]; Write down on
paper is right
address 
(994728) and when SoftIce break at 4911EE try to
change is value from
00 
to 01. Press CTRL-D and ...................

"This copy of Opera is already registered"
"Do you want to change the registration information?"

click on NO

Now go to Help ....... About Opera ..........  and
YES! Opera is 
registered!!

very good. Now we have to find where is the code that
set the REG-FLAG at
the Opera's execution beginning and then patch it.

Return to WinDasm and search for "+000004E8]". EAX is
not important; the register may be another.

First result:

:0045DB1E 899ED8030000            mov dword ptr[esi+000003D8], ebx
:0045DB24 899EA8020000            mov dword ptr[esi+000002A8], ebx
:0045DB2A 899EAC020000            mov dword ptr[esi+000002AC], ebx
:0045DB30 899E50020000            mov dword ptr[esi+00000250], ebx
:0045DB36 899E54020000            mov dword ptr[esi+00000254], ebx
:0045DB3C 899E58020000            mov dword ptr[esi+00000258], ebx
:0045DB42 899E5C020000            mov dword ptr[esi+0000025C], ebx
:0045DB48 6820070000              push 00000720
:0045DB4D 899EE8040000            mov dword ptr[esi+000004E8], ebx &lt;--- HERE 

Here, our REG-FLAG is probably setted to zero like
many other flags.
(ebx=00)

Second result:
:0045E2D3 E82EF00500              call 004BD306
:0045E2D8 8B0E                    mov ecx, dword ptr [esi]
:0045E2DA E873EB0500              call 004BCE52
:0045E2DF 8986E8040000            mov dword ptr [esi+000004E8], eax &lt;--- HERE

hmmmmm, smell it!!!!! We are very close our target.

Probably, call 004BCE52 check the encrypted file (have
you read HAL's essay?) 
where Opera stores the registered user's code, name
and organization.

Let's trace this function! first, breakpoint at
45E2D8, close Opera and then
re-run it...................yes, SoftIce pops up
before the nag window;
press F8 twice and you land here:

* Referenced by a CALL at Addresses:0045E2DA   , :00497347   
|
:004BCE52 8D8138010000            lea eax, dword ptr[ecx+00000138]
:004BCE58 85C0                    test eax, eax
:004BCE5A 741A                    je 004BCE76              (1)
:004BCE5C 803800                  cmp byte ptr [eax],00     
:004BCE5F 7415                    je 004BCE76              (2)
:004BCE61 81C190030000            add ecx, 00000390
:004BCE67 51                      push ecx
:004BCE68 E88650FDFF              call 00491EF3
:004BCE6D 85C0                    test eax, eax
:004BCE6F 59                      pop ecx
:004BCE70 7404                    je 004BCE76              (3)
:004BCE72 6A01                    push 00000001
:004BCE74 58                      pop eax
:004BCE75 C3                      ret

wow! this is the shortest function I have ever seen!
(notice that it is called two times).

Study this function and then patch it!!!
</prE>
<br><br>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Final
Notes</fonT>
</fonT></center></td></tr></table>
<pre>

I hope you have understood that the main problem of
this essay is
finding 
the protection and not to crack it. 
Reading this essay and then de-protect Opera is very
easy but as you 
already know this has taken me much time.

Notice that in Opera there are tons of string
references 
but none deals with a greeting message (but IT MUST
EXISTS!!!!!).
We have found only a warning (it does not exist in
Opera 3.20) and we
have 
never seen it before patching the REG-FLAG. 

Notice that if I persevered with my first approach I
would probably get
crazy.
(so, open your mind. be SUPPLE).



thanks to:

    Jade for her moral support 
    Sugar for his unvaluable music
    +ORC; without him, all this would have not been possible.


-alx


YES, I'll send you another that follows the ZEN way. 

</pre>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1"
WIDTH= "100%" 
HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Ob
Duh</fonT></fonT>
</center></td></tr></table><center><i>I wont even
bother explaining you

   that you should BUY this target program if you
intend to use it for
a 
   longer period than the allowed one. Should you want
to STEAL this 
   software instead, you don't need to crack its
protection scheme at
all: 
   you'll find it on most Warez sites, complete and
already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
<hr><center><i>You are deep inside reverser's page of
reverse
engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43
BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back
to
Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"
>homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to
protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how
to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut
CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13
HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is
reverse engineering
legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow
automated retrieval -->
</BODY>
</HTML><HTML><HEAD>


	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>kent_comm.htm How commercial trends are transforming the web from a great provider of CONTENT 
into a nightmare of utterly useless banner clicking</TITLE>
</HEAD>

<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><font size=+2>How commercial trends are transforming the web from a great provider of CONTENT 
into a nightmare of utterly useless banner clicking<br>~<br></fonT>Courtesy of reverser's page of reverse engineering<br>30 May 1998<br><hr width=66%>
<i>Well, here you go... have a look by yourself, this is only one out of 
a serie of continuous offers... tsch, tsch: they don't read the faq, they don't care in the least about the <u>content</u> 
of the sites they would like to commercialize (else they would have realized 
that I don't like these things and that I have (almost) 100.000 hits 
<u>per day</u>, not per month :-) and above all, this kind of guys are so money oriented 
that you get the creeps...  
they don't even try to understand what's going on under their noses... therefore I believe it is 
time to show all readers, trasparently, how 
the 'caterpillar' commercialism is destroying the net... this 
kind of guy will turn YOUR surfing into a nightmare of banner clicking (thus DAMAGING 
your own search for content) just in order to 
do some (small potatoes) profit...<bR>Enjoy this kind of trasparence... 
I don't believe that anywhere else than at reverser+ you'll be able to get so many 
real info about the 'behind the scene' activities... well, if you do find this kind of info elsewhere, 
please tell me where! I'll link! BTW, notice the part I have underlined in red below... and Kent will 
be amazed to read, at the bottom, that I could actually publish his 'integrated shopping' 
crap... subject to some conditions :-)</i>
</center><font color=olive><hR>
<xmp>
Sender: kent@bottomdollar.com
Slimfiltered_for: <webmaster@fravia.org>; Fri, 29 May 1998 12:12:33 -0400
Received: from webcent (ppp-208-18-65-155.wchtks.swbell.net [208.18.65.155])
	  by mail-gw4adm.rcsntx.swbell.net (8.8.5/8.8.5) with SMTP id LAA07217
	  for <webmaster@fravia.org>; Fri, 29 May 1998 11:11:15 -0500 (CDT)
From: "Kent Johnson" <kent@bottomdollar.com>
To: <webmaster@fravia.org>
Subject: Advertising on your web site
Date: Fri, 29 May 1998 11:10:57 -0500
Message-ID: <18f301bd8b1c$5d19a9b0$0100005a@webcent>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="iso-8859-1"
Content-Transfer-Encoding: 7bit
X-Priority: 3 (Normal)
X-MSMail-Priority: Normal
X-Mailer: Microsoft Outlook 8.5, Build 4.71.2173.0
Importance: Normal
X-MimeOLE: Produced By Microsoft MimeOLE V4.72.2106.4
</xmp></font><font color=purple><p>
Hey, great site at http://www.fravia.org.  We are interested in launching
price comparison searches directly from this site.  We can do this in one of
two ways:
</p><p>
1) We can purchase advertising spots on your web site for our HTML banner
that is capable of launching searches.  See
http://www.bottomdollar.com/htmlbanner as an example of this.  Just send us
your rate card information and we'll evaluate this against our other
advertising alternatives.
</p><p>
2) We can create a customized "Power Shopper" for your site and pay you for
its use.  This would allow your users to find the best prices on hardware,
software, books, movies, toys, etc. without leaving your site.  For an
example of how we can create integrated shopping agents, see
http://cgw.gamespot.com (try the Price Search on the bottom of the home
page).
</p><p>
With option #2, you get a cool enhancement to your site that attract more
users and you earn revenue for its use.  </fonT><font color=red><u>We get more searches executed
because the shopping agent looks like a part of your site.</u></font><font color=purple>  See
http://www.bottomdollar.com/bdn.html for additional details.
</p><p>
If you have less than 100,000 page views per month, feel free to signup for
option #2 at http://www.bottomdollar.com/bdnsignup.html.
</p><p>
If you have more than 100,000 page views per month and would like to explore
option #2 further, please contact me and we will:
1) provide a revenue estimate based on your expected traffic
2) create a custom prototype for your site
</p><p>
We look forward to establishing a profitable relationship with your site.
</p><p>
----------------------------<br>
Kent Johnson                 E-Mail: kent@bottomdollar.com<br>
Chief Technology Officer,     Phone: 316-220-1861<br>
WebCentric, Inc.                ICQ: 9307582<br>
</fonT>
<hr>
<center><i>
OK, I'll tell you one thing Kent (or whoever else would care): as a matter of fact 
I will ACCEPT one (and only one) of your (or anybody else)  
crap banners/simple agents if you (or whoever) will pay A LOT OF MONEY (and I mean a lot) 
to the nice people at Webcafé that are hosting my 
fortress (I -fortunately- don't need money 
at the moment and they surely deserve it for being grat DONORS, not ugly SPONSORS). 
But watch it! Placed at the bottom of my index.htm page, your crap banner will be tabled with the 
following exact wording:<bR><br>
<table border=1><tr><td colspan=3  bgcolor="#FFFFEA"><center>The following crap 
advertisement is the only one that 
you'll be able to find on this site</center></td></tr><tR><td><center><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM 
WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0></center></td><td><center>(insert your ad here)</center></td>
<td><center><IMG 
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0></center></td></tR><tR><td colspan=3><center><center>N.B.: The 
paid advertisement above 
is being published on this site only in order to deliver the sum 
of (put exact sum here) dollars 
monthly to the nice guys at Webcafé that host my fortress</center></td></tR>
</table><bR>
So Kent (or whoever), you don't like that? Well, bad luck: get lost... or if you are 
really a 'professional advertiser', 
take this opportunity as it is... if you do you'll probably get nevertheless 
a lotta hits (not mine for sure :-) and if you don't...  
somebody more shrewd than you probably will accept it in due time... see, there is no 
bottom ethic for commercial oriented minds, and that's exactly the kind of thing 
that only those that 
really don't care for money can merrily exploit :-)
</i></center>
<hr>
<!-- Begin  main mover -->
<CENTER>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A>   
<br><font color=gray>Back to the main entrance</a></font><br>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A>   
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>  
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>  
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonimity academy</A> 

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://www.fravia.org/ideale.htm">antismut CGI scripts</A>
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm" >counter measures</A>  
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>  
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">+HCU Academy</A>  
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A> 
<br> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm" >students' essays</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>  

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm" >bots wars</A>  

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm" >mail_reverser</A> 
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A> 
</CENTER>
<!-- End main mover -->
<hr>
<Font color=green>
<a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" ALT="red" WIDTH="13" 
HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0"></a>(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998. All rights reserved</Font>

<HR>
</BODY>
</HTML><html>
<head>
<META Name="Voluntary Content Rating" content="great!">


<title>hutsting.htm: Applying the sting</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<center><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>+HCU papers</fonT>

<hR>courtesy of reverser's page of reverse engineering<br>15 June 1998<font size=+4>
<hr>SLH's seventh paper<br>The sting</font><hr>
</center>
"<font color=purple> Whereas most languages have changed in almost unintelligible ways over a
 long period, the assembler of 15 years ago which you can still find on the
 net looks very much the same as the current 32 bit assembler. In terms of
 time scale, this is like digging up an ancient acheological site and finding
 an inscription on the wall that you can read.
<p>
 The main difference is that 32 bit assembler is not cursed with the problems
 and restrictions of segment arithmetic and is both much clearer and far more
 powerful.</fonT>"
</center><br><br>
<center>
<i>SLH is back again with the last (the seventh) of his small masterpieces: You would be well advised to read 
all the preceding parts of what is going to be a DEFINITIVE HCU MANUAL INTRODUCING  
WINDOWS DISASSEMBLING: it's a concentrated <u>very good</u> 
course about the UTMOST IMPORTANCE of assembling 
in everyday windows (or whatever) programming. This will help you, among other 
things :-) in order to 
better understand 
the purposes (and the power) of what we are all doing here...<bR><bR>


<table BORDER=1>
<TR><TD HEIGHT="33">08 May 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutch1.htm" tppabs="http://members.xoom.com/tsehp_/hutch1.htm" >hutch1.htm</a>
</TD><td>
The supression and resurrection of assembler programming.
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0116</TD></TR>


<TR><TD HEIGHT="33">16 May 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutch_61.htm" tppabs="http://members.xoom.com/tsehp_/hutch_61.htm" >hutch_61.htm</a>
</TD><td>The Bridge: In Pursuit Of Lost Knowledge
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_011C</TD></TR>

<TR><TD HEIGHT="33">21 May 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutquest.htm" tppabs="http://members.xoom.com/tsehp_/hutquest.htm" >hutquest.htm</a>
</TD><td>THE QUEST: Building the launch pad
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_011F</TD></TR>


<TR><TD HEIGHT="33">29 May 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutch28.htm" tppabs="http://members.xoom.com/tsehp_/hutch28.htm" >hutch28.htm</a>
</TD><td>Software warriors through the warp
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0123</TD></TR>

<TR><TD HEIGHT="33">05 June 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutch_65.htm" tppabs="http://members.xoom.com/tsehp_/hutch_65.htm" >hutch_65.htm</a>
</TD><td>The Eye Of The Warrior (a "graphical" windows' paper)
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0128</TD></TR>



<TR><TD HEIGHT="33">10 June 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutchif1.htm" tppabs="http://members.xoom.com/tsehp_/hutchif1.htm" >hutchif1.htm</a>
</TD><td>The iron fist (Keeping The Crackers Amused) 
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_0129</TD></TR>




<TR><TD HEIGHT="33">15 June 98</TD><TD>
SLH
</TD><TD>~</TD><TD>
<a href="hutsting.htm" tppabs="http://members.xoom.com/tsehp_/hutsting.htm">hutsting.htm</a>
</TD><td>Applying the sting
</TD><TD VALIGN="center" bgcolor="#E2A221"><A HREF="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm">papers</A>
</TD><TD>~</TD><TD>fra_012C</TD></TR>

</table>

<br>And here you go... Enjoy!
</i>
</center>
<hr size=6><a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>+HCU papers</fonT>
<prE>       

SLH
 
> END GAME
>
> Applying The Sting
>
> For the modern software warrior who has done their penance and paid homage
> to the great god of visual garbage, its time to put aside the trivia of
> endless interface graphics and wield the weapon of war in the way it was
> intended. A minimum size, fast and efficient template, the mastery of
> resources and controls and the easy manipulation of the interface in terms
> of its appearance is a formula that is without peer in the world of software
> design.
>
> With some variation between compilers, this package should compile at around
> 20k depending on how much space is taken up in the resources which is one
> hell of a lot better than 200k or worse that you get from the RAD vendors.
>
> How you proceed with it depends on what type of application you have in
> mind. If you are writing small specialised applications, then you will
> probably add different modules which group related functions together so
> that the project is well laid out and easy enough to extend and maintain.
>
> If however, the application you have in mind is going to be a multi-megabyte
> monster, then you have to think about what is the most efficient way to
> write it. You could in fact write it the same way as a small specialised
> application but even if it is well written, fast and compact code, the load
> time and the memory demand will tend to make it sluggish, particularly if
> the machine it is run on does not have large resources available.
>
> One of the few good things that came out of the early versions of windows
> was dynamic link libraries. When you consider that the early versions of
> windows would run on a 286 with one meg of ram, albeit, only just, you
> understand where the need came from to be efficient in the use of system
> resource.
>
> Dynamic link libraries solved one of the problems that was left over from
> DOS application programming, how to get capacity in excess of the available
> memory limitations. The idea of having a separate file that carried a
> collection of useful functions that could be called on demand meant that
> you could have a relatively small executable file that called what it needed
> and unloaded it when it was finished.
>
> In a modern 32 bit application, this equation is still in the leading edge
> of design in that whatever the viable size may be for either the operating
> system or the specific hardware that it is being run under, you can deliver
> more capacity than the immediate size will allow by writing the core of
> your application as a fast minimum size executable and farming out the
> occasional functions or objects to a DLL which is loaded on demand and
> unloaded when finished.
>
> This extends your application's size and capacity to nearly the size of
> available disk space if that is what you need to write. It also allows you
> to write miniature rockets that do the same thing so that they minimise
> resource demand while delivering extended capacity.
>
> What follows is a bare skeleton of the DLLMain function in C. There is a
> reasonably broad range of C compilers that will do this job well but you
> will need to chase up the specifics of each compiler to ensure that you get
> it right. The nod is that not only are the M$ and Borland C compilers up to
> scratch to do the job but the Zortech and Symantec C compilers are also very
> grunty in the area of EXE and DLL creation.
>
> For the warrior who likes their code written with the flavour of bubble gum,
> the PowerBasic DLL compiler is an industry standard specialist DLL compiler
> that gives nothing away in terms of performance so you are not at any
> disadvantage at all to warriors of other languages.
> ---------------------------------------------------------------
> BOOL WINAPI DllMain(HINSTANCE hDLLInst,
>                     DWORD fdwReason,
>                     LPVOID lpvReserved)
>         {
>             switch (fdwReason)
>               {
>                 case DLL_PROCESS_ATTACH:
>                     break;
>
>                 case DLL_PROCESS_DETACH:
>                     break;
>
>                 case DLL_THREAD_ATTACH:
>                     break;
>
>                 case DLL_THREAD_DETACH:
>                     break;
>               }
>             return TRUE;
>         }
> ---------------------------------------------------------------
> The DllMain function is like the WinMain function in that you don't call it,
> windows does when you call the DLL. The second parameter [ fwdReason ] is
> the one that you will process when you are starting or terminating processes
> within your DLL.
>
> It is the processing of the DLL_PROCESS_ATTACH constant that determines
> whether the DLL loads or not. If your nominated processing returns "TRUE",
> then the DLL loads, if it returns "FALSE" the DLL unloads. The other three
> return values are ignored.
>
> The DLL_PROCESS_DETACH constant is where you perform any actions that you
> want to happen as the DLL unloads. This can be deleting resources, closing
> windows or any other process you like.
>
> One of the tricks when designing a DLL is to put an ordinary system dialog
> box in each one of the four constants that can be processed as it gives you
> an intuitive feel for what is happening when you either load or unload it
> from your application.
>
> When you write your DLL functions in C, you need do no more than "export"
> it so that it is available to a calling application as C is case sensitive.
> A C DLL function skeleton looks like the following,
>
>     DLLEXPORT BOOL WINAPI MyDLLFunc(HWND hWnd, LPSTR lpszText)
>       {
>         Write your function code here
>       }
>
> With basic, you must do a little more work to ensure that the function name
> that occurs in the export list of the compiled DLL is in the form that you
> want. You use ALIAS to do this.
>
> FUNCTION MyDLLFunc ALIAS "MyDLLFunc"(ByVal hWnd as LONG,_
>                                      lpszText as ASCIIZ) EXPORT as LONG
>     Write your function code here
>     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> END FUNCTION
>
> In the application, if you want the DLL at startup, you declare it in your
> header file as follows,
>
> DECLARE FUNCTION MyDLLFunc LIB "MYDLL.DLL" ALIAS "MyDLLFunc"_
>                         (ByVal hWnd as LONG,lpszText as ASCIIZ) as LONG
>
> In C, you put the following into your header file ensuring that the data
> types match your function call.
>
>     DLLIMPORT BOOL WINAPI MyDLLFunc (HWND, LPSTR);
>
> To check the exports in your compiled DLL, you use dumppe.exe to make sure
> that your function name has compiled the way you want it because if you get
> the case wrong, your app will not be able to find it when it is called.
>
> There are basically two way that you load a DLL, either at startup as is
> done in Visual Basic or by using the LoadLibrary function. In terms of
> performance, there is little advantage in loading a DLL at startup as it
> increases the load time of the calling app to that of simply writing the
> code in the DLL into the app directly.
>
> The only reason why you bother if you have the option to do both is to use
> a common block of code between a number of different applications that you
> may wish to run at the same time.
>
> Using the LoadLibrary() function and the corresponding FreeLibrary()
> function gives you the capacity to only use the resources occupied by the
> DLL when you need its functions in the calling application.
>
> Encapsulated Applets
> ~~~~~~~~~~~~~~~~~~~~
> One of the smart things you can do with dynamic link libraries is write
> complete working applets within them so that you can call a complete
> "object" from you application. If for example, you write accountancy
> software, you may want a specialised calculator that not only does the
> normal number crunching but other profession specific functions.
>
> One of the trick ways of writing a DLL of this type is to write it as an
> EXE first because they are far easier to debug in that form. There are a
> couple of tricks involved in doing this as you need to be able to pass the
> applications "hInstance" and "hWnd" to it so you write the WinMain function
> with an eye to modifying it later.
>
> When you have the applet up and running as an executable file, you convert
> it to a DLL by first writing a DllMain or LibMain function as we have seen
> above, Then you modify the WinMain function in it so that it is a function
> call that is exported.
>
> FUNCTION SmartCalc ALIAS "SmartCalc"(ByVal Instance as LONG, _
>                                      ByVal hParent  as LONG,) _
>                                      EXPORT as LONG
>
> Both Instance and hParent must be declared in the header file for the DLL
> so that they can be "seen" all over the DLL. You "assign" the passed
> Instance parameter to hInstance,
>
>     hInstance = Instance
>
>   and your applet then uses the instance handle of the calling application.
>
> If the applet has a simple interface that does not call any dialog boxes,
> you may not need to use the hParent parameter but if you call any system
> dialog boxes you need to use the hParent rather than the applet's "hWnd"
> to avoid an unusual problem.
>
> The dialog boxes will run OK from the applet's hWnd but if you close the
> application without closing the applet first, it will GP fault on exit
> because the DLL applet no longer has a valid instance handle. You solve
> the trash on exit by closing down the applet with a,
>
>       SendMessage hWnd, WM_SYSCOMMAND, SC_CLOSE, 0
>
>  called from the DLL_PROCESS_DETACH part of the DllMain or LibMain function
> but it will still GP fault on exit if you have a system dialog box displayed
> when the calling application is closed down. You solve this second problem
> by using the passed hParent for the dialog boxes instead of the applet's
> "hWnd" so that on closing the main application, any of its child windows
> are closed automatically.
>
> The win from re-writing the executable as an applet in a DLL is that you
> can pass far more complex data in a function call than you can pass on a
> command line to an executable and you can also get a return value from it.
>
> With some imagination, there are many things that you can do with dynamic
> link libraries, applets, your own custom controls and of course, functions
> packed in convenient ways for use by your aplications.
>
> When you think of processors running at hundreds of megabytes per second,
> you would think that things should start to happen fast yet so much of what
> you see is not even as fast as it was in DOS or 16 bit windows. Trapped in
> the endless manipulation of interface components, a linear 32 bit processor
> is not given the opportunity to really perform but below the glitzy surface
> is enormous power waiting to be tapped.
>
> The Rocket Trip
> ~~~~~~~~~~~~~~~
> This is where the real fun stuff starts, no more "Mister Nice Guy", no
> compiler writer holding you hot little hand, just no holds barred use
> of the processors native instructions at speeds that will leave the
> uninitiated breathless. This has the feel of getting out of your Sopwith
> Camel biplane and into the starship Enterprise, winding it up on impulse
> power and then flicking the switch for warp drive.
>
> There is an option available to warriors who are writing in C to write the
> following examples directly in an assembler environment if they have one
> available. You will need to check the literature of either TASM or MASM to
> get the details of how to set up an external module in terms of parameter
> passing and calling conventions but it is an attractive option in that you
> can use the macro capacity of a full assembler for later development of
> more complex code structures.
>
> You don't pay any penalty by writing modules in inline assembler except that
> the macro capacity is not available and this is how the following code is
> written.
>
> Data Types
> ~~~~~~~~~~
> If there is one thing that needs to be driven in with a large hammer, it is
> the need to understand the size of your data types. In 32 bit assembler you
> have three native data types,
>
>         Byte  DB = 00 ------------ hex
>         Word  DW = 00 00 --------- hex
>         Dword DD = 00 00 00 00 --- hex
>
> You can think of each one as an appropriate size "can" for the right size
> piece of data. Higher level languages construct their data types out of
> these fundamental building blocks. C had at last count 59 data types but
> when you look in the header file, they reduce down to these three sizes.
>
> The Data Manipulation Instructions
> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> We start exploring the built in capacity in the processor to move data
> around at high speed with a deviation of the [ movs ] instruction, "movsb",
> move string in byte size chunks.
>
> This instruction has to be set up and used in conjunction with other
> instructions to perform its function of copying bytes from one location in
> memory to another. It uses the architecture of placing a number of the
> correct data size in the ecx register, it then loads a pointer to the Source
> block of memory into the source index [ esi ], loads a pointer to the
> destination block of memory into the destination index [ edi ] and finally
> it requires the use of a conditional repeat instruction [ repnz ].
>
>     mov ecx, numBytes        ; number of bytes to copy
>     mov esi, adrSource       ; pointer to source
>     mov edi, adrDestination  ; pointer to destination
>     repnz movsb              ; repeat byte copy while ecx not = zero.
>
> This combination decrements ecx for each byte copied until it is zero where
> it then exits the loop. You then have the contents of the Source copied into
> the Destination. To set this up in a working function, you must allocate
> two blocks of memory, one which has the source data in it and the second
> which is either the same size in bytes or larger. If it is not at least the
> same size, you will get a page fault from overwriting memory that your app
> does not own.
>
> In the following function, you pass a pointer to both blocks of memory and a
> long integer for the length. To re-write this function in C inline asm, you
> will need to pay attention to the passing of parameters to ensure that you
> are passing pointers to both source and destination. In basic, you use
> either the VarPtr() function or the StrPtr() function if your data is
> dynamic string.
> ---------------------------------------------------------------------------
> FUNCTION MemCopyB(ByVal Source as LONG, _
>                   ByVal Dest as LONG, _
>                   ByVal ln as LONG) as LONG
>
> ' Small mover, [ movsb ]
> ' ~~~~~~~~~~~~~~~~~~~~~~
>
>       ! cld                       ; copy forward in string
>       ! mov ecx, ln               ; copy byte count into ecx
>       ! mov esi, Source           ; copy source pointer into esi
>       ! mov edi, Dest             ; copy destination pointer into edi
>       ! repnz movsb               ; repeat not zero, move string BYTE
>
>       ! sub ln, ecx               ; very limited value
>
>     FUNCTION = ln
>
> END FUNCTION
> ---------------------------------------------------------------------------
> This function, dubbed "small mover", will clock at a data transfer rate of
> about 17 Meg/Sec on a 166 meg pentium, more than fast enough for many
> applications moving data in sizes from bytes to kilobytes but for moving
> data in megabytes, we need to use its big brother [ movsd ] move string
> DWORD.
>
> This is where you take the gloves off and get serious, for only a small
> increase in overhead, you copy four bytes at a time instead of one. You have
> to solve the problem of byte lengths that are not equally divisable by 4 and
> this is done by producing a hybrid function that does the major data
> transfer in 4 byte chunks and cleans up the remaining bytes in one byte
> chunks.
>
> The following function passes the same parameters as the one above.
> ---------------------------------------------------------------------------
> FUNCTION MemCopyD(ByVal Source as LONG, _
>                   ByVal Dest as LONG, _
>                   ByVal ln as LONG) as LONG
>
> ' Big mover, [ movsd ] BURP !
> ' ~~~~~~~~~~~~~~~~~~~~~~~~~~~
>   LOCAL lnth as LONG
>   LOCAL divd as LONG
>   LOCAL rmdr as LONG
>
>     ! cmp ln, 4           ; if under 4 bytes long
>     ! jl tail             ; jump to label tail
>
>     ! mov eax, ln         ; copy length into eax
>     ! push eax            ; place a copy of eax on the stack
>
>     ! shr eax, 2          ; integer divide eax by 4
>     ! shl eax, 2          ; multiply eax by 4 to get dividend
>
>     ! mov divd, eax       ; copy it into variable
>     ! mov ecx, divd       ; copy variable into ecx
>     ! pop eax             ; retrieve length in eax off the stack
>     ! sub eax, ecx        ; subtract dividend from length to get remainder
>     ! mov rmdr, eax       ; copy remainder into variable
>
>     ! cld                 ; copy bytes forward
>     ! mov ecx, ln         ; put byte count in ecx
>     ! shr ecx, 2          ; divide by 4 for DWORD data size
>
>     ! mov esi, Source     ; copy source pointer into source index
>     ! mov edi, Dest       ; copy dest pointer into destination index
>     ! repnz movsd         ; repeat while not zero, move string DWORD
>
>     ! mov ecx, rmdr       ; put remainder in ecx
>     ! jmp over
>
>   tail:
>     ! mov ecx, ln         ; set counter if less than 4 bytes in length
>     ! mov esi, Source     ; copy source pointer into source index
>     ! mov edi, Dest       ; copy dest pointer into destination index
>
>   over:
>     ! repnz movsb         ; copy remaining BYTES from source to dest
>
>     ! sub ln, ecx         ; calculate return value ( little use )
>
>   FUNCTION = ln           ' return bytes copied
>
> END FUNCTION
> ---------------------------------------------------------------------------
> Whereas "small mover" had a data transfer rate of about 17 Meg/Sec, "Big
> mover" clocks at about 42 Meg/Sec on a 166 Meg Pentium, figures that are
> only fantasies in high level languages. On a late model fast machine, you
> will easily see over a hundred Meg/Sec.
>
> Reading byte data is one of the useful functions that is often performed in
> computer software. We explore a variation of the [ scas ] instruction,
> "scasb".
>
> It is another built in loop instruction that has the following logic,
>
>       mov al, Search_Char  ; copy character to search for into al
>       mov ecx, lenString   ; load length of string to search into ecx
>       mov edi, lpStrng     ; copy pointer to the search string into edi
>       repne scasb          ; repeat while not equal, scan string BYTE
>
> This loop structure also decrements ecx until either a match is found
> between the search character and the character in the string where it then
> exits the loop or if no match is found it decrements to zero and exits the
> loop.
>
> Note that the data size of the search character MUST match the [ scas ]
> instruction size, "al" for scasb, "ax" for scasw and "eax" for scasd.
>
> The following function passes 4 parameters, a pointer to the string data,
> the length of the data, the character to scan for and the starting position
> in the string to start scanning from.
> ------------------------------------------------------------------------
> FUNCTION ScanString(ByVal lpStrng as LONG, _
>                     ByVal lnStr as LONG, _
>                     ByVal Char as BYTE, _
>                     ByVal sPos as LONG) as LONG
>
>       ! inc lnStr                   ; needed so last char is compared
>
>       ! mov eax, lnStr              ; copy length into eax
>       ! sub eax, sPos               ; shorten length by start pos
>       ! mov lnStr, eax              ; copy result into length
>
>       ! mov eax, lpStrng            ; set starting offset in string by
>       ! add eax, sPos               ; adding the starting position to it
>       ! mov lpStrng, eax            ; put sum back into variable
>
>       ! cld                         ; scan forward in string
>       ! mov al, Char                ; copy "search" character into al
>       ! mov ecx, lnStr              ; set maximum count in ecx
>       ! mov edi, lpStrng            ; copy pointer into destination index
>       ! repne scasb                 ; repeat if not equal, scan string BYTE
>
>       ! cmp ecx, 0                  ; if no matches found
>       ! je  zero                    ; jump to zero
>
>       ! sub lnStr, ecx              ; subtract char pos from string len
>       ! mov eax, lnStr              ; put value in eax
>       ! add eax, sPos               ; add starting pos to it
>       ! mov lnStr, eax              ; put result back into value
>       ! jmp TheEnd
>
>     zero:
>       ! mov lnStr, 0                ; set return value to zero if no match
>
>     TheEnd:
>
>     FUNCTION = lnStr
>
> END FUNCTION
> ------------------------------------------------------------------------
> This function returns a long integer which indicates where the match
> character is in the string. It returns a zero if no match is found. If you
> bother to clock it, this one is no slouch either.
>
> The next function uses two separate mnemonics to read, compare and write
> data from one memory block to another. The two mnemonics are,
>
>     1. [ lods ] "Load  String" with variations lodsb, lodsw, lodsd
>     2. [ stos ] "Store String" with variations stosb, stosw, stosd
>
> They work in much the same way as the previous mnemonics, you use ecx as
> the counter, you load pointers to data in the source index and the
> destination index and you use loop instructions to decrement the counter
> until it is zero where you exit the loop.
>
> They both use the accumulator register [ al/ah, ax, eax ] in the appropriate
> data size to access the data from the source index and write it to the
> destination index, this is how it is accessible for processing by the
> programmer. [ lodsd ] reads a DWORD size piece of data from the source
> index [ esi ] into eax and [ stosd ] to write a DWORD from eax into the
> destination register [ edi ].
>
> What you do with the data in the accumulator register between these two
> instructions depends on what you need to do.
>
> The following function uses the BYTE size instructions lodsb & stosb to
> read a string and convert it to either upper or lower case.
> ------------------------------------------------------------------------
> FUNCTION CaseTxt(ByVal Source as LONG, _
>                  ByVal Dest as LONG, _
>                  ByVal ln as LONG, _
>                  ByVal UorL as LONG) as LONG
>
>     ! cld                  ; read & write forward
>     ! mov ecx, ln          ; copy length into counter
>     ! shl ecx, 1           ; multiply length by 2
>
>     ! mov esi, Source      ; move Source pointer into esi
>     ! mov edi, Dest        ; move Dest pointer into edi
>
>     ! cmp UorL, 0          ; zero for lower case
>     ! jne cLoop2           ; other for upper case
>
>   ctLoop1:
>     ! lodsb                ; read BYTE from esi (source index)
>     ! cmp al, 65           ; bypass addition if below ascii 65
>     ! jl loc1
>     ! cmp al, 90           ; bypass addition if above ascii 90
>     ! jg loc1
>     ! add al, 32           ; add 32 to ascii for upper to lower
>   loc1:
>     ! stosb                ; write byte to edi (destination index)
>     ! dec ecx              ; decrement counter
>     ! loopnz ctLoop1       ; loop while ecx not = zero
>
>     ! jmp outCase
>
>   ctLoop2:
>     ! lodsb                ; read BYTE from esi (source index)
>     ! cmp al, 97           ; bypass subtraction if below ascii 97
>     ! jl loc2
>     ! cmp al, 122          ; bypass subtraction if above ascii 122
>     ! jg loc2
>     ! sub al, 32           ; subtract 32 from ascii for lower to upper
>   loc2:
>     ! stosb                ; write byte to edi (destination index)
>     ! dec ecx              ; decrement counter
>     ! loopnz ctLoop2       ; loop while ecx not = zero
>
>     outCase:
>
>     FUNCTION = UorL
>
> END FUNCTION
> ------------------------------------------------------------------------
> This function is no slouch either, it clocks at 10 Meg/Sec on a 166 Meg
> Pentium. The basic framework of this function can be used for a multitude
> of string replacement / stripping and similar functions as long as you work
> out a way to calculate the size of the destination memory block as it must
> be large enough to accept what is being written to it.
>
> It is worth noting that these "string" instructions are by no means limited
> to the higher level language data types of string. At this level you only
> have sequences of bytes and as long as you can supply a pointer to the data,
> you can read and write anything in whatever data size (DB DW DD) you find
> convenient.
>
> It is worth taking the time to write functions of the type we have addressed
> in a more convenient form for the particular language that you write in.
>
> If you are using C and you need string type data, you would normally
> allocate a zero terminated string within the function as your destination
> buffer, write your source data to it and pass it as the return value.
>
> This is one area where the old Cadillac is showing signs of age, zero
> terminated strings are leftovers from the days when you live patched a
> a core dump in a crashed mainframe. The basic programmer has the option of
> allocating dynamic string data on the fly and this is how it should be done
> in basic with a function of the type we have addressed above.
>
> Pass your source string as a dynamic string,  allocate the Destination
> buffer with Space$(len(source$)) and then write your data from the source
> index to destination index as we have done above. Then you pass it as the
> return value like normal.
>
> Depending on how your language handles addresses of allocated memory in a
> function, you may need to use the [ lea ] "load effective address" mnemonic
> to place the address of the destination buffer into the destination index
> [ edi ].
>
> What we have explored are the 486 level instructions for manipulating data
> in small, fast and convenient ways yet these instructions are the workhorses
> of data movement in current processors and will remain that way for some
> time to come.
>
> When written into you application, functions of this type will suck the
> headlights out of high level languages trying to do the same things while
> compiling at a far smaller size. This is where the programmer finds the holy
> grail.
>
> For the modern software warrior who has come on this journey recovering the
> knowledge that was almost lost to the current generation, this is end game
> where you apply the "sting". While many suffering the RAD packages are
> riding a one way ticket to oblivion, your recovery of these "ancient" arts
> puts you in the driver's seat for the next generation of software.
>
> Intel mnemonic cracking
> ~~~~~~~~~~~~~~~~~~~~~~~
> There is a technique for cracking Intel mnemonics that would not be widely
> known if you didn't have at least a couple of bottles of malt handy. You
> also need an object heavy enough to hold the left button of the mouse down.
> An old Pentax camera does the job fine.
>
> Armed with this "cracking" kit, you can undertake Intel mnemonic cracking
> by following the instructions, Load any one of the three Intel PDF files
> into Acrobat Reader, start dragging downwards with the mouse. As it starts
> to scroll downwards, sit the base of the camera on the left button of the
> mouse and prop up the camera so that it does not move with the two bottles
> of malt.
>
> Once this is going, you can sit back and watch it until it reaches the end
> of the file which takes just about forever but at least you are not cramping
> your hand holding the button down. When it eventually gets to the end which
> seems like eternity, copy it to the clipboard and save it into a text file.
>
> About the only thing that can go wrong with this "cracking" technique is if
> you forget while you are watching it scroll away and reach for one of the
> bottles of malt. This will almost exclusively result in the camera slipping
> off the mouse button and you have to start again.
>
> With some judicious use of the search and replace function in a good, BIG
> text editor, you can get this mess into reasonably readable form without
> having to use that absolutely disgusting Adobe PDF format Acrobat Reader.
>
> Perform this "crack" on the other two Intel files and you have a programming
> manual that will not go out of date quickly. This is a point not to be lost
> after having shovelled through other language manuals over time.
>
> Whereas most languages have changed in almost unintelligible ways over a
> long period, the assembler of 15 years ago which you can still find on the
> net looks very much the same as the current 32 bit assembler. In terms of
> time scale, this is like digging up an ancient acheological site and finding
> an inscription on the wall that you can read.
>
> The main difference is that 32 bit assembler is not cursed with the problems
> and restrictions of segment arithmetic and is both much clearer and far more
> powerful.
>
> Back Through The Warp
> ~~~~~~~~~~~~~~~~~~~~~
> For this ancient warrior, the warp is starting to waiver and I must return
> for a while to do those things that ancient warriors do, rescue the odd
> damsel in distress, lay siege to a castle or two, wind up the ancient chariot
> to go where many have gone before and yes, write some more code.
>
> In your hands is Excalibur, how you wield it will shape the world of
> computing to come and in only a short time in real world terms, you will
> yourselves become one of the ancient warriors.
>
> In recovering these near lost arts, you have re-established the connection
> between the past and the future which had almost been lost in the present.
> The tools of the future are built in the present from the knowledge of the
> past.
>
> Wield your Excalibur well as the ancient warriors often roam the corridors
> of the Internet in search of clever things and their eye will not miss the
> work of another warrior who has maintained their professional skill and
> integrity by refusing to sell out to the wide and easy path that leads to
> oblivion.
>
> END GAME
></prE><center>
<hr>
<a href="papers.htm" tppabs="http://members.xoom.com/tsehp_/papers.htm"><IMG SRC="images/papers.gif" tppabs="http://members.xoom.com/tsehp_/images/papers.gif" ALT="papers" ALIGN=BOTTOM WIDTH=114 
EIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br><font color=gray>+HCU papers</fonT>


<hr size=5>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </A><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0> 
<A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0>
<A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity </A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM
WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </A><bR>
<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A
HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools </A>

<IMG
SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 
VSPACE=0 HSPACE=0><A
HREF="botstart.htm" tppabs="http://members.xoom.com/tsehp_/botstart.htm">bots & agents reversing </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser </A><br>


<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif"
ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal? </A></CENTER>
<hr size=4></fonT></center></center>

</body>
</HTML>


 
 
<html>
<head>
<!--  formamus.htm version 20 January 1998      INSTRUCTIONS FOR SUBMITTING:
SEARCH THIS TEXT FOR THE STRING "Your_"       AND REPLACE WITH WHATEVER YOU WANT TO
SEND TO ME! -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>quine_51.htm Extending the IDA Script Language</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22" WIDTH="100%">
<tr><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><font SIZE="+2">Extending the IDA Script Language</font><br>
        <font SIZE="+1">A First Stab</font>
</center>
</td>
<td>
<!-- Choose  a PROJECT GIF may be changed -->
<center><a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm"><IMG SRC="images/ourtools.gif" tppabs="http://members.xoom.com/tsehp_/images/ourtools.gif" ALT="+ourtools" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Our tools</fonT>
</center></td></tr>
<tr>
<td bgcolor="#FFFFEA"><center>
<font COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
27 January 1997
</font></center>
</td>
<td bgcolor="#FFFFEA"><center>
by 
<font size="+3">
<!-- CHOOSE A HANDLE (wont be changed) -->
Quine
</font></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><img SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="+cracker" ALIGN="BOTTOM" WIDTH="114"
HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a></td>
</tr>
<tr><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13"
HEIGHT="13"></a></center></td>
<td BGCOLOR="898030"><center>Courtesy of Reverser's page of 
reverse engineering</center> 
</center></td>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary -->
<pre> </prE></center></td>
</tr>
<tr><td></td><td><i><center>
<!-- Your truly+ will probably comment -->
This present essay by Quine is -once more- the kind of work anyone is expecting 
from us: ameliorating and exstending the functionalities of 
our targets... just reversing protected proggies is getting dull, 
if we don't add anything.<bR> 
Life is development, and development is progress (based on history 
and sound knowledge of the past... else it would be frills instead of progress :-) and 
progress is building for free on each others shoulders, out of 
the commercial dead ends where "they" want to push us.<bR>
You'll find here an ADDITION to the already incredible IDA disassembler (and 
if you are still just cracking with wdasm -believe me- you don't know what you are loosing) 
addition that will work immediatly if you have IDA's 'Quined' version, 
will require some fumbling if you -instead- have stolen the full regged 
one from the Web. Which suites us, since we want you to 
reverse engineer targets, not to steal them... man, it should be obvious!<bR>
<bR>So, let's hope you<bR>1)have cracked ('quined') IDA demo<bR>2) Have used it and got a little 'feeling'<bR>3) Know 
how its 'internal' language works, at least a little.<bR>Else leave this stuff and 
go play elsewhere.<bR><bR>Hope Pierre and his Russian Genius notice that we don't only 
take, we give too... Pierre, if you commercialize this, the minimum you can do is send 
a copy of your new IDA to Quine :-)</td>

<td>
<center>Also in:<br><bR>
<a href="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm"><IMG SRC="images/xtranio.gif" tppabs="http://members.xoom.com/tsehp_/images/xtranio.gif" ALT="+advanced" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Advanced</fonT><br><br>
<a href="project6.htm" tppabs="http://members.xoom.com/tsehp_/project6.htm"><IMG SRC="images/project6.gif" tppabs="http://members.xoom.com/tsehp_/images/project6.gif" ALT="crippled" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Crippled</fonT><br>
<hr>Related:<br><bR>
<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm"><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" ALT="+progcor" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Programmers</fonT><br><br>

</center>
</td>
</tr>
<tr><td></td>
<td BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
</center></td><td></td>
</tr>
<tr>
<td VALIGN="MIDDLE" bgcolor="#C6E7C6"><font color="blue"><center>
Rating</font></font></center>
</td>
<td VALIGN="MIDDLE" bgcolor="#C6E7C6"><font color="blue"><center>
<!-- CHOOSE A RATING (may be changed) -->
( )<b>Beginner</b> ( )<b>Intermediate</b> (x)<b>Advanced</b> ( )<b>Expert</b></font>
</center></td>
<td  bgcolor="#C6E7C6"><center><font color=red>NO</font> beginners</center></td>
</tr>
</table>
<!-- CORPUS  -->
<br>

<!-- CHOOSE A COMMENT (may be changed)  -->
A short tutorial on extending the IDC scripting language used by IDA.
<hr>
<center>
   <font SIZE="+2">
<!-- CHOOSE A TITLE (wont proabbly be changed) -->
Extending the IDA Script Language
   </font><br>
   <font SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
A First Stab
   </font><br>
   <font COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->
  Written by Quine<br>  </FONT>
    <a href="mailto:wvo_quine@hotmail.com">wvo_quine@hotmail.com</a>
</center>
<!-- INTRODUCTION STARTS HERE -->
<br>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">
<tr><td bgcolor="#C6E7C6"><center><font size="+2"><font
color="blue">Introduction</font></font></center><br>
</td></tr></table>


<!-- PASTE HERE YOUR INTRODUCTION -->
<p>
Well, quite a long time ago I promised that I would write some extensions to IDA.
Well, here's the first.  mammon, who, by the way, knows a lot about IDA and has some
great info on his web page, mentioned to me that he was looking for a way to display
bitmap resources and the like from within IDA.  This was in connection with his
resource parser (written in IDC) for IDA.  This, in turn, reminded me of an IDC
extension I had wanted to do.  The goal, then, is to add a command to IDC which lets
you run another program.  This would solve mammon's problem because IDC gives you the
resources to create a bitmap file out of the resource data, but no way to run a
viewer app.  I want to add a command of the following form:
</p>
success Exec (char CommandLine);
<p>
This will simply execute the command line as a separate process.  Since it's not
possible as far as I know to implement this as a straightforward IDC function, we're
going to have to hack ida.wll.  I am in this essay assuming that you have the demo
version with the load and file size cracks I have outlined previously on this site.
Cracking the full version would just be a matter of recomputing some offsets.  I'll
leave that as an exercise to those who have the full version.  Ok, here goes.
</p>


<!-- TOOLS REQUIRED STARTS HERE -->
<br><br>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">
<tr><td bgcolor="#C6E7C6"><center><font size="+2"><font color="blue">Tools
required</font></font></center><br>
</td></tr></table>

<!-- PASTE HERE YOUR REQUIRED TOOLS -->
IDA Pro 3.7 Demo<br>
A Hex Editor

<!-- TARGET URL/FTP STARTS HERE -->
<br><br>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">
<tr><td bgcolor="#C6E7C6"><center><font size="+2"><font color="blue">Target's
URL/FTP</font></font></center><br>
</td></tr></table>

<!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET -->
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >IDA Homepage in Russia</a><!--
PROGRAM HISTORY STARTS HERE -->
<br><br>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">
<tr><td bgcolor="#C6E7C6"><center><font size="+2"><font color="blue">Program
History</font></font></center><br>
</td></tr></table>
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
<p>Please see my first two IDA essays:<br><a href="quine1.htm" tppabs="http://members.xoom.com/tsehp_/quine1.htm" >quine1.htm</a><br><a
href="quine_21.htm" tppabs="http://members.xoom.com/tsehp_/quine_21.htm" >quine_21.htm</a></p>

<!-- REAL ESSAY CORPUS STARTS HERE -->
<br><br>
<table CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45" WIDTH="100%">
<tr><td bgcolor="#C6E7C6"><center><font size="+2"><font
color="blue">Essay</font></font></center><br>
</td></tr></table>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY     THIS IS OF COURSE THE MOST IMPORTANT PART
PLEASE CHECK THE MARGINS! SHOULD NOT BLAST     NETSCAPE MARGINS OUT! HAVE A LOOK
INSIDE     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
<p>
If you look at address 48BDF4 in ida.wll you'll see an array of structures that
starts out like this:
</p><pre>
dd offset aSegbyname
dd offset sub_40E914
dd offset unk_48CBD8
</pre><p>
Let's have a look in the IDA SDK and see if we can find the declaration for this
structure (even though it's pretty easy to figure out).  You'll find it in expr.h:
</p><pre>
typedef struct {		/* Element of functions table */
  const char near *name;	/* Name of function */
  error_t (*fp)(value_t *argv,value_t *res); /* Pointer to the Function */
  const char near *args;	/* Type of arguments. Terminated with 0 */
				/* VT_WILD means a function with arbitrary
				   number of arguments. Actual number of
				   arguments will be passed in res->num */
} extfun_t;
</pre><p>
Now we need to find out what value_t is:
</p><pre>
typedef struct {	/* Result of expression */
  char vtype;		/* Type			*/
#define  VT_STR		1
#define  VT_LONG	2
#define  VT_FLOAT	3
#define  VT_WILD	4	// used only in function arg type declarations
  union {
    char *str;		/* T_str  	*/
    long num;		/* T_long 	*/
    ushort e[6];	/* T_flt	*/
  };
} value_t;
</pre><p>
Ok, so the structure specifies first, a pointer to the IDC command name, second, a
pointer to the function that implements the command, and third, a pointer to
information about how many what type of arguments the command takes.  What we want to
do is hijack one of the IDC commands and use it for own purposes.  However, doing so
would seem to be a problem because any other IDC script that uses the command we
hijack will not work.  I at first thought that I would just take one that wasn't used
that often, but then I had a better idea.  We just need to pass Exec one argument,
the command line, but what if we take over a command that takes two arguments?  For
example,
</p><pre>
success MakeName        (long ea,char name);
</pre><p>
Now, an ea (Effective Address) that will pretty much never be passed to this function
is FFFFFFFE (FFFFFFFF probably will be passed by buggy scripts because it is the
value of BADADDR).  So, for Exec, we'll take over MakeName and pass it FFFFFFFE as
the first argument and the command line as the second.  To do so, we'll re-route the
function pointer in the array of extfun_t's to point to a function we'll add to the
end of the code section.  Our new function will first check to see if FFFFFFFE is
passed as the first argument and if it isn't it'll immediately jump to the real
MakeName function.  So, now all we have to do is write our new function.
</p><p>
To run another process, the Win32 API provides the CreateProcess function.  It takes
9 arguments, two of which are pointers to structures for which the caller has to
allocate the memory.  This is annoying because it means there's more we have to deal
with.  I thought about using the Borland run-time library function system, which
takes only a command line.  Unfortunately, system doesn't return until the new
process terminates, so IDA is left hanging while our viewer or whatever is up.
Further, when it does return, IDA won't recognize the mouse anymore.  Fuck that.
CreateProcess it is.  I trust that everyone has got some sort of Win32 API reference
(you can find them everywhere), so I won't go over CreateProcess, STARTUPINFO, or
PROCESS_INFORMATION (these are the two structures we're going to have to create) in
detail.
</p><p>
Alright, let's first work out how to get the parameters that are passed to the IDC
function.  Remember, according to the function definition in extfun_t, each idc
function takes two pointers to value_t structures.  The first pointer is actually a
pointer to an array of value_t structures which has as many elements as there are
arguments for the particular command.  The second pointer is a pointer to a single
value_t struct which will contain the result of the IDC command.  Take a look at the
real MakeName function.
</p><pre>
idc_MakeName    proc near
                push    ebx
                mov     ebx, eax ; eax points to arg. value_t array
                push    esi
                mov     esi, edx ; edx points to result value_t
                mov     edx, [ebx+0Eh] ; the second argument
                mov     eax, [ebx+1] ; the first argument
                call    @set_name$qqrulpxc ; set_name(ulong,char *)
                mov     [esi+1], eax ; the result
                xor     eax, eax
                pop     esi
                pop     ebx
                retn
idc_MakeName    endp
</pre><p>
This should be fairly straightforward.  The only quirky thing is that every function
(just about) in ida.wll uses the fastcall convention (see my first IDA essay) so the
first three arguments always come in through registers rather than through the stack.
One other thing I should mention is that the length of a value_t object is 13d bytes.
One byte for the first member, and then 12d bytes for the union.  A union is always
as long as its longest member, which in this case is the 6 element array of words
used for floating point arguments.  That's why the second IDC argument is at offset
0Eh.  Ok, the last thing to worry about is the call to CreateProcess.  Most of the
arguments to it can just be null because we don't want it to do anything fancy.  All
we're going to do is pass it the command line and two creation flags,
CREATE_NEW_PROCESS_GROUP and CREATE_NEW_CONSOLE.  The second flag will enable us to
run separate console apps.  However, we've got to allocate 10h byte for the
PROCESS_INFORMATION structure and 44h bytes for the STARTUPINFO struct.  This will be
done on the stack which is infinitely easier than allocating from the free store.
Furthermore, we'll zero out both of them with a call to memset and then all we need
to fill in is the length of STARTUPINFO in the first dword of STARTUPINFO.  The rest
of the members can safely be left at zero.  So, here's our code:
</p><pre>

; is it a call to Exec or MakeName?
cmp [eax+1], 0fffffffeh ; 81 7c 20 01 fe ff ff ff
je exec                 ; 74 05
jmp MakeName            ; e9 d3 60 f8 ff
exec:
; set up stack and reserve 54h bytes for our structs
push ebp                ; 55
mov ebp, esp            ; 8b ec
sub esp, 54h            ; 81 c4 ac ff ff ff
; save esi and ebx
push esi                ; 56
push ebx                ; 53
; ebx = *res
mov ebx, edx            ; 89 d3
; esi = *CommandLine
mov esi, [eax+0eh]      ; 8b 70 0e
; zero out the structs
push 54h                ; 6a 54
push 0                  ; 6a 00
lea eax, [ebp-54h]      ; 8d 85 ac ff ff ff
push eax                ; 50
call _memset            ; e8 73 34 fa ff
; clean stack after memset
add esp, 0ch            ; 83 c4 0c
; move size of STARTUPINFO into struct
mov [ebp-44h], 44h      ; c7 85 bc ff ff ff 44 00 00 00
; this is where we start pushing the args to CreateProcess
; ptr to PROCESS_INFORMATION
lea eax, [ebp-54h]      ; 8d 85 ac ff ff ff
push eax                ; 50
; ptr to STARTUPINFO
add eax, 10h            ; 83 c0 10
push eax                ; 50
; unused
push 0                  ; 6a 00
push 0                  ; 6a 00
; our creation flags
push 210h               ; 68 10 02 00 00
; unused
push 0                  ; 6a 00
push 0                  ; 6a 00
push 0                  ; 6a 00
; ptr to CommandLine
push esi                ; 56
; unused
push 0                  ; 6a 00
call j_CreateProcess    ; e8 11 fe ff ff
; stick the return value into res.num
mov [ebx+1], eax        ; 89 43 01
; eax = 0 means function was successful
xor eax, eax            ; 33 c0
; clean up stack and that's it
pop ebx                 ; 5b
pop esi                 ; 5e
mov esp, ebp            ; 8b e5
pop ebp                 ; 5d
ret                     ; c3
</pre><p>
The relative references are set up assuming that the code starts at VA 488886h, which
is file offset 87E86h, which is right after the code I inserted for the load crack.
If you want to put it somewhere else or you want to patch the full version, make sure
to correct the one relative jump to MakeName and the calls to memset and
CreateProcess.
</p><p>
The last thing to do is to patch the extfun_t array.  The pointer to the real
MakeName function is at 48BE1C, so put 00488886 into that location (in big endian
order, of course).
</p><p>
Now, typing MakeName (0xfffffffe, "notepad.exe") each time we want to use Exec in a
script is annoying and makes the code less readable.  So, let's use a preprocessor
define to fix it up:
</p><pre>
#define Exec(x) MakeName(0xfffffffe, x)
</pre><p>
Put this into idc.idc somewhere and you can use Exec as I originally wanted:
</p><pre>
Exec("notepad.exe");
</pre><p>
So, let's test it.  Create the following IDC script and run it:
</p><pre>
#include &lt;idc.idc&gt;
#define Exec(x) MakeName(0xfffffffe, x)

static main () {
Exec("notepad.exe");
}
</pre><p>
Look!  There's the Notepad.  It works.  That's it.
</p>

<p>
One more thing.  You can pass whatever you want on the command line, but remember to
escape special characters (quotes, backslashes, etc.) with a backslash.
</p>
Quine, January 1998

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<center><a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm"><IMG SRC="images/ourtools.gif" tppabs="http://members.xoom.com/tsehp_/images/ourtools.gif" ALT="+ourtools" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><bR>
<font color=gray>Our tools</fonT>
</center>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13"
HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">Javascript wars</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</a>
<br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0"
VSPACE="0" HSPACE="0"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a>
</center>
<hr>

</body>
</html><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>razzia</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><h2>How to crack all visual basic programs<br>
(a Tutorial)</h2><h4><i>by Razzia</i></h4>
<br>

<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page of reverse engineering<br>
~
<br><i>This Tutorial is EXTREMELY interesting: more and more programs have been written in 
overbloated languages like visual basic or Delphy and, as Razzia correctly points 
out, this makes these programs even more crackable as &quot;normal&quot; applications! Besides 
I find Razzia's style extremelky clever (the &quot;more info about this program&quot; blocks 
should be used by ALL crackers from now on, for instance) and very well structured. 
Head his advice and always &quot;make the point&quot; (consider your approach) *BEFORE* jumping in a cracking 
session!<br>Another very interesting technique, useful for protection schemes that 
change the mathematical algorhitm every time they are installed, is the patching of the Visual Basic dll
 itself in order to SHOW you (in a mesagebox you'll call) which password you 
should enter<br> Enjoy!
</i><br> 
<hr size="2">
 <h3><b>razzia's tutorial for vb cracking</b></h3></center>
<pre>


               Introduction      

  Lately more and more programs come out that are programmed in VB.
Since VB programs are still unknown material for most crackers they
ignore them and label thhem as 'uncrackable'. In this document i will show
you that this is not true for text based protections (serials/reg#'s).

  As tools we will need only soft-ice and in one case hiew. Further-
more i assume that the reader is somewhat familiar with cracking. For 
absolutely beginners i recommend the great tutorials made by +orc and 
ed!son's good windows tutorial. But i will try my best to make the text 
understandable for everyone who has a little knownledge about cracking.

   
               Getting ourselves prepared

  Before i start bombing you with asm listings lets take a moment to
think about what we are dealing with. 
  We are dealing with exe's that dont have code themselves but instead
they make calls to a library with standard functions. 
  What does this mean? It means that there is a big disadventage to
protect programs written in VB. Why? Do you think that the writers of
the VB dll made 10 different functions you could use in order to compare 
2 strings? No, of course not. They made the dll to be as efficient as
possible and as small as possible. 
  So therefore a good guess is that there will be only 1 (or 2) place(s)
inside the dll where two strings can be compared. And that turns out to 
be the case, as you will see if you finish reading this document. 
  Does the little lamp already begin to glow in your head ? ;--) 
Wouldnt it be great if we knew where, in the dll, 2 strings get compared?
Yes, it would be great. It would reduce VB cracking to a boring job of
setting a single breakpoint at the right place. Continue reading for
the details.    



               Strategy
  
  Before we continue it would be wise to set out a strategy (like you 
should always do, with every other case of cracking).

  Lets think about the protection ...
You enter a string of text, then you hit enter or press 'OK' or whatever.
Then windows passes the data you entered to the VB dll. The VB dll then 
does whatever it needs in order to know if the data you entered are right 
or wrong. And you get a msg, saying you entered a good/wrong code.

  So where would then be the weak link in the chain? The answer is where 
windows passes the data you entered to the VB dll. Thats our entry point.
We can make softice break there. And then we will be at the source of the 
protection-chain. With the aid of breakpoints we can then monitor what
happens to our text. 

  I think that we now have enough background information to crack a 
first example.


               Case 1 : The Collector v2.1

  The collector is an utility for creating and maintaining your 
image/photo collection. Not bad for a VB program.
  More info about this program :

  Name       : The Collector v2.1 
  Where      : http://intranet.ca/~logic/collectr.html
  Size       : collectr.exe = 246.047 bytes
  Protection : serial
  DLL        : uses VB3 dll  <************** VB3.DLL I find it easier to explain things in steps. So therefore i will split the cracking process in smaller chunks : Step 1 : Run The Collector right at startup it will ask you for a serial # Step 2 : Enter a dummy serial like '9876543210'. Now press control-d to enter softice. In softice enter 'bpx hmemcpy' to place a breakpoint on the hmemcpy function of the kernel. (Intermezzo : What is hmemcpy? Windows uses hmemcpy alot in operations concerning strings. In this case it will be used to copy the buffer with the text we entered to the memory space of the VB dll. Remember when i said that we were gonna break when windows passed our entered string to the VB dll?) Step 3 : Leave softice with control-d. And press 'OK". This will make softice break right at the beginning of hmemcpy. Step 4 : Now we will continue with tracing further into the hmemcpy function to find out where the string we entered will be stored. Keep pressing F10 untill you see this : :Memory_copying_snippet JMP 9E9F PUSH ECX ;these lines copy the SHR ECX,02 ;string at ds:si to es:di REPZ MOVSD ;the REPZ MOVSD! POP ECX AND ECX,03 REPZ MOVSB ;the REPZ MOVSB! XOR DX,DX Step 5: Right before REPZ MOVSD do a 'ed si'. You will see the text you entered, in my case its shows '0987654321'. Do a 'ed es:di' and you will see nothing (yet). But if you press F10 and get passed the REPZ MOVSB you will see the text getting copied to this new location, where the VB dll can access it. Step 6: Now we know where the text is located. Lets review our strategy here. Our plan was to find out where the VB dll kept our serial, then put a breakpoint on that memory location and find out with what it got compared. So, lets set a bpr (breakpoint on range) at the location where our string ,ow dwells. Since the REPZ MOVS(D/B) instructions increased the pointer in di (it now points to the end of our string) we do 'bpr es:di-8 es:di-1 rw'. Dont hit enter yet read step 7 first. Step 7: Before you hit enter i will tell you what to expect. Softice will break everywhere where that block of memory with the string is read or written to. For example you will break inside the function strlen where the lenght of the string is calculated. And you will break where the string is copied to another place in memory (for example with REPZ MOVSW). When this happens place a new bpr at the new location with the string. It will also break when the string or part of it gets deleted. If the whole string does NOT get completely deleted do not remove the corresponding bpr. Only remove it when the complete string gets written over by something else. Also you will break again in hmemcpy. Hmemcpy will read another echo of the string in the dll's memory. Place a bpr there too. And finally you will break at the part of the code "that.class" tppabs="http://fravia.org/that.class" does the comparing (the instruction you will see is REPZ CMPSB). When i reached that part of code i had 4 breakpoints set. One breakpoint for hmemcpy and 3 bpr's on 3 echos of the string (or parts of it). Step 8: Now we have found the code where the VB3 dll does the comparing we can now place a breakpoint there and disable the other breakpoints. We wont need them anymore. We HAVE FOUND the place where things get compared in VB3. What you see is this : :The_VB3_compare_snippet : 8BCA mov cx, dx : F3A6 repz cmpsb ;<- here the strings in ds:si and es:di : 7401 je 8CB6 ; are being compared : 9F lahf : 92 xchg ax,dx : 8D5E08 lea bx, [bp+08] : E80E06 call 92CB Just before the REPZ CMPSB if you do a 'ed si' and a 'ed es:di', you will see what is compared with what. In this case the second and third character of the string we entered are compared with 'V8'. So if you restart the program and enter 0V87654321 it will register. Step 9: We are not finished yet. Quite the contrary! Truly, the important part is what we do now. Next time we meet a VB3 program (and we'll meet quite a lot of them :) we want to place a breakpoint at the location with the code above and read out the right serial. How do we do that ? Lets try it real quick with our target: The Collector. Start The Collector and enter a dummy serial. Enter softice and place a breakpoint on hmemcpy. Leave softice and press 'OK', this will put you back in softice. Now, get out of the kernel and and get in the code of VBRUN300 (press F11 and F10 untill you get there) Now do a search for the pattern : 8B,CA,F3,A6,74,01,9f,92,8D,5E,08,E8,0E,06 that's the "mov cx, dx" and the rest we have seen above, search: s 0 l ffffffffff 8B,CA,F3,A6,74,01,9f,92,8D,5E,08,E8,0E,06 Place a breakpoint at the adress that gets returned (bpx <seg:offset>)
    -press F5 and you will land in the middle of the above comparing
     code.
    -Only thing left to do is check out the pointers in es:di and ds:si
   

               Case 2 : Minimize Magic 1.2.4
  
  Minimize Magic is an utility that you can use to minimize your 
programs to the traybar.

  More info about this program:

  Name       : Minimize Magic 1.2.4 
  Where      : http://www.genesoft.demon.co.uk/
  Size       : minimagic.exe =  159.744 bytes
  Protection : password based on key  
  DLL        : uses VB4 dll  <************** VB4.DLL To crack this program you can proceed on the same lines we used with The Collector. Starting with hmemcpy, working your way to the code "that.class" tppabs="http://fravia.org/that.class" compares the string you entered. Important thing to know is that the VB4 dll always converts strings to the WideChar format before it does anything with them. So instead of using hmemcpy you can set a breakpoint on MultiByteToWideChar to break. Check your windows API reference to learn more about this function. I have done all the hard work for you and found the VB4 dll code that compares two strings (in WideChar format !). Heres the listing : : 56 push esi : 57 push edi : 8B7C2410 mov edi, [esp + 10] : 8B74240C mov esi, [esp + 0C] : 8B4C2414 mov ecx, [esp + 14] : 33C0 xor eax, eax : F366A7 repz cmpsw ;<-- here the (WideChar) strings at ds:esi : 7405 je 0F79B362 ; and es:edi get compared : 1BC0 sbb eax, eax : 83D8FF sbb eax, FFFFFFFF : 5F pop edi : 5E pop esi : C20C00 ret 000C Now we know enough about the VB4 dll, let's crack Minimize Magic: Step 1: Start Minimize Magic and chose Register from the menus. You will be asked for a Name and a Password. Enter a name and a dummy password. Dont press 'OK' yet, continue with next step. Step 2: Enter softice and place a breakpoint on hmemcpy. Leave softice and press 'OK'. You will land in softice. Step 3: Press F11 and F10 untill you are out of the kernel and in the code of the VB40032.dll. Now we will search for the pattern of the code above. Do 's 0 l fffffffff 56,57,8b,7c,24,10,8b,74,24,0c,8b,4c,24,14' and place a breakpoint at the adress that gets returned. Step 4: Press F5 to leave softice... you will immediately break again into the target, right at the beginning of the above code. Here the password you entered will be compared to the correct password. Trace until right before the REPZ CMPSW and do 'ed es:edi', this will show the password you entered. If you do 'ed esi' you will see the correct password. (this string will be in WideChar format for example you could see A T G H D E H D. That means your password is ATGHDEHD) Ok, now you found a working password that will work only for the version installed on your computer. If you give that password to somebody else, the program wont accept it. The password is calculated from a Key that is different on each computer. This key could be randomly generated at setup or based on the info on your hd, or on the date, the time or whatever. Whichever one it is, it could be hard to find out how its generated or where it is stored. So how can we make a general crack ? We could use the 'Magic Window' trick here. We will 'reprogram' the VB40032.dll to show the correct password. The original code in the VB40032.dll looks like this : :0F79B348 56 push esi :0F79B349 57 push edi :0F79B34A 8B7C2410 mov edi, [esp + 10] ; es:edi> pw you entered 
:0F79B34E 8B74240C   mov esi, [esp + 0C] ; esi -&gt; correct pw
:0F79B352 8B4C2414   mov ecx, [esp + 14] 
:0F79B356 33C0       xor eax, eax
:0F79B358 F366A7     repz cmpsw          ; compare them
:0F79B35B 7405       je 0F79B362
:0F79B35D 1BC0       sbb eax, eax
:0F79B35F 83D8FF     sbb eax, FFFFFFFF
:0F79B362 5F         pop edi
:0F79B363 5E         pop esi
:0F79B364 C20C00     ret 000C            ; end of this function

:0F79B367 57         push edi            ; the code below this adress 
:0F79B368 8B7C2408   mov edi, [esp + 08] ; is not important, but we
:0F79B36C 8B4C2410   mov ecx, [esp + 10] ; will need its space
:0F79B370 8B44240C   mov eax, [esp + 0C]
:0F79B374 0BE4       or esp, esp
:0F79B376 F266AF     repnz scasw
:0F79B379 B800000000 mov eax, 00000000
:0F79B37E 7503       jne 0F79B383
:0F79B380 8D47FE     lea eax, [edi-02]
:0F79B383 5F         pop edi
:0F79B384 C20C00     ret 000C

  The code is located at offset 7a748 in the vb40032.dll file. So, to
make a general crack make a patch that turns the above code into:

:0F79B348 56           push esi
:0F79B349 57           push edi
:0F79B34a 8B7C2410     mov edi, [esp + 10] ;es:edi --&gt; text you enter
:0F79B34E 8B74240C     mov esi, [esp + 0C] ;esi --&gt; correct pw  
:0F79B352 813F70006300 cmp dword ptr [edi], 00630070 ;edi -&gt; 'PC&quot; ?
:0F79B358 7527         jne 0F79B381                  ;if not - leave       
:0F79B35A 803E00       cmp byte ptr [esi], 00   |<- these lines :0F79B35D 7410 je 0F79B36F | put spaces :0F79B35F 83C601 add esi, 00000001 | between the chars :0F79B362 C60620 mov byte ptr [esi], 20 | :0F79B365 EB03 jmp 0F79B36A |<--skip the ret :0F79B367 C20C00 ret 000C ;<-- this to prevent crash :0F79B36A 83C601 add esi, 00000001 | :0F79B36D EBEB jmp 0F79B35A |<- back to the start :0F79B36F 8B3DDCC47B0F mov edi, [0F7BC4DC] *<-- these lines :0F79B375 8B74240C mov esi, [esp + 0C] * call the :0F79B379 6A00 push 00000000 * MessageBoxA :0F79B37B 56 push esi * function to show :0F79B37C 56 push esi * the correct :0F79B37D 6A00 push 00000000 * password :0F79B37F FFD7 call edi * :0F79B381 5F pop edi :0F79B382 5E pop esi :0F79B383 90 nop :0F79B384 C20C00 ret 000C Comments: We used the space of two routines, so to prevent a crash we have to put a RET function at the beginning of the (original) second function (see line 0F79B367). This part of the VB4 dll code "is.class" tppabs="http://fravia.org/is.class" not only used to check the passwords. It is used by other parts of the program as well. Therefor we need to do something so that only something will be shown when we are dealing with a password comparison. That is what the code at line 0F79B352 is about. It checks to see if EDI points to the text "PC". So we can use that to trigger the crack. To trigger the crack, "PC" has to be entered for password when registering. The lines marked with | are there to put spaces between chars of the string. Originally there would be a string of WideChar format. That means that in memory there will be zero's between the chars. But the function we have used to show us the text (MessageBoxA) translates a 0 to end of string. So we would get only 1 letter if we did not replace the zeros with spaces. The lines marked with * are there to call the function MessageBoxA to show the correct password. I ripped those commands from the VB4 dll. Placed a breakpoint on MessageBoxA to see how VB4 called it. Well thats it for Minimize Magic. To make a general crack, a patch could be written that patches the VB4 dll at offset 7a748 with the above code. To use such a crack minimagic.exe and the vb40032.dll should be placed in a temp dir and the patch run there. Then start minimize.exe from that temp dir, and use 'PC' for password. And voila, a window will pop up with the correct password. Once the correct pw is known, the temp files should be deleted and the password can be used in the original Minimize Magic. Case 3 : Sub Station Alpha 2.02 Most of the VB4 programs can be cracked with the method described in case 2, but i have encountered 2 programs which used a different method of comparing. One of those programs is Sub Station Alpha 2.02. It uses a protection that first converts a number you enter to its hex value and then compares it with the correct number. Lets start to crack Sub Station Alpha right now: things will get clearer. Info about this program: Name : Sub Station Alpha 2.02 Where : http://www.eswat.demon.co.uk/index.html Size : SUBSTN32.EXE="629.248" bytes Protection : password based on user name DLL : uses VB4 dll Earlier i mentioned that VB4 converts strings to the widechar format before it does aything with them. Therefore we will use this function as an entry point. Again we will do it step by step ;--) Step 1: Start Sub Station Alpha and chose register from the menus. Enter a name and a dummy registration key. Step 2: Enter softice and place a breakpoint on MultiByteToWideChar (with softice command 'bpx multibytetowidechar') Step 3: Now, leave softice and press "Register". Step 4: Softice will break at the beginning of MultiByteToWideChar, press F11 to get out of it. You will see : :FF1500C27B0F call [KERNEL32!MultiByteToWideChar] :8BD8 mov ebx, eax :83FEFF cmp esi, FFFFFFFF :7501 jne 0F738BCF :4B dec ebx :53 push ebx :6A00 push 00 :FF1518C97B0F call dword ptr [0F7BC918] :8BE8 mov ebp, eax :85ED test ebp, ebp :0F845B260100 jz 0F74B23D :43 inc ebx :53 push ebx :55 push ebp :56 push esi :57 push edi :6A00 push 00 :6A00 push 00 :FF1500C27B0F call [KERNEL32!MultiByteToWideChar] :8BC5 mov eax, ebp ;<-- do 'ed ebp' here :5D pop ebp :5F pop edi :5E pop esi The important place is right after the second call to MultiByte- ToWideChar. Disable the first bp on MultiByteToWideChar and place a new bp right after the second call to that function (on the line with MOV EAX,EBP). On that line EBP will contain a pointer to a string in WideChar format that was processed. It doesnt have to be the string of the registration key. Therefor we will edit that breakpoint so that it will only break when it is processing the registration key. How can we do that? Well, the MultiByteToWideChar function returns the lenght of the string it processed plus 1 in EAX. So we will add a conditional statement on the breakpoint. Do 'bl' to find out what the number is of that breakpoint. Then do 'bpe #' and add 'if al="=&lt;lengthOfKeyString+1">' to the breakpoint. For example, if you
entered '212121', lenghtOfKeyString would be 6 :--).
  

  Step 5: Now we will let the program run with F5. When softice breaks
do a 'ed edp' and see the WideChar form of the key you entered. We 
place a bpr on the block of memory containing the string and we 
continue (F5). What will happen is this. Softice will break on several 
places. Whats important is that it will break in the code of OLEAUT32.
When that happens trace a litle further to see whats going on. The 
first few times you will get out of the OLEAUT32 very quickly. But
eventually you will see this code :

( listing from OLEAUT32.DLL)
:6534B6B3 395C240C cmp [esp + 0C], ebx     ;  this is a loop that
:6534B6B7 7E14     jle 6534B6CD            ;  goes trough all 
:6534B6B9 33C9     xor ecx, ecx            ;  the chars of a 
:6534B6BB 8D0492   lea eax, [edx + 4*edx]  ;  string, in the end
:6534B6BE 8A0E     mov cl , [esi]          ;  edx will have the 
:6534B6C0 46       inc esi                 ;  hex value of the string
:6534B6C1 4F       dec edi
:6534B6C2 FF4C240C dec [esp + 0C]
:6534B6C6 8D1441   lea edx, [ecx + 2*eax]
:6534B6C9 85FF     test edi, edi
:6534B6CB 7FE6     jg 6534B6B3
:6534B6CD 85FF     test edi, edi
:6534B6CF 7F4A     jg 6534B71B
  .............
  .............
:6534B6F2 8910     mov [eax], edx          ;  edx is saved 
:6534B6F4 33C0     xor eax, eax
:6534B6F6 83C424   add esp, 00000024
:6534B6F9 C21000   ret 0010

  Step 6: We saw that the key is transformed into its hex value,
and saved to a place in memory. If you monitor this memory location,
you will end up here in the VB4 dll that compares it with another 
value:
 
:0F7A2CE1 5A             pop edx             ; load edx
:0F7A2CE2 58             pop eax             ; load eax
:0F7A2CE3 2BC2           sub eax, edx        ; subtract them 
:0F7A2CE5 83F801         cmp eax, 00000001
:0F7A2CE8 1BC0           sbb eax, eax
:0F7A2CEA 50             push eax
:0F7A2CEB 0FB706         movzx word ptr eax, [esi]
:0F7A2CEE 83C602         add esi, 00000002
:0F7A2CF1 FF2445F4997B0F jmp dword ptr [2*eax + 0F7B99F4]
:0F7A2CF8 E8BB000000     call 0F7A2DB8

  We see that EDX and EAX get loaded from the stack, and then 
substracted. This is just an indirect way of comparing those two
values. If you check out the contents of EAX and EDX, you will see
that one has the number you entered and the other one will have the
correct registration number. 

  Step 7: Now we found this location its wise to note the hex values
of the code, so you can find it back quickly when you suspect that  
another VB4 program uses this protection.

  

                 Final notes              


  Well, with the above 3 techniques i have been able to crack quite
some VB3/4 programs that used a text based protection. Sometimes
when you set a breakpoint at the comparing routine, softice will not 
break. Try then to enter strings with a different length. Because
the program could be checking the length of the string you enter before
it compares the string itself. And other programs first isolate chars
from the string you enter and then compare those isolated chars, but 
again they get compared at the locations stated in the examples above.
  With VB5 programs i havent much experience, i only cracked one of 
them. It was called Hitlist Pro v3.0. By patching the VB5 dll, I could
remove its 30 day timelimit just like it was a regular program. Of 
course, the VB5 dll had to be placed in the Hitlist Pro main dir,
this to prevent other VB5 programs using the patched DLL. 

  Thats it folks, you may contact me (if you know how ;--) on irc
with feedback and questions.


 Big greets to : tHATDUDE, madmax!, cH, Teraphy, KillerBee,j0b,
                 StarDogg Champion,aCP,rANDOM and all the 
                 others i forgot.

 Special greets and thanks to +ORC and rest of +HCU


  razzia [pc97]        
  date: 08 May 1997 
   
 </pre>
<hr size="2"><center><i>
I'm impressed. I believe we should use this approach also with all the OTHER 
overbloated languages' dlls... say for instance the *.dll of Visual c++... 
That's an idea! I'm already on my way</i> :-)
<hr size="2"></center>

<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#84" tppabs="http://members.xoom.com/tsehp_/finished.htm#84"> homepage</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="new_page_1.htm#73" tppabs="http://members.xoom.com/tsehp_/finished.htm#73"> links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="new_page_1.htm#82" tppabs="http://members.xoom.com/tsehp_/finished.htm#82"> students' essays</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mailFraVia</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
  















     
             
            





<html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>banda2</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<center><font size="+3">CENTURY LAN ANALYZER VER 1.22b<br>[WIN95 VERSION]<br></font><font size="+2">
(Another Timelock fiasco)</font>

<h4>by The Undertaker<br>
<br>
(22 August 1997, slightly edited by Reverser)</h4>
<hr>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">Courtesy of Reverser's page 
of reverse engineering<br><br><i>Well, another Timelock fiasco... why 
should anyone still use such a stupid protection scheme beats me</i></center>
<hr size="7">
<pre><center><font size="+2">CENTURY LAN ANALYZER VER 1.22b [ WIN95 VERSION ]

by the THE UNDERTACKER -=BANDA=-</font></center>      


Once, while studying in the R&amp;D lab, I found a very good network 
analyzer called CENTURY LAN ANALYZER. This is a very good protocol 
analyzer, the best I have ever seen.
But unfortunatly it comes with a 30 day trial version, which I believe
can be an interesting target for our studies.
In fact this software has been protected using the infamous TLOCK32.DLL 
(Time Lock) with its &quot;unique key&quot; generating facility. 
You can get this interesting software at <a href="FRAVIA_index.htm#284" tppabs="http://members.xoom.com/tsehp_/index.htm#284">www.shomiti.com</a>. 

The protection scheme is very weak: it uses the KERNAL32!LSTRCMP 
function to compare user input &amp; correct string. 
Each time you install the softwarea new &quot;unique&quot; registration number will 
be generated. To complete the crack we need to defeat the registration key 
genarating facility. 
OK, so now Lets RoLL WiTh IT !!!

Load Your Beloved  :- Soft-Ice for Windows 95 ver 3.01.

In the purchase window, right down REGISTRATION NUMBER --

        REG - 269535306778

Once you are in The Registration Window, enter Softice &amp; put follwing 
breakpoints.

 (In addtion to the breakpoint below you may also put GETWINDOWTEXT)
        BPX LSTRCMP
        F5
        Fill something in the Unlock Code window &amp; Click OK.
        g
        you will land on the LSTRCMP Funtion

XXXX:1000133A CALL [KERNAL32!LSTRCMP] --&gt; Trace into this Process until..
XXXX:BFF77150 CALL BFF71247           --&gt; Trace into this Process until..
XXXX:BFF71265 CALL BFF78592           --&gt; Trace into this Process until..
XXXX:BFF7866F MOV EAX,[EBP+18]            Process Once..

D EAX            ------------&gt; YOU GOT THE UNLOCK CODE.


In SoftICe memory window you can see the real the UNLOCK CODE.
Now write down the unlock code.
Yet we are not done!
This unlock code is only valid with the
current registration number. For every new installtion a new registration
code will occur. Due to this you unlock code is valid only with 
current installation. Clearly an &quot;unclean&quot; crack.

To avoid the problem here is the solution.

In \WINDOWS directory there is a file called COAGL.TDK. This file
conteins the registration code (12 digit) you may feel free to change
the registration code directly inside the COAGL.TDK file. 
Once the time for a new installtion comes, change the registraion number 
in the COAGL.TDK file &amp; put the correct Unlock Code. 
(I am too lazy to write a key genarator for this stupid protection 
 scheme beacuse this method works perfectly :-) 

<center>Happy packet snippering !!!!!

My thanks to reverser!

****** REVERSE ENGINEERING LIVES FOREVER ******
   <b>
THE UNDERTACKER -=BANDA=-  /Sri Lanka/</b></center></pre>
 <font color="green">(c) The Undertaker 1997. All rights reserved</font>
<hr ALIGN="CENTER" WIDTH="100%" SIZE="3">
<center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13">
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#79" tppabs="http://fravia.org/tppmsgs/msgs0.htm#79">homepage</a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> 
<a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#53" tppabs="http://fravia.org/tppmsgs/msgs0.htm#53">links</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0">
<a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a> 
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm#78" tppabs="http://fravia.org/tppmsgs/msgs0.htm#78">students' essays</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</a>


<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>

<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering illegal?</a></center>
<center><hr ALIGN="CENTER" WIDTH="100%" SIZE="2"></center>
</body>
</html>

<HTML>
<HEAD>
<!--  formamus.htm version 09 January 1999 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>by
+Tsehp
</TITLE></HEAD><BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" 
WIDTH= "100%"  HEIGHT="22">
<TR><td></td><td>
<p align="center">
<font face="Arial">
<!-- Choose  a TITLE and a subtitle, choose well! --><font size="+2">Reversing
IDA 4.01<br>
</font><font size="+1">Watermarked protection scheme</font></font></p>
  </td><td>
<font face="Arial">
<!-- Choose  a PROJECT GIF, leave this if unsure --></font></td></tr><tR><td bgcolor="#FFFFEA"><font face="Arial"><center><FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) --></FONT></center><font color="890000">8
    Feb 2000</font></font></td><td bgcolor="#FFFFEA"><center><font face="Arial">by <font size=+3>
<!-- CHOOSE A HANDLE , i.e. your pseudo (wont be changed) -->
 Tsehp</fonT></font></center></td><td VALIGN="center" bgcolor="#FFFFEA">
<font face="Arial">
<!--
<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</font>
</td></tr><TR><td><center><a href="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><font face="Arial"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0" width="13" height="13"></font></a></center></td>
<TD BGCOLOR="898030"><center><font face="Arial">Courtesy of Reverser's page of 
reverse engineering</font></center> 
  </TD><td BGCOLOR="898030"><center>
<font face="Arial">
<!-- Your truly+ will edit only if really necessary -->
slightly edited
<br>
by tsehp+</font>
</center></td></TR>
<!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
<TD BGCOLOR="898030"><font face="Arial"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers -->
  </font></TD><td></td></TR><TR><td VALIGN= "MIDDLE" 
bgcolor="#C6E7C6"><center><font color=blue face="Arial">Rating</FONT></center>
</TD><td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><center>
<font color=blue face="Arial">
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> ( )<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td><td></td></tr></table>
<font face="Arial">
<!-- END HEAD  --><bR>
<!-- CORPUS  -->
<!-- CHOOSE A COMMENT (may be changed)  -->
 A great tools deserves a great protection, and I was not disappointed by this
jewel. You will deal here with RSA encryption of the main app and its modules, a
license key checked everytime, reconstructing dumped dll's, and finally looking
for false errors generated by the authors.<br>
&nbsp;</font>
<hR><font face="Arial"><center><FONT SIZE="+2">
<!-- Repeat your TITLE  -->Reversing IDA 4.01&nbsp;<br>
Watermarked protection scheme</FONT><BR><FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by Tsehp
</FONT></center><br><br>

<!-- INTRO STARTS HERE -->
</font>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Introduction</fonT>
    </center></td></tr></table>
<p align="left"><font face="Arial">First I have to tell you : Don't ever mistake on my purposes.
The main goal of this essay is to study the<br>
protection if this great tool and not to give ready made tricks for someone to
spread it on the web.<br>
Discovered by Nolan blender : Ida 4.01 include your license info inside idb
databases in the same way it<br>
does on asm and lst files, if you apply the changes in ida.key and ida.wll this
will be finished.<br>
I was able able to remove all the watermarks of IDA 4.01 and did a serious byte
compare of idb<br>
databases created with ida almost completly unwatermarked on this essay and my
version that is<br>
completly unwatermarked. There's absolutly NO DIFFERENCES with the idb files
resulting, so your<br>
privacy is respected if you apply this essay.<br>
You need a regular copy of ida 4.01 to make this work, this program contains
your name watermarked everywhere<br>
and I don't tell you everything on this essay.<br>
So some watermarks will be left if you just apply what I will tell you.<br>
This tool is a must, for every serious reverser and have to be improved by its
authors, they really deserves the money it costs.<br>
What are we dealing with ? Your registered name resides encrypted in your
ida.key, ida uses this all the time to validate a lot of functions.<br>
All its modules *.w32 are encrypted in part of data section with a unique key
generated for your copy, its the same for the main dll ida.wll and<br>
all the different loaders *.ldw. The rest is left intact.<br>
I made this essay on win2k final.<!-- TOOLS STARTS HERE -->
</font>
</p>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue face="Arial">Tools required</fonT>
    </center></td></tr></table>
<font face="Arial"><br>
Softice 4.01<br>
Nt_Icedump 1.6<br>
Procdump 1.6.2<br>
An hexeditor with binary file compare (hex workshop)<br>
One Legal copy of IDA 4.01 (to apply this essay) Or two legal copies to check
the watermarks.
<br><br>

<!-- TARGET URL STARTS HERE -->
</font>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Target's URL/FTP</fonT>
    </center></td></tr></table>
<font face="Arial">
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->www.datarescue.com
<br><br>

<!-- PROGRAM HISTORY STARTS HERE -->
</font>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Program History</fonT>
    </center></td></tr></table>
<font face="Arial">
<!-- PASTE HERE YOUR TARGET'S HISTORY (if any) -->
<br>On this site, quine did some great work on previous versions. He managed to
enable some crippled functions in trial versions and finally extended ida by adding new functions.
You *must* read his <a href="quine1.htm" tppabs="http://members.xoom.com/tsehp_/quine1.htm">previous</a> essays about this.<br>
</font>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Essay</fonT>
</center></td></tr></table>
<font face="Arial">
<!-- PASTE HERE THE TEXT OF YOUR ESSAY
     THIS IS OF COURSE THE MOST IMPORTANT PART
     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED! 
     SHOULD NOT BLAST OPERA'S MARGINS OUT! HAVE A LOOK INSIDE
     YOUR OWN BROWSER WHEN YOU FINISH!  -->

The purpose is to make IDA work without watermarks. What are they ? They can take your name, strong encrypt it
and put it inside a license file (ida.key) like a lot of downloaded trials.&nbsp;</font>
<p><font face="Arial">But they can also crypt some parts of several dlls and
modules working in your app. Whats new about that ?<br>
Well datarescue doesn't sell a mass of copies, so they have the time to
customise their prog for everyone of their customer. If you manage only to crack
the ida.key and spread the rest, they can track you back.&nbsp;</font></p>
<p><font face="Arial">The watermarks consist of two parts, first a signed
encryption of the executables, modules and loaders. All those decrypts at load
time and<br>
are different for the encrypted part on every copy. At last, the ida.key is used
to generate your license info, clearly inserted at the top of<br>
the listings produced by IDA and embedded inside your packed idb files. Pierre
Vandevenne said it was for multi-users to be able to<br>
identify authors but we don't know this when we buy this prog and can't avoid
this to occur.</font></p>
<p><font face="Arial">*1 The ida.key protection.&nbsp;<br>
<br>
If you search on the web, you could find some older copies of ida with ida.key
generators. Don't waste your time with encryption or decryption routines, you
will play their game. Its more easy just to let your pc decrypt this and check
what's after. Load softice and do a bpx createfileA do &quot;d esp-&gt;4&quot;,
wait for ida.key to be sent to this api. Look for the handle returned in eax, do
a bpx readfile, check for the handle pushed in esp-&gt;4 inside the api and do a
d esp-&gt;8 and F12, the data is filled with the content of the key that is
used. Very careful here, do a bpr on a byte inside this block, you will land in
a movsd instr, remove your bpr and do a bpr on the new mem loc where this
content is copied. You will land again on a second movsd, do the same. You
finally land at $10078231,inside ida.wll keep in the data view with the crypted
info. Do several f12 (p ret) until you land at $10077aa6. You must see in the
data section of softice your personal info on reverse order. So we went thru
several routines that reads the ida.key, apply the decryption and build your
info on reverse order. Apply p ret until you land here :</font></p>
<pre><font face="Arial">001B:10077848  E83B020000    		CALL      10077A88
001B:1007784D  85C0               		TEST      EAX,EAX &lt;--
001B:1007784F  7C09               		JL        1007785A &lt;-- patch this to nop
001B:10077851  0FBE4610        		MOVSX     EAX,BYTE PTR [ESI+10]
001B:10077855  83F83D            		CMP       EAX,3D
001B:10077858  7404                		JZ        1007785E &lt;-- patch this to jmp 1007785e
001B:1007785A  33C0               		XOR       EAX,EAX
001B:1007785C  EB1F              		JMP       1007787D
001B:1007785E  6A7F               		PUSH      7F
001B:10077860  56                    	PUSH      ESI
001B:10077861  53                    	PUSH      EBX
001B:10077862  E84556FBFF    		CALL      1002CEAC
001B:10077867  83C40C            	ADD       ESP,0C
001B:1007786A  C605B4EE091007      	MOV       BYTE PTR [1009EEB4],07
001B:10077871  C7054488081001000000	MOV       DWORD PTR [10088844],00000001
001B:1007787B  8BC3                	MOV       EAX,EBX</font></prE>
<pre><font face="Arial">
<font size="3">If you do a &quot;d esi&quot; you will see your registration info. The first part is to put some ff inside ida.key, just
to remove your info inside this file, you will find the corresponding bytes that you saw before after the readfile
api, all the other bytes are unused.
This place is called about five times until ida decompiles your target, you can apply 3 patches to force ida
to work without a good key. The patches are showed on the listing.
first patch on ida.wll

.text:1006A34E jz short loc_0_1006A36B
.text:1006A350 mov eax, [eax+8]
.text:1006A353 mov edx, dword_0_1009AA62
.text:1006A359 cmp edx, 20h
.text:1006A35C jge short loc_0_1006A376 &lt;- patch this to jmp
.text:1006A35E mov ecx, edx
.text:1006A360 mov edx, 1
.text:1006A365 shl edx, cl
.text:1006A367 test edx, eax
.text:1006A369 jnz short loc_0_1006A376
.text:1006A36B</font></font></prE>
<p><font face="Arial" size="3">The last patch is here :</font></p>
<p><font face="Arial" size="2"><br>
001B:1006A340 0000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ADD [EAX],AL<br>
001B:1006A342 BA01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDX,00000001<br>
001B:1006A347 E800D40000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL 1007774C &lt;-- this call leads to the above
listing<br>
001B:1006A34C 85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST EAX,EAX<br>
001B:1006A34E 741B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JZ 1006A36B<br>
001B:1006A350 8B4008&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV EAX,[EAX+08]<br>
001B:1006A353 8B1562AA0910&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDX,[1009AA62]<br>
001B:1006A359 83FA20&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CMP EDX,20<br>
001B:1006A35C 7D18&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JGE 1006A376 &lt;--force this to jump<br>
001B:1006A35E 8BCA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV ECX,EDX<br>
001B:1006A360 BA01000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV EDX,00000001<br>
001B:1006A365 D3E2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SHL EDX,CL<br>
001B:1006A367 85C2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST EDX,EAX<br>
001B:1006A369 750B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ 1006A376<br>
001B:1006A36B 6812770810&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PUSH 10087712<br>
001B:1006A370 E8F7CEFEFF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL 1005726C</font></p>
<p><font face="Arial">This place occurs when the loaders are called by ida, like pe.ldw for
example. Those modules are used for ida to interpret typical file formats like pe, ne, dos etc...<br>
But you have a big problem, you can't find those places inside idag.exe, its
normal, this prog is encrypted. We will face this again later on this essay, so I will use two different
approaches to allow those patches.<br>
The first technique is used here for teaching purposes, if you want to remove
the watermarks it will not succeed. Why ? Because idag.exe is encrypted with your license info, so the
better way would be to reconstruct a virgin dumped app.&nbsp;</font></p>
<p><font face="Arial"><br>
*2 Reconstructing ida.wll&nbsp;</font></p>
<p><font face="Arial"> To allow the patches inside ida.wll, you have to dump it decrypted. You will
use icedump, procdump and<br>
your hex editor. This technique will be further explained in the last part of
this essay.<br>
First load ida until the nag screen. Do addr idag to switch to its address
context.<br>
Do bpmb 8:10001000 x , the ida.wll will be stopped at its *decrypted* entry
point.<br>
Look at the pe structure in procdump : base address 1000000 length ac000<br>
Exit ida and start it again, first break at 10001000 with a ret, let run until
the second break.<br>
At the second break, all is decrypted so you can
dump it.<br>
Do a pagein d 10000000 ac000 c:\temp\ida.dmp , so all the mem is dumped.<br>
We have to fix the pe header with procdump with those options enabled :<br>
* recompute object size<br>
* optimize pe structure<br>
* check header sections<br>
* rebuild header<br>
* use actual import infos<br>
We have to manually rebuild the import table, I did a fast rebuild by copying
and pasting with my hex editor, a fast way but we could have manually fixed the
api's addresses using the pe import table structure.<br>
You can locate the import table with procdump by the directories function and
calculate the raw offset, read<br>
the pe docs.<br>
Heres a snip of the original values in ida.wll not dumped :</font></p>
<font face="Arial">
&nbsp;</font>
<h1><center><font face="Arial">ida.wll (original)</font></center></h1>
<hr>
<pre><code><font face="Arial">
<font color="#000000">0004A6A2 </font><font color="#0000FF">0090 </font><font color="#000080">C1A8 </font><font color="#0000FF">0A00 </font><font color="#000080">D2A8 </font><font color="#0000FF">0A00 </font><font color="#000080">E5A8 </font><font color="#0000FF">0A00 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">6B65 </font><font color="#0000FF">726E </font><font color="#000080">656C </font><font color="#0000FF">3332 </font><font color="#000080">2E64 </font><font color="#000000">..................kernel32.d
0004A6BE </font><font color="#0000FF">6C6C </font><font color="#000080">0000 </font><font color="#0000FF">0047 </font><font color="#000080">6574 </font><font color="#0000FF">5072 </font><font color="#000080">6F63 </font><font color="#0000FF">4164 </font><font color="#000080">6472 </font><font color="#0000FF">6573 </font><font color="#000080">7300 </font><font color="#0000FF">0000 </font><font color="#000080">4765 </font><font color="#0000FF">744D </font><font color="#000080">6F64 </font><font color="#000000">ll...GetProcAddress...GetMod
0004A6DA </font><font color="#0000FF">756C </font><font color="#000080">6548 </font><font color="#0000FF">616E </font><font color="#000080">646C </font><font color="#0000FF">6541 </font><font color="#000080">0000 </font><font color="#0000FF">004C </font><font color="#000080">6F61 </font><font color="#0000FF">644C </font><font color="#000080">6962 </font><font color="#0000FF">7261 </font><font color="#000080">7279 </font><font color="#0000FF">4100 </font><font color="#000080">0000 </font><font color="#000000">uleHandleA...LoadLibraryA...
0004A6F6 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">B4A8 </font><font color="#0000FF">0A00 </font><font color="#000080">A4A8 </font><font color="#0000FF">0A00 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">............................
0004A712 </font><font color="#0000FF">0000 </font><font color="#000080">30A9 </font><font color="#0000FF">0A00 </font><font color="#000080">3BA9 </font><font color="#0000FF">0A00 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">..0...;.....................
0004A72E </font><font color="#0000FF">0000 </font><font color="#000080">7573 </font><font color="#0000FF">6572 </font><font color="#000080">3332 </font><font color="#0000FF">2E64 </font><font color="#000080">6C6C </font><font color="#0000FF">0043 </font><font color="#000080">A90A </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0045 </font><font color="#0000FF">6E75 </font><font color="#000080">6D54 </font><font color="#000000">..user32.dll.C.........EnumT
0004A74A </font><font color="#0000FF">6872 </font><font color="#000080">6561 </font><font color="#0000FF">6457 </font><font color="#000080">696E </font><font color="#0000FF">646F </font><font color="#000080">7773 </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#000000">hreadWindows
</font>
</font></code></pre>
<pre><font face="Arial">You must paste that inside your dumped ida.wll (ida.dmp) at this location :</font></prE>
<font face="Arial">
&nbsp;</font>
<h1><center><font face="Arial">ida.dmp</font></center></h1>
<hr>
<pre><code><font face="Arial">
0008B2A2 <font color="#0000FF">0090 </font><font color="#000080">5401 </font><font color="#0000FF">0080 </font><font color="#000080">3B01 </font><font color="#0000FF">0080 </font><font color="#000080">E001 </font><font color="#0000FF">0080 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">4B45 </font><font color="#0000FF">524E </font><font color="#000080">454C </font><font color="#0000FF">3332 </font><font color="#000080">2E44 </font><font color="#000000">..T...;...........KERNEL32.D
0008B2BE </font><font color="#0000FF">4C4C </font><font color="#000080">0000 </font><font color="#0000FF">0047 </font><font color="#000080">6574 </font><font color="#0000FF">5072 </font><font color="#000080">6F63 </font><font color="#0000FF">4164 </font><font color="#000080">6472 </font><font color="#0000FF">6573 </font><font color="#000080">7300 </font><font color="#0000FF">0000 </font><font color="#000080">4765 </font><font color="#0000FF">744D </font><font color="#000080">6F64 </font><font color="#000000">LL...GetProcAddress...GetMod
0008B2DA </font><font color="#0000FF">756C </font><font color="#000080">6548 </font><font color="#0000FF">616E </font><font color="#000080">646C </font><font color="#0000FF">6541 </font><font color="#000080">0000 </font><font color="#0000FF">004C </font><font color="#000080">6F61 </font><font color="#0000FF">644C </font><font color="#000080">6962 </font><font color="#0000FF">7261 </font><font color="#000080">7279 </font><font color="#0000FF">4100 </font><font color="#000080">0000 </font><font color="#000000">uleHandleA...LoadLibraryA...
0008B2F6 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">B4A8 </font><font color="#0000FF">0A00 </font><font color="#000080">A4A8 </font><font color="#0000FF">0A00 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">............................
0008B312 </font><font color="#0000FF">0000 </font><font color="#000080">30A9 </font><font color="#0000FF">0A00 </font><font color="#000080">3BA9 </font><font color="#0000FF">0A00 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">..0...;.....................
0008B32E </font><font color="#0000FF">0000 </font><font color="#000080">5553 </font><font color="#0000FF">4552 </font><font color="#000080">3332 </font><font color="#0000FF">2E44 </font><font color="#000080">4C4C </font><font color="#0000FF">0043 </font><font color="#000080">A90A </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0045 </font><font color="#0000FF">6E75 </font><font color="#000080">6D54 </font><font color="#000000">..USER32.DLL.C.........EnumT
0008B34A </font><font color="#0000FF">6872 </font><font color="#000080">6561 </font><font color="#0000FF">6457 </font><font color="#000080">696E </font><font color="#0000FF">646F </font><font color="#000080">7773 </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#000000">hreadWindows
</font>
</font></code></pre>
<font face="Arial">
Not at the same raw offset, because this file expanded in mem when you dumped it
and the size grew up.<br>
You can rename your ida.dmp to ida.wll and find the 3 places to apply the
patches I described above.<br>
&nbsp;<br>
After you did that, you can void your ida.key at the same places I did :</font>
<h1><center><font face="Arial">ida.key</font></center></h1>
<hr>
<pre><code><font face="Arial">
<font color="#000000">00000054 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
00000070 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
0000008C </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
000000A8 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
000000C4 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#0000FF">     </font><font color="#000080">     </font><font color="#000000">..........
</font>
<font size="3">This section is inserted into your idb files, and no use for integrity checks. Better void it.</font></font></code></pre>
<font face="Arial">
&nbsp;</font>
<h1><center><font face="Arial">ida.key</font></center></h1>
<hr>
<pre><code><font face="Arial">
000000F0 <font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
0000010C </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
00000128 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
00000144 </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#0000FF">FFFF </font><font color="#000080">FFFF </font><font color="#000000">............................
</font>
</font></code></pre>
<pre><font face="Arial" size="3">You can remove other bytes, try it as an exercise.</font></pre>
<pre><font face="Arial" size="3">All the encrypted info is removed on the second snip.
After that, ida 4.01 still works and doesn't show you anymore your license info, even on *.asm  or other files it can generate.
And the embedded license info inside the idb files is not generated anymore.
BUT there's is still a small problem, you can try to decompile big progs, it works ok at the  beginning and finally crashed at the end with 
messages like execution flows beyond limits etc... 
And if you put back your right key, the decompiling is working fine. Whats happening ?
Put back your normal key in the ida directory.
A very devious final check of your key at the end of the decompiling procedure, the one that's 
hard to find. How did I found that ? I went to  the patched routine at this location :</font></pre>
<pre><code><font face="Arial">
</font></code></pre>
<p><font face="Arial"><font size="2" face="Arial">001B:10077848&nbsp;
E83B020000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
CALL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10077A88<br>
001B:1007784D&nbsp;
85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EAX,EAX &lt;--stop here<br>
001B:1007784F&nbsp;
7C09&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1007785A &lt;-- patch this to nop<br>
001B:10077851&nbsp;
0FBE4610&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOVSX&nbsp;&nbsp;&nbsp;&nbsp; EAX,BYTE PTR [ESI+10]</font><br>
</font>
</p>
<p><font face="Arial">If you do a bpmb 1b:10077848 x at this place, and load idag.exe you will hit
5 times before your target is decompiled.<br>
When you stop, just do a d esi, you will see in the data section your decompiled
license info :<br>
= name , date , blah blah.<br>
If you change the egal sign to something else in mem at the second hit the
errors will happen again at the end of the decompiling.&nbsp;<br>
 The check resides here, on your decrypted key. Yes we patched ida but this info is kept in mem and
used again. If you want to trace that by yourself, take some time and be patient, this info is copied in mem to several locations (about 300
times) before the check. You have to do a bpmb on the egal sign and release your bpmb when this value is copied to another location and do a bpmb at
the new place. I used also other tricks not said here, but if you're patient, this method works fine.<br>
We finally land at this place inside ida.wll, when your license info is finally
checked and not copied to another mem location.</font></p>
<p><font face="Arial" size="2">0008:10013318  53&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      EBX<br>
0008:10013319  56&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      ESI<br>
0008:1001331A  57&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      EDI<br>
0008:1001331B  55&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      EBP<br>
0008:1001331C  51&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      ECX<br>
0008:1001331D  E876FFFFFF&nbsp;&nbsp;&nbsp;&nbsp; CALL      10013298<br>
0008:10013322  84C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST      AL,AL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;-You land here<br>
0008:10013324  0F858E000000&nbsp;&nbsp; JNZ       100133B8<br>
0008:1001332A  A1CF930910&nbsp;&nbsp;&nbsp;&nbsp; MOV       EAX,[100993CF]<br>
0008:1001332F  E8AC080000&nbsp;&nbsp;&nbsp;&nbsp; CALL      10013BE0<br>
0008:10013334  33D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
XOR       EDX,EDX<br>
0008:10013336  8AD0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       DL,AL<br>
0008:10013338  B888AA0810&nbsp;&nbsp;&nbsp;&nbsp; MOV       EAX,1008AA88<br>
0008:1001333D  891424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       [ESP],EDX<br>
0008:10013340  E857E1FFFF&nbsp;&nbsp;&nbsp;&nbsp; CALL      1001149C<br>
0008:10013345  50&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      EAX</font></p>
<p><font face="Arial">Guess what ? if al contains 0 the errors occurs, and that whats happens when
your voided ida.key is used.<br>
The call 10013298 is used later at run time, so we need to patch this call so it
nevers put a 0 on AL.</font></p>
<p><font face="Arial">Very important : the same technique will be used on encrypted modules of ida
(find them). We have to do this on all those places because the encryption is watermarked, I mean that they used
your personal info to crypt everything, I have to thank Nolan Blender who helped me a lot by providing me a sfv file (files crc) on all the files of
his copy of ida 4.01. I needed this info to locate the different files, heres a summary of the differences :<br>
<br>
Idag.exe<br>
Ida.wll<br>
ida.key&nbsp; 4 sure ;-)</font></p>
<p><font face="Arial">all the *.ldw and *.w32</font></p>
<p><font face="Arial">On previous versions, only the ida.key was different and you can now see
where are the watermarks. I recommend reading the stenography section of this
mirror to learn more about this.</font></p>
<p><font face="Arial"> On
every file I treated, I saw very small differences between nolan's version and mine, that means that some watermarks remains (small encrypted
parts) and are decrypted by idag.exe at run time, when the modules are loaded and initialized.&nbsp;</font></p>
<p><font face="Arial"><br>
*3 Restoring ida.wll and modules to their *almost* original state.</font></p>
<p><font face="Arial">First you need to understand about pe structure before reading the rest.
Check <a href="text/pe.txt" tppabs="http://members.xoom.com/tsehp_/text/pe.txt">here</a> if you don't and come back.</font></p>
<p><font face="Arial">Ida.wll and all the modules have a normal entry point. Use procdump's pe
editor on ida.wll you will find : $100AA000.</font></p>
<p><font face="Arial">Do a bpmb on it and load ida.</font></p>
<p><font face="Arial" size="2">001B:100AA000  60                  PUSHAD &lt;-- You land here<br>
001B:100AA001  E841060000          CALL      100AA647<br>
001B:100AA006  EB41                JMP       100AA049<br>
001B:100AA008  0000                ADD       [EAX],AL<br>
001B:100AA00A  E177                LOOPZ     100AA083<br>
001B:100AA00C  0C00                OR        AL,00<br>
001B:100AA00E  0000                ADD       [EAX],AL<br>
001B:100AA010  0000                ADD       [EAX],AL</font></p>
<p><font face="Arial">Typical decryption or unpacking routine, pushad saves all the registers and
the next instructions does the dll decryption and finally jumps to the<br>
real entry point. To find this place you must know something, all the dlls have
a common init section, the real entry point. This init functions maps<br>
the memory, initializes the vars etc... But this functions unloads the dll too.
So exit idag.exe just after the nag and the bpmb triggers again, do<br>
a p ret (f12) and&nbsp; :<br>
</font>
</p>
<p><font face="Arial" size="2">001B:10001000  A1E0A10710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EAX,[1007A1E0] &lt;--- you land
here<br>
001B:10001005  C1E002&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SHL       EAX,02<br>
001B:10001008  A3E4A10710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       [1007A1E4],EAX<br>
001B:1000100D  8B442408&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EAX,[ESP+08]<br>
001B:10001011  A356A20710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       [1007A256],EAX<br>
001B:10001016  FF148546A20710&nbsp; CALL      [EAX*4+1007A246]<br>
001B:1000101D  833D56A2071001      CMP       DWORD PTR [1007A256],01<br>
001B:10001024  0F8580000000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; JNZ       100010AA<br>
001B:1000102A  803DECA1071000      CMP       BYTE PTR [1007A1EC],00<br>
001B:10001031  7424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JZ        10001057<br>
001B:10001033  E88A850700&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL      KERNEL32!GetVersion<br>
001B:10001038  BAEDA10710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       EDX,1007A1ED<br>
001B:1000103D  2500000080&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AND       EAX,80000000<br>
001B:10001042  7405&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JZ        10001049<br>
001B:10001044  BA0DA20710&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       EDX,1007A20D<br>
001B:10001049  52&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
PUSH      EDX</font></p>
<p><font face="Arial">That's just the real entry of the ida.wll, it's the same with all the
modules, always at base address + 1000 to find the virtual address.</font></p>
<p><font face="Arial">We need to dump entirely this dll from mem to hd , I first used procdump to
do that but it fails when ida loads again the dumped dll. Why ?</font></p>
<p><font face="Arial">Very simple, procdumps uses loadlibrarya to load ida.wll in its address
context (a big mistake to dump protected dll's), so the init section at<br>
10001000 is called, the memory mapped and the dll is dumped. But when the mem is
mapped, the init section puts some flags on and those<br>
flags are dumped too. If ida loads then the dumped dll, the mem flags will
already be set and the protection will detect this and some errors occurs. The
main flags are located in data section, and tested at the dll's init procedure.</font></p>
<p><font face="Arial">We just need to dump the dll just at the beginning of the init section. You
will use icedump to do that.</font></p>
<p><font face="Arial">Put a bmpb at 1b:10001000 x , load ida, wait for the second trigger (you have
a ret at 10001000 when it first triggers at decrypt time)<br>
then you land again at the same address, but this time, the dll is loaded, the
mem is paged in its data section and the flags are not set.</font></p>
<p><font face="Arial">Procdump told you about ida.wll<br>
image base 10000000<br>
lenght ac000</font></p>
<p><font face="Arial">Just use icedump and do : pagein d 10000000 ac000 &quot;your path, like
\??\temp\ida.dmp&quot;</font></p>
<p><font face="Arial">You will get an ida.dmp file, containing a header to rebuild, with all the
decrypted sections.</font></p>
<p><font face="Arial">You must rebuild the header with procdump's automated feature. You change the
entry point to 10001000 with proc dump too and it's working.</font></p>
<p><font face="Arial">Dont forget to patch ida.wll so the          CALL      10013298 will never
put eax at 0. Find the raw offset by yourself !</font></p>
<p><font face="Arial">Here's what I done inside ida.wll</font></p>
<p><font face="Arial" size="2"><br>
0008:10013298  83C4E8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ADD       ESP,-18<br>
0008:1001329B  33C9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
XOR       ECX,ECX<br>
0008:1001329D  8BC4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EAX,ESP<br>
0008:1001329F  C644240424&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+04],24<br>
0008:100132A4  C644240520&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+05],20<br>
0008:100132A9  C644240675&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+06],75<br>
0008:100132AE  C644240773&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+07],73<br>
0008:100132B3  C644240865&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+08],65<br>
0008:100132B8  C644240972&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+09],72<br>
0008:100132BD  C644240A31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+0A],31<br>
0008:100132C2  C644240B00&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOV       BYTE PTR [ESP+0B],00<br>
0008:100132C7  8D542404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
LEA       EDX,[ESP+04]<br>
0008:100132CB  E878410100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL      10027448<br>
0008:100132D0  8BC4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EAX,ESP<br>
0008:100132D2  B153&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       CL,53<br>
0008:100132D4  33D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
XOR       EDX,EDX<br>
0008:100132D6  E825480100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CALL      10027B00<br>
0008:100132DB  85C0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST      EAX,EAX<br>
0008:100132DD  7504&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JNZ       100132E3<br>
0008:100132DF  B001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       AL,01 *patched part, it was XOR
eax,eax<br>
0008:100132E1  EB31&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JMP       10013314<br>
0008:100132E3  8B5004&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EDX,[EAX+04]<br>
0008:100132E6  81FAC030D737&nbsp; CMP       EDX,37D730C0<br>
0008:100132EC  7D04&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JGE       100132F2<br>
0008:100132EE  B001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       AL,01 *same<br>
0008:100132F0  EB22&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JMP       10013314<br>
0008:100132F2  8B5010&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EDX,[EAX+10]<br>
0008:100132F5  81C2C9FDFFFF        ADD       EDX,FFFFFDC9<br>
0008:100132FB  81FA0605FFA5&nbsp; CMP       EDX,A5FF0506<br>
0008:10013301  7404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JZ        10013307<br>
0008:10013303  B001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       AL,01 *same<br>
0008:10013305  EB0D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JMP       10013314<br>
0008:10013307  8B500C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       EDX,[EAX+0C]<br>
0008:1001330A  85D2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
TEST      EDX,EDX<br>
0008:1001330C  7404&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JZ        10013312<br>
0008:1001330E  B001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       AL,01 *same<br>
0008:10013310  EB02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
JMP       10013314<br>
0008:10013312  B001&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
MOV       AL,01<br>
0008:10013314  83C418&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ADD       ESP,18<br>
0008:10013317  C3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
RET</font></p>
<p><font face="Arial">So we managed to dump ida.wll and replace the crypted one with a almost
virgin one</font><font face="Arial">.</font></p>
<p><font face="Arial">Your ida is now working well, decompiling everything without errors,
and not signing the files, as an exercise we can bring back the *.w32 and *.ldw to
their *almost* original state. We will use the same technique to dump, rebuild
the header and change the entry point to base address +1000.</font></p>
<p><font face="Arial">But this time you have errors when the loadlibraryA function called from ida
tries to load the module, we take pe.ldw as a target practice.<br>
You can use a great tool called Pebrowse to compare pe.ldw original to the
dumped one, it will show you that the import section is not<br>
the same on your dumped module, why ? Because when you dumped it, your windows
changed the api addresses inside this section and those addresses are not working on your dumped module.</font></p>
<p><font face="Arial">The import section is damaged. Where is it located, look in procdumps
directory structure: import table = 178f4 (virtual address)</font></p>
<p><font face="Arial">What is the corresponding file offset ? Look at the sections : .adata Virtual
offset 17000 and Raw Offset f200.</font></p>
<p><font face="Arial">The raw offset is (178f4-17000) = 8f4 + f200 = faf4</font></p>
<p><font face="Arial">You see here the imported functions on ascii style with you hex editor. You
can do two things :<br>
the most interesting is to learn, check in <a href="text/pe.txt" tppabs="http://members.xoom.com/tsehp_/text/pe.txt">pe.txt</a> the
import table structure and rebuild it yourself, I did that, it takes times but
you will get great rewards<br>
in you future cracks.</font></p>
<p><font face="Arial">The easy method, get the import section from your original pe.ldw :</font></p>
<font face="Arial">
&nbsp;</font>
<h1><center><font face="Arial">original pe.ldw</font></center></h1>
<hr>
<pre><code><font face="Arial">
0000889C <font color="#0000FF">6172 </font><font color="#000080">7920 </font><font color="#0000FF">2573 </font><font color="#000080">0090 </font><font color="#0000FF">C178 </font><font color="#000080">0100 </font><font color="#0000FF">D278 </font><font color="#000080">0100 </font><font color="#0000FF">E578 </font><font color="#000080">0100 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">6B65 </font><font color="#000080">726E </font><font color="#000000">ary %s...x...x...x......kern
000088B8 </font><font color="#0000FF">656C </font><font color="#000080">3332 </font><font color="#0000FF">2E64 </font><font color="#000080">6C6C </font><font color="#0000FF">0000 </font><font color="#000080">0047 </font><font color="#0000FF">6574 </font><font color="#000080">5072 </font><font color="#0000FF">6F63 </font><font color="#000080">4164 </font><font color="#0000FF">6472 </font><font color="#000080">6573 </font><font color="#0000FF">7300 </font><font color="#000080">0000 </font><font color="#000000">el32.dll...GetProcAddress...
000088D4 </font><font color="#0000FF">4765 </font><font color="#000080">744D </font><font color="#0000FF">6F64 </font><font color="#000080">756C </font><font color="#0000FF">6548 </font><font color="#000080">616E </font><font color="#0000FF">646C </font><font color="#000080">6541 </font><font color="#0000FF">0000 </font><font color="#000080">004C </font><font color="#0000FF">6F61 </font><font color="#000080">644C </font><font color="#0000FF">6962 </font><font color="#000080">7261 </font><font color="#000000">GetModuleHandleA...LoadLibra
000088F0 </font><font color="#0000FF">7279 </font><font color="#000080">4100 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">B478 </font><font color="#000080">0100 </font><font color="#0000FF">A478 </font><font color="#000080">0100 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">ryA..............x...x......
0000890C </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">4479 </font><font color="#000080">0100 </font><font color="#0000FF">5779 </font><font color="#000080">0100 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">........Dy..Wy..............
00008928 </font><font color="#0000FF">4C79 </font><font color="#000080">0100 </font><font color="#0000FF">5F79 </font><font color="#000080">0100 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#000000">Ly.._y......................
00008944 </font><font color="#0000FF">6964 </font><font color="#000080">612E </font><font color="#0000FF">776C </font><font color="#000080">6C00 </font><font color="#0000FF">7573 </font><font color="#000080">6572 </font><font color="#0000FF">3332 </font><font color="#000080">2E64 </font><font color="#0000FF">6C6C </font><font color="#000080">0001 </font><font color="#0000FF">0000 </font><font color="#000080">8000 </font><font color="#0000FF">0000 </font><font color="#000080">0067 </font><font color="#000000">ida.wll.user32.dll.........g
00008960 </font><font color="#0000FF">7901 </font><font color="#000080">0000 </font><font color="#0000FF">0000 </font><font color="#000080">0000 </font><font color="#0000FF">0045 </font><font color="#000080">6E75 </font><font color="#0000FF">6D54 </font><font color="#000080">6872 </font><font color="#0000FF">6561 </font><font color="#000080">6457 </font><font color="#0000FF">696E </font><font color="#000080">646F </font><font color="#0000FF">7773 </font><font color="#000080">0000 </font><font color="#000000">y........EnumThreadWindows..
</font>
</font></code></pre>
<p><font face="Arial">compare this place to your dumped pe.ldw and copy all the bytes from 889c to
8962 from original to your dumped ldw.</font></p>
<p><font face="Arial">The import section is now restored and points to the good api's addresses.</font></p>
<p><font face="Arial">Don't forget to : rebuild the pe header, change the entry point and rebuild
the import sections on all the modules ldw or w32 that you want</font></p>
<p><font face="Arial">and they will be all decrypted, you can now decompile them with ida if you
want to look further.</font></p>
<p><font face="Arial">As an example I did that on my pe.ldw and nolan's pe.ldw, three places in the
dumped files still differs (first your license info in plain ascii text<br>
in the header, easy to remove, and two other places in the files. So my essay
stops here and I still will not explain you how to remove the last<br>
watermarks, search for yourself, it's an easy thing for you if you understood
all the essay.</font></p>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Final Notes</fonT>
    </center></td></tr></table>
<pre><font face="Arial">
<font size="3">If you manage to remove the last watermarks, don't spread this cracked tool. Software protections
are getting more and more hard to defeat. You could compromise further updates of ida if you do 
that, so you will work against you reversing potential.</font></font></pre>
<pre><font face="Arial" size="3">Here's a snippet of a word from Pierre Vandevenne, the product administrator :</font></pre>
<pre><font face="Arial" size="3">**/**</font></pre>
<font face="Arial" size="3">
<b>Re: Re: IDA 4.01 changing thoughts...</b><br>
Wednesday, 09-Feb-2000 16:18:29</font>
<ul>
  <font face="Arial" size="3">195.0.122.9 writes:<br>
  <br>
  Hello,<br>
  <br>
  We probably don't have the same definition of stealing, but I thought I'd say
  a few words here<br>
  <br>
  The name of the user that created the database is indeed stored in the
  database. No need for reverse engineering, hearsay or whatever here, the name
  is displayed in the beginning of the disassembly !<br>
  <br>
  Several reasons for this, one of them being that some users have requested IDA
  Pro to be multi-user and to be able to retrieve who created the database.<br>
  <br>
  About the greediness, well we could be a greedy company, but it really doesn't
  apply to IDA. Consider<br>
  <br>
  1) that the market for advanced development tools is extremely small today.<br>
  <br>
  2) that IDA is developed in a fully legal and licensed environment. We pay for
  compilers, for specs, for books, for packers, whatever we need<br>
  and can buy. We buy from companies and companies buy from us and as a result
  jobs are created on both sides. Wrong ?<br>
  <br>
  3) Ilfak now works full time in Belgium - guess what, we haven't imported him
  as an illegal alien and haven't hidden him in a cave with a<br>
  486 and an amber monitor. Anything wrong with this approach ? Doesn't he
  deserve a nice work environment ?<br>
  <br>
  4) we give constant and immediate support to customers.<br>
  <br>
  Honesty is not a function of the mood, it is an intrinsical quality. If you
  want to be dishonest, please feel free to do so, you don't need any
  justification.<br>
  <br>
  <br>
  <a href="mailto:pierre@datarescue.com">Pierre
  Vandevenne</a>&nbsp;</font>
  <p><font face="Arial" size="3">**/**</font></p>
</ul>
<pre><font face="Arial" size="3">At this day 14/2/2000 the ida 4.02 version still injects your ida.key into idb database...&nbsp;</font></pre>
<pre>&nbsp;</pre>
<pre><font face="Arial" size="3">If something is wrong, or updates are needed to allow this on win98 or nt4, send me a word.</font></pre>
<pre><font face="Arial" size="3">Greetings,</font></pre>
<pre><font face="Arial" size="3">&nbsp;</font></pre>
<pre><font face="Arial" size="3">+Tsehp  
<!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</font></pre>
<font face="Arial">
<br><br>

<!-- OB DUH STARTS HERE -->
</font>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH= "100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font color=blue size="+2" face="Arial">Ob Duh</fonT>
</center></td></tr></table><font face="Arial"><center><i>I wont even bother explaining you 
   that you should BUY this target program if you intend to use it for a 
   longer period than the allowed one. Should you want to STEAL this 
   software instead, you don't need to crack its protection scheme at all: 
   you'll find it on most Warez sites, complete and already regged, 
   farewell, don't come back.</i></center>

<!-- WAY OUT STARTS HERE -->
</font>
<hr><font face="Arial"><center><i>You are deep inside reverser's page of reverse engineering,  
choose your way out:<br><br></i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->
<!-- 
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->
<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm" >homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="protec.htm" tppabs="http://members.xoom.com/tsehp_/protec.htm">how to protect</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm">how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity academy</A> 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
</font>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML><html>
<head>

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><title>protec.htm: HOW TO PROTECT BETTER</title>
</head>
<BODY BGCOLOR=#C0C0C0 TEXT=#001010 VLINK=#405040>
<table><tr><td colspan=2>
<center><H2>reverser's HOW TO PROTECT BETTER<bR>(SOFTWARE REVERSING LAB)</H2>
</center></td></tR>
<tR><td><IMG SRC="images/protec_big.jpg" tppabs="http://members.xoom.com/tsehp_/images/protec_big.jpg" ALT="Ivan Bilibin: " good protection is not a dream" 
ALIGN=LEFT WIDTH=534 HEIGHT=320 BORDER=0 VSPACE=0
 HSPACE=0 a></td>
<td align="center"><H4>A good protection is NOT an impossible dream!<br><br>
<font color=blue>How to (try to) protect software effectively</fonT></H4>
<table><tr><tD><center><H4>
<font color=red>[</font><a href="protec.htm#anchorintro">intro</a><font color=red>]</font><br>Advices<br>
<font color=red>[</font><a href="protec.htm#anchoradm">Mark's</a><font color=red>]</font> ~ 
<font color=red>[</font><a href="protec.htm#anchoradt">Tidbit's</a><font color=red>]</font><br>
<font color=red>[</font><a href="stonetips.htm" tppabs="http://members.xoom.com/tsehp_/stonetips.htm" >Stone's</a><font color=red>]</font> ~ 
<font color=red>[</font><a href="protec.htm#anchoradmo">More tips</a><font color=red>]</font><br>
<font color=red>[</font><a href="protec.htm#anchorshr">To shrink?</a><font color=red>]</font><br>

<font color=red>[</font><a href="htp_essa1.htm" tppabs="http://members.xoom.com/tsehp_/htp_essa1.htm" >essays</a><font color=red>]</font><br> 
<font color=red>[</font><a href="protec.htm#anchortric">tricks</a><font color=red>]</font> ~ 
<font color=red>[</font><a href="protec.htm#anchorlin">links</a><font color=red>]</font><br>

</H4></center></tD></tr></table></center></tD>
</tr>
</table><bR><bR><center>(Last update: October 1999)<br>
<a name="anchorintro"></a>
<br></center>
<H2><font color=gray><center>Software Protection, 
an impossible dream?</fonT><bR>An introduction</H2>
<br><br><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=CENTER WIDTH=600
HEIGHT=7 BORDER=0 VSPACE=0 HSPACE=0><bR><br></center>
I would like to start, with this section of my site, a good "special" reversing  
laboratory for software protection. As my readers know, we have already tried this 
some time ago with the <a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm" >Our Protections</a> section. Yet that 
section didn't seem to florish, so I'm now re-organizing various 'threads' into a 
coeherent "software protection" project. I hope that this will 
help reversers and protectors alike... no cracker should underestimate the 
difficulty (and the beauty) of writing a good protection, exactly as no protector 
should underestimate the difficulty (and the beauty) of reversing a difficult 
snippet of software. Cracking and protecting are two very important sciences in 
their own right, but I have noticed that the development of good protections suffers 
a 'psychological' penalty. "There's no point in protecting or overprotecting: a determined 
cracker can crack any protection!"; "nothing can guarantee absolute security"; 
"Any protection scheme can be defeated"; "protection measures can be easily worked around", 
and so on and so on... stalk the protectors on usenet and you'll see this kind 
of typical whining.<br>
Well, any protection scheme can be cracked... may be. Yet let's devise schemes that 
will make things a lot HARDER for the typical cracker to mess with... 
and who better than some good +crackers can teach protectors how to 
protect?<bR><b>It's almost winter, snow is in the air! C'mon: let's 
push another snowball down 
the Webhill!</b>
<a name="anchoradm"></a>
<hr>
<H2><font color=gray><center>Software Protection, 
an impossible dream?</fonT><bR>All the advices you may need</H2></center>
<center><br><br><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=CENTER WIDTH=600
HEIGHT=7 BORDER=0 VSPACE=0 HSPACE=0><bR>
<br></center><IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0> 
<font color=blue> <font size=+2> Mark's famous 14 protector's commandments</font></fonT>
<ul>
<li>1 Never use meaningful file or procedure names such as 
  IsValidSerialNum (duh.) If you do use functions for 
  checking purposes, place at least some required code 
  that your program really needs, in such a function. 
  When the cracker disables the function, the program 
  will produce incorrect results.
</li><lI>2 Don't warn the user right after a violation is made.  
  Wait later, maybe until the next day or two (crackers hate that).
</li><lI>3 Use checksums in DLL's and in the EXE.  Have them check each other.  
  Not perfect but it just makes it harder to crack.
</li><lI>4 Pause a second or two after a password entry to make brute 
  force cracking unfeasible.  Simple to do, but rarely done.
</li><lI>5 Self-heal your software.  You know, error correction like modems 
  and hard drives use.  The technology has been around for years, 
  and no one uses it on their software?  The best thing about this 
  is that if the cracker used a decompiler, they may be looking at 
  a listing that is no longer valid.
</li><lI>6 Patch your own software.  Change your code to call different 
  validation routines each time.  Beat us at our own game.
</li><lI>7 Store serial numbers in unlikely places, like as a property 
  of a database field.
</li><lI>8 Store serial numbers in several places
</li><lI>9 Don't rely on the system date.  Get the date of  several files, 
  like SYSTEM.DAT, SYSTEM,DA0 and BOOTLOG.TXT and compare them to 
  the system date.  Require that the time be greater than the last 
  run.
</li><lI>A Don't use literal strings that tell the user that their time is 
  expired.  These are the first things to look for.  Build strings 
  dynamically or use encryption.
</li><lI>B Flood the cracker with bogus calls and hard-coded strings.  Decoys 
  are fun.
</li><lI>C Don't use a validation function.  Every time you validate the user, 
  write your validation code inline with the current process.  That 
  just makes more cracking for the cracker.
</li><lI>D When using hard-coded keys or passwords, make them look like program 
  code or function calls (i.e., "73AF" or "GetWindowText").  This 
  actually works very well and confuses some decompilers.
</li><lI>E Finally, never reveal your best protection secrets :-)
</LI></ul>
<br>
<a name="anchoradt"></a>
<hR><IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0> 
<font color=blue> <font size=+2> Tidbit's 'common sense' rules</font></fonT>
<br><ul>
<li>1. No nagscreens. Making enemies among your customers is very stupid, indeed.
</li><lI>2. Create important menus and dialog boxes dynamically, whether in something
like turbo-vision, xforms or m$windoze. Use your own format of rcdata like borland
did in delphi if you don't want to write too much code.
</li><lI>3. If your program doesn't save data in "crapware" edition, don't include a "grayed"
menu item. No saving means no saving. That's it.
</li><lI>4. The only way to tell user that he is unregistered should be in the "about" dialog.
The latter should also be created dynamically.
</li><lI>5. Avoid using any kind of string resources like "this crap is unregistered, blah blah"
</li><lI>6. Link statically unless your program is a complex one (at least of m$word 2.0
complexity)
</li><lI>7. Don't loose time on writing anything that will kill disassemblers or debuggers.
Take my word on it - doing it is worthless, people who made them or HCU'ers :-)
will soon find the way around, so shift your interest to more important stuff.
</li><lI>8. Use your language of choice fully. Even if it's visual basic, learn it thoroughly first.
Using some advanced constructs it is possible to make debugging a nightmare.
</li><lI>9. Use run time library fully when writing the beta versions, in final release rewrite
some functions at least to make crackers life harder.
</li><lI>9a) Example: many ocx'es for vbasic take PLENTY of space, and they are really
easy to hook to. Use only ones which you need, usually much of ocx crap can be
rewritten to use plain windows api.</li>
<lI>10. Take SOME time to THINK about protecting your software. Is it worth the
protection? Wouldn't it be better to IMPROVE YOUR SOFTWARE, rather than
improving protections?
</li><lI>11. Try to embed at least part of the protection inside the data manipulation.
Data structures can take ages to understand basing only on disassembly listing,
they also are more error-prone for cracker. Crackers usually take notes on loose
sheets of paper, and not everyone reads his own handwriting 100% accurately.
</li><lI>12. A protection that mangles data is a good one usually.
</li><lI>12a) Example: Got a charting program. The crapware shouldn't print. Disabling
printing and later on enabling it basing on some registration# is the most often
committed suicide. Let your thingo print. When creating data structures for
printing, mangle them in some way. Unmangle them just before printing, using
reg# or something other for that purpose. Even more, make this mangling subtle.
Assume that you've got a pie chart to print. Don't alter anything, but add some
not too big random numbers to values of data series - this is mangling then.
The chart will look "not that bad", but will be otherwise unuseable (if the changes
are random and on the order of 20%, for example). Finding such protection, if
its connection with reg# is not self-evident can take much time. One has to delve
inside your data structures and find that dreaded mangling and unmangling code. Not
too easy, especially if you program high level, not in asm.
</li><lI>13. When mangling data, use some tricks so that it is not self-evident where that
reg# comes from into unmangling code.
</li><lI>13a) Example: I did it for a dos platform once. The reg# (in a "go/no-go" protection)
was specified as a command line argument. The command line parser was clean and
it was the only place where command line was ever referenced. In some other place
the "irrevelant" code  was using a "bad" version of borland pascal move routine from 
rtl (move copies a range of data from here to there). The routine in rtl was altered 
to copy a few bytes more and to wrap around the segment boundary. The "irrevelant" code
called copy with parameters set so that it would copy some useless crap together with
command line somewhere else, and that "somewhere" was left unused for some time. It was
evaluated in the wholly other part of program. Athough setting bpx on memory range would
find that, it was not THAT evident that one should place the "enable#" on command line
(it was nowhere mentioned since I needed to protect from my coworkers only).
</li><lI>14. Be economically inclined. Calculate whether you need to write your "to be protected"
program at all. Isn't there (albeit big) a commercial, widely available package that
does the same thing? If you need that tiny program for yourself only, in 99% of cases
it's cheaper to use existing package that supports scritping (to tailor it to your needs).
If you want to sell it, check your market. The problem of protecting software vanishes
if no one will use your software. Don't overestimate your work's "importance to the world".
Search the net. There's nothing like you want to do? Search more, then. Start work only
when you're sure there's need.
</li><lI>15. Always explore your language of choice on the level proposed (or, more often these
times, pushed) by the language developers. If you're real programmer that doesn't want
his "hello world" app to be 2megs+ big, shift down to the api level asap - ie. after
exploring all the nice "visualties" the commercial types might be pushing you to use.
</li><lI>15a) Example: This pertains mostly to things like borland c++, delphi and m$ vc++ -
write your app using the existing user interface crap (foundation classes etc). When
the innards are debugged (hah, they never are, but if you at least don't find any bugs
in the first 20 minutes of post-build testing), rewrite your user interface to use
windows api directly. Do it cleverly, think first, think a lot, and you'll usually get
an app that is at most 1/4 of the original size, and that works much faster. Do you
believe that corel draw 3 was written using nearly pure api? Such a HUGE app? - you
say it's impossible. No, it quite is, ever more in the 32bit world when you don't need
to spend so much time moving data around the 16bit segment boundary (corel 3.0 was for
windows 3.x - it was 16 bit).
</li><lI>16. What does p.15 have to do with protections, you think. Oh well, it does have much.
Since your code doesn't use the "prepackaged" stuff, it's more personal, more custom.
Since each programmer's style of programming is different, it take more time for a
potential cracker to find out what's going inside your app. Alas, all this is useless
if cracker doesn't have to know the innards to deprotect. So always protect in a way
that is tied in MANY PLACES to the innards (data structures etc).
</li><lI>17. A monolithic app that doesn't reference to much more than kernel or device drivers
is usually harder to crack. There are less dependencies to get from watching the .exe
and .dll's with quickview for example. Try to export only the callbacks needed by
windoze for example. Check what goes to the outside world. Try to include no or little
details of registration procedure. Your code should give as little information in "clear
text" to the cracker as possible.
</li><lI>18. For god's sake, don't give away the working code! Try to provide users with:
<br>- The crapware version, that DOESN'T have the "missing features" compiled in. This thing
should also have no nag screens nor "enter reg# here" suff - it's obvious, since it's
the CRAPWARE ONLY.
<br>- The full version, that HAS the full functionality compiled in but that also requires
user to enter the reg# once somewhere. This version should be only given away to those
that have paid. At least there is no way to get the thing to crack from your site, since
you only expose the crapware for lamers. Alas, your "full" version, maybe even cracked,
will be to be found shortly on warez sites, but not everyone knows where to search,
so you at least can be proud that your app has been stolen by "the enlightened" :-)
</li><lI>19. As has been said many times: don't overuse the "registered", "unregistered",
"registration code", etc. words - both in clear text and in encrypted form. If possible,
invent some clever algorith to generate these on the fly basing on some variables,
definitely don't use the "bool Is_Registered" flag anywhere! 
</li><lI>19a) Notes: It would be quite nice if the program will be having some sample (bad?) 
reg# stored inside in some place(s). The user, after entering the registration#, should
have no IMMEDIATE indication of any kind that the software is registered now. THis
indication shouldn't also be deferred using timer, like in unix login. It's childish
easy to find the "sleep x" code. Each function, like save, print, etc. that depends
on registration, should check the reg# by itself, and it should do it in such way
that user nor cracker doesn't see that something is going wrong or good. As said before:
no disabled stuff. If saving is disabled, either don't provide it at all, or make 
the unregistered save work just like real one, just that data isn't written to disk
or is written badly. Consider such scheme: user isn't presented with any "this funct
disabled" box, the save works ok (save dialog opens, save completed "%" bar scrolls
as usually), but you may for example lseek back to the beginning of file after writing
each record if the user isn't reg#. This approach is hard to crack since such attempt
requires to delve DEEP into the program's internals and to find what is going bad
and where. People also think sometimes that their version is simply damaged and throw
their program away, whereas that dreaded save might work ok when registered.
</li><lI>19b) Notes: CLEARLY INDICATE facts mentioned in 19a), like that:
<<"<font color=purple>Reminder: This program, when not registered, won't save nor print any data.
These two functions will operate ONLY when the CORRECT registration number is
entered in the registration dialog box.
Warning: we restate that save and print options WON'T WORK until the CORRECT
registration number is specified. All other features are unaffected in the
unregistered version.<br>
Note: You cannot verify that correct registration number has been entered.
Program doesn't display any warinings that you've entered invalid number.
You know that it is ok when save and printing works, else please retype the
registration number and try again."</fonT>>>
This will indicate:<br>
a) to the user that he definitely WILL enable the program when the CORRECT number
has been entered,<br>
b) to the hacker that it is going to be a tough job since the registration #
checker sits somewhere else.<br>
</li><lI>19c) Implementation notes: Move your reg# to the checker routine in an unsuspicious way. 
If you can, don't use the "existing" textbox and gettexta, implement the reg# 
entering routine by hand, it would be quite wise even to refrain from using the 
existing text rendering procedures and render the number on-screen as it is 
entered using your own renderer. You can edit your own font resource or use 
some preexisting font, then just encode it in some way so that it will be 
unreadable by resource workshops, even better include it in the source as 
static constants. Although it is still easy to find where the "drawbitmap" 
equivalent was used to paint the reg#, it is definitely harder to understand 
the whole underlying routine, especially noticing where does that 
reg# go. Using a multi-layered approach here is the most feasible one:
<br>- dynamically create accelerator keys in your 'register me' dialog box, these
accells should be for keys used in reg# entry (0-9,a-z for example)
<br>- each accell should call different routine, if feasible (makes breakpointing tougher)
<br>- each routine should store the flag that given char was entered somewhere else,
it would be nice if each keypress would modify some global variable, in some way
that is decodeable for you, but not to the cracker (at first glance)
<br>- then there should be some kind of 'monitoring' routine that acts accordingly,
paining the characters on the dialog box and taking actions upon backspace and enter,
for example
<br>- yet another routine should collect all entered characters and create a reg# and store
it in some untrivial place. using a .vxd here to manipulate the virtual memory to make
some 'backup' copies in a not-easily-debuggeable way is a nice idea. a .vxd can work
like a tiny embedded debugger, bpxing on the place where that reg# goes. it can then copy
it to some quite other place, all that happening in the background and not to be noticed
easily. the cracker will of course (at the first try, at least) try to check where this
location is accessed. since it is accessed nowhere, he will scream: how the hell does this
app know that the reg# has been entered, if it even does not access it? oh well, just
a tiny .vxd or even a background thread has copied it somewhere else. they'll get at
it later, but at first it can stir crackers minds, though.
</li><lI>20. Notes on registration numbers:
<br>- balance between security, feasiblity, programmability and end-user headaches
<br>- too long, non-alphanumeric reg#'s tend to be continuously entered badly. at least
provide a "non-persistent" reg# entry field so that user will rewrite the reg# each
time, possibly correctly at last. many people will just "glance-compare" the entered
reg# and the one (possibly) emailed to them, arriving at the final thought that they
did enter it correctly, whereas the font is too small or they are too tired to notice
that this '1' and 'l' have been interchanged (in a reg# like 'l83jjd_0)pH1lTe' )
<bR>- refrain from any user feedback. the reg# entry box should accept strings of any
length, without any validation. don't give crackers the knowledge about reg#.
sometimes knowing that it's 10 chars long or that is contains only uppercase alphabet
helps, so don't help them
<br>- the reg# verification scheme (I'm pretty sorry about it, but it just is like that)
needs to take into account the number of prospective users, and thus you oughta do some
"market analysis"
<br>- if your reg# is 10 numbers long, there are 10^10 possible reg#'s. but since your app
might find let's say only 10^4 (10'000) users, you should invent an algorithm that
assigns each one of 10^4 users one of 10^10 reg#'s, and does it somewhat uniformly. This
prevents people and programs (some .vxd based "macro" players, like the one presented
some time ago in DDJ, for example) to be used for brute force approach. If there are
only 10^4 users and you allow 10^9 "valid" reg#s out of 10^10, on average each 10th 
reg# tried brute-force will be valid, whereas on the case of 10^4 prospective users, that
many valid reg#'s and space of 10^10 reg#s, on average only each 10^6th reg# tried brute
force will be valid. Ever calculated how much time it would take to brute-force search
10^6 numbers, even using a fast machine and extremenly fast macro player (keystroke
generator simulating reg# entry and checking for results)?
<br>- the assignment operator that assigns user# to reg# shouldn't be trivial, and it's 
implementation should be done in asm by someone experienced both in maths (topology
known by +ORC helps here, also :-) and asm. check your operator. create graphs of
how it works. understand your own work, especially its drawbacks and vulnerabilities
<br>- be inventive. don't use anything that seems simple, quick and effective. unless you've
come with something like Einstein's relativity theory, your approach is yes, simple,
yes, quick, but no, not effective, and yes, easy to crack. I'm sorry but we aren't
geniuses and developing a good protection scheme takes time, it took time myself, and
still takes although i'm creating protections for fun since 5 years or so. It will
definitely take some time you, dear reader, and don't believe your self-confidence.
Protections written by self-confident and unexperienced prgrmrs end up in the 
"<a href="project7.htm" tppabs="http://members.xoom.com/tsehp_/project7.htm" >most
stupid protection</a>" page of reverser. a nice and exposed place, and with what a
neighboorhood, but a protection ending there is still the "most stupid". not a nice
definition of your work, huh? :-]'
</li><lI>21. Play same game twice. It helps. If you invent some nice and hard to crack memory
move-around scheme to protect reg# inside your data space, do the same to parts of your
data, even better using the same routine just with other parameters. Crackers are
lived up to the fact that protection algorithms are always used for protections only.
If integrity of your data will rely, at least partly, on proper working of your
protection code, crackers get a tough work to do. it's called functional verification
of the "okayness" of protection code. you don't checksum nor crc it, but simply call
it "from the other place" and let it process the protection-unrelated data. if it
will process this data ok, then cracker mustn't have altered it. this places end on
easy cracks like "change that jump here and that cmp there to nops"..
</li><lI>22. Strainer to you: does lotus 1-2-3 for dos "diskette" protection (it let you install
it up to 3 times without "zapping" it from hd first) work still in win95? if yes, why? 
if not, why? analyze the code, I've learnt MUCH from it. it's only dos code, it's
probably 100 times cracked already, but there are some niceties to learn from it.
not a very good protection scheme, has many holes in it, but remember what +ORC said:
a cracker well educated in historical code is nearly always a perfect one :-)))
(ok, ok, i know, there's nothing perfect aside from moskovskaya in this bad world, but,
can't we joke at times ? 8-0=)
<bR><br>
cheerz,<br>
tibit</li></ul>

<br>
<a name="anchoradmo"></a>
<hR><IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0> 
<font color=blue> <font size=+2> More tips you might take into consideration</font></fonT>
 

<br><ul><li>
Use a serial which is several KB long of arithmetical transforms, to drive
anyone trying to crack it insane. This makes a keygenerator almost
impossible - Also, brute force attacks are blocked very efficiently.
</li><lI>
Caution with the Runtime libary! Use it fully when writing the beta versions, in
the final release rewrite some functions at least to make crackers life harder.
</li><lI>
Mangle data. Protection that mangles data is usually a good one.
Example: Imagine a charting program .. e.g., just disabling printing and later
on enabling it basing on some registration# is the most often committed
suicide. Let your thingo print. When creating data structures for printing,
mangle them in some way. Unmangle them just before printing, using reg# or
something other for that purpose. Even more, make this mangling subtle.
Assume that you've got a pie chart to print. Don't alter anything, but add
some not too big random numbers to values of data series - this is mangling
then. The chart will look "not that bad", but will be otherwise unuseable (if the
changes are random and on the order of 20%, for example). Finding such
protection, if its connection with reg# is not self-evident can take much time.
One has to delve inside your data structures and find that dreaded mangling
and unmangling code.
</li><lI>
Traps. Do a CRC check on your EXE. If it is modified then don't show the typical error
message, but wait a day and then notify the user using some cryptic error
code. When (and if) they contact you with the error code, you know that it is due to
the crack. Be aware: such traps could also be activated due to virus infection
or incorrect downloads. Don't blame a potential customer for software piracy. 
</li><lI>
The rcr/rcl trick
If a rcr/rcl is performed on a value, it becomes much more of a pain to crack -
you can't reverse it with by negating it's effects without knowing what the
value of the carry flag was before the original operation. If the carry flag is
created as a result of some other pain in the neck operation, you are probably
onto a winner. 
</li><lI>
Stick conditional jumps in. Everywhere.
Conditional jumps are not fun to reverse engineer. No loops, but jumps which
conditionally bypass/include portions of your wonderful key manipulation
code. There is no easy inverse operation to be performed here. 
</li><lI>
Use portions of the code as magic number tables.
(preferably critical sections). You have no idea how annoying this can be, if
you're like most crackers and like to change things around using softice (a
popular cracking tool). 
</li><lI>
Play with the cracker's mind.
This one is fun :-) Stick series of nops in, as though you were doing
self-modifying code (oh my god! what the heck! nops? Aha! Self-modifying
code! Idiot spends next three years trying to find the code that should be
there.). Pepper the code with junk instructions. Cut the code up into little
pieces and put them all over the executable, with (preferably conditional)
jumps between them. - Anything which you would find a pain in the neck. 
</li><lI>
Detect SoftIce. Early.
Now crash the computer. You can crash a pentium or a pentium with MMX
even without a vxd by the opcode: F0 0F C7 C8 (illegal form of cmpxchg8b
instruction with lock prefix). Beyond that, we have to resort to the tried and
true methods. Using a vxd, take the CPU out of protected mode. Windows
doesn't like that. Wonder why?
<lI></ul>


<a name="anchorshr"></a>
<hr>

<IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0>

<H2><font color=gray><center>Software Protection, 
an impossible dream?</fonT><bR>The Shrinkers discussion</H2></center>

On Richard Fellner's page I found this snippet:
<pre>Don't rely on "EXE-packers". For almost any tool which compresses EXE files
(Shrinker, WWPack32, NeoLite - to list the most popular ones) there's an
uncompressor around, so compressors capable for software-protection
should at least support configurable encryption. Unpackers for the above (and
other) tools are not very wide-spreaded, however, don't rely on them as your
program's one and only "protection"!</pre>
Now the question is: is this true?
<br><br>
A shrinker, like the one from <a href="http://www.blinkinc.com/" >Blinkinc</a> should 
be seen as a 'first line of defense' for a protector. The application will be uncompressed 
when it is loaded and cannot therefore be decompiled from disk. This makes the possibility 
to mess with it  
a little more complicated for the cracker, especially if, after having compressed the 
application with Shrinker or with WWpack32 you checksum (twice) the compressed EXE.
<br><br>
The standard binary post-processors seem at the moment to be:<bR>
<a href="http://www.blinkinc.com/" >Shrinker</a><br>
<a href="http://www.previewsystems.com/" >VBox</a><br>
and WWrap32<br>
And for these shrinker there are corresponding unshrinkers in the scene... where are they?
<hr ALIGN="center" width=44%>
Well, a first good tool (yet not for beginners) is 
<a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm" tppabs="http://fravia.org/zipped/ucfpd114.zip">procdump</a> a very good unpacker by Riz+la, Stone and 
G-rom (btw: 
in the unpack.txt companion file you'll find VERY USEFUL information about the 
most common commercial' packers). I'm presenting here version 1.1, build 4 from 11 October 
1998. Visit Stone's page to fetch more recent versions.

<a name="anchorlin"></a>
<hr>

<IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0>

<H2><font color=gray><center>Software Protection, 
an impossible dream?</fonT><bR>Links</H2></center>

<center><br><br><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN=CENTER WIDTH=600
HEIGHT=7 BORDER=0 VSPACE=0 HSPACE=0><bR>
<br></center>
<font color=blue><font size=+2>Anti-Cracking sites</font></fonT>

<bR><br>
 Vitas Ramanchauskas' site: 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="http://www.soft4you.com/vitas/antihack.htm" >http://www.soft4you.com/vitas/antihack.htm</a>
<br>Some interesting techniques and original ideas
<br><br>Richard Fellner's anti-crack tips 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm" >http://www.user.xpoint.at/r.fellner/nocrack.htm</a> 
<br>(most of them have been shamelessly stolen from my site :-)
<br><br>Rob Beckers' How to Battle Warez: 
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="http://www.cat-soft.com/warez.htm" >http://www.cat-soft.com/warez.htm</a>
<br>A VERY interesting part about site tracking and elementary/intermediate stalking techniques
<br>
<hr>
<font color=blue><font size=+2>Anti-Cracking discussions</font></fonT>
<br><bR>
You may be interested in my <a href="couninte.htm" tppabs="http://members.xoom.com/tsehp_/couninte.htm" >Counter Intelligence</a> page.

<hr size=3>

<font color=blue><font size=+2>Cracking discussions</font></fonT>
<br><bR>
You may be interested in my <a href="whydwcr.htm" tppabs="http://members.xoom.com/tsehp_/whydwcr.htm" >Why crackers crack? (Reversing reversers' psychology)</a> 'late November' thread.
<hr size=3><a name="anchortric"></a><center>

<IMG SRC="images/protec.gif" tppabs="http://members.xoom.com/tsehp_/images/protec.gif" ALT="protec" 
ALIGN=LEFT WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0><font color=blue><font size=+4>Tricks</font></fonT>
<br><bR>

<font color=red>[</font><a href="protec.htm#melt">Let's melt softice? Pro and contra</a><font color=red>]</font> 
<font color=red>[</font><a href="protec.htm#funn">Funny tricks against idiots</a><font color=red>]</font></center>
<hr>
<a name="melt"></a>
<H2>
1. Let's melt softice? Pro and contra
</H2>
Here you'll be able to check David Eriksson's original (Mid-97) <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="sources/meltice.c" tppabs="http://members.xoom.com/tsehp_/sources/meltice.c" >meltice</a>! A tool 
for detecting softice written in C, and here you'll have the same code ported  
by PhR to <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="text/melticed.txt" tppabs="http://members.xoom.com/tsehp_/text/melticed.txt" >Pascal/Delphi</a> (with Hoffmeister's corrections).<bR>
Anyway such an approach is of limited use. You may succeed in annoying some 
casual crackers, yet the fact that Numega chose to name their kernel
drivers that way doesn't mean much... 
there is nothing that prevents any reveser from renaming them...<br><bR>
So I publish the snippets above because this can give some ideas to good protectors. Go beyond 
and prepare some good code for Sice detection (or even some 'retaliating code'... come to 
think of it, if I were a protection scheme and if I would detect on a computer -say- 
softice, wdasm and 
smartcheck I would know that I should ring 
all possible defcom red alert bells... but READ (and head) THE FOLLOWING CAVEAT!<br><br>
First of all you should UNDERSTAND what Softice is... many 'sunday' programmers 
don't have the slightest clue...<br>
<br>
SoftICE is - same as WDEB386.EXE of Microsoft a completely different story,
from turbodebugger... 
much to shareware-authors and driver developers dismay.<br>First of all,

SoftICE is 
    started before Windows starts (more exactly - you run winice.exe and
winice in turn runs win.com).  This applies to win9x .
configured to run as a
    boot driver, kernel driver, or a dynamic loadable (kernel) driver under
NT.<br>
When the gui starts SI is already present and can be invoked via ALT-D
(preset). So there is no "present-not present" thing with softice, it sits
beneath windows and waits till you need it. as the bulk of softice consists
of ring 0 software, you're not limited in what you can view. driver writers
for that reason quite routinely start their machine with si present.
<br>
Therefore you go about detecting it like you'd detect any other vxd  - seeking the
VMM's DDB and then just walking the linked list of DDBs in the case of
Win9x, and examining the list of loaded drivers in NT.
<br>The problem rather
is, what are you going to do if you find it? Nuke the machine?<br>
The world
increasingly seems to fill up with authors, who think, just because somebody
(mostly by accident) installed one of their vanity proggies, they got the
right to nuke others peoples machines.<br>
As it's part of my job to work with
softice I just can't work with some programs without reversing them at 
the moment - o.k. so what, but what will annoy almost all VXD authors 
is if you just go about rebooting the machine if they start
your software... maybe putting a link into the autostart group before.
<br>
Therefore do me and people like me a favor please: forget 
that debugger detection
crap, do a little bit of math and firgure out how to en- and decrypt your
software at runtime (as it is to valuable to be looked at by other people),
be creative and contructive instead of just destructive.
<br><br>
Btw, there is no law against people debugging and reversing your 
software, as strange as this may seem to you, but there surely is a law 
against deliberatly risking to damage other peoples' property.
<hr>
<br><bR><a name="funn"></a><H2>
2. Funny tricks against idiots.</H2>
<br>
Publish the following on alt.2600 (or IRC, or wherever lamers abound) 
as standard answer to all zombies' questions regarding 
software deprotection:<bR>

"<font color=bluE>There is a file in the root directory that controls all copy
protection called command.com (or under NT, I believe it's
'ntldr'). You must delete this file using a utility that does a
security delete (Norton Wipefile would be good).  Then restart
your computer.  Copy protection schemes will no longer function.</font>"
<br><br>
Also nice:
<br><br>
"<font color=blue>In order to deprotect all protected software you will need to 
perform a dos command inside your dos 
box. After having started a dos box 
(start ~ programs ~ MS-dos prompt), you will see a funny small 
black window, with the following (cryptic) message:
<prE>
C:\WINDOWS>
</pre>
Don't worry about its meaning for the moment, just 
type 
<pre>cd.. (that is "cd point point") </pre>
and you will see a small display changement, the prompt will 
now read:
<prE>
C:\>
</prE>

Now you are "root", as hackers use to say, just type the following:
<prE>
prompt deprotect>
</prE>
And you have started the deprotection routines, note in fact that the 
prompt now
reads
<prE>
deprotect>
</prE>
All what you need to do, now, is to excute the command
<prE>
deltree /Y
</prE>
(Notice that there is a space after deltree, before /Y). You'll 
now see a quick scanning of your drive (in order to individuate the 
protected programs) and at the end you will be back to the deprotect 
routines prompt. Have fun with your unprotected programs</fonT>"
<hr width=44%>
Of course you should NOT add any smiley to these messages... This is called 
"darwinian selection among wannabie crackers" :-)



<hr size=3>


<center>

Visit the experimental <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN=TOP WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0
HSPACE=0><a href="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/index.htm">message board</a> for 
all people hanging around at reverser's
<hr size=3>

<!-- Begin mover -->

<table>
<tr>
<td><center>
<a href="protecti.htm" tppabs="http://members.xoom.com/tsehp_/protecti.htm"><IMG SRC="images/tough.gif" tppabs="http://members.xoom.com/tsehp_/images/tough.gif" ALT="Ourprotections" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Our Protections</font>
</center></td>
<td><center>
<a href="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm"><IMG SRC="images/ourtools.gif" tppabs="http://members.xoom.com/tsehp_/images/ourtools.gif" ALT="OURTOOLS" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Our own tools</font>
</center></td>

<td><center>
<a href="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"><IMG SRC="images/academy.gif" tppabs="http://members.xoom.com/tsehp_/images/academy.gif" ALT="academy" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Students' essays</font>
</center></td>

<td><center>
<a href="projunpa.htm" tppabs="http://members.xoom.com/tsehp_/projunpa.htm"><IMG SRC="images/packers.gif" tppabs="http://members.xoom.com/tsehp_/images/packers.gif" ALT="projunpa" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Packers & Unp</font>
</center></td>

<td><center>
<a href="project3.htm" tppabs="http://members.xoom.com/tsehp_/project3.htm"><IMG SRC="images/project3.gif" tppabs="http://members.xoom.com/tsehp_/images/project3.gif" ALT="dongles" ALIGN=BOTTOM 
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a><br>
<font color=gray>Dongles lab</font>
</center></td>
</tr>
</table>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="aca400.htm" tppabs="http://members.xoom.com/tsehp_/aca400.htm">most recent essays</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">+HCU database</a><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter measures</a>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">CGI antismut</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</a><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm">javascript wars</a>

<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="javaco1.htm" tppabs="http://members.xoom.com/tsehp_/javaco1.htm">AntiMicro$oft</a>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_fravia</a><br>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" HEIGHT=13 WIDTH=13 ALT= red_ball><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</a>
</center>
<!-- End mover -->
<hr>
 <a href="awards.htm" tppabs="http://members.xoom.com/tsehp_/awards.htm" ><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" 
ALT="red" WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 
HSPACE=0></a>
<Font color=green>
(c) <a href="io13.htm" tppabs="http://members.xoom.com/tsehp_/io13.htm">Reverser</a>, 1995, 1996, 1997, 1998, 1999. All rights reserved</font>

<hr>
</body>
</html><html>
<head>
  <title>syncche.htm</title>
</head>
<body BGCOLOR="#C0C0C0" TEXT="#001010" VLINK="#405040">
<p><center><font SIZE="+3">HyperChem 5.0  - 'Same old sauce'<br>
</font><font SIZE="+2">&quot;Don't lure us any more&quot;</font>
</center>

<h4><center><i>by +Sync</i><br>   <br>
<a href="solution.htm" tppabs="http://members.xoom.com/tsehp_/solution.htm"><img SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="cracker" ALIGN="BOTTOM" WIDTH="114" HEIGHT="43" BORDER="0" VSPACE="0" HSPACE="0"></a><br><br>
(28 October 1997)</center></h4>

<center><hr><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> Courtesy of reverser's page of reverse engineering<br>
</center><br><i>Well, +Sync (our &quot;tester maximo&quot;) worked on this essay as an answer 
to an email that we 
got some days ago. +Sync has accomplished a very &quot;altruistic&quot; task indeed: he 
tested a protection scheme in order to see if it was relevant or not for 
our studies. Unfortuntaley it was not.<br>
I believe we should all learn some lessons:<br>
1)		<font color="blue">Never ask for help when you have not &quot;done your math&quot; yourselves.<br>
</font>Admittely, it may be difficult at times to know if a &quot;new protection&quot; is 
only an old known one in disguise, or if it is really new and daunting, yet 
we'll never accept, from now on, requests regarding &quot;apparently new&quot; protection 
schemes that are not accompanied by a THOROUGH first investigation by the 
guy that asks for help. +Sync's time and capabilities (and +gthorne's and 
mine, and of all other 'new' +HCUkers... not to speak of +ORC's ones) 
are too precious to be wasted on such banalities).<br>
2)	<font color="blue">New and daunting protection schemes are indeed very rare.</font><br>As soon as 
one appears there are many chances that it will reveal itself as an 'old sauce', 
like this one. It's a pity, but it is -alas- so (let's hope that clever programmers 
will learn enough from our essays to provide us more tough challenges :-)<br> 
3)	<font color="blue">I hope that some funny faces are not mistaking the +HCU for a place 
where you are allowed to hunt for ready made cracks.</font><br>WE ARE NOT INTERESTED in the software 
that we crack (with very few exceptions), as funny as it may seem to some, 
we are interested (a lot) in 'pure' software reverse engineering activities,  
it just happens that protection schemes constitute a nice challenge. Anyway we 
will NEVER again publish any reverse engineering of a program if we may again 
suspect, like we do in this case, that we have been lured to work on a 
protection scheme only in order to crack a banal specific target. You need a 
ready-made crack? Are you a &quot;me-too&quot; luser, incapable of reversing software yourself? Are 
you too lazy or stupid to study the (aboundant) material provided all over the 
net? Beggar off, there are plenty of self-appointed 
crackers ready to futter you software in spades till you have slurped so much that you'll explode. 
You are here at the wrong address.<br><center>
And now, duly feeling guiltiness and remorse, enjoy this nice &quot;surgical&quot; clean cut essay by +Sync
</center>
<hr size="6"></i><pre><font size="+2">HyperChem 5.0  - 'Same old sauce'
   </font>
Well, this was sent to me through the +HCU as a possible new project. 
I would have to say that not only does this not qualify as a new project, 
it is simply the same thing that we have presented over and over again.  
At most, this might qualify for the &quot;time protections&quot; section.  
Anyway, here it is. 
Available at <a href="http://www.hyper.com/" >http://www.hyper.com</a> the program is called HyperChem, 
which seems to be a very versatile use for you Chemical Engineers out 
there.  
First thing, as always, is to run the program.  
It quickly tells you that you cannot run this version without an 
&quot;authorization code&quot;.  You get this code from them, and enter it in
HCLicense.EXE in order to run this program.  
This is the very interesting part of this target's protection.  
Enter any set of numbers as the Authorization Code and it will
register almost every time.  
It doesn't like alpha characters though. 
Can it really be that easy?  Unfortunately not.  
Try running the program again and nothing has changed.  
So what the hell is HCLicense doing?  Well, check it out with WDASM or 
Softice or IDA or any way you want, and it comes down to this:
All it does is take the number you put in, and store it in a key in the
registry.  
The key is :
HKEY_CURRENT_USER\Software\Hypercube\HyperChem\5.0\Registration\DemoKey
Well, so now all we need to do is find out where in the program it
checks this key.  So WDASM CHEM.EXE and look for 'DemoKey'.  
Right below where you find it, you will find the following code

* Reference To: ADVAPI32.RegQueryValueExA, Ord:0136h
                                  |
:0041B730 FF156CA65000      Call dword ptr [0050A66C]  ;get the key
:0041B736 85C0              test eax, eax
:0041B738 753E              jne 0041B778
:0041B73A 8B9540FEFFFF      mov edx, dword ptr [ebp+FFFFFE40]
:0041B740 899538FDFFFF      mov dword ptr [ebp+FFFFFD38], edx
:0041B746 8B8538FDFFFF      mov eax, dword ptr [ebp+FFFFFD38]
:0041B74C 8B08              mov ecx, dword ptr [eax]	;ecx holds code from HCLicense
:0041B74E 898D34FDFFFF      mov dword ptr [ebp+FFFFFD34], ecx
:0041B754 8B9534FDFFFF      mov edx, dword ptr [ebp+FFFFFD34] ;now in edx
:0041B75A 3B9530FDFFFF      cmp edx, dword ptr [ebp+FFFFFD30] ;check if right
:0041B760 7516              jne 0041B778     ;jmp if it's not right

So, we need to prevent the jump at 41b760 from being made, as follows:
:0041B760 7516              jne 0041B778        ;jmp if it's not right
to
:0041B760 4048              inc eax    dec eax  ; ie do nothing

So now we will be able to run the program right?  Well, try it out.  
It tells us that our evaluation has expired!  Before we even get to 
run it once! What kind of shoddy programming is this?  
Well, it's not hard to fix.  Look for an occurrence of GetLocalTime 
(or BPX it in S-ICE) and you'll quickly find the code snippet below.

* Reference To: KERNEL32.GetLocalTime, Ord:00F5h
                                  |
:0041A176 FF1514A95000            Call dword ptr [0050A914]
:0041A17C 83EC10                  sub esp, 00000010
:0041A17F 8BCC                    mov ecx, esp
:0041A181 8B55F0                  mov edx, dword ptr [ebp-10]
:0041A184 8911                    mov dword ptr [ecx], edx
:0041A186 8B45F4                  mov eax, dword ptr [ebp-0C]
:0041A189 894104                  mov dword ptr [ecx+04], eax
:0041A18C 8B55F8                  mov edx, dword ptr [ebp-08]
:0041A18F 895108                  mov dword ptr [ecx+08], edx
:0041A192 8B45FC                  mov eax, dword ptr [ebp-04]
:0041A195 89410C                  mov dword ptr [ecx+0C], eax
:0041A198 E814160000              call 0041B7B1     ;check if expired yet
:0041A19D 83C410                  add esp, 00000010
:0041A1A0 85C0                    test eax, eax     ;are we?
:0041A1A2 7504                    jne 0041A1A8      ;yes, jmp away
:0041A1A4 33C0                    xor eax, eax      ;no, go on good guy
:0041A1A6 EB31                    jmp 0041A1D9

So again we need to force the jump not to be made
:0041A1A2 7504                    jne 0041A1A8      ;yes, jmp away
to
:0041A1A2 4048                    inc eax   dec eax ;don't ever jump

That's it, HyperChem 5.02 Evaluation version now runs as it would if you
had entered a valid code, and were still in the evaluation period.  
There is still a nag screen at startup, which I did not bother writing 
details about (if you don't know how to remove it, you need to study a 
little more).  
I did begin to reverse the Authorization Code, it is created from the 
name and organization you type in at install, however a patch was 
necessary to clean up the expiration, so a keymaker would only do half 
the job anyway.  
Hope this helps someone.
+Sync  <a href="mailto:" sync1@iname.com">sync1@iname.com</a>

</pre><font color="green">
(c) +Sync, 1997. All rights reversed.</font>
		<hr size="2">
<center><i>You are deep inside reverser's page of reverse
engineering, choose your way out:</i></center>


<p><center>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"> <a HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" ALIGN="BOTTOM" WIDTH="13" HEIGHT="13" BORDER="0" VSPACE="0" HSPACE="0" NATURALSIZEFLAG="0"> <a HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anonymity
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students' essays </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools
</a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails </a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">academy database </a>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm">antismut </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms </a><img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser 
</a><br>
<img SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALIGN="BOTTOM" BORDER="0" VSPACE="0" HSPACE="0" WIDTH="13" HEIGHT="13"><a HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">is reverse engineering legal? </a></font></center></p>

<p><center><font SIZE="-1"><hr></font></center>
</body>
</html>
<!-- saved from url=(0022)http://internet.e-mail -->
<HTML>
<HEAD>
<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="GENERATOR" CONTENT="Mozilla/4.02 [en] (WinNT; I) [Netscape]">
<TITLE>zee_inst.htm - InstallShield scripts decompiling</TITLE>
<!--  formamus.htm version 02 February 1998       INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!      SEARCH THIS TEXT FOR THE STRING "Your_"       AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH!       THANKS A LOT: this will allow automated retrieval -->
</HEAD>
<BODY TEXT="#001010" BGCOLOR="#C0C0C0" VLINK="#405040">
&nbsp;
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="22" >
<CAPTION><!-- this is for the data.....fra_00xx....yymmdd....handle..beg+int...not ass... --></CAPTION>

<TR>
<TD></TD>

<TD><!-- Choose  a TITLE probably wont be changed -->
<CENTER><FONT SIZE=+2>Decompiling InstallShield Scripts</FONT></CENTER>

<CENTER><FONT SIZE=+1>(work in progress)</FONT></CENTER>
</TD>

<TD><!-- Choose  a PROJECT GIF, leave this if unsure -->
<CENTER><A HREF="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm"><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" ALT="progcor" BORDER=0 HEIGHT=43 WIDTH=114 ALIGN=CENTER></A></CENTER>

<CENTER><FONT COLOR="#808080">Programmers</FONT></CENTER>
</TD>
</TR>

<TR>
<TD BGCOLOR="#FFFFEA">
<CENTER><!-- CHOOSE A DATE (will probably be changed) --><FONT COLOR="#890000">04 March 1998</FONT></CENTER>
</TD>

<TD BGCOLOR="#FFFFEA">
<CENTER>by&nbsp;<!-- CHOOSE A HANDLE (wont be changed) --><FONT SIZE=+3>zeezee</FONT></CENTER>
</TD>

<TD VALIGN=CENTER BGCOLOR="#FFFFEA"><!--<a href="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/hcu1.gif" ALT="+cracker" ALIGN=BOTTOM WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>--></TD>
</TR>

<TR>
<TD>
<CENTER><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" BORDER=0 ALIGN=BOTTOM width="13" height="13"></A></CENTER>
</TD>

<TD BGCOLOR="#898030">
<CENTER>Courtesy of Reverser's page of reverse engineering</CENTER>
</TD>

<TD BGCOLOR="#898030">
<CENTER><!-- Your truly+ will edit only if really necessary -->slightly
edited by reverser+</CENTER>
</TD>
</TR>

<TR>
<TD><FONT COLOR="#C4C0CF">fra_00xx</FONT>&nbsp;
<BR><FONT COLOR="#C4C0CF">98xxxx</FONT>&nbsp;
<BR><FONT COLOR="#C4C0CF">handle</FONT>&nbsp;
<BR><FONT COLOR="#C4C0CF">1100</FONT>&nbsp;
<BR><FONT COLOR="#C4C0CF">NA</FONT>&nbsp;
<BR><FONT COLOR="#C4C0CF">PC</FONT></TD>

<TD>
<CENTER><!-- Your truly+ comments --><I>Here it is, with a little delay :-( Zeezee's 
work on installshield decompiling!<br>I don't believe that this work is obsolete. Quite the 
countrary: it offers (IMO) a welcome ADDITION to NaTzGUL's beautiful tool and to NaTzGUL's 
master essays.<br>In fact, as 
I have stated more than once, I believe that if we have more capable reversers working on the 
SAME subject we get (almost always) as many DIFFERENT ways to tackle the same solution. (At times 
we even get different solutions!)<bR>Since that what interest us are mostly the 
TECHNIQUES that should be used and not the solutions in themselves, this 'doppeltgemoppelt' 
approach offers -on our Web- quite some advantages.<bR>Enjoy!</I></CENTER>
</TD>

<TD></TD>
</TR>

<TR>
<TD></TD>


<TD BGCOLOR="#898030">
<CENTER><B>There is a crack, a crack in everything That's how the light
gets in</B></CENTER>
<!-- Leonard Coehn's old song, because we are poets, not only crackers --></TD>

<TD></TD>
</TR>

<TR>
<TD VALIGN=CENTER BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF">Rating</FONT></CENTER>
</TD>

<TD VALIGN=CENTER BGCOLOR="#C6E7C6">
<CENTER><!-- CHOOSE A RATING (may be changed) --><FONT COLOR="#0000FF">(
)<B>Beginner</B> (x)<B>Intermediate</B> (x)<B>Advanced</B> ( )<B>Expert</B></FONT></CENTER>
</TD>

<TD></TD>
</TR>
</TABLE>
<!-- END HEAD  -->
<BR><!-- CORPUS  --><!-- CHOOSE A COMMENT (may be changed)  -->
<BR>This essay has become obsolete one day after it was written. Nights
I sent it to Reverser+ and on the morning the wonderful
<BR>decompiler by NaTzGUL was available. The idea behind this essay was
to help develop InstallShield decompiler and
<BR>since it is now present, this essay is purely informational.

<P>This essay has no use to all except those willing to decompile InstallShield
scripts.

<P>&nbsp;I will explain here where you can find InstallShield script compiler
code generator tables.You will find from the disassembly how modern compiler
encodes code generation procedures etc.

<P>
<HR>
<CENTER><!-- CHOOSE A TITLE (wont probably be changed) --><FONT SIZE=+2>Decompiling
InstallShield scripts and guidelines for decompiler writers</FONT></CENTER>

<CENTER><!-- CHOOSE A SUBTITLE (wont proabbly be changed) --><FONT SIZE=+2>(work
in progress)</FONT></CENTER>

<CENTER><!-- REPEAT YOUR CHOSEN HANDLE HERE --><FONT COLOR="#0B7FC1">Written
by zeezee</FONT></CENTER>
&nbsp;

<P><!-- INTRO STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Introduction</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>

<PRE>&nbsp;&nbsp;
<!-- PASTE HERE YOUR INTRODUCTION -->
Decompiling InstallShield scripts is not cracking. It's pure reverse-engineering.&nbsp;
It may be more - a lesson how good compiler is built, how expressions are translated&nbsp;
into machine code, how they are executed, how a modern compiler implements
token search algorithms and more.
It's impossible to cover all these topics in one short essay, but I think
it may be a foundation for other crackers and +crackers to delve deeper into
this subject (assuming anyone is interested in pure reversing).
Goal of this essay: To give the reader some basic information about InstallShield compiler.
</PRE>

<PRE>Future Goal: Someone writes an InstallShield scripts decompiler :).</PRE>

<PRE>>>>Author's note five days later: There IS now InstallShield decompiler!</PRE>
Before reading this: Read this <A HREF="natz51.htm" tppabs="http://members.xoom.com/tsehp_/natz51.htm">essay</A> by NaTzGUL.
I'm assuming here that the reader knows what InstallShield script is and
where it can be found (hint: setup.ins ;).&nbsp;
<!-- TOOLS STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Tools required</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>
<!-- PASTE HERE YOUR REQUIRED TOOLS -->IDA 3.7 (full, 'quined' or freeware)
<BR>Wdasm will work also, but we will heavily rely on cross-references,
which in IDA are only a mouse-click away
<BR>&nbsp;

<P><!-- TARGET URL STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Target's URL/FTP</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) --><A HREF="http://www.installshield.com/">http://www.installshield.com</A>
You must register first to download lite version.
<BR>This is not absolutely necessary to perform our work, but helpfile
may help a lot explaining built-in functions syntax, parameters etc.
<BR>The compiler engine available for download is sufficient to follow
this essay.
<BR>InstallShield Compiler main engine <A HREF="http://acrigs.com/FRAVIA/zipped/iscompil.zip" tppabs="http://members.xoom.com/tsehp_/zipped/iscompil.zip">Download
it here</A> (109k).
<BR>InstallShield setup.exe (659k) - get it from any CD you have handy...



<P><!-- REAL ESSAY  STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Essay</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>
<!-- PASTE HERE THE TEXT OF YOUR ESSAY     THIS IS OF COURSE THE MOST IMPORTANT PART     PLEASE CHECK THE MARGINS WHEN YOU ARE FINISHED!      SHOULD NOT BLAST NETSCAPE MARGINS OUT! HAVE A LOOK INSIDE     YOUR OWN BROWSER WHEN YOU HAVE FINISHED!  -->
<PRE>I'm assuming here that the reader has all our tools ready and will follow all steps
described below. I don't attach any listings. If you want to follow, just
load setup.exe and compiler.dll into IDA (one after another), wait until autoanalysis is
finished and save resulting IDB files.


When reading above mentioned NaTzGUL's essay (excellent, btw.) I tried to delve
deeper into compiled script. First I disassembled setup.exe (this is the script
interpreter&nbsp;
if you forgot) and located the command scanner:

At 00420E84 you will find opcode fetch, parameter determination and, finally,
a jump to the command service routine.

Table containing addresses of procs (opcodes 000..1C6) starts at 00495FC8.
For each command there is a record:
&nbsp;&nbsp; byte&nbsp; parameters type
&nbsp;&nbsp; dword procedure_address
When you have time, name these procedures like cmd_xxx where xxx is opcode.

eg. at 0049609B you will find a record containing (2, 0042AC02), which
corresponds to the command 02A - MessageBox.
02C is goto, 02F is strlen, 033 is Exec etc...

This was found quite easy, but then comes a more tricker part:

Where can we find real names of the functions?

After short thinking I decided to reverse the InstallShield compiler.
Of course the compiler must be located anywhere first.

First solution:   Get it from www.installshield.com (Lite version).
Second solution:  Get in from the Web (you know how to search).
Third solution:   Get Visual C++ 5 or other CD containing InstallShield Lite 
                  as an added bonus.
Fourth solution:  Get it <A HREF="http://acrigs.com/FRAVIA/zipped/iscompil.zip" tppabs="http://members.xoom.com/tsehp_/zipped/iscompil.zip">here</A> (DLL only for reversing).

Our target is now compiler.dll, main compiler module called from the IDE and
probably from the command-line script compiler which I don't have.

The essential part of the compiler is lexical analyzer which isn't so
interesting for us. More important is the code generator and token analyzer.
Remember that this compiler does not generate pure machine code. It generates scripts
which are interpreted during actual setup process by setup.exe.
The code generator contains of
&nbsp;&nbsp; [deep breath here]
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; several hundred pointers to linked lists of records containing pointers to
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; code generation tables
&nbsp;&nbsp; [deep breath end]
(sounds nice, ehm).

I'll explain it briefly.

Short definition: Token: something that can be a keyword, function name,
&nbsp; number, variable name etc,
&nbsp; eg. tokens are:
&nbsp; goto, MessageBox, IS_OS2 etc.
If you are purist, replace this definition by yours.

Assume the compiler has completed the token MessageBox. It searches a service
for it using nice pointer table contained in 10033408..10033807. Looks like
a tree...

These 256 dwords are almost all pointing to linked lists of structures.
Let's see eg. where points dword at 10033650. Click on reference and you land in
10031938.
Make 4 dwords from the following data and you quickly discover the token table
structure:

address 10031938:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; actual value

&nbsp;&nbsp; dword *next_list_element_pointer&nbsp;&nbsp; 10031948
&nbsp;&nbsp; dword *token_string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "ConfigAdd"
&nbsp;&nbsp; dword command_flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 00000201
&nbsp;&nbsp; dowrd *token_service_data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1002E898

&nbsp;command_flags are 0201 in all functions and built-in constants, other values
&nbsp;in this field are meaining that token is a keyword (eg. 'case' has 0A01)

&nbsp;token_string is simply this what are we searching for: ASCIIZ name of function or constant.
&nbsp;token_service_data are the data for the code generator. These data are several
&nbsp;(mostly 3 for constant or 4 for functions) words, eg.

-&nbsp; for functions:
&nbsp;&nbsp; word 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (this means: token is a function)
&nbsp;&nbsp; word function_opcode
&nbsp;&nbsp; word ?&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (maybe parameter count?)
&nbsp;&nbsp; word ?

-&nbsp; for compiler predefined constants:
&nbsp;&nbsp; word 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (this means: token is a predefined constant)
&nbsp;&nbsp; dword constant_value.

Let's follow the linked list in above example. At 10031948 we have:
&nbsp;&nbsp;&nbsp; dword pointing to next list element
&nbsp;&nbsp;&nbsp; dword pointing to "MessageBox"
&nbsp;&nbsp;&nbsp; dword 00000201 (function/constant)
&nbsp;&nbsp;&nbsp; dword pointing to 1002E8A0

And at 1002E8A0 we have:
&nbsp;&nbsp;&nbsp; word 2 (function)
&nbsp;&nbsp;&nbsp; word 2A (opcode for this function in script)
&nbsp;&nbsp;&nbsp; word 2 ???
&nbsp;&nbsp;&nbsp; word 2 ???

Of course IDA 'Xref clicking' is much faster than reading this&nbsp;
step-by-step description.

So, we have found an opcode for MessageBox which is (surprise?) equal to this
one found by reversing setup.exe (see above).

Once again, here is a quick way to find an opcode for built-in function or
&nbsp;predefined constant value:

1. Locate ASCIIZ name of searched token (Alt-B in IDA). Remember to find this
&nbsp;&nbsp; keyword _exactly_ as it should appear.
2. Click on Xref - you will land in linked list
3. Check if dword after is 00000201, if not you are searching for a keyword...
4. Click on Xref of dword below - you will land in token_service_data.
5. Second word is the opcode.

Let's check it again for LaunchApp (should be simple exec, isn't it?)
Alt-B, "LaunchApp" (check case-sensitive, otherwise slow search) -> 1002C2FC.
Click on Xref: 1003198C
Below we have dword 00000201 (or press 'D' 3 times to make dword)
And then kinda offset - click on it -> 1002E8BE.
First word is 2 - it's a function
Second word is 33 - it's the opcode.

BTW, when you return to the disassembly of SETUP.EXE and find command code 033
service procedure you will find quickly that we're right...

Author's note five days later:</PRE>

<PRE>{</PRE>

<PRE>&nbsp; You may experiment with IDA script language to correctly display all these records.</PRE>

<PRE>&nbsp; There is no need to experiment further. The decompiler is already written.</PRE>

<PRE>}

So... A little bonus for all going so far with this essay!

If you want to see the token table compile the file below.
</prE><xmp>
---cut here, don't destroy your monitor with scissors!---

// InstallShield COMPILER.DLL token table dump
// by zeezee

// Warning: Compile using 16-bit segmented model. Good old BC3.1 will do.
// sizeof( int ) = 2
// sizeof( long ) = 4

#include&nbsp;<stdio.h>
#include&nbsp;<stdlib.h>

// known offsets in the COMPILER.DLL file
#define TABLE_START 0x1002F328l
#define TABLE_END 0x10033408l
#define LOAD_OFF 0x10000E00l // diff load_address - file_offset

void main( void )
{
  FILE *cfil;
  char sbuf[80];
  unsigned long ptr_next, ptr_name, ptr_serv, flags, fptr;
  unsigned int token_type;
  unsigned long opcode;

  cfil = fopen( "compiler.dll", "rb" );
  if( cfil == NULL )
  {
    printf( "Cannot open COMPILER.DLL\n");
    exit( 1 );
  }
  fptr = TABLE_START;

  // We are now pointing to the start of the list
  // Each element has the form:
  // dd *next_element
  // dd *asciiz_name
  // dd flags
  // dd *service_proc

  // Since we know that all list elements are consecutive, we are treating
  // the list simply like table ignoring pointers to next elements

  do
  {
    fseek( cfil, fptr - LOAD_OFF, SEEK_SET );
    // read these 4 dwords
    fread( &amp;ptr_next, 4, 1, cfil );
    fread( &amp;ptr_name, 4, 1, cfil );
    fread( &amp;flags, 4, 1, cfil );
    fread( &amp;ptr_serv, 4, 1, cfil );

    // read name
    fseek( cfil, ptr_name - LOAD_OFF, SEEK_SET );
    fread( sbuf, 1, 79, cfil ); // read function name

    // read type and opcode
    fseek( cfil, ptr_serv - LOAD_OFF, SEEK_SET );
    fread( &amp;token_type, 2, 1, cfil );
    fread( &amp;opcode, 4, 1, cfil ); // may be opcode or constant value

    if( token_type != 2 ) // constants and variables
    {
      printf( "F=%04X, O=%08lX, T=%01X, N=%s\n" ,
        (int) flags, opcode, token_type, sbuf );
    }
    else // functions
    {
      printf( "F=%04X, O=%04X, P=%01X, T=%01X, N=%s\n" ,
        (int) flags, (int) (opcode &amp; 0xffff), (int) (opcode >> 16 ), token_type, sbuf );
    }

    fptr += 16; // point to next element in the table
  }
  while( fptr &lt; TABLE_END );

  fclose( cfil );
}

---cut here---</xmp><prE>

and here short doc to the above

&nbsp;&nbsp; indis.exe - InstallShield COMPILER.DLL token table dump - by zeezee

Usage:
Place into directory where COMPILER.DLL exists
Works only with version which is exactly 260096 bytes long and dated 22.01.97.
When using other version you must find and change table start address!

Command line: indis >indis.dat

For each function/constant/variable a record is generated eg:

For predefined values:

&nbsp;&nbsp;&nbsp; F=0201, O=000000CA, T=0, N=FREEENVSPACE

&nbsp;&nbsp;&nbsp; where:
&nbsp;&nbsp;&nbsp; F - flags
&nbsp;&nbsp;&nbsp; O - constant value (long)
&nbsp;&nbsp;&nbsp; T = 0 for constants, 1 for variables (?)
&nbsp;&nbsp;&nbsp; N - name

For built-in functions:

F=0201, O=0000, P=5, T=2, N=StructGetAddressEx
&nbsp;&nbsp;&nbsp; F - flags (other than 201 only for keywords)
&nbsp;&nbsp;&nbsp; O - opcode
&nbsp;&nbsp;&nbsp; P - param count (?)
&nbsp;&nbsp;&nbsp; T = 2 for built-in functions
&nbsp;&nbsp;&nbsp; N - name

Enjoy!
zeezee</PRE>
<!-- FINAL NOTES STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Final Notes</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>

<PRE>&nbsp;&nbsp;<!-- PASTE HERE YOUR FINAL NOTES (if any) -->Greets to NaTzGUL for his brilliant essay.</PRE>

<PRE>>>>five days later: ...and for wisdec decompiler!</PRE>

<PRE>
zeezee (not +zeezee yet, but I hope I will earn this someday ;)</PRE>
<!-- OB DUH STARTS HERE -->
<TABLE BORDER CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD BGCOLOR="#C6E7C6">
<CENTER><FONT COLOR="#0000FF"><FONT SIZE=+2>Ob Duh</FONT></FONT></CENTER>
</TD>
</TR>
</TABLE>

<CENTER><I>The standard Ob Duh does not apply here. We're only reversing,
not cracking.</I></CENTER>
<!-- WAY OUT STARTS HERE -->
<HR>
<CENTER><I>You are deep inside reverser's page of reverse engineering, choose
your way out:</I></CENTER>

<CENTER><!-- EITHER A NICE GIF LIKE THIS -->
<a href="progcor.htm" tppabs="http://members.xoom.com/tsehp_/progcor.htm"><IMG SRC="images/useful.gif" tppabs="http://members.xoom.com/tsehp_/images/useful.gif" ALT="progcor" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br><font color=gray>Back to progcor</FonT>
<br><bR>
<!-- OR JUST A LINK LIKE THIS -->
<!--
<IMG SRC="../../fourohfour.xoom.com/Members404Error.xihtml.htm" tppabs="http://members.xoom.com/tsehp_/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://members.xoom.com/tsehp_/project1.htm">Back to Your_chosen_project</A>
<hr width=33%>
-->
<CENTER>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"> homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm"> links</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm"> search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm"> +ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm"> students' essays</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm"> academy database</A>
<BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm"> reality cracking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="howtosea.htm" tppabs="http://members.xoom.com/tsehp_/howtosea.htm"> how to search</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="javascri.htm" tppabs="http://members.xoom.com/tsehp_/javascri.htm"> javascript wars</A>
<BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm"> tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm"> anonymity academy</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm"> cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="ideale.htm" tppabs="http://members.xoom.com/tsehp_/ideale.htm"> antismut CGI-scripts</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm"> mail_reverser</A>
<BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" BORDER=0 HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<HR>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>   <HTML>
<HEAD>
<TITLE>photosep.htm: ph0t0n's contribution to reverser's crossing</TITLE>

<body bgcolor="C0C0C0" text="#001010" vlink="#405040 Alink=#00FF50">
<prE>
                 Although I don't have nearly the leg to stand on that +Mammon does, I 
                 will tell my opions nonetheless...

                 I think a ReDesign is a great idea, And I think that you should keep
                 the 
                 cracking sections the same (unless for space considerations...) and you 
                 should only accept OUTSTANDING advanced cracking Tutorials (not as 
                 though I understand them yet).

                 I for one would love to see more on how to Reverse Engineer products -
                 I 
                 have spent a few good hours changing Netscape into eScape! And I feel 
                 this stuff is the most important things anyone can be doing (I know it 
                 sounds a little self-righteous, ohwell)

                 I feel [stepping onto soapbox] that by fixing the applications we 
                 currently have, we gain the ammunition to make the better programs of 
                 tomrow.
                 I'm currently in the throws of trying to 'fix' one of our most used 
                 tools W32-Dasm... although this program is well suited for the task it 
                 does, it was written terribly (sorry to the coder).  I can't even
                 choose 
                 a file to disassemble except for ONE method.  No command line, no OLE, 
                 no DDE nothing.
                 [stepping down]

                 In conclusion, I feel that your site is great, and whatever path your 
                 should choose to head, that It will in some way better the software 
                 world.
                 Thank you for the dissemanation of your knowledge - and providing a 
                 vechile through which other GREAT software agents / reality crackers / 
                 coders / anyother person with sound ideas may spread their own brand of 
                 Information.</prE>

</body>
</html>
<HTML>
<HEAD>
   
	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><TITLE>siulflex.htm: Linux advanced cracking: flexlm</TITLE>
</HEAD>
<BODY TEXT="#001010" BGCOLOR="#C0C0C0" VLINK="#405040">

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="22" >
<TR>
<TD></TD>

<TD>
<CENTER><P><!-- Choose  a TITLE probably wont be changed --><FONT
SIZE=+2>Flexlm,
the Flexible lies manager.<BR>
</FONT>XprismPro 1.0</P></CENTER>
</TD>

<TD>
<CENTER><P><!-- Choose  a PROJECT GIF may be changed --><A
HREF="ourtools.htm" tppabs="http://members.xoom.com/tsehp_/ourtools.htm"><IMG SRC="images/ourtools.gif" tppabs="http://members.xoom.com/tsehp_/images/ourtools.gif" ALT="our tools"
BORDER=0 HEIGHT=43 WIDTH=114 ALIGN=CENTER></A>
<BR>
<FONT COLOR="#808080">Our tools</FONT> </P></CENTER>
</TD>
</TR>

<TR>
<TD bgcolor="#FFFFEA">
<CENTER><P><FONT COLOR="#890000">06 September 1998 </FONT></P></CENTER>
</TD>

<TD bgcolor="#FFFFEA">
<CENTER><P>by SiuL+Hacky </P></CENTER>
</TD>

<TD valign="center" bgcolor="#FFFFEA"><A HREF="hcu98_3.htm" tppabs="http://members.xoom.com/tsehp_/hcu98_3.htm"><IMG
SRC="images/hcu1.gif" tppabs="http://members.xoom.com/tsehp_/images/hcu1.gif" ALT="+cracker" BORDER=0 HEIGHT=43 WIDTH=114
ALIGN=BOTTOM></A></TD>
</TR>

<TR>
<TD>
<CENTER><P><A HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm"><IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" BORDER=0
HEIGHT=13 WIDTH=13 ALIGN=BOTTOM></A></P></CENTER>
</TD>

<TD bgcolor="898030">
<CENTER><P>Courtesy of Reverser's page of reverse engineering
</P></CENTER>
</TD>

<TD bgcolor="898030"></TD>
</TR>

<TR>
<TD></TD>

<TD>
<CENTER><P><I>Well, well, well... while some of us have been sleeping in
the sun, other (more serious) crackers have worked a lot. SiuL+Hacky's
Linux essays are legendary, and here you have another VERY interesting
paper. Since everyone and his dog is now switching to Linux (and the
megaflop
of Windows'98 contributes to this... man, anyone that went trough the
ordeal
of upgrading that idiotical Windoze's OS will switch to Linux, I
believe)
these essays are more and more important. Actually, d'you want an
advice?
Throw your windoze away, start working (was about time) as you should in
Linux and start cracking the hell out of it following Siul+Hacky's
steps!<BR>
Enjoy this great work, but be warned: this stuff is not for beginners,
not at all.</I></P></CENTER>
</TD>

<TD>
<CENTER><P><A HREF="advanced.htm" tppabs="http://members.xoom.com/tsehp_/advanced.htm"><IMG SRC="images/advanced.gif" tppabs="http://members.xoom.com/tsehp_/images/advanced.gif" 
ALT="advanced" BORDER=0 HEIGHT=43 WIDTH=114 ALIGN=CENTER></A>
<BR>
<FONT COLOR="#808080">Advanced</FONT> </P></CENTER>
</TD>
</TR>

<TR>
<TD></TD>

<TD bgcolor="898030">
<CENTER><P><B>There is a crack, a crack in everything That's how the
light
gets in</B> </P></CENTER>
</TD>

<TD></TD>
</TR>

<TR>
<TD valign="MIDDLE" bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF">Rating</FONT> </P></CENTER>
</TD>

<TD valign="MIDDLE" bgcolor="#C6E7C6">
<CENTER><P><!-- CHOOSE A RATING (may be changed) --><FONT
COLOR="#0000FF">()<B>Beginner</B>
()<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</P></CENTER>
</TD>

<TD></TD>
</TR>
</TABLE>

<P><!-- CORPUS  --></P>

<P><BR>
<!-- CHOOSE A COMMENT (may be changed)  --></P>

<P>
<HR><!-- CHOOSE A TITLE (wont proabbly be changed) --></P>

<CENTER><P><FONT SIZE=+3>Flexlm: The Flexible lies manager.<BR>
</FONT><FONT SIZE=+2>XprismPro 1.0 <BR>
<!-- REPEAT YOUR CHOSEN HANDLE HERE --></FONT><FONT
COLOR="#0B7FC1">Written
by SiuL+Hacky </FONT><!-- INTRODUCTION STARTS HERE --><BR>
</P></CENTER>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT
SIZE=+2>Introduction</FONT></FONT><BR>
</P></CENTER>
</TD>
</TR>
</TABLE>

<P>One of the most popular commercial schemes in the unix worl is
Flexlm.
It has been working for several years in the market, but I've never seen
attempts to break it, probably, because it was not so popular in the
win-world,
and anyway it is not practically used in a shareware basis. It's used
with
huge software package that has more to do with warez. If you succede in
grasping the idea of FlexLM, you'll see that it may try to stop making
(ilegal) copies of legal software. It fails.</P>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT SIZE=+2>Tools
required</FONT></FONT><BR>
</P></CENTER>
</TD>
</TR>
</TABLE>

<P><!-- PASTE HERE YOUR REQUIRED TOOLS --></P>

<TABLE BORDER=1 WIDTH="100%" >
<TR>
<TD width="40%"><FONT COLOR="#0000FF">Ltrace </FONT></TD>

<TD width="60%">search for ltrace_0.3.2.tar.gz</TD>
</TR>

<TR>
<TD width="40%"><FONT COLOR="#0000FF">Dasm</FONT></TD>

<TD width="60%"><A HREF="siulflex.htm#DASM">Here !</A> </TD>
</TR>

<TR>
<TD width="40%"><FONT COLOR="#0000FF">perl interpreter</FONT></TD>

<TD width="60%">( available in linux distributions)</TD>
</TR>

<TR>
<TD width="40%"><FONT COLOR="#0000FF">gcc</FONT></TD>

<TD width="60%">(the same apply)</TD>
</TR>

<TR>
<TD width="40%"><FONT COLOR="#0000FF">Flexlm programer's
kit:</FONT></TD>

<TD width="60%"><A HREF="http://www.flexlm.com/">http://www.flexlm.com</A></TD></TR>

<TR>
<TD width="40%"><FONT COLOR="#0000FF">DDD</FONT></TD>

<TD width="60%"><A
HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">http://www.cs.tu-bs.de/softech/ddd</a>
</TD>
</TR>
</TABLE>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT SIZE=+2>Target's
URL/FTP</FONT></FONT><BR>
</P></CENTER>
</TD>
</TR>
</TABLE>

<P><!-- DON'T FORGET TO PASTE HERE ALSO THE URL/FTP OF YOUR TARGET
                 --></P>

<P>XprismPro: <A HREF="http://www.khoral.com/">http://www.khoral.com</A></P>

<P>The demo was removed some months ago, but it is used here as an
example
and some other linux program protected with Flexlm, could be used.
Moreover,
you could try also with Windows NT versions (I encourage you not to do
it, even just for aesthetic reason :-).</P>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT SIZE=+2>Tools
Update</FONT></FONT></P></CENTER>
</TD>
</TR>
</TABLE>

<P>There's a growing number of tools available for developing, but they
are quite specific and only a few of them are for general use. They
should
be know by you already, but for those of you <I>off the world</I> you
could
have a look to these variations of the known gdb:</P>

<P><B><U><A
HREF="file:///C:/Documents%20and%20Settings/Charlie/My%20Documents/My%20Webs/FRAVIA/new_page_1.htm">GDB 4.17</A> </U></B></P>

<P>This upgrade provides gdb multithread capabilites, that until this
version
had no support at all.</P>

<P><B><U><A
HREF="http://hegel.ittc.ukans.edu/projects/smartgdb">SMARTGDB 0.9</A></U></B></P>

<P>I must admit the idea of smartgdb developers is really interesting,
but i have to warn you too, that it still needs a lot of work for not
disappointing
you when you try to use it. The main improvements are firstly the
multithread
support, and secondly and more important, it carries a Tcl/Tk
interpreter
that allows you to write code that ameliorates the interface the way you
want. Moreover, it gives you the chance to write procedures that take
care
of breakpoints.</P>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT
SIZE=+2>Essay</FONT></FONT></P></CENTER>
</TD>
</TR>
</TABLE>

<P>After cracking with ltrace XPrismPro, i was really interested in some
of the internals of the comercial protection used: FlexLm (Flexible
License
Manager). Probably many of you know it, many hardware cad tools use that
crap, and you find it no matter you run Solaris or Windows NT (sorry for
the last ones). XPrismpro (hey don't look, they removed the demo time
ago
!), carried a complete user manual of Flexlm, well that's nice for
motivation,
but there were a lot of questions unanswered. The main details available
in the user's manual are (excerpt from flexlm user's manual): </P>

<OL>
<LI>The license module in the client application finds the license file,
which includes the host name of the license server node and port number
of the license manager daemon, lmgrd. </LI>

<LI>The client establishes a connection with the license manager daemon
(lmgrd) and tells it what vendor daemon it needs to talk to. </LI>

<LI>lmgrd determines which machine and port correspond to the master
vendor
daemon and sends that information back to the client. </LI>

<LI>The client establishes a connection with the specified vendor daemon
and sends its request or a license. </LI>

<LI>The vendor daemon checks in its memory to see if any licenses are
available
and sends a grant or denial back to the client. </LI>

<LI>The license module in the application grants or denies use of the
feature,
as appropriate. </LI>
</OL>

<P>I must add that the license file, a text file, contains a key (ten
bytes
i think) that authenticates the license. This license file and the
vendor
daemon must be provided by the software company that sells you the
program.
This is an exaple of license file (censored :-). </P>

<P><FONT FACE="Courier New"><FONT SIZE=-1>SERVER localhost.localdomain
ANY <BR>
VENDOR khoral /usr/local/flexlm/v6.0/i86_l1/khoral <BR>
FEATURE xprismpro khoral 1.0 permanent 4 XXXXXXXXXXXX </FONT></FONT></P>

<P>I must admit i don't find the coherence. Do flexlm guys really think
that network administrators are so worried with the lincensed/unlicensed
software that the people run ? Is the access granted by the server, by
the local license file, or by both ? I just can think the license server
is located inside vendor's network, i mean, imagine i buy some crap to
Adobe, and then everytime i run it, it connects with Adobe and grant me
access. But that is fucking unflexible :-) !!!. In that case i was
thinking
it could not be so hard to make a fake server that grants access
everytime.
</P>

<P>Anyway, after reading that i had to visit flexlm web site and look
for
some enlightenment: </P>

<P><a href="http://www.globetrotter.com/">http://www.globetrotter.com</a> </P>

<P>:-), firstly you can read there a ton of comercial shit about stop
piracy,
improve your sales and so on. Go to Flexlm product, and there is
available
an evaluation programmer's kit. Do you think flexlm programmer's kit is
protected with flexlm :-DDDD ??? NO, of course, not. BTW, you can get
that
programmers kit from some mirrors (do ftpsearch, and look for
install_flexlm.ftp).
</P>

<P>Two of the files are provided encrypted, and of course you must begg
for the key or start some reversing. A program is given to decrypt, and
it nicely tells you if the code is wrong and what is the format of the
code: </P>

<PRE><FONT SIZE=-1>xxxx-xxxx-xxxx-xxxx-xx or 
                 xxxx-xxxx-xxxx-xxxx-xxx or 
                 nnnn-xxxx-xxxx-xxxx-xxxx-xx </FONT></PRE>

<P>One of the features of the decryption program is to provide the key
in a text file. Perfect, don't forget it. </P>

<P>Run ltrace, of course, and you'll see that when you introduce a
number
in the format above, the last number (two or three ciphers) is converted
to long (atol function) and the error message is constructed. Dasm the
file and you'll see that the value returned by the function atol is
compared
with 0x100 (256), and you're fired if the value is greater. Then when
you
introduce the right format and the last number is less than 256, you
receive
a different error message. Looking at the new ltrace output, woowww,
there's
a call to sprintf that generates a string like xxxx-xxxx-xxxx-xxxx,
hmmm,
interesting. Now if you put this number you got from sprintf and keep
the
last number untouched, you'll get a good decryption key, but not good
for
the specific files. Fortunately, that sprintf is the only one present in
the whole log. </P>

<P>The last task is to get the specific decryption key for flexlm files.
I decided to use a funny approach and write a perl script that </P>

<OL>
<LI>calls the decryption program through ltrace. Last number among
[0-99]
</LI>

<LI>reads ltrace's log and builds a good key. Store it in a file and
repeat.
</LI>

<LI>once you get all the good keys, extract the first one, put it in a
file and check if it can decrypt flexlm files. </LI>

<LI>if not, just try the next </LI>
</OL>

<P>in a few seconds you'll get the good decryption key that i'll not
give
you, but you can easily get with the power of perl :-). </P>

<P>Once you get the programmers kit (evaluation) available, let's start
reading the manual, written in good html. I'll not punish you with the
gory details but the conclusion i got was, how could it be patented ???
All the supposed security of the flexlm is based in keeping the methods
secret. That is absurd, anyone could get this kit and you'll see how
vendors
are giving away in their daemons (or in their client programs) the
information
needed to build a license generator. The programmer's guide just gives
you some clues of the encryption process, and some of the functions of
Flexlm API (the ones used in the source code examples provided). </P>

<P>Now let's go to setup the whole thing and run an installation script.
It will ask you the vendor daemon name, a pair of 8 bytes encryption
seeds
that MUST BE KEPT SECRET as they are the ones that are unique to your
software,
and 5 vendor keys supposedly provided by Flexlm guys. Of course, i had
not that vendor keys. The script starts to compile your new daemon, but
at the end you receive a message that the vendor keys provided are
invalid
or so. </P>

<P>If you now look at the Makefile and the software provided, this is a
summary of what they supply in this kit: </P>

<OL>
<LI>License manager: lmgrd </LI>

<LI>Source examples for daemon and client program </LI>

<LI>Some utilities to test lmgrd, build licenses and so on. </LI>

<LI>Three libraries that must be linked and that contain Flexlm API,
server
and client side. </LI>

<LI>Source code for the license generator: <FONT
COLOR="#008000">lmcrypt</FONT>
(remeber that name) </LI>
</OL>

<P>The last one is really surprising at the first glance, but as the
interesting
routines are in the libraries it's not that easy. Anyway it's impossible
not to run lmcrypt just the second you see it. Run it and you'll get the
stupid message about the vendor keys. Most of the compiled programs
showed
the same behaviour, so it is neccessary to: </P>

<UL>
<LI>Build valid vendor keys. </LI>

<LI>Patch a little bit. </LI>
</UL>

<P>May be any of you like the first option, i find it particularly
boring.
Hey, hey, one moment, that's what Flexlm guys says about the security of
their product: </P>

<P>---------------------------------------------------------- Keeping
Your
Software Secure </P>

<P>No software is completely secure. FLEXlm is no exception. While
GLOBEtrotter
Software has made every effort to ensure the integrity of FLEXlm, all
points
of attack can never be anticipated. The following lists known points of
vulnerability in FLEXlm in increasing order of difficulty to break.
Globetrotter
Software also maintains a list of techniques for making your
implementation
more secure - please contact technical support (<a href="index-old.htm" tppabs="http://members.xoom.com/tsehp_/py/nfCmp.py-Pyt=Tnf&1st=1&to=support@globes.com&YY=17604">support@globes.com</a>) for
a description of these techniques. </P>

<P><I>Easy</I> </P>

<P>Running the debugger on the application code if it is released with
unstripped executables (on Unix) or as a debug version (on Windows).
</P>

<P><I>Difficult, depending on application policy </I></P>

<P>Killing the daemons, since a majority of daemons must be up in order
for anything to run, and a dead daemon is detected within the timer
interval
in a client. If, however, you do not use one of the built-in timers and
you do not call HEARTBEAT(), then your software protection could be
bypassed
by someone who kills the daemons each time that the application reaches
the maximum license limit, as the applications would never detect that
the daemon went down. </P>

<P><I>Very Difficul</I>t </P>

<P><B>Guessing</B> the license keys that belong in the license file.
FLEXlm's
standard authentication algorithm takes the user-visible data fields
(number
of licenses, expiration date, version number, vendor-defined string,
feature
name, host IDs of all servers, plus any optional authenticated fields)
and combines them with the vendor's private encryption seeds to produce
a license key. The algorithm used is a proprietary one-way block
chaining
encypherment of all the input data.</P>

<P><B>Writing</B> a new daemon that emulates your vendor daemon. FLEXlm
encrypts the traffic between client and vendor daemon to make this point
of attack much more difficult. </P>

<P><B>Running</B> the debugger on a stripped (Unix) or a non-debug
(Windows)
executable. This requires someone to find the FLEXlm calls without any
symbol table knowledge. </P>

<P>-------------------------------------------- At the end of the essay
you may set your own ratios :-). </P>

<P>I like this facility of english language to put qualifiers one after
the other, even though is widely used in commercial stuff. Watch the
pseudo-sophistication
that it provides:</P>

<P><I>&quot;The algorithm used is a proprietary one-way block chaining
encypherment ...&quot;</I></P>

<P>Back to the cracking, if you see the <U>source</U> code of lmcrypt.c,
the error message is caused by a call to the function lc_init: </P>

<P><FONT FACE="Courier New"><FONT SIZE=-1>status = <FONT
COLOR="#0000FF">lc_init</FONT>(prevjob,
VENDOR_NAME, &amp;code, &amp;job); </FONT></FONT></P>

<P>if the function doesn't return 0, you know, beggar off. I felt really
dissappointed patching the source code, so let's go back to our
libraries
and look for a global solution. There are three: </P>

<PRE><FONT SIZE=-1>liblmgr.a
                 liblmgr_as.a
                 liblmgr_s.a</FONT></PRE>

<P>Usually you find two types of libraries: <B>.a</B> libraries (static)
and <B>.so</B> (dynamic). So in this case there's a collection of static
libraries that are statically linked to your code. How they are made?
Well,
very simple these files are just &quot;<B>ar</B>&quot; archives (similar
to tar archives), and inside them there's a collection of object (.o)
files.
With &quot;<B>ar</B>&quot; command you may extract files, add, and so
on.
The syntax is the same of the tar command. There's also a very useful
command
for investigating the contents of a library: <B>nm</B>. This command
gives
you information about how is organized the library's functions and
variables.
This is just some interesting part of running nm libmgr.a </P>

<PRE><FONT SIZE=-1>lm_init.o: 
                 00000000 d VERSION
                          U calloc
                          U errno
                 00000004 d first
                 00000000 t gcc2_compiled.
                          U getenv
                          U l_getattr
                          U l_getattr_init
                          U l_malloc
                          U l_more_featdata
                 00000014 D l_n36_buff
                          U l_set_error
                          U l_sg
                 00000af0 T lc_first_job
                          U lc_get_attr
                 00000000 T lc_init
                 00000b10 T lc_next_job
                          U lc_set_attr
                 00000008 D lm_bpi
                 0000000c D lm_max_masks
                 00000010 D lm_nofile
                          U localtime
                 </FONT> </PRE>

<P>the numbers on the right is the location of the data or the function
inside the object code file. If it is empty then the symbol was declared
as external. So here we can see that the code of <FONT
COLOR="#0000FF">lc_init
</FONT>is inside file lm_init.o. You know what to do, extract lm_init.o,
patch the code in a way <FONT COLOR="#0000FF">lc_init</FONT> returns
always
0 and then replace the old lm_init.o in the library, with your patched
file. This way if you rebuild all the programs, they will give you no
problems
with the vendor keys (at least less :-). </P>

<P>Now<FONT COLOR="#008000"> lmcrypt</FONT> runs fine. It gets a
just-made
license file as the input (the checksum key must be equal to 0), and
gets
out a perfect valid license file. My very first idea was to crack the
daemon
in order to grant access always, so i realized debuggin a daemon (memory
resident) program could be too hard without ltrace. The problem is that,
although may be supported in the future, now ltrace doesn't log calls to
functions inside the executable (even if they are available in the
symbol
table), and all the cool functions from the API are statically linked.
What i tried next, was to make them dynamically linked. I know that
needs
an explanation, ok. </P>

<P>We've got three libraries full of object files, now if you extract
those
object files in a directory and then use gcc (C compiler if you don't,
but should, know) to create a shared <B>.so</B> library, it could be
possible
to recompile the programs, indicating the compiler to link dynamically
to the new <B>.so</B> library. I was not quite sure that it would work,
but in about an hour i had my brand new version of <FONT
COLOR="#008000">lmcrypt</FONT>
dynamically linked. The command line for creating shared libraries is
something
like this: </P>

<P>gcc -shared -Wl,-soname,libflex.so.1 -o libflex.so.1.0 *.o </P>

<P>if you want to repeat this process, i got two unresolved references
that have to be solved: </P>

<OL>
<LI>Add an aditional object file lm_new.o that is compiled when you
build
the whole crap. </LI>

<LI>Before creating the .so library remove lm_sapi.o file. </LI>
</OL>

<P>If you don't want problems, put the library in /usr/local/lib for
instance,
run ldconfig and it's ready to be used: </P>

<P>gcc -o <FONT COLOR="#008000">lmcrypt</FONT> lmcrypt.c -lflex </P>

<P>As you'll know soon, i got nothing with all this, but i'm telling you
because i got a really good time with the process (the best of the whole
crack) and may be useful for you in the future.</P>

<P>Anyway, like it was quite successful, i repeated the process
compiling
the daemon. It was not so hard and i got a dynamically linked daemon,
but
soon i realized i could not use ltrace with it for two reasons: </P>

<UL>
<LI>Ltrace analyzes an ELF file and log the calls made to dynamic
functions
declared in the ELF file. So the functions called from functions in the
library ( a function in a library calls another one in a library), are
not logged. In my daemon, even the main function was taken from the
library
created (libflex.so.1), then nothing could be logged. You dig it ? The
solution was to leave some of the &quot;important&quot; object files
outside
the dynamic library and link them statically, but it was getting really
meshy. </LI>
</UL>

<UL>
<LI>The daemon cannot be started directly. Is the license manager lmgrd,
the one that starts the daemon (via an exec system call). Ltrace has
some
problems logging child processes and that was the case. Later i
discovered
that you may start the daemon by yourself, you just need to give it the
appropiate (and not obvious) commmand line. </LI>
</UL>

<P>I finally decided to build my fat statically linked daemon. When you
run it, it gives you a message about vendor keys don't support daemon
mode
and then it shows your vendorkey1, vendorkey2, vendorkey3 and
vendorkey4.
I forgot to tell you the evaluation kit had the limitation that it
didn't
support daemon mode. I patched the file, and i received a message about
my vendor keys were over. I patched it too and then, i got no message
but
my deamon died when it was booting, creating a segmentation fault. In
that
case a &quot;core&quot; file is generated and can be debugged with gdb
( i just got there the command line for the daemon). </P>

<P>Ok, may be the vendor keys are necessary ... Then i got the daemon
provided
by khoral guys from XPrismPro and it booted with no error. Ok, why don't
getting khoral vendor keys ???? </P>

<P>Now is the moment to give the information about the encryption
process
and some data structure used by the software. The supposed process is:
</P>

<P>a) for running the software, you get vendor keys 1,2,3,4 and 5. </P>

<P>b) <FONT COLOR="#008000">lmcrypt</FONT><FONT COLOR="#408080">
</FONT>creates
the license. For the job it uses your PERSONAL AND SUPERSECRET
encryption
seed1 and seed2. </P>

<P>c) the daemon checks the encryption using encryption seed1 and seed2
xored with vendorkey5, to keep them secret and improve security :-DDDDD.
</P>

<PRE><FONT SIZE=-1>typedef struct  {
                                             short type;   
                                             unsigned long data[2];
                                             unsigned long keys[4]; 
                                             short flexlm_version;
                                             short flexlm_revision;
                                             char flexlm_patch[2];
                                             char
behavior_ver[LM_MAX_BEH_VER + 1];
                                           } codes;
</FONT>                 </PRE>

<P>where &quot;data&quot; array keeps encryption seeds (xored with
vendorkey5),
and &quot;key&quot; array keeps vendorkeys1,2,3 and 4. If you go back to
the definition of function <FONT COLOR="#0000FF">lc_init</FONT>, a
pointer
to a structure like this is passed to the function. </P>

<P>You'll notice that vendorkey5 is not present in the data structure,
you can do a binary search in the daemon and it is no present as a
redable
data. It's quite easy to run DDD and in the call to <FONT
COLOR="#0000FF">lc_init</FONT>,
for instance, read khoral vendor keys1,key2,key3,key4, xored_seed1 and
xored_seed2. All of them are carried in a the structure declared above.
</P>

<P>I tried to use those vendor keys (and make up the five one :-)
building
my home daemon, but the performance was the same i obtained with my
patching:
the daemon dies with no error message. Ok, let's admit that the
evaluation
kit doesn't support daemon mode (or at least is not too obvious to fool
it). Well let's concentrate now in the license generation. </P>

<P>What <FONT COLOR="#008000">lmcrypt</FONT> finally does is to call the
function lc_cryptstr </P>

<P><FONT FACE="Courier New"><FONT SIZE=-1>int lc_cryptstr(job, str,
return_str,
code, flag, filename, errors) </FONT></FONT></P>

<P>that takes the text line of the license with the sensitive
information
(and the checksum key=0) and replaces the checksum key with the good
value.
The parameter &quot;code&quot;, is the structure that we saw before, BUT
seed1 and seed2 have been previously unxored, i.e., the original value
of seed1 and seed2. Vendorkey5 is available to the program <FONT
COLOR="#008000">lmcrypt,</FONT>
so the unxoring is no mistery. The difference is that vendorkey5 is not
provided to the daemon that checks the license to be good or bad. </P>

<P>To be honest i didn't believe such an algorithm that takes the
ckecksum
and says if it's good or bad without generating it again. Obviously
vendorkey5
should be hidden somehow in the code ( i made some tests and vendorkey5
was not introduced in the code of the daemon ). It was a little bit
tricky,
but either way as vendorkey5 is a 4 bytes value, a brute force attack
would
not be so hard and the system would be quite unsecure. </P>

<P>Of course, my home daemon had a perfect symbol table, and the
function
used by <FONT COLOR="#008000">lmcrypt</FONT> (lc_cryptstr) was not used.
It would be too obvious. Reading the documentation of lc_cryptstr,
Globber
guys says that function is an easier choice than using directly
lc_crypt,
a function that is not documented BTW. The declaration is something
like:
</P>

<P><FONT FACE="Courier New"><FONT SIZE=-1>lc_crypt (no_care, no_care,
no_care,
code); </FONT></FONT></P>

<P>code ? quite interesting. Let's look at the assembly listing of the
daemon, read it backwords: ( i worked most of the time with khoral
daemon,
the one with the intersting seeds and no symbols, but it's more
educational
if you see the symbol names :-) </P>

<PRE>0806428a <ls_do_borrow+72a> leal   0xfffff7b4(%ebp),%eax
08064290 <ls_do_borrow+730> pushl  %eax;   <-- code "parameter.class" 
08064291 <ls_do_borrow+731> pushl  $0x0;   <-- paramter for
l_bin_date

Reference to function : l_bin_date

08064293 <ls_do_borrow+733> call   08078710
08064298 <ls_do_borrow+738> addl   $0x4,%esp
0806429b <ls_do_borrow+73b> movl   %eax,%eax
0806429d <ls_do_borrow+73d> pushl  %eax;    <--- no care parameter3
0806429e <ls_do_borrow+73e> movl   0x10(%ebp),%eax
080642a1 <ls_do_borrow+741> pushl  %eax;    <--- no care parameter2
080642a2 <ls_do_borrow+742> movl   0x80aebac,%eax
080642a7 <ls_do_borrow+747> pushl  %eax;    <--- no care parameter1

Reference to function : lc_crypt

080642a8 <ls_do_borrow+748> call   0808c0a0 <<<< calling
lc_crypt </PRE>

080642ad <ls_do_borrow+74d> addl   $0x10,%esp
</PRE>

<P>then the parameter comes from a local variable, let's see now the
whole
routine:</P>

<PRE><FONT SIZE=-1>Reference to function : l_svk

0806423b <ls_do_borrow+6db> call   08087e30 
08064240 <ls_do_borrow+6e0> addl   $0x8,%esp
08064243 <ls_do_borrow+6e3> movl   %eax,%eax
08064245 <ls_do_borrow+6e5> movl   %eax,local_A; <--- the returned value
0806424b <ls_do_borrow+6eb> pushl  $0x28;     <------- size of structure
0806424d <ls_do_borrow+6ed> movl   0x80ae910,%eax; <-- pointer to &quot;code&quot; structure
08064252 <ls_do_borrow+6f2> pushl  %eax
08064253 <ls_do_borrow+6f3> leal   local_B,%eax
08064259 <ls_do_borrow+6f9> pushl  %eax

Reference to function : memcpy  <------ copy code "structure.class" to local_2

0806425a <ls_do_borrow+6fa> call   0804977c
0806425f <ls_do_borrow+6ff> addl   $0xc,%esp
08064262 <ls_do_borrow+702> movl   0x80ae910,%eax; <-- pointer to code "struc.class" 
08064267 <ls_do_borrow+707> movl   0x4(%eax),%ecx; <-- load seed1
0806426a <ls_do_borrow+70a> xorl   local_A,%ecx;   <-- some xoring
08064270 <ls_do_borrow+710> movl   %ecx,local_B+4; <-- update seed1
08064276 <ls_do_borrow+716> movl   0x80ae910,%eax; <-- pointer to code "struc.class" 
0806427b <ls_do_borrow+71b> movl   0x8(%eax),%ecx; <-- load seed2
0806427e <ls_do_borrow+71e> xorl   local_A,%ecx;   <-- more xoring
08064284 <ls_do_borrow+724> movl   %ecx,local_B+8; <-- update seed2
0806428a <ls_do_borrow+72a> leal   local_B,%eax;   <-- corrected code
08064290 <ls_do_borrow+730> pushl  %eax;   <---------- our parameter
08064291 <ls_do_borrow+731> pushl  $0x0

Reference to function : l_bin_date

08064293 <ls_do_borrow+733> call   08078710 
08064298 <ls_do_borrow+738> addl   $0x4,%esp
0806429b <ls_do_borrow+73b> movl   %eax,%eax
0806429d <ls_do_borrow+73d> pushl  %eax
0806429e <ls_do_borrow+73e> movl   0x10(%ebp),%eax
080642a1 <ls_do_borrow+741> pushl  %eax
080642a2 <ls_do_borrow+742> movl   0x80aebac,%eax
080642a7 <ls_do_borrow+747> pushl  %eax

Reference to function : lc_crypt

080642a8 <ls_do_borrow+748> call   0808c0a0 <lc_crypt>
080642ad <ls_do_borrow+74d> addl   $0x10,%esp
</FONT>                 </PRE>

<P>I put again the code structure to ease the analysis: </P>

<PRE><FONT SIZE=-1>typedef struct  {
                           short type;
                           unsigned long data[2];
                           unsigned long keys[4];
                           short flexlm_version;
                           short flexlm_revision;
                           char flexlm_patch[2];
                           char behavior_ver[LM_MAX_BEH_VER + 1];
                         } codes;
</FONT>                 </PRE>

<P>OK, so vendorkey5 is supplied by a call to function l_svk (of course,
not documented) </P>

<P>int l_svk(char*,codes*) </P>

<P>And my dear friends, the first parameter is the daemon name !!! I
didn't
analysed it deeply, but apparently the function uses vendorkeys2 and 3,
together with vendor name, and builds on the fly vendorkey5, used to
unxor
seed1 and seed2. </P>

<P>Now we get all the data to rebuild the whole crap, and build all
kind,
types, sort of licenses, server redundants, node locked, permanent,
blah,
blah. HEY COMPANIES FROM THE WORLD, THIS IS YOUR SECURITY !!! I don't
understand
quite well what does a company as Lockeed Martin using Flexlm. Once you
know the process, it's quite easy to look at function signatures and
locate
the sensible functions quickly. The whole security is based on secrecy,
and that uses to be no security. </P>

<P>The license generation works perfectly if you want to try it. Anyway
my doubts about the whole crap remains. Apparently XPrismPro doesn't use
the daemon thing at all. Turn it on, turn it off, it only needs the
license
file, so i'll gotta wait to test the daemon weakness ( or not ). If
anyone
understands perfectly the daemon working, please tell me. What now I
grasp
it's that the idea is to spread n (identic) licenses in a company, and
you can use just m (m<n) at the same time, so the license server
                 grant
                 access depending on wether or not m<n. The information
for
                 "m"
                 is got from the license that has to be located in the
local host and the
                 server too.</P>
</P>

<P>That's all folks !!!</P>

<P>--------------------------------------------------------</P>

<P>Because people use to ask it to me, i repeat here the code for dasm,
but IT WAS AVAILABLE IN OLD ESSAYS TOO !</P>

<P><A NAME="DASM"></A></P>

<PRE><FONT SIZE=-1>#!/usr/bin/perl
;############ MODIFY THIS LINE WITH YOUR PERL LOCATION ############
push(@INC,&quot;/usr/lib/perl5&quot;);
require(&quot;flush.pl&quot;);


;##################################################################
;######## LINUX DISASSEMBLER 2.01
;######## (C) SiuL+Hacky Aug 1998
;######## You may copy, modify, distribute this program and
;######## is up you to keep this header here
;######## Usage: dasm exe_file dasm_file
;##################################################################


$f_input=$ARGV[0];
$f_output=$ARGV[1];
&amp;printflush(STDOUT, &quot;\nCreating disassembled file ...&quot;);
$return=system(&quot;objdump -d -T -x --prefix-addresses
&quot;.$f_input.&quot;>&quot;.$f_output.&quot;2&quot;);
if ($return!=0){
  print &quot;\nERROR OPENING OBJDUMP $return&quot;;
  print &quot;\nUsage: dasm exe_file dasm_file&quot;;
  print &quot;\nBe sure to get objdump in your path. Check also file
permissions\n&quot;;
  exit(1);
 }

open(INPUT, &quot;<&quot;.$f_output.&quot;2&quot;);

&amp;printflush(STDOUT, &quot;\nReading strings ...&quot;);
$_=<INPUT>;
while (!/.rodata/){
  $_=<INPUT>;
}
($rubbish, $rest)=split(/.rodata/,$_,2);
($rubbish, $rest)=split(/0/,$rest,2);
@numbers=split(/  /,$rest,5);
$size=hex($numbers[0]);
$starting_address=hex($numbers[1]);
$end_address=$starting_address+$size;
$offset=hex($numbers[3]);
open(CODIGO, &quot;<&quot;.$f_input);
seek(CODIGO,$offset,0);
read(CODIGO,$cadena,$size);
close(CODIGO);


$_=<INPUT>;
while (!/SYMBOL TABLE/){
  $_=<INPUT>;
}
&amp;printflush(STDOUT, &quot;\nProcessing symbol table ...&quot;);
$_=<INPUT>;
while (!/^\n/){
 @st_element=split(/ /, $_);
 $_=$st_element[$#st_element];
 chop;
 $symbol_table{$st_element[0]}=$_;
 $_=<INPUT>;
}


while (!/\.text/){
  $_=<INPUT>;
}
&amp;printflush(STDOUT,  &quot;\nProcessing jmps and calls ...&quot;);

######### the regex gets rid of possible line information #############


while (<INPUT>){
  $_=~ s/<.*?>//g;
  $_=~s/  / /g;
  if (/j/){
    ($direccion,$inst,$destino)=split(/ /,$_,3);
    $destino=~s/ //g;
    chomp($destino);
    $salto{$destino}.=($direccion.&quot; \; &quot;);
  }
  elsif (/call/){
    ($direccion,$inst,$destino)=split(/ /,$_,3);
    $destino=~s/ //g;
    chomp($destino);
    $call{$destino}.=($direccion.&quot; \; &quot;);
  }
}

seek(INPUT,0,0);
&amp;printflush(STDOUT, &quot;\nWritting references ...\n&quot;);
open(OUTPUT, &quot;>&quot;.$f_output) || die print &quot;\nError
opening write file\n&quot;;
print OUTPUT &quot;FILE REFERENCED\n\n&quot;;

while (!/Disassembly of section .text:/){
 $_=<INPUT>;
 print OUTPUT;
}
$char=&quot;.&quot;;
$counter=0;
while(<INPUT>){
 $counter++;
 if ( ($counter % 400)==0){
   printflush(STDOUT,$char);
   if ( ($counter % 4000)==0){
     printflush(STDOUT,&quot;\r&quot;);
     if ($char eq &quot;.&quot;){ $char=&quot; &quot;;}
     else { $char=&quot;.&quot;;}
   }  
 }
 $copia=$_;
 $_=~s/<.*?>//ge;
 $_=~s/  / /g;
 ($direccion, $inst, $destino)=split(/ /,$_,3);
 if ( defined( $symbol_table{$direccion} )){
   print OUTPUT &quot;\n&quot;;
   print OUTPUT &quot;---- Function :
&quot;.$symbol_table{$direccion}.&quot; ----\n&quot;;
 }
 if (/call/){
   $destino=~s/ //g;
   chomp($destino);
   if ( defined( $symbol_table{$destino} )){
     print OUTPUT &quot;\n&quot;;
     print OUTPUT &quot;Reference to function :
&quot;.$symbol_table{$destino}.&quot;\n\n&quot;;
   }
 }  
 if ( defined( $salto{$direccion} )){
   print OUTPUT &quot;\n&quot;;
   print OUTPUT &quot;Referenced from jump at
&quot;.$salto{$direccion}.&quot;\n\n&quot;;
 }
 if ( defined( $call{$direccion} )){
   print OUTPUT &quot;\n&quot;;
   print OUTPUT &quot;Referenced from call at
&quot;.$call{$direccion}.&quot;\n\n&quot;;
 }
 if (/\$/){
        ($instruccion, $operand)=split(/\$/,$_,2);
        if (!/push/){
          ($operand, $rest)=split(/\,/,$operand,2);
        }
        chomp($operand);
        $offset=hex($operand);
        if ( ($offset <= $end_address) &amp;&amp; ($offset >=
$starting_address ) ){
          $auxiliar=substr($cadena, $offset-$starting_address);
          $length=index($auxiliar, pack(&quot;x&quot;) );
          $auxiliar=substr($auxiliar, 0, $length);       
          $auxiliar=~s/\n//g;
          print OUTPUT &quot;\n&quot;;
          print OUTPUT &quot;Possible reference to string:&quot;;
          print OUTPUT &quot;\n\&quot;$auxiliar\&quot;\n\n&quot;
        }       
  }
 print OUTPUT $copia;
}
close(INPUT);
close(OUTPUT);
print &quot;\n&quot;;
system(&quot;rm &quot;.$f_output.&quot;2&quot;);
</FONT>                 </PRE>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT SIZE=+2>Final
Notes</FONT></FONT><BR>
</P></CENTER>
</TD>
</TR>
</TABLE>

<P><!-- PASTE HERE YOUR FINAL NOTES (if any) --></P>

<P>It's not my intention to harm any company that was fooled with this
system, so as you could see no ready to use crack was released. I just
wanted to show how poor is the protection scheme used in the license
generation.</P>

<TABLE BORDER=1 CELLSPACING=2 WIDTH="100%" HEIGHT="45" >
<TR>
<TD bgcolor="#C6E7C6">
<CENTER><P><FONT COLOR="#0000FF"><FONT SIZE=+2>Ob Duh</FONT></FONT><BR>
</P></CENTER>
</TD>
</TR>
</TABLE>

<CENTER><P><I>I WILL bother explaining you that you should BUY this
target
program if you intend to use it for a longer period than the allowed
one.
Should you want to STEAL this software instead, you are a moron. This is
the kind of software that WE NEED. Many people should register it and
allow
its Author to write even more interesting stuff!</I> <!-- WAY OUT
                 STARTS HERE --></P></CENTER>

<P>
<HR></P>

<CENTER><P><I>You are deep inside reverser's page of reverse engineering,
choose your way out:</I> <BR>
</P></CENTER>

<CENTER><P>
<HR ALIGN=CENTER WIDTH=100% SIZE=3><!-- Begin  main mover --><FONT
SIZE=+2>Reverser's
main site</FONT> <BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="FRAVIA_index.htm" tppabs="http://members.xoom.com/tsehp_/index.htm">homepage</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="orc.htm" tppabs="http://members.xoom.com/tsehp_/orc.htm">+ORC</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="noanon.htm" tppabs="http://members.xoom.com/tsehp_/noanon.htm">anon</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="coumes.htm" tppabs="http://members.xoom.com/tsehp_/coumes.htm">counter
measures</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13
ALIGN=BOTTOM><A HREF="tools.htm" tppabs="http://members.xoom.com/tsehp_/tools.htm">tools</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="academy.htm" tppabs="http://members.xoom.com/tsehp_/academy.htm">+HCU
Academy</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13
ALIGN=BOTTOM><A HREF="stalking.htm" tppabs="http://members.xoom.com/tsehp_/stalking.htm">stalking</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">reality cracking</A>
<BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="student.htm" tppabs="http://members.xoom.com/tsehp_/student.htm">students'
essays</A> <IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13
ALIGN=BOTTOM><A HREF="cocktail.htm" tppabs="http://members.xoom.com/tsehp_/cocktail.htm">cocktails</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="links.htm" tppabs="http://members.xoom.com/tsehp_/links.htm">links</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="searengi.htm" tppabs="http://members.xoom.com/tsehp_/searengi.htm">search_forms</A>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="info.htm" tppabs="http://members.xoom.com/tsehp_/info.htm">mail_reverser</A>
<BR>
<IMG SRC="images/bulletr.gif" tppabs="http://members.xoom.com/tsehp_/images/bulletr.gif" ALT="red" HEIGHT=13 WIDTH=13 ALIGN=BOTTOM><A
HREF="legal.htm" tppabs="http://members.xoom.com/tsehp_/legal.htm">Is
reverse engineering legal?</A> <!-- End main mover --></P></CENTER>

</BODY>
</HTML><html>                                                                                                        
<head>                                                                                                        

	<META NAME="VPSiteProject" CONTENT="file:///C|/Documents%20and%20Settings/Administrator/My%20Documents/My%20Webs/fravia/Project.vpp"><meta name="voluntary content rating" content="pending">                                                       
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
<meta name="robots" content="noindex, nofollow">    
<meta http-equiv="content-language" content="en-us">                                                                                                          
<title>danadd2.htm: Dangerous food additives &amp reversing labels [second installment]</title>                                       
</head>                                                                                                       


<body bgcolor=#c0c0c0 text=#001010 vlink=#405040>                                                             

<center>
<a href="realicra.htm" tppabs="http://members.xoom.com/tsehp_/realicra.htm">
<img src="images/realicra.gif" tppabs="http://members.xoom.com/tsehp_/images/realicra.gif" alt="realicra" align=bottom width=114 height=43 border=0 vspace=0 hspace=0></a>
</center>

<br>

<center><font color=gray>reality cracking